# Action definition:
  # type Mutation {
  #   scalar_array_response : [String!]!
  #   }
  # }
# Hanlder/Webhook response:
  # ["foo", "bar", null]

- description: Update action definition to expect non-nullable array fields
  url: /v1/query
  status: 200
  response:
    message: success
  query:
    type: update_action
    args:
      name: scalar_array_response
      definition:
        kind: synchronous
        arguments:
        output_type: '[String!]!'
        handler: "{{ACTION_WEBHOOK_HANDLER}}/scalar-array-response"

- description: Run scalar-array-response sync action
  url: /v1/graphql
  status: 200
  query:
    query: |
      mutation {
        scalar_array_response
      }

  response:
    errors:
    - extensions:
        internal:
          error: unexpected response
          response:
            status: 200
            body: 
              - foo
              - bar
              - null
            headers:
            - value: application/json
              name: Content-Type
            - value: abcd
              name: Set-Cookie
          request:
            body:
              session_variables:
                x-hasura-role: admin
              input: {}
              action:
                name: scalar_array_response
              request_query: "mutation {\n  scalar_array_response\n}\n"
            url: "{{ACTION_WEBHOOK_HANDLER}}/scalar-array-response"
            headers: []
            transformed_request:
        path: $
        code: unexpected
      message: got null for the action webhook response
- description: Revert action wehbook
  url: /v1/query
  status: 200
  response:
    message: success
  query:
    type: update_action
    args:
      name: scalar_array_response
      definition:
        kind: synchronous
        arguments:
        output_type: '[String]!'
        handler: "{{ACTION_WEBHOOK_HANDLER}}/scalar-array-response"
