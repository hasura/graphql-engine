<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hasura.RQL.DDL.Action</span><span>
</span><span id="line-4"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#CreateAction"><span class="hs-identifier">CreateAction</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#runCreateAction"><span class="hs-identifier">runCreateAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#resolveAction"><span class="hs-identifier">resolveAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#UpdateAction"><span class="hs-identifier">UpdateAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#runUpdateAction"><span class="hs-identifier">runUpdateAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#DropAction"><span class="hs-identifier">DropAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#runDropAction"><span class="hs-identifier">runDropAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#dropActionInMetadata"><span class="hs-identifier">dropActionInMetadata</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#CreateActionPermission"><span class="hs-identifier">CreateActionPermission</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#runCreateActionPermission"><span class="hs-identifier">runCreateActionPermission</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#DropActionPermission"><span class="hs-identifier">DropActionPermission</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#runDropActionPermission"><span class="hs-identifier">runDropActionPermission</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#dropActionPermissionInMetadata"><span class="hs-identifier">dropActionPermissionInMetadata</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#caName"><span class="hs-identifier">caName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#caDefinition"><span class="hs-identifier">caDefinition</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#caComment"><span class="hs-identifier">caComment</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#uaName"><span class="hs-identifier">uaName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#uaDefinition"><span class="hs-identifier">uaDefinition</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#uaComment"><span class="hs-identifier">uaComment</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">where</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">makeLenses</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.~)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(^.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">J</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.TH</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">J</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Dependent.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DMap</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Environment.html"><span class="hs-identifier">Data.Environment</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Env</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict.InsOrd</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">OMap</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NEList</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Text.Extended.html"><span class="hs-identifier">Data.Text.Extended</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html"><span class="hs-identifier">Hasura.Base.Error</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.EncJSON.html"><span class="hs-identifier">Hasura.EncJSON</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Metadata.Class.html"><span class="hs-identifier">Hasura.Metadata.Class</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Prelude.html"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.CustomTypes.html"><span class="hs-identifier">Hasura.RQL.DDL.CustomTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DDL.CustomTypes.html#lookupPGScalar"><span class="hs-identifier">lookupPGScalar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Action.html"><span class="hs-identifier">Hasura.RQL.Types.Action</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html"><span class="hs-identifier">Hasura.RQL.Types.Common</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html"><span class="hs-identifier">Hasura.RQL.Types.CustomTypes</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html"><span class="hs-identifier">Hasura.RQL.Types.Metadata</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.Object.html"><span class="hs-identifier">Hasura.RQL.Types.Metadata.Object</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html"><span class="hs-identifier">Hasura.RQL.Types.SchemaCache</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.Build.html"><span class="hs-identifier">Hasura.RQL.Types.SchemaCache.Build</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.SQL.Tag.html"><span class="hs-identifier">Hasura.SQL.Tag</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Session.html"><span class="hs-identifier">Hasura.Session</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.GraphQL.Draft.Syntax</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span id="local-6989586621688702850"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#getActionInfo"><span class="hs-identifier hs-type">getActionInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688702850"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#CacheRM"><span class="hs-identifier hs-type">CacheRM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688702850"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Action.html#ActionName"><span class="hs-identifier hs-type">ActionName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><a href="#local-6989586621688702850"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Action.html#ActionInfo"><span class="hs-identifier hs-type">ActionInfo</span></a></span></span><span>
</span><span id="line-55"></span><span id="getActionInfo"><span class="annot"><span class="annottext">getActionInfo :: ActionName -&gt; m ActionInfo
</span><a href="Hasura.RQL.DDL.Action.html#getActionInfo"><span class="hs-identifier hs-var hs-var">getActionInfo</span></a></span></span><span> </span><span id="local-6989586621688702807"><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702807"><span class="hs-identifier hs-var">actionName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-56"></span><span>  </span><span id="local-6989586621688702806"><span class="annot"><span class="annottext">ActionCache
</span><a href="#local-6989586621688702806"><span class="hs-identifier hs-var">actionMap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SchemaCache -&gt; ActionCache
</span><a href="Hasura.RQL.Types.SchemaCache.html#scActions"><span class="hs-identifier hs-var hs-var">scActions</span></a></span><span> </span><span class="annot"><span class="annottext">(SchemaCache -&gt; ActionCache) -&gt; m SchemaCache -&gt; m ActionCache
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m SchemaCache
forall (m :: * -&gt; *). CacheRM m =&gt; m SchemaCache
</span><a href="Hasura.RQL.Types.SchemaCache.html#askSchemaCache"><span class="hs-identifier hs-var">askSchemaCache</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><span class="annottext">Maybe ActionInfo -&gt; m ActionInfo -&gt; m ActionInfo
forall (m :: * -&gt; *) a. Applicative m =&gt; Maybe a -&gt; m a -&gt; m a
</span><a href="Hasura.Prelude.html#onNothing"><span class="hs-identifier hs-var">onNothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionName -&gt; ActionCache -&gt; Maybe ActionInfo
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702807"><span class="hs-identifier hs-var">actionName</span></a></span><span> </span><span class="annot"><span class="annottext">ActionCache
</span><a href="#local-6989586621688702806"><span class="hs-identifier hs-var">actionMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m ActionInfo -&gt; m ActionInfo) -&gt; m ActionInfo -&gt; m ActionInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ActionInfo
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotExists"><span class="hs-identifier hs-var">NotExists</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ActionInfo) -&gt; Text -&gt; m ActionInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;action with name &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702807"><span class="hs-identifier hs-var">actionName</span></a></span><span> </span><span class="annot"><span class="annottext">ActionName -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; does not exist&quot;</span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">data</span><span> </span><span id="CreateAction"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#CreateAction"><span class="hs-identifier hs-var">CreateAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CreateAction"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#CreateAction"><span class="hs-identifier hs-var">CreateAction</span></a></span></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_caName"><span class="annot"><span class="annottext">CreateAction -&gt; ActionName
</span><a href="Hasura.RQL.DDL.Action.html#_caName"><span class="hs-identifier hs-var hs-var">_caName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.RQL.Types.Action.html#ActionName"><span class="hs-identifier hs-type">ActionName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>    </span><span id="_caDefinition"><span class="annot"><span class="annottext">CreateAction -&gt; ActionDefinitionInput
</span><a href="Hasura.RQL.DDL.Action.html#_caDefinition"><span class="hs-identifier hs-var hs-var">_caDefinition</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.RQL.Types.Action.html#ActionDefinitionInput"><span class="hs-identifier hs-type">ActionDefinitionInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>    </span><span id="_caComment"><span class="annot"><span class="annottext">CreateAction -&gt; Maybe Text
</span><a href="Hasura.RQL.DDL.Action.html#_caComment"><span class="hs-identifier hs-var hs-var">_caComment</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-special">$(</span><span id="caComment"><span id="caDefinition"><span id="caName"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">CreateAction</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-special">$(</span><span id="local-6989586621688702782"><span id="local-6989586621688702784"><span id="local-6989586621688702786"><span id="local-6989586621688702788"><span id="local-6989586621688702790"><span id="local-6989586621688702792"><span class="hs-identifier">J.deriveJSON</span><span> </span><span class="hs-identifier">hasuraJSON</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">CreateAction</span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span id="local-6989586621688702776"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#runCreateAction"><span class="hs-identifier hs-type">runCreateAction</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688702776"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.Build.html#CacheRWM"><span class="hs-identifier hs-type">CacheRWM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688702776"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html#MetadataM"><span class="hs-identifier hs-type">MetadataM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688702776"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#CreateAction"><span class="hs-identifier hs-type">CreateAction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><a href="#local-6989586621688702776"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span></span><span>
</span><span id="line-74"></span><span id="runCreateAction"><span class="annot"><span class="annottext">runCreateAction :: CreateAction -&gt; m EncJSON
</span><a href="Hasura.RQL.DDL.Action.html#runCreateAction"><span class="hs-identifier hs-var hs-var">runCreateAction</span></a></span></span><span> </span><span id="local-6989586621688702775"><span class="annot"><span class="annottext">CreateAction
</span><a href="#local-6989586621688702775"><span class="hs-identifier hs-var">createAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-comment">-- check if action with same name exists already</span><span>
</span><span id="line-76"></span><span>  </span><span id="local-6989586621688702774"><span class="annot"><span class="annottext">ActionCache
</span><a href="#local-6989586621688702774"><span class="hs-identifier hs-var">actionMap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SchemaCache -&gt; ActionCache
</span><a href="Hasura.RQL.Types.SchemaCache.html#scActions"><span class="hs-identifier hs-var hs-var">scActions</span></a></span><span> </span><span class="annot"><span class="annottext">(SchemaCache -&gt; ActionCache) -&gt; m SchemaCache -&gt; m ActionCache
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m SchemaCache
forall (m :: * -&gt; *). CacheRM m =&gt; m SchemaCache
</span><a href="Hasura.RQL.Types.SchemaCache.html#askSchemaCache"><span class="hs-identifier hs-var">askSchemaCache</span></a></span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><span class="annottext">m () -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><span class="annottext">Maybe ActionInfo -&gt; (ActionInfo -&gt; m ()) -&gt; m ()
forall (m :: * -&gt; *) a.
Applicative m =&gt;
Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="Hasura.Prelude.html#onJust"><span class="hs-identifier hs-var">onJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionName -&gt; ActionCache -&gt; Maybe ActionInfo
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702771"><span class="hs-identifier hs-var">actionName</span></a></span><span> </span><span class="annot"><span class="annottext">ActionCache
</span><a href="#local-6989586621688702774"><span class="hs-identifier hs-var">actionMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((ActionInfo -&gt; m ()) -&gt; m ()) -&gt; (ActionInfo -&gt; m ()) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-79"></span><span>      </span><span class="annot"><span class="annottext">m () -&gt; ActionInfo -&gt; m ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; ActionInfo -&gt; m ()) -&gt; m () -&gt; ActionInfo -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-80"></span><span>        </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#AlreadyExists"><span class="hs-identifier hs-var">AlreadyExists</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-81"></span><span>          </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;action with name &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702771"><span class="hs-identifier hs-var">actionName</span></a></span><span> </span><span class="annot"><span class="annottext">ActionName -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; already exists&quot;</span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688702768"><span class="annot"><span class="annottext">metadata :: ActionMetadata
</span><a href="#local-6989586621688702768"><span class="hs-identifier hs-var hs-var">metadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-83"></span><span>        </span><span class="annot"><span class="annottext">ActionName
-&gt; Maybe Text
-&gt; ActionDefinitionInput
-&gt; [ActionPermissionMetadata]
-&gt; ActionMetadata
</span><a href="Hasura.RQL.Types.Action.html#ActionMetadata"><span class="hs-identifier hs-var">ActionMetadata</span></a></span><span>
</span><span id="line-84"></span><span>          </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702771"><span class="hs-identifier hs-var">actionName</span></a></span><span>
</span><span id="line-85"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CreateAction -&gt; Maybe Text
</span><a href="Hasura.RQL.DDL.Action.html#_caComment"><span class="hs-identifier hs-var hs-var">_caComment</span></a></span><span> </span><span class="annot"><span class="annottext">CreateAction
</span><a href="#local-6989586621688702775"><span class="hs-identifier hs-var">createAction</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CreateAction -&gt; ActionDefinitionInput
</span><a href="Hasura.RQL.DDL.Action.html#_caDefinition"><span class="hs-identifier hs-var hs-var">_caDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">CreateAction
</span><a href="#local-6989586621688702775"><span class="hs-identifier hs-var">createAction</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-88"></span><span>  </span><span class="annot"><span class="annottext">MetadataObjId -&gt; MetadataModifier -&gt; m ()
forall (m :: * -&gt; *).
(QErrM m, CacheRWM m, MetadataM m) =&gt;
MetadataObjId -&gt; MetadataModifier -&gt; m ()
</span><a href="Hasura.RQL.Types.SchemaCache.Build.html#buildSchemaCacheFor"><span class="hs-identifier hs-var">buildSchemaCacheFor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionName -&gt; MetadataObjId
</span><a href="Hasura.RQL.Types.Metadata.Object.html#MOAction"><span class="hs-identifier hs-var">MOAction</span></a></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702771"><span class="hs-identifier hs-var">actionName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(MetadataModifier -&gt; m ()) -&gt; MetadataModifier -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="annottext">(Metadata -&gt; Metadata) -&gt; MetadataModifier
</span><a href="Hasura.RQL.Types.Metadata.html#MetadataModifier"><span class="hs-identifier hs-var">MetadataModifier</span></a></span><span> </span><span class="annot"><span class="annottext">((Metadata -&gt; Metadata) -&gt; MetadataModifier)
-&gt; (Metadata -&gt; Metadata) -&gt; MetadataModifier
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-90"></span><span>      </span><span class="annot"><span class="annottext">(Actions -&gt; Identity Actions) -&gt; Metadata -&gt; Identity Metadata
Lens' Metadata Actions
</span><a href="Hasura.RQL.Types.Metadata.html#metaActions"><span class="hs-identifier hs-var">metaActions</span></a></span><span> </span><span class="annot"><span class="annottext">((Actions -&gt; Identity Actions) -&gt; Metadata -&gt; Identity Metadata)
-&gt; (Actions -&gt; Actions) -&gt; Metadata -&gt; Metadata
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">ActionName -&gt; ActionMetadata -&gt; Actions -&gt; Actions
forall k v.
(Eq k, Hashable k) =&gt;
k -&gt; v -&gt; InsOrdHashMap k v -&gt; InsOrdHashMap k v
</span><span class="hs-identifier hs-var">OMap.insert</span></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702771"><span class="hs-identifier hs-var">actionName</span></a></span><span> </span><span class="annot"><span class="annottext">ActionMetadata
</span><a href="#local-6989586621688702768"><span class="hs-identifier hs-var">metadata</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><span class="annottext">EncJSON -&gt; m EncJSON
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">EncJSON
</span><a href="Hasura.RQL.Types.Common.html#successMsg"><span class="hs-identifier hs-var">successMsg</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-93"></span><span>    </span><span id="local-6989586621688702771"><span class="annot"><span class="annottext">actionName :: ActionName
</span><a href="#local-6989586621688702771"><span class="hs-identifier hs-var hs-var">actionName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CreateAction -&gt; ActionName
</span><a href="Hasura.RQL.DDL.Action.html#_caName"><span class="hs-identifier hs-var hs-var">_caName</span></a></span><span> </span><span class="annot"><span class="annottext">CreateAction
</span><a href="#local-6989586621688702775"><span class="hs-identifier hs-var">createAction</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">{- Note [Postgres scalars in action input arguments]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
It's very comfortable to be able to reference Postgres scalars in actions
input arguments. For example, see the following action mutation:

    extend type mutation_root {
      create_user (
        name: String!
        created_at: timestamptz
      ): User
    }

The timestamptz is a Postgres scalar. We need to validate the presence of
timestamptz type in the Postgres database. So, the 'resolveAction' function
takes all Postgres scalar types as one of the inputs and returns the set of
referred scalars.
-}</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span id="local-6989586621688702759"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#resolveAction"><span class="hs-identifier hs-type">resolveAction</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><a href="Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688702759"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><a href="Data.Environment.html#Environment"><span class="hs-identifier hs-type">Env.Environment</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html#AnnotatedCustomTypes"><span class="hs-identifier hs-type">AnnotatedCustomTypes</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Action.html#ActionDefinitionInput"><span class="hs-identifier hs-type">ActionDefinitionInput</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-118"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">DMap.DMap</span></span><span> </span><span class="annot"><a href="Hasura.SQL.Tag.html#BackendTag"><span class="hs-identifier hs-type">BackendTag</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html#ScalarSet"><span class="hs-identifier hs-type">ScalarSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- See Note [Postgres scalars in custom types]</span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><a href="#local-6989586621688702759"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Action.html#ResolvedActionDefinition"><span class="hs-identifier hs-type">ResolvedActionDefinition</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-121"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html#AnnotatedOutputType"><span class="hs-identifier hs-type">AnnotatedOutputType</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">)</span></span><span>
</span><span id="line-123"></span><span id="resolveAction"><span class="annot"><span class="annottext">resolveAction :: Environment
-&gt; AnnotatedCustomTypes
-&gt; ActionDefinitionInput
-&gt; DMap BackendTag ScalarSet
-&gt; m (ResolvedActionDefinition, AnnotatedOutputType)
</span><a href="Hasura.RQL.DDL.Action.html#resolveAction"><span class="hs-identifier hs-var hs-var">resolveAction</span></a></span></span><span> </span><span id="local-6989586621688702758"><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621688702758"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html#AnnotatedCustomTypes"><span class="hs-identifier hs-type">AnnotatedCustomTypes</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688702755"><span id="local-6989586621688702756"><span class="annot"><span class="annottext">AnnotatedObjects
NonObjectTypeMap
_actObjects :: AnnotatedCustomTypes -&gt; AnnotatedObjects
_actNonObjects :: AnnotatedCustomTypes -&gt; NonObjectTypeMap
_actObjects :: AnnotatedObjects
_actNonObjects :: NonObjectTypeMap
</span><a href="Hasura.RQL.Types.CustomTypes.html#_actObjects"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Action.html#ActionDefinition"><span class="hs-identifier hs-type">ActionDefinition</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688702743"><span id="local-6989586621688702744"><span id="local-6989586621688702745"><span id="local-6989586621688702746"><span id="local-6989586621688702747"><span id="local-6989586621688702748"><span id="local-6989586621688702749"><span id="local-6989586621688702750"><span id="local-6989586621688702751"><span class="annot"><span class="annottext">Bool
[HeaderConf]
[ArgumentDefinition GraphQLType]
Maybe MetadataResponseTransform
Maybe RequestTransform
Timeout
InputWebhook
GraphQLType
ActionType
_adResponseTransform :: forall a b. ActionDefinition a b -&gt; Maybe MetadataResponseTransform
_adRequestTransform :: forall a b. ActionDefinition a b -&gt; Maybe RequestTransform
_adHandler :: forall a b. ActionDefinition a b -&gt; b
_adTimeout :: forall a b. ActionDefinition a b -&gt; Timeout
_adForwardClientHeaders :: forall a b. ActionDefinition a b -&gt; Bool
_adHeaders :: forall a b. ActionDefinition a b -&gt; [HeaderConf]
_adType :: forall a b. ActionDefinition a b -&gt; ActionType
_adOutputType :: forall a b. ActionDefinition a b -&gt; GraphQLType
_adArguments :: forall a b. ActionDefinition a b -&gt; [a]
_adResponseTransform :: Maybe MetadataResponseTransform
_adRequestTransform :: Maybe RequestTransform
_adHandler :: InputWebhook
_adTimeout :: Timeout
_adForwardClientHeaders :: Bool
_adHeaders :: [HeaderConf]
_adType :: ActionType
_adOutputType :: GraphQLType
_adArguments :: [ArgumentDefinition GraphQLType]
</span><a href="Hasura.RQL.Types.Action.html#_adResponseTransform"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621688702733"><span class="annot"><span class="annottext">DMap BackendTag ScalarSet
</span><a href="#local-6989586621688702733"><span class="hs-identifier hs-var">allScalars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-124"></span><span>  </span><span id="local-6989586621688702732"><span class="annot"><span class="annottext">[ArgumentDefinition (GType, NonObjectCustomType)]
</span><a href="#local-6989586621688702732"><span class="hs-identifier hs-var">resolvedArguments</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ArgumentDefinition GraphQLType]
-&gt; (ArgumentDefinition GraphQLType
    -&gt; m (ArgumentDefinition (GType, NonObjectCustomType)))
-&gt; m [ArgumentDefinition (GType, NonObjectCustomType)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">[ArgumentDefinition GraphQLType]
</span><a href="#local-6989586621688702751"><span class="hs-identifier hs-var">_adArguments</span></a></span><span> </span><span class="annot"><span class="annottext">((ArgumentDefinition GraphQLType
  -&gt; m (ArgumentDefinition (GType, NonObjectCustomType)))
 -&gt; m [ArgumentDefinition (GType, NonObjectCustomType)])
-&gt; (ArgumentDefinition GraphQLType
    -&gt; m (ArgumentDefinition (GType, NonObjectCustomType)))
-&gt; m [ArgumentDefinition (GType, NonObjectCustomType)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621688702730"><span class="annot"><span class="annottext">ArgumentDefinition GraphQLType
</span><a href="#local-6989586621688702730"><span class="hs-identifier hs-var">argumentDefinition</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><span class="annottext">ArgumentDefinition GraphQLType
-&gt; (GraphQLType -&gt; m (GType, NonObjectCustomType))
-&gt; m (ArgumentDefinition (GType, NonObjectCustomType))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">ArgumentDefinition GraphQLType
</span><a href="#local-6989586621688702730"><span class="hs-identifier hs-var">argumentDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">((GraphQLType -&gt; m (GType, NonObjectCustomType))
 -&gt; m (ArgumentDefinition (GType, NonObjectCustomType)))
-&gt; (GraphQLType -&gt; m (GType, NonObjectCustomType))
-&gt; m (ArgumentDefinition (GType, NonObjectCustomType))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621688702729"><span class="annot"><span class="annottext">GraphQLType
</span><a href="#local-6989586621688702729"><span class="hs-identifier hs-var">argumentType</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688702728"><span class="annot"><span class="annottext">gType :: GType
</span><a href="#local-6989586621688702728"><span class="hs-identifier hs-var hs-var">gType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphQLType -&gt; GType
</span><a href="Hasura.RQL.Types.CustomTypes.html#unGraphQLType"><span class="hs-identifier hs-var hs-var">unGraphQLType</span></a></span><span> </span><span class="annot"><span class="annottext">GraphQLType
</span><a href="#local-6989586621688702729"><span class="hs-identifier hs-var">argumentType</span></a></span><span>
</span><span id="line-127"></span><span>          </span><span id="local-6989586621688702726"><span class="annot"><span class="annottext">argumentBaseType :: Name
</span><a href="#local-6989586621688702726"><span class="hs-identifier hs-var hs-var">argumentBaseType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GType -&gt; Name
</span><span class="hs-identifier hs-var">G.getBaseType</span></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621688702728"><span class="hs-identifier hs-var">gType</span></a></span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621688702728"><span class="hs-identifier hs-var">gType</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>        </span><span class="annot"><span class="annottext">(NonObjectCustomType -&gt; (GType, NonObjectCustomType))
-&gt; m NonObjectCustomType -&gt; m (GType, NonObjectCustomType)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">if</span><span>
</span><span id="line-130"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621688702724"><span class="annot"><span class="annottext">NonObjectCustomType
</span><a href="#local-6989586621688702724"><span class="hs-identifier hs-var">noCTScalar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DMap BackendTag ScalarSet
-&gt; Name
-&gt; (PGScalarType -&gt; NonObjectCustomType)
-&gt; Maybe NonObjectCustomType
forall a.
DMap BackendTag ScalarSet -&gt; Name -&gt; (PGScalarType -&gt; a) -&gt; Maybe a
</span><a href="Hasura.RQL.DDL.CustomTypes.html#lookupPGScalar"><span class="hs-identifier hs-var">lookupPGScalar</span></a></span><span> </span><span class="annot"><span class="annottext">DMap BackendTag ScalarSet
</span><a href="#local-6989586621688702733"><span class="hs-identifier hs-var">allScalars</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688702726"><span class="hs-identifier hs-var">argumentBaseType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnotatedScalarType -&gt; NonObjectCustomType
</span><a href="Hasura.RQL.Types.CustomTypes.html#NOCTScalar"><span class="hs-identifier hs-var">NOCTScalar</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnotatedScalarType -&gt; NonObjectCustomType)
-&gt; (PGScalarType -&gt; AnnotatedScalarType)
-&gt; PGScalarType
-&gt; NonObjectCustomType
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; ScalarType ('Postgres 'Vanilla) -&gt; AnnotatedScalarType
</span><a href="Hasura.RQL.Types.CustomTypes.html#ASTReusedScalar"><span class="hs-identifier hs-var">ASTReusedScalar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688702726"><span class="hs-identifier hs-var">argumentBaseType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-131"></span><span>              </span><span class="annot"><span class="annottext">NonObjectCustomType -&gt; m NonObjectCustomType
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">NonObjectCustomType
</span><a href="#local-6989586621688702724"><span class="hs-identifier hs-var">noCTScalar</span></a></span><span>
</span><span id="line-132"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621688702720"><span class="annot"><span class="annottext">NonObjectCustomType
</span><a href="#local-6989586621688702720"><span class="hs-identifier hs-var">nonObjectType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; NonObjectTypeMap -&gt; Maybe NonObjectCustomType
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688702726"><span class="hs-identifier hs-var">argumentBaseType</span></a></span><span> </span><span class="annot"><span class="annottext">NonObjectTypeMap
</span><a href="#local-6989586621688702756"><span class="hs-identifier hs-var">_actNonObjects</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-133"></span><span>              </span><span class="annot"><span class="annottext">NonObjectCustomType -&gt; m NonObjectCustomType
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">NonObjectCustomType
</span><a href="#local-6989586621688702720"><span class="hs-identifier hs-var">nonObjectType</span></a></span><span>
</span><span id="line-134"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-135"></span><span>              </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m NonObjectCustomType
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#InvalidParams"><span class="hs-identifier hs-var">InvalidParams</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m NonObjectCustomType) -&gt; Text -&gt; m NonObjectCustomType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-136"></span><span>                </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;the type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text
</span><a href="Data.Text.Extended.html#dquote"><span class="hs-identifier hs-var">dquote</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688702726"><span class="hs-identifier hs-var">argumentBaseType</span></a></span><span>
</span><span id="line-137"></span><span>                  </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; is not defined in custom types or it is not a scalar/enum/input_object&quot;</span></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-comment">-- Check if the response type is an object</span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688702717"><span class="annot"><span class="annottext">outputType :: GType
</span><a href="#local-6989586621688702717"><span class="hs-identifier hs-var hs-var">outputType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GraphQLType -&gt; GType
</span><a href="Hasura.RQL.Types.CustomTypes.html#unGraphQLType"><span class="hs-identifier hs-var hs-var">unGraphQLType</span></a></span><span> </span><span class="annot"><span class="annottext">GraphQLType
</span><a href="#local-6989586621688702750"><span class="hs-identifier hs-var">_adOutputType</span></a></span><span>
</span><span id="line-141"></span><span>      </span><span id="local-6989586621688702716"><span class="annot"><span class="annottext">outputBaseType :: Name
</span><a href="#local-6989586621688702716"><span class="hs-identifier hs-var hs-var">outputBaseType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GType -&gt; Name
</span><span class="hs-identifier hs-var">G.getBaseType</span></span><span> </span><span class="annot"><span class="annottext">GType
</span><a href="#local-6989586621688702717"><span class="hs-identifier hs-var">outputType</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621688702715"><span class="annot"><span class="annottext">AnnotatedOutputType
</span><a href="#local-6989586621688702715"><span class="hs-identifier hs-var">outputObject</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621688702714"><span class="annot"><span class="annottext">AnnotatedOutputType
</span><a href="#local-6989586621688702714"><span class="hs-identifier hs-var">aot</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-144"></span><span>      </span><span class="hs-keyword">if</span><span>
</span><span id="line-145"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621688702713"><span class="annot"><span class="annottext">AnnotatedOutputType
</span><a href="#local-6989586621688702713"><span class="hs-identifier hs-var">aoTScalar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DMap BackendTag ScalarSet
-&gt; Name
-&gt; (PGScalarType -&gt; AnnotatedOutputType)
-&gt; Maybe AnnotatedOutputType
forall a.
DMap BackendTag ScalarSet -&gt; Name -&gt; (PGScalarType -&gt; a) -&gt; Maybe a
</span><a href="Hasura.RQL.DDL.CustomTypes.html#lookupPGScalar"><span class="hs-identifier hs-var">lookupPGScalar</span></a></span><span> </span><span class="annot"><span class="annottext">DMap BackendTag ScalarSet
</span><a href="#local-6989586621688702733"><span class="hs-identifier hs-var">allScalars</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688702716"><span class="hs-identifier hs-var">outputBaseType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnotatedScalarType -&gt; AnnotatedOutputType
</span><a href="Hasura.RQL.Types.CustomTypes.html#AOTScalar"><span class="hs-identifier hs-var">AOTScalar</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnotatedScalarType -&gt; AnnotatedOutputType)
-&gt; (PGScalarType -&gt; AnnotatedScalarType)
-&gt; PGScalarType
-&gt; AnnotatedOutputType
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; ScalarType ('Postgres 'Vanilla) -&gt; AnnotatedScalarType
</span><a href="Hasura.RQL.Types.CustomTypes.html#ASTReusedScalar"><span class="hs-identifier hs-var">ASTReusedScalar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688702716"><span class="hs-identifier hs-var">outputBaseType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-146"></span><span>            </span><span class="annot"><span class="annottext">AnnotatedOutputType -&gt; m AnnotatedOutputType
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">AnnotatedOutputType
</span><a href="#local-6989586621688702713"><span class="hs-identifier hs-var">aoTScalar</span></a></span><span>
</span><span id="line-147"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621688702711"><span class="annot"><span class="annottext">AnnotatedObjectType
</span><a href="#local-6989586621688702711"><span class="hs-identifier hs-var">objectType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; AnnotatedObjects -&gt; Maybe AnnotatedObjectType
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688702716"><span class="hs-identifier hs-var">outputBaseType</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedObjects
</span><a href="#local-6989586621688702755"><span class="hs-identifier hs-var">_actObjects</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-148"></span><span>            </span><span class="annot"><span class="annottext">AnnotatedOutputType -&gt; m AnnotatedOutputType
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(AnnotatedOutputType -&gt; m AnnotatedOutputType)
-&gt; AnnotatedOutputType -&gt; m AnnotatedOutputType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AnnotatedObjectType -&gt; AnnotatedOutputType
</span><a href="Hasura.RQL.Types.CustomTypes.html#AOTObject"><span class="hs-identifier hs-var">AOTObject</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedObjectType
</span><a href="#local-6989586621688702711"><span class="hs-identifier hs-var">objectType</span></a></span><span>
</span><span id="line-149"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-150"></span><span>            </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m AnnotatedOutputType
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotExists"><span class="hs-identifier hs-var">NotExists</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;the type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text
</span><a href="Data.Text.Extended.html#dquote"><span class="hs-identifier hs-var">dquote</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688702716"><span class="hs-identifier hs-var">outputBaseType</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; is not an object type defined in custom types&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-comment">-- If the Action is sync:</span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-comment">--      1. Check if the output type has only top level relations (if any)</span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-comment">--   If the Action is async:</span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-comment">--      1. Check that the output type has no relations if the output type contains nested objects</span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-comment">-- These checks ensure that the SQL we generate for the join does not have to extract nested fields</span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-comment">-- from the action webhook response.</span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688702709"><span class="annot"><span class="annottext">[ObjectFieldDefinition (GType, AnnotatedObjectFieldType)]
</span><a href="#local-6989586621688702709"><span class="hs-identifier hs-var">nestedObjects</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688702708"><span class="annot"><span class="annottext">[ObjectFieldDefinition (GType, AnnotatedObjectFieldType)]
</span><a href="#local-6989586621688702708"><span class="hs-identifier hs-var">scalarOrEnumFields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AnnotatedOutputType
</span><a href="#local-6989586621688702714"><span class="hs-identifier hs-var">aot</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-158"></span><span>          </span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html#AOTObject"><span class="hs-identifier hs-type">AOTObject</span></a></span><span> </span><span id="local-6989586621688702707"><span class="annot"><span class="annottext">AnnotatedObjectType
</span><a href="#local-6989586621688702707"><span class="hs-identifier hs-var">aot'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-159"></span><span>            </span><span class="annot"><span class="annottext">(ObjectFieldDefinition (GType, AnnotatedObjectFieldType) -&gt; Bool)
-&gt; NonEmpty
     (ObjectFieldDefinition (GType, AnnotatedObjectFieldType))
-&gt; ([ObjectFieldDefinition (GType, AnnotatedObjectFieldType)],
    [ObjectFieldDefinition (GType, AnnotatedObjectFieldType)])
forall a. (a -&gt; Bool) -&gt; NonEmpty a -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">NEList.partition</span></span><span>
</span><span id="line-160"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html#ObjectFieldDefinition"><span class="hs-identifier hs-type">ObjectFieldDefinition</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688702701"><span id="local-6989586621688702702"><span id="local-6989586621688702703"><span id="local-6989586621688702704"><span class="annot"><span class="annottext">Maybe Value
Maybe Description
(GType, AnnotatedObjectFieldType)
ObjectFieldName
_ofdType :: forall a. ObjectFieldDefinition a -&gt; a
_ofdDescription :: forall a. ObjectFieldDefinition a -&gt; Maybe Description
_ofdArguments :: forall a. ObjectFieldDefinition a -&gt; Maybe Value
_ofdName :: forall a. ObjectFieldDefinition a -&gt; ObjectFieldName
_ofdType :: (GType, AnnotatedObjectFieldType)
_ofdDescription :: Maybe Description
_ofdArguments :: Maybe Value
_ofdName :: ObjectFieldName
</span><a href="Hasura.RQL.Types.CustomTypes.html#_ofdType"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-161"></span><span>                  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(GType, AnnotatedObjectFieldType) -&gt; AnnotatedObjectFieldType
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(GType, AnnotatedObjectFieldType)
</span><a href="#local-6989586621688702701"><span class="hs-identifier hs-var">_ofdType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-162"></span><span>                    </span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html#AOFTScalar"><span class="hs-identifier hs-type">AOFTScalar</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedScalarType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-163"></span><span>                    </span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html#AOFTEnum"><span class="hs-identifier hs-type">AOFTEnum</span></a></span><span> </span><span class="annot"><span class="annottext">EnumTypeDefinition
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-164"></span><span>                    </span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html#AOFTObject"><span class="hs-identifier hs-type">AOFTObject</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-165"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ObjectTypeDefinition
  (GType, AnnotatedObjectFieldType)
  (TableInfo ('Postgres 'Vanilla))
  (ColumnInfo ('Postgres 'Vanilla))
-&gt; NonEmpty
     (ObjectFieldDefinition (GType, AnnotatedObjectFieldType))
forall a b c.
ObjectTypeDefinition a b c -&gt; NonEmpty (ObjectFieldDefinition a)
</span><a href="Hasura.RQL.Types.CustomTypes.html#_otdFields"><span class="hs-identifier hs-var hs-var">_otdFields</span></a></span><span> </span><span class="annot"><span class="annottext">(ObjectTypeDefinition
   (GType, AnnotatedObjectFieldType)
   (TableInfo ('Postgres 'Vanilla))
   (ColumnInfo ('Postgres 'Vanilla))
 -&gt; NonEmpty
      (ObjectFieldDefinition (GType, AnnotatedObjectFieldType)))
-&gt; ObjectTypeDefinition
     (GType, AnnotatedObjectFieldType)
     (TableInfo ('Postgres 'Vanilla))
     (ColumnInfo ('Postgres 'Vanilla))
-&gt; NonEmpty
     (ObjectFieldDefinition (GType, AnnotatedObjectFieldType))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AnnotatedObjectType
-&gt; ObjectTypeDefinition
     (GType, AnnotatedObjectFieldType)
     (TableInfo ('Postgres 'Vanilla))
     (ColumnInfo ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.Types.CustomTypes.html#_aotDefinition"><span class="hs-identifier hs-var hs-var">_aotDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedObjectType
</span><a href="#local-6989586621688702707"><span class="hs-identifier hs-var">aot'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>          </span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html#AOTScalar"><span class="hs-identifier hs-type">AOTScalar</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedScalarType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>        </span><span id="local-6989586621688702691"><span class="annot"><span class="annottext">scalarOrEnumFieldNames :: [Name]
</span><a href="#local-6989586621688702691"><span class="hs-identifier hs-var hs-var">scalarOrEnumFieldNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ObjectFieldDefinition (GType, AnnotatedObjectFieldType) -&gt; Name)
-&gt; [ObjectFieldDefinition (GType, AnnotatedObjectFieldType)]
-&gt; [Name]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html#ObjectFieldDefinition"><span class="hs-identifier hs-type">ObjectFieldDefinition</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688702687"><span id="local-6989586621688702688"><span id="local-6989586621688702689"><span id="local-6989586621688702690"><span class="annot"><span class="annottext">Maybe Value
Maybe Description
(GType, AnnotatedObjectFieldType)
ObjectFieldName
_ofdType :: (GType, AnnotatedObjectFieldType)
_ofdDescription :: Maybe Description
_ofdArguments :: Maybe Value
_ofdName :: ObjectFieldName
_ofdType :: forall a. ObjectFieldDefinition a -&gt; a
_ofdDescription :: forall a. ObjectFieldDefinition a -&gt; Maybe Description
_ofdArguments :: forall a. ObjectFieldDefinition a -&gt; Maybe Value
_ofdName :: forall a. ObjectFieldDefinition a -&gt; ObjectFieldName
</span><a href="#local-6989586621688702687"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ObjectFieldName -&gt; Name
</span><a href="Hasura.RQL.Types.CustomTypes.html#unObjectFieldName"><span class="hs-identifier hs-var hs-var">unObjectFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectFieldName
</span><a href="#local-6989586621688702690"><span class="hs-identifier hs-var">_ofdName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[ObjectFieldDefinition (GType, AnnotatedObjectFieldType)]
</span><a href="#local-6989586621688702708"><span class="hs-identifier hs-var">scalarOrEnumFields</span></a></span><span>
</span><span id="line-169"></span><span>        </span><span id="local-6989586621688702685"><span class="annot"><span class="annottext">validateSyncAction :: m ()
</span><a href="#local-6989586621688702685"><span class="hs-identifier hs-var hs-var">validateSyncAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AnnotatedOutputType
</span><a href="#local-6989586621688702714"><span class="hs-identifier hs-var">aot</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-170"></span><span>          </span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html#AOTObject"><span class="hs-identifier hs-type">AOTObject</span></a></span><span> </span><span id="local-6989586621688702684"><span class="annot"><span class="annottext">AnnotatedObjectType
</span><a href="#local-6989586621688702684"><span class="hs-identifier hs-var">aot'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-171"></span><span>            </span><span class="annot"><span class="annottext">Maybe
  (NonEmpty
     (TypeRelationship
        (TableInfo ('Postgres 'Vanilla))
        (ColumnInfo ('Postgres 'Vanilla))))
-&gt; (NonEmpty
      (TypeRelationship
         (TableInfo ('Postgres 'Vanilla)) (ColumnInfo ('Postgres 'Vanilla)))
    -&gt; m ())
-&gt; m ()
forall (m :: * -&gt; *) a.
Applicative m =&gt;
Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="Hasura.Prelude.html#onJust"><span class="hs-identifier hs-var">onJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ObjectTypeDefinition
  (GType, AnnotatedObjectFieldType)
  (TableInfo ('Postgres 'Vanilla))
  (ColumnInfo ('Postgres 'Vanilla))
-&gt; Maybe
     (NonEmpty
        (TypeRelationship
           (TableInfo ('Postgres 'Vanilla))
           (ColumnInfo ('Postgres 'Vanilla))))
forall a b c.
ObjectTypeDefinition a b c
-&gt; Maybe (NonEmpty (TypeRelationship b c))
</span><a href="Hasura.RQL.Types.CustomTypes.html#_otdRelationships"><span class="hs-identifier hs-var hs-var">_otdRelationships</span></a></span><span> </span><span class="annot"><span class="annottext">(ObjectTypeDefinition
   (GType, AnnotatedObjectFieldType)
   (TableInfo ('Postgres 'Vanilla))
   (ColumnInfo ('Postgres 'Vanilla))
 -&gt; Maybe
      (NonEmpty
         (TypeRelationship
            (TableInfo ('Postgres 'Vanilla))
            (ColumnInfo ('Postgres 'Vanilla)))))
-&gt; ObjectTypeDefinition
     (GType, AnnotatedObjectFieldType)
     (TableInfo ('Postgres 'Vanilla))
     (ColumnInfo ('Postgres 'Vanilla))
-&gt; Maybe
     (NonEmpty
        (TypeRelationship
           (TableInfo ('Postgres 'Vanilla))
           (ColumnInfo ('Postgres 'Vanilla))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AnnotatedObjectType
-&gt; ObjectTypeDefinition
     (GType, AnnotatedObjectFieldType)
     (TableInfo ('Postgres 'Vanilla))
     (ColumnInfo ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.Types.CustomTypes.html#_aotDefinition"><span class="hs-identifier hs-var hs-var">_aotDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedObjectType
</span><a href="#local-6989586621688702684"><span class="hs-identifier hs-var">aot'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((NonEmpty
    (TypeRelationship
       (TableInfo ('Postgres 'Vanilla)) (ColumnInfo ('Postgres 'Vanilla)))
  -&gt; m ())
 -&gt; m ())
-&gt; (NonEmpty
      (TypeRelationship
         (TableInfo ('Postgres 'Vanilla)) (ColumnInfo ('Postgres 'Vanilla)))
    -&gt; m ())
-&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621688702682"><span class="annot"><span class="annottext">NonEmpty
  (TypeRelationship
     (TableInfo ('Postgres 'Vanilla)) (ColumnInfo ('Postgres 'Vanilla)))
</span><a href="#local-6989586621688702682"><span class="hs-identifier hs-var">relLst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-172"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688702681"><span class="annot"><span class="annottext">relationshipsWithNonTopLevelFields :: [TypeRelationship
   (TableInfo ('Postgres 'Vanilla)) (ColumnInfo ('Postgres 'Vanilla))]
</span><a href="#local-6989586621688702681"><span class="hs-identifier hs-var hs-var">relationshipsWithNonTopLevelFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-173"></span><span>                    </span><span class="annot"><span class="annottext">(TypeRelationship
   (TableInfo ('Postgres 'Vanilla)) (ColumnInfo ('Postgres 'Vanilla))
 -&gt; Bool)
-&gt; NonEmpty
     (TypeRelationship
        (TableInfo ('Postgres 'Vanilla)) (ColumnInfo ('Postgres 'Vanilla)))
-&gt; [TypeRelationship
      (TableInfo ('Postgres 'Vanilla)) (ColumnInfo ('Postgres 'Vanilla))]
forall a. (a -&gt; Bool) -&gt; NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NEList.filter</span></span><span>
</span><span id="line-174"></span><span>                      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html#TypeRelationship"><span class="hs-identifier hs-type">TypeRelationship</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688702674"><span id="local-6989586621688702675"><span id="local-6989586621688702676"><span id="local-6989586621688702677"><span id="local-6989586621688702678"><span class="annot"><span class="annottext">HashMap ObjectFieldName (ColumnInfo ('Postgres 'Vanilla))
SourceName
RelType
TableInfo ('Postgres 'Vanilla)
RelationshipName
_trFieldMapping :: forall t f. TypeRelationship t f -&gt; HashMap ObjectFieldName f
_trRemoteTable :: forall t f. TypeRelationship t f -&gt; t
_trSource :: forall t f. TypeRelationship t f -&gt; SourceName
_trType :: forall t f. TypeRelationship t f -&gt; RelType
_trName :: forall t f. TypeRelationship t f -&gt; RelationshipName
_trFieldMapping :: HashMap ObjectFieldName (ColumnInfo ('Postgres 'Vanilla))
_trRemoteTable :: TableInfo ('Postgres 'Vanilla)
_trSource :: SourceName
_trType :: RelType
_trName :: RelationshipName
</span><a href="Hasura.RQL.Types.CustomTypes.html#_trFieldMapping"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-175"></span><span>                          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688702668"><span class="annot"><span class="annottext">objsInRel :: [Name]
</span><a href="#local-6989586621688702668"><span class="hs-identifier hs-var hs-var">objsInRel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ObjectFieldName -&gt; Name
</span><a href="Hasura.RQL.Types.CustomTypes.html#unObjectFieldName"><span class="hs-identifier hs-var hs-var">unObjectFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">(ObjectFieldName -&gt; Name) -&gt; [ObjectFieldName] -&gt; [Name]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">HashMap ObjectFieldName (ColumnInfo ('Postgres 'Vanilla))
-&gt; [ObjectFieldName]
forall k v. HashMap k v -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="annot"><span class="annottext">HashMap ObjectFieldName (ColumnInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621688702674"><span class="hs-identifier hs-var">_trFieldMapping</span></a></span><span>
</span><span id="line-176"></span><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Bool) -&gt; [Name] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; [Name] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621688702691"><span class="hs-identifier hs-var">scalarOrEnumFieldNames</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621688702668"><span class="hs-identifier hs-var">objsInRel</span></a></span><span>
</span><span id="line-177"></span><span>                      </span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>                      </span><span class="annot"><span class="annottext">NonEmpty
  (TypeRelationship
     (TableInfo ('Postgres 'Vanilla)) (ColumnInfo ('Postgres 'Vanilla)))
</span><a href="#local-6989586621688702682"><span class="hs-identifier hs-var">relLst</span></a></span><span>
</span><span id="line-179"></span><span>              </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TypeRelationship
   (TableInfo ('Postgres 'Vanilla)) (ColumnInfo ('Postgres 'Vanilla))]
-&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[TypeRelationship
   (TableInfo ('Postgres 'Vanilla)) (ColumnInfo ('Postgres 'Vanilla))]
</span><a href="#local-6989586621688702681"><span class="hs-identifier hs-var">relationshipsWithNonTopLevelFields</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-180"></span><span>                </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#ConstraintError"><span class="hs-identifier hs-var">ConstraintError</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-181"></span><span>                  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Relationships cannot be defined with nested object fields : &quot;</span></span><span>
</span><span id="line-182"></span><span>                    </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
forall t (f :: * -&gt; *). (ToTxt t, Foldable f) =&gt; f t -&gt; Text
</span><a href="Data.Text.Extended.html#commaSeparated"><span class="hs-identifier hs-var">commaSeparated</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RelationshipName -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text
</span><a href="Data.Text.Extended.html#dquote"><span class="hs-identifier hs-var">dquote</span></a></span><span> </span><span class="annot"><span class="annottext">(RelationshipName -&gt; Text)
-&gt; (TypeRelationship
      (TableInfo ('Postgres 'Vanilla)) (ColumnInfo ('Postgres 'Vanilla))
    -&gt; RelationshipName)
-&gt; TypeRelationship
     (TableInfo ('Postgres 'Vanilla)) (ColumnInfo ('Postgres 'Vanilla))
-&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TypeRelationship
  (TableInfo ('Postgres 'Vanilla)) (ColumnInfo ('Postgres 'Vanilla))
-&gt; RelationshipName
forall t f. TypeRelationship t f -&gt; RelationshipName
</span><a href="Hasura.RQL.Types.CustomTypes.html#_trName"><span class="hs-identifier hs-var hs-var">_trName</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeRelationship
   (TableInfo ('Postgres 'Vanilla)) (ColumnInfo ('Postgres 'Vanilla))
 -&gt; Text)
-&gt; [TypeRelationship
      (TableInfo ('Postgres 'Vanilla)) (ColumnInfo ('Postgres 'Vanilla))]
-&gt; [Text]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[TypeRelationship
   (TableInfo ('Postgres 'Vanilla)) (ColumnInfo ('Postgres 'Vanilla))]
</span><a href="#local-6989586621688702681"><span class="hs-identifier hs-var">relationshipsWithNonTopLevelFields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>          </span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html#AOTScalar"><span class="hs-identifier hs-type">AOTScalar</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedScalarType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ActionType
</span><a href="#local-6989586621688702749"><span class="hs-identifier hs-var">_adType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-185"></span><span>      </span><span class="annot"><span class="annottext">ActionType
</span><a href="Hasura.RQL.Types.Action.html#ActionQuery"><span class="hs-identifier hs-var">ActionQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m ()
</span><a href="#local-6989586621688702685"><span class="hs-identifier hs-var">validateSyncAction</span></a></span><span>
</span><span id="line-186"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.Action.html#ActionMutation"><span class="hs-identifier hs-type">ActionMutation</span></a></span><span> </span><span class="annot"><span class="annottext">ActionMutationKind
</span><a href="Hasura.RQL.Types.Action.html#ActionSynchronous"><span class="hs-identifier hs-var">ActionSynchronous</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m ()
</span><a href="#local-6989586621688702685"><span class="hs-identifier hs-var">validateSyncAction</span></a></span><span>
</span><span id="line-187"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.Action.html#ActionMutation"><span class="hs-identifier hs-type">ActionMutation</span></a></span><span> </span><span class="annot"><span class="annottext">ActionMutationKind
</span><a href="Hasura.RQL.Types.Action.html#ActionAsynchronous"><span class="hs-identifier hs-var">ActionAsynchronous</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-188"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688702655"><span class="annot"><span class="annottext">maybeRel :: Bool
</span><a href="#local-6989586621688702655"><span class="hs-identifier hs-var hs-var">maybeRel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AnnotatedOutputType
</span><a href="#local-6989586621688702714"><span class="hs-identifier hs-var">aot</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-189"></span><span>              </span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html#AOTObject"><span class="hs-identifier hs-type">AOTObject</span></a></span><span> </span><span id="local-6989586621688702654"><span class="annot"><span class="annottext">AnnotatedObjectType
</span><a href="#local-6989586621688702654"><span class="hs-identifier hs-var">aot'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe
  (NonEmpty
     (TypeRelationship
        (TableInfo ('Postgres 'Vanilla))
        (ColumnInfo ('Postgres 'Vanilla))))
-&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ObjectTypeDefinition
  (GType, AnnotatedObjectFieldType)
  (TableInfo ('Postgres 'Vanilla))
  (ColumnInfo ('Postgres 'Vanilla))
-&gt; Maybe
     (NonEmpty
        (TypeRelationship
           (TableInfo ('Postgres 'Vanilla))
           (ColumnInfo ('Postgres 'Vanilla))))
forall a b c.
ObjectTypeDefinition a b c
-&gt; Maybe (NonEmpty (TypeRelationship b c))
</span><a href="Hasura.RQL.Types.CustomTypes.html#_otdRelationships"><span class="hs-identifier hs-var hs-var">_otdRelationships</span></a></span><span> </span><span class="annot"><span class="annottext">(ObjectTypeDefinition
   (GType, AnnotatedObjectFieldType)
   (TableInfo ('Postgres 'Vanilla))
   (ColumnInfo ('Postgres 'Vanilla))
 -&gt; Maybe
      (NonEmpty
         (TypeRelationship
            (TableInfo ('Postgres 'Vanilla))
            (ColumnInfo ('Postgres 'Vanilla)))))
-&gt; ObjectTypeDefinition
     (GType, AnnotatedObjectFieldType)
     (TableInfo ('Postgres 'Vanilla))
     (ColumnInfo ('Postgres 'Vanilla))
-&gt; Maybe
     (NonEmpty
        (TypeRelationship
           (TableInfo ('Postgres 'Vanilla))
           (ColumnInfo ('Postgres 'Vanilla))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AnnotatedObjectType
-&gt; ObjectTypeDefinition
     (GType, AnnotatedObjectFieldType)
     (TableInfo ('Postgres 'Vanilla))
     (ColumnInfo ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.Types.CustomTypes.html#_aotDefinition"><span class="hs-identifier hs-var hs-var">_aotDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedObjectType
</span><a href="#local-6989586621688702654"><span class="hs-identifier hs-var">aot'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>              </span><span class="annot"><a href="Hasura.RQL.Types.CustomTypes.html#AOTScalar"><span class="hs-identifier hs-type">AOTScalar</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedScalarType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-191"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621688702655"><span class="hs-identifier hs-var">maybeRel</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ObjectFieldDefinition (GType, AnnotatedObjectFieldType)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[ObjectFieldDefinition (GType, AnnotatedObjectFieldType)]
</span><a href="#local-6989586621688702709"><span class="hs-identifier hs-var">nestedObjects</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-192"></span><span>              </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#ConstraintError"><span class="hs-identifier hs-var">ConstraintError</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-193"></span><span>                </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Async action relations cannot be used with object fields : &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
forall t (f :: * -&gt; *). (ToTxt t, Foldable f) =&gt; f t -&gt; Text
</span><a href="Data.Text.Extended.html#commaSeparated"><span class="hs-identifier hs-var">commaSeparated</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ObjectFieldName -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text
</span><a href="Data.Text.Extended.html#dquote"><span class="hs-identifier hs-var">dquote</span></a></span><span> </span><span class="annot"><span class="annottext">(ObjectFieldName -&gt; Text)
-&gt; (ObjectFieldDefinition (GType, AnnotatedObjectFieldType)
    -&gt; ObjectFieldName)
-&gt; ObjectFieldDefinition (GType, AnnotatedObjectFieldType)
-&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ObjectFieldDefinition (GType, AnnotatedObjectFieldType)
-&gt; ObjectFieldName
forall a. ObjectFieldDefinition a -&gt; ObjectFieldName
</span><a href="Hasura.RQL.Types.CustomTypes.html#_ofdName"><span class="hs-identifier hs-var hs-var">_ofdName</span></a></span><span> </span><span class="annot"><span class="annottext">(ObjectFieldDefinition (GType, AnnotatedObjectFieldType) -&gt; Text)
-&gt; [ObjectFieldDefinition (GType, AnnotatedObjectFieldType)]
-&gt; [Text]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ObjectFieldDefinition (GType, AnnotatedObjectFieldType)]
</span><a href="#local-6989586621688702709"><span class="hs-identifier hs-var">nestedObjects</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="annottext">AnnotatedOutputType -&gt; m AnnotatedOutputType
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">AnnotatedOutputType
</span><a href="#local-6989586621688702714"><span class="hs-identifier hs-var">aot</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span id="local-6989586621688702650"><span class="annot"><span class="annottext">ResolvedWebhook
</span><a href="#local-6989586621688702650"><span class="hs-identifier hs-var">resolvedWebhook</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Environment -&gt; InputWebhook -&gt; m ResolvedWebhook
forall (m :: * -&gt; *).
QErrM m =&gt;
Environment -&gt; InputWebhook -&gt; m ResolvedWebhook
</span><a href="Hasura.RQL.Types.Common.html#resolveWebhook"><span class="hs-identifier hs-var">resolveWebhook</span></a></span><span> </span><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621688702758"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">InputWebhook
</span><a href="#local-6989586621688702745"><span class="hs-identifier hs-var">_adHandler</span></a></span><span>
</span><span id="line-196"></span><span>  </span><span class="annot"><span class="annottext">(ResolvedActionDefinition, AnnotatedOutputType)
-&gt; m (ResolvedActionDefinition, AnnotatedOutputType)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[ArgumentDefinition (GType, NonObjectCustomType)]
-&gt; GraphQLType
-&gt; ActionType
-&gt; [HeaderConf]
-&gt; Bool
-&gt; Timeout
-&gt; ResolvedWebhook
-&gt; Maybe RequestTransform
-&gt; Maybe MetadataResponseTransform
-&gt; ResolvedActionDefinition
forall a b.
[a]
-&gt; GraphQLType
-&gt; ActionType
-&gt; [HeaderConf]
-&gt; Bool
-&gt; Timeout
-&gt; b
-&gt; Maybe RequestTransform
-&gt; Maybe MetadataResponseTransform
-&gt; ActionDefinition a b
</span><a href="Hasura.RQL.Types.Action.html#ActionDefinition"><span class="hs-identifier hs-var">ActionDefinition</span></a></span><span>
</span><span id="line-198"></span><span>        </span><span class="annot"><span class="annottext">[ArgumentDefinition (GType, NonObjectCustomType)]
</span><a href="#local-6989586621688702732"><span class="hs-identifier hs-var">resolvedArguments</span></a></span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><span class="annottext">GraphQLType
</span><a href="#local-6989586621688702750"><span class="hs-identifier hs-var">_adOutputType</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span class="annot"><span class="annottext">ActionType
</span><a href="#local-6989586621688702749"><span class="hs-identifier hs-var">_adType</span></a></span><span>
</span><span id="line-201"></span><span>        </span><span class="annot"><span class="annottext">[HeaderConf]
</span><a href="#local-6989586621688702748"><span class="hs-identifier hs-var">_adHeaders</span></a></span><span>
</span><span id="line-202"></span><span>        </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621688702747"><span class="hs-identifier hs-var">_adForwardClientHeaders</span></a></span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621688702746"><span class="hs-identifier hs-var">_adTimeout</span></a></span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><span class="annottext">ResolvedWebhook
</span><a href="#local-6989586621688702650"><span class="hs-identifier hs-var">resolvedWebhook</span></a></span><span>
</span><span id="line-205"></span><span>        </span><span class="annot"><span class="annottext">Maybe RequestTransform
</span><a href="#local-6989586621688702744"><span class="hs-identifier hs-var">_adRequestTransform</span></a></span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><span class="annottext">Maybe MetadataResponseTransform
</span><a href="#local-6989586621688702743"><span class="hs-identifier hs-var">_adResponseTransform</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-207"></span><span>      </span><span class="annot"><span class="annottext">AnnotatedOutputType
</span><a href="#local-6989586621688702715"><span class="hs-identifier hs-var">outputObject</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-keyword">data</span><span> </span><span id="UpdateAction"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#UpdateAction"><span class="hs-identifier hs-var">UpdateAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UpdateAction"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#UpdateAction"><span class="hs-identifier hs-var">UpdateAction</span></a></span></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_uaName"><span class="annot"><span class="annottext">UpdateAction -&gt; ActionName
</span><a href="Hasura.RQL.DDL.Action.html#_uaName"><span class="hs-identifier hs-var hs-var">_uaName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.RQL.Types.Action.html#ActionName"><span class="hs-identifier hs-type">ActionName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-212"></span><span>    </span><span id="_uaDefinition"><span class="annot"><span class="annottext">UpdateAction -&gt; ActionDefinitionInput
</span><a href="Hasura.RQL.DDL.Action.html#_uaDefinition"><span class="hs-identifier hs-var hs-var">_uaDefinition</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.RQL.Types.Action.html#ActionDefinitionInput"><span class="hs-identifier hs-type">ActionDefinitionInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-213"></span><span>    </span><span id="_uaComment"><span class="annot"><span class="annottext">UpdateAction -&gt; Maybe Text
</span><a href="Hasura.RQL.DDL.Action.html#_uaComment"><span class="hs-identifier hs-var hs-var">_uaComment</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-special">$(</span><span id="uaComment"><span id="uaDefinition"><span id="uaName"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">UpdateAction</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span class="hs-special">$(</span><span id="local-6989586621688702641"><span id="local-6989586621688702643"><span class="hs-identifier">J.deriveFromJSON</span><span> </span><span class="hs-identifier">hasuraJSON</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">UpdateAction</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#runUpdateAction"><span class="hs-identifier hs-type">runUpdateAction</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621688702640"><span class="annot"><a href="#local-6989586621688702640"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688702640"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.Build.html#CacheRWM"><span class="hs-identifier hs-type">CacheRWM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688702640"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html#MetadataM"><span class="hs-identifier hs-type">MetadataM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688702640"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-222"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#UpdateAction"><span class="hs-identifier hs-type">UpdateAction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><a href="#local-6989586621688702640"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span>
</span><span id="line-224"></span><span id="runUpdateAction"><span class="annot"><span class="annottext">runUpdateAction :: UpdateAction -&gt; m EncJSON
</span><a href="Hasura.RQL.DDL.Action.html#runUpdateAction"><span class="hs-identifier hs-var hs-var">runUpdateAction</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#UpdateAction"><span class="hs-identifier hs-type">UpdateAction</span></a></span><span> </span><span id="local-6989586621688702639"><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702639"><span class="hs-identifier hs-var">actionName</span></a></span></span><span> </span><span id="local-6989586621688702638"><span class="annot"><span class="annottext">ActionDefinitionInput
</span><a href="#local-6989586621688702638"><span class="hs-identifier hs-var">actionDefinition</span></a></span></span><span> </span><span id="local-6989586621688702637"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621688702637"><span class="hs-identifier hs-var">actionComment</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621688702636"><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621688702636"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m SchemaCache
forall (m :: * -&gt; *). CacheRM m =&gt; m SchemaCache
</span><a href="Hasura.RQL.Types.SchemaCache.html#askSchemaCache"><span class="hs-identifier hs-var">askSchemaCache</span></a></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688702635"><span class="annot"><span class="annottext">actionsMap :: ActionCache
</span><a href="#local-6989586621688702635"><span class="hs-identifier hs-var hs-var">actionsMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SchemaCache -&gt; ActionCache
</span><a href="Hasura.RQL.Types.SchemaCache.html#scActions"><span class="hs-identifier hs-var hs-var">scActions</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaCache
</span><a href="#local-6989586621688702636"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><span class="annottext">m ActionInfo -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(m ActionInfo -&gt; m ()) -&gt; m ActionInfo -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><span class="annottext">Maybe ActionInfo -&gt; m ActionInfo -&gt; m ActionInfo
forall (m :: * -&gt; *) a. Applicative m =&gt; Maybe a -&gt; m a -&gt; m a
</span><a href="Hasura.Prelude.html#onNothing"><span class="hs-identifier hs-var">onNothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionName -&gt; ActionCache -&gt; Maybe ActionInfo
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702639"><span class="hs-identifier hs-var">actionName</span></a></span><span> </span><span class="annot"><span class="annottext">ActionCache
</span><a href="#local-6989586621688702635"><span class="hs-identifier hs-var">actionsMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m ActionInfo -&gt; m ActionInfo) -&gt; m ActionInfo -&gt; m ActionInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-229"></span><span>      </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ActionInfo
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotExists"><span class="hs-identifier hs-var">NotExists</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ActionInfo) -&gt; Text -&gt; m ActionInfo
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;action with name &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702639"><span class="hs-identifier hs-var">actionName</span></a></span><span> </span><span class="annot"><span class="annottext">ActionName -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; does not exist&quot;</span></span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><span class="annottext">MetadataObjId -&gt; MetadataModifier -&gt; m ()
forall (m :: * -&gt; *).
(QErrM m, CacheRWM m, MetadataM m) =&gt;
MetadataObjId -&gt; MetadataModifier -&gt; m ()
</span><a href="Hasura.RQL.Types.SchemaCache.Build.html#buildSchemaCacheFor"><span class="hs-identifier hs-var">buildSchemaCacheFor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionName -&gt; MetadataObjId
</span><a href="Hasura.RQL.Types.Metadata.Object.html#MOAction"><span class="hs-identifier hs-var">MOAction</span></a></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702639"><span class="hs-identifier hs-var">actionName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(MetadataModifier -&gt; m ()) -&gt; MetadataModifier -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ActionDefinitionInput -&gt; Maybe Text -&gt; MetadataModifier
</span><a href="#local-6989586621688702634"><span class="hs-identifier hs-var">updateActionMetadataModifier</span></a></span><span> </span><span class="annot"><span class="annottext">ActionDefinitionInput
</span><a href="#local-6989586621688702638"><span class="hs-identifier hs-var">actionDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621688702637"><span class="hs-identifier hs-var">actionComment</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><span class="annottext">EncJSON -&gt; m EncJSON
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">EncJSON
</span><a href="Hasura.RQL.Types.Common.html#successMsg"><span class="hs-identifier hs-var">successMsg</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><a href="#local-6989586621688702634"><span class="hs-identifier hs-type">updateActionMetadataModifier</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Action.html#ActionDefinitionInput"><span class="hs-identifier hs-type">ActionDefinitionInput</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html#MetadataModifier"><span class="hs-identifier hs-type">MetadataModifier</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621688702634"><span class="annot"><span class="annottext">updateActionMetadataModifier :: ActionDefinitionInput -&gt; Maybe Text -&gt; MetadataModifier
</span><a href="#local-6989586621688702634"><span class="hs-identifier hs-var hs-var">updateActionMetadataModifier</span></a></span></span><span> </span><span id="local-6989586621688702633"><span class="annot"><span class="annottext">ActionDefinitionInput
</span><a href="#local-6989586621688702633"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span id="local-6989586621688702632"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621688702632"><span class="hs-identifier hs-var">comment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-235"></span><span>      </span><span class="annot"><span class="annottext">(Metadata -&gt; Metadata) -&gt; MetadataModifier
</span><a href="Hasura.RQL.Types.Metadata.html#MetadataModifier"><span class="hs-identifier hs-var">MetadataModifier</span></a></span><span> </span><span class="annot"><span class="annottext">((Metadata -&gt; Metadata) -&gt; MetadataModifier)
-&gt; (Metadata -&gt; Metadata) -&gt; MetadataModifier
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-236"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Actions -&gt; Identity Actions) -&gt; Metadata -&gt; Identity Metadata
Lens' Metadata Actions
</span><a href="Hasura.RQL.Types.Metadata.html#metaActions"><span class="hs-identifier hs-var">metaActions</span></a></span><span> </span><span class="annot"><span class="annottext">((Actions -&gt; Identity Actions) -&gt; Metadata -&gt; Identity Metadata)
-&gt; ((ActionDefinitionInput -&gt; Identity ActionDefinitionInput)
    -&gt; Actions -&gt; Identity Actions)
-&gt; (ActionDefinitionInput -&gt; Identity ActionDefinitionInput)
-&gt; Metadata
-&gt; Identity Metadata
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Index Actions -&gt; Traversal' Actions (IxValue Actions)
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Index Actions
ActionName
</span><a href="#local-6989586621688702639"><span class="hs-identifier hs-var">actionName</span></a></span><span> </span><span class="annot"><span class="annottext">((ActionMetadata -&gt; Identity ActionMetadata)
 -&gt; Actions -&gt; Identity Actions)
-&gt; ((ActionDefinitionInput -&gt; Identity ActionDefinitionInput)
    -&gt; ActionMetadata -&gt; Identity ActionMetadata)
-&gt; (ActionDefinitionInput -&gt; Identity ActionDefinitionInput)
-&gt; Actions
-&gt; Identity Actions
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ActionDefinitionInput -&gt; Identity ActionDefinitionInput)
-&gt; ActionMetadata -&gt; Identity ActionMetadata
Lens' ActionMetadata ActionDefinitionInput
</span><a href="Hasura.RQL.Types.Action.html#amDefinition"><span class="hs-identifier hs-var">amDefinition</span></a></span><span> </span><span class="annot"><span class="annottext">((ActionDefinitionInput -&gt; Identity ActionDefinitionInput)
 -&gt; Metadata -&gt; Identity Metadata)
-&gt; ActionDefinitionInput -&gt; Metadata -&gt; Metadata
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">ActionDefinitionInput
</span><a href="#local-6989586621688702633"><span class="hs-identifier hs-var">def</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>          </span><span class="annot"><span class="annottext">(Metadata -&gt; Metadata)
-&gt; (Metadata -&gt; Metadata) -&gt; Metadata -&gt; Metadata
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Actions -&gt; Identity Actions) -&gt; Metadata -&gt; Identity Metadata
Lens' Metadata Actions
</span><a href="Hasura.RQL.Types.Metadata.html#metaActions"><span class="hs-identifier hs-var">metaActions</span></a></span><span> </span><span class="annot"><span class="annottext">((Actions -&gt; Identity Actions) -&gt; Metadata -&gt; Identity Metadata)
-&gt; ((Maybe Text -&gt; Identity (Maybe Text))
    -&gt; Actions -&gt; Identity Actions)
-&gt; (Maybe Text -&gt; Identity (Maybe Text))
-&gt; Metadata
-&gt; Identity Metadata
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Index Actions -&gt; Traversal' Actions (IxValue Actions)
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Index Actions
ActionName
</span><a href="#local-6989586621688702639"><span class="hs-identifier hs-var">actionName</span></a></span><span> </span><span class="annot"><span class="annottext">((ActionMetadata -&gt; Identity ActionMetadata)
 -&gt; Actions -&gt; Identity Actions)
-&gt; ((Maybe Text -&gt; Identity (Maybe Text))
    -&gt; ActionMetadata -&gt; Identity ActionMetadata)
-&gt; (Maybe Text -&gt; Identity (Maybe Text))
-&gt; Actions
-&gt; Identity Actions
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Identity (Maybe Text))
-&gt; ActionMetadata -&gt; Identity ActionMetadata
Lens' ActionMetadata (Maybe Text)
</span><a href="Hasura.RQL.Types.Action.html#amComment"><span class="hs-identifier hs-var">amComment</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Text -&gt; Identity (Maybe Text))
 -&gt; Metadata -&gt; Identity Metadata)
-&gt; Maybe Text -&gt; Metadata -&gt; Metadata
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621688702632"><span class="hs-identifier hs-var">comment</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="hs-keyword">newtype</span><span> </span><span id="ClearActionData"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#ClearActionData"><span class="hs-identifier hs-var">ClearActionData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ClearActionData"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#ClearActionData"><span class="hs-identifier hs-var">ClearActionData</span></a></span></span><span> </span><span class="hs-special">{</span><span id="unClearActionData"><span class="annot"><span class="annottext">ClearActionData -&gt; Bool
</span><a href="Hasura.RQL.DDL.Action.html#unClearActionData"><span class="hs-identifier hs-var hs-var">unClearActionData</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">}</span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688702621"><span id="local-6989586621688702623"><span id="local-6989586621688702625"><span class="annot"><span class="annottext">Int -&gt; ClearActionData -&gt; ShowS
[ClearActionData] -&gt; ShowS
ClearActionData -&gt; String
(Int -&gt; ClearActionData -&gt; ShowS)
-&gt; (ClearActionData -&gt; String)
-&gt; ([ClearActionData] -&gt; ShowS)
-&gt; Show ClearActionData
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ClearActionData] -&gt; ShowS
$cshowList :: [ClearActionData] -&gt; ShowS
show :: ClearActionData -&gt; String
$cshow :: ClearActionData -&gt; String
showsPrec :: Int -&gt; ClearActionData -&gt; ShowS
$cshowsPrec :: Int -&gt; ClearActionData -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688702616"><span id="local-6989586621688702618"><span class="annot"><span class="annottext">ClearActionData -&gt; ClearActionData -&gt; Bool
(ClearActionData -&gt; ClearActionData -&gt; Bool)
-&gt; (ClearActionData -&gt; ClearActionData -&gt; Bool)
-&gt; Eq ClearActionData
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ClearActionData -&gt; ClearActionData -&gt; Bool
$c/= :: ClearActionData -&gt; ClearActionData -&gt; Bool
== :: ClearActionData -&gt; ClearActionData -&gt; Bool
$c== :: ClearActionData -&gt; ClearActionData -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688702611"><span id="local-6989586621688702613"><span class="annot"><span class="annottext">Value -&gt; Parser [ClearActionData]
Value -&gt; Parser ClearActionData
(Value -&gt; Parser ClearActionData)
-&gt; (Value -&gt; Parser [ClearActionData]) -&gt; FromJSON ClearActionData
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [ClearActionData]
$cparseJSONList :: Value -&gt; Parser [ClearActionData]
parseJSON :: Value -&gt; Parser ClearActionData
$cparseJSON :: Value -&gt; Parser ClearActionData
</span><a href="#local-6989586621688702611"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">J.FromJSON</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688702603"><span id="local-6989586621688702605"><span id="local-6989586621688702607"><span id="local-6989586621688702609"><span class="annot"><span class="annottext">[ClearActionData] -&gt; Encoding
[ClearActionData] -&gt; Value
ClearActionData -&gt; Encoding
ClearActionData -&gt; Value
(ClearActionData -&gt; Value)
-&gt; (ClearActionData -&gt; Encoding)
-&gt; ([ClearActionData] -&gt; Value)
-&gt; ([ClearActionData] -&gt; Encoding)
-&gt; ToJSON ClearActionData
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [ClearActionData] -&gt; Encoding
$ctoEncodingList :: [ClearActionData] -&gt; Encoding
toJSONList :: [ClearActionData] -&gt; Value
$ctoJSONList :: [ClearActionData] -&gt; Value
toEncoding :: ClearActionData -&gt; Encoding
$ctoEncoding :: ClearActionData -&gt; Encoding
toJSON :: ClearActionData -&gt; Value
$ctoJSON :: ClearActionData -&gt; Value
</span><a href="#local-6989586621688702603"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">J.ToJSON</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#shouldClearActionData"><span class="hs-identifier hs-type">shouldClearActionData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#ClearActionData"><span class="hs-identifier hs-type">ClearActionData</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-243"></span><span id="shouldClearActionData"><span class="annot"><span class="annottext">shouldClearActionData :: ClearActionData -&gt; Bool
</span><a href="Hasura.RQL.DDL.Action.html#shouldClearActionData"><span class="hs-identifier hs-var hs-var">shouldClearActionData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClearActionData -&gt; Bool
</span><a href="Hasura.RQL.DDL.Action.html#unClearActionData"><span class="hs-identifier hs-var hs-var">unClearActionData</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#defaultClearActionData"><span class="hs-identifier hs-type">defaultClearActionData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#ClearActionData"><span class="hs-identifier hs-type">ClearActionData</span></a></span><span>
</span><span id="line-246"></span><span id="defaultClearActionData"><span class="annot"><span class="annottext">defaultClearActionData :: ClearActionData
</span><a href="Hasura.RQL.DDL.Action.html#defaultClearActionData"><span class="hs-identifier hs-var hs-var">defaultClearActionData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ClearActionData
</span><a href="Hasura.RQL.DDL.Action.html#ClearActionData"><span class="hs-identifier hs-var">ClearActionData</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-keyword">data</span><span> </span><span id="DropAction"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#DropAction"><span class="hs-identifier hs-var">DropAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DropAction"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#DropAction"><span class="hs-identifier hs-var">DropAction</span></a></span></span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_daName"><span class="annot"><span class="annottext">DropAction -&gt; ActionName
</span><a href="Hasura.RQL.DDL.Action.html#_daName"><span class="hs-identifier hs-var hs-var">_daName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.RQL.Types.Action.html#ActionName"><span class="hs-identifier hs-type">ActionName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-250"></span><span>    </span><span id="_daClearData"><span class="annot"><span class="annottext">DropAction -&gt; Maybe ClearActionData
</span><a href="Hasura.RQL.DDL.Action.html#_daClearData"><span class="hs-identifier hs-var hs-var">_daClearData</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#ClearActionData"><span class="hs-identifier hs-type">ClearActionData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688702592"><span id="local-6989586621688702594"><span id="local-6989586621688702596"><span class="annot"><span class="annottext">Int -&gt; DropAction -&gt; ShowS
[DropAction] -&gt; ShowS
DropAction -&gt; String
(Int -&gt; DropAction -&gt; ShowS)
-&gt; (DropAction -&gt; String)
-&gt; ([DropAction] -&gt; ShowS)
-&gt; Show DropAction
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [DropAction] -&gt; ShowS
$cshowList :: [DropAction] -&gt; ShowS
show :: DropAction -&gt; String
$cshow :: DropAction -&gt; String
showsPrec :: Int -&gt; DropAction -&gt; ShowS
$cshowsPrec :: Int -&gt; DropAction -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688702588"><span id="local-6989586621688702590"><span class="annot"><span class="annottext">DropAction -&gt; DropAction -&gt; Bool
(DropAction -&gt; DropAction -&gt; Bool)
-&gt; (DropAction -&gt; DropAction -&gt; Bool) -&gt; Eq DropAction
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DropAction -&gt; DropAction -&gt; Bool
$c/= :: DropAction -&gt; DropAction -&gt; Bool
== :: DropAction -&gt; DropAction -&gt; Bool
$c== :: DropAction -&gt; DropAction -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-special">$(</span><span id="local-6989586621688702576"><span id="local-6989586621688702578"><span id="local-6989586621688702580"><span id="local-6989586621688702582"><span id="local-6989586621688702584"><span id="local-6989586621688702586"><span class="hs-identifier">J.deriveJSON</span><span> </span><span class="hs-identifier">hasuraJSON</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">DropAction</span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span id="local-6989586621688702575"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#runDropAction"><span class="hs-identifier hs-type">runDropAction</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.Build.html#CacheRWM"><span class="hs-identifier hs-type">CacheRWM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688702575"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-258"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html#MetadataM"><span class="hs-identifier hs-type">MetadataM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688702575"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><a href="Hasura.Metadata.Class.html#MonadMetadataStorageQueryAPI"><span class="hs-identifier hs-type">MonadMetadataStorageQueryAPI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688702575"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-261"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#DropAction"><span class="hs-identifier hs-type">DropAction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><a href="#local-6989586621688702575"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span></span><span>
</span><span id="line-263"></span><span id="runDropAction"><span class="annot"><span class="annottext">runDropAction :: DropAction -&gt; m EncJSON
</span><a href="Hasura.RQL.DDL.Action.html#runDropAction"><span class="hs-identifier hs-var hs-var">runDropAction</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#DropAction"><span class="hs-identifier hs-type">DropAction</span></a></span><span> </span><span id="local-6989586621688702574"><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702574"><span class="hs-identifier hs-var">actionName</span></a></span></span><span> </span><span id="local-6989586621688702573"><span class="annot"><span class="annottext">Maybe ClearActionData
</span><a href="#local-6989586621688702573"><span class="hs-identifier hs-var">clearDataM</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-264"></span><span>  </span><span class="annot"><span class="annottext">m ActionInfo -&gt; m ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(m ActionInfo -&gt; m ()) -&gt; m ActionInfo -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ActionName -&gt; m ActionInfo
forall (m :: * -&gt; *).
(QErrM m, CacheRM m) =&gt;
ActionName -&gt; m ActionInfo
</span><a href="Hasura.RQL.DDL.Action.html#getActionInfo"><span class="hs-identifier hs-var">getActionInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702574"><span class="hs-identifier hs-var">actionName</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span class="annot"><span class="annottext">m () -&gt; m ()
forall (m :: * -&gt; *) a. (QErrM m, CacheRM m) =&gt; m a -&gt; m a
</span><a href="Hasura.RQL.Types.SchemaCache.Build.html#withNewInconsistentObjsCheck"><span class="hs-identifier hs-var">withNewInconsistentObjsCheck</span></a></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-266"></span><span>    </span><span class="annot"><span class="annottext">MetadataModifier -&gt; m ()
forall (m :: * -&gt; *).
(MetadataM m, CacheRWM m) =&gt;
MetadataModifier -&gt; m ()
</span><a href="Hasura.RQL.Types.SchemaCache.Build.html#buildSchemaCache"><span class="hs-identifier hs-var">buildSchemaCache</span></a></span><span> </span><span class="annot"><span class="annottext">(MetadataModifier -&gt; m ()) -&gt; MetadataModifier -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-267"></span><span>      </span><span class="annot"><span class="annottext">ActionName -&gt; MetadataModifier
</span><a href="Hasura.RQL.DDL.Action.html#dropActionInMetadata"><span class="hs-identifier hs-var">dropActionInMetadata</span></a></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702574"><span class="hs-identifier hs-var">actionName</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ClearActionData -&gt; Bool
</span><a href="Hasura.RQL.DDL.Action.html#shouldClearActionData"><span class="hs-identifier hs-var">shouldClearActionData</span></a></span><span> </span><span class="annot"><span class="annottext">ClearActionData
</span><a href="#local-6989586621688702570"><span class="hs-identifier hs-var">clearData</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ActionName -&gt; m ()
forall (m :: * -&gt; *).
MonadMetadataStorageQueryAPI m =&gt;
ActionName -&gt; m ()
</span><a href="Hasura.Metadata.Class.html#deleteActionData"><span class="hs-identifier hs-var">deleteActionData</span></a></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702574"><span class="hs-identifier hs-var">actionName</span></a></span><span>
</span><span id="line-269"></span><span>  </span><span class="annot"><span class="annottext">EncJSON -&gt; m EncJSON
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">EncJSON
</span><a href="Hasura.RQL.Types.Common.html#successMsg"><span class="hs-identifier hs-var">successMsg</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-comment">-- When clearData is not present we assume that</span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-comment">-- the data needs to be retained</span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621688702570"><span class="annot"><span class="annottext">clearData :: ClearActionData
</span><a href="#local-6989586621688702570"><span class="hs-identifier hs-var hs-var">clearData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClearActionData -&gt; Maybe ClearActionData -&gt; ClearActionData
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">ClearActionData
</span><a href="Hasura.RQL.DDL.Action.html#defaultClearActionData"><span class="hs-identifier hs-var">defaultClearActionData</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ClearActionData
</span><a href="#local-6989586621688702573"><span class="hs-identifier hs-var">clearDataM</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#dropActionInMetadata"><span class="hs-identifier hs-type">dropActionInMetadata</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Action.html#ActionName"><span class="hs-identifier hs-type">ActionName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html#MetadataModifier"><span class="hs-identifier hs-type">MetadataModifier</span></a></span><span>
</span><span id="line-276"></span><span id="dropActionInMetadata"><span class="annot"><span class="annottext">dropActionInMetadata :: ActionName -&gt; MetadataModifier
</span><a href="Hasura.RQL.DDL.Action.html#dropActionInMetadata"><span class="hs-identifier hs-var hs-var">dropActionInMetadata</span></a></span></span><span> </span><span id="local-6989586621688702567"><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702567"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><span class="annottext">(Metadata -&gt; Metadata) -&gt; MetadataModifier
</span><a href="Hasura.RQL.Types.Metadata.html#MetadataModifier"><span class="hs-identifier hs-var">MetadataModifier</span></a></span><span> </span><span class="annot"><span class="annottext">((Metadata -&gt; Metadata) -&gt; MetadataModifier)
-&gt; (Metadata -&gt; Metadata) -&gt; MetadataModifier
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Actions -&gt; Identity Actions) -&gt; Metadata -&gt; Identity Metadata
Lens' Metadata Actions
</span><a href="Hasura.RQL.Types.Metadata.html#metaActions"><span class="hs-identifier hs-var">metaActions</span></a></span><span> </span><span class="annot"><span class="annottext">((Actions -&gt; Identity Actions) -&gt; Metadata -&gt; Identity Metadata)
-&gt; (Actions -&gt; Actions) -&gt; Metadata -&gt; Metadata
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">ActionName -&gt; Actions -&gt; Actions
forall k v.
(Eq k, Hashable k) =&gt;
k -&gt; InsOrdHashMap k v -&gt; InsOrdHashMap k v
</span><span class="hs-identifier hs-var">OMap.delete</span></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702567"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-keyword">newtype</span><span> </span><span id="ActionMetadataField"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#ActionMetadataField"><span class="hs-identifier hs-var">ActionMetadataField</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ActionMetadataField"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#ActionMetadataField"><span class="hs-identifier hs-var">ActionMetadataField</span></a></span></span><span> </span><span class="hs-special">{</span><span id="unActionMetadataField"><span class="annot"><span class="annottext">ActionMetadataField -&gt; Text
</span><a href="Hasura.RQL.DDL.Action.html#unActionMetadataField"><span class="hs-identifier hs-var hs-var">unActionMetadataField</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">}</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688702558"><span id="local-6989586621688702560"><span id="local-6989586621688702562"><span class="annot"><span class="annottext">Int -&gt; ActionMetadataField -&gt; ShowS
[ActionMetadataField] -&gt; ShowS
ActionMetadataField -&gt; String
(Int -&gt; ActionMetadataField -&gt; ShowS)
-&gt; (ActionMetadataField -&gt; String)
-&gt; ([ActionMetadataField] -&gt; ShowS)
-&gt; Show ActionMetadataField
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ActionMetadataField] -&gt; ShowS
$cshowList :: [ActionMetadataField] -&gt; ShowS
show :: ActionMetadataField -&gt; String
$cshow :: ActionMetadataField -&gt; String
showsPrec :: Int -&gt; ActionMetadataField -&gt; ShowS
$cshowsPrec :: Int -&gt; ActionMetadataField -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688702554"><span id="local-6989586621688702556"><span class="annot"><span class="annottext">ActionMetadataField -&gt; ActionMetadataField -&gt; Bool
(ActionMetadataField -&gt; ActionMetadataField -&gt; Bool)
-&gt; (ActionMetadataField -&gt; ActionMetadataField -&gt; Bool)
-&gt; Eq ActionMetadataField
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ActionMetadataField -&gt; ActionMetadataField -&gt; Bool
$c/= :: ActionMetadataField -&gt; ActionMetadataField -&gt; Bool
== :: ActionMetadataField -&gt; ActionMetadataField -&gt; Bool
$c== :: ActionMetadataField -&gt; ActionMetadataField -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688702550"><span id="local-6989586621688702552"><span class="annot"><span class="annottext">Value -&gt; Parser [ActionMetadataField]
Value -&gt; Parser ActionMetadataField
(Value -&gt; Parser ActionMetadataField)
-&gt; (Value -&gt; Parser [ActionMetadataField])
-&gt; FromJSON ActionMetadataField
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [ActionMetadataField]
$cparseJSONList :: Value -&gt; Parser [ActionMetadataField]
parseJSON :: Value -&gt; Parser ActionMetadataField
$cparseJSON :: Value -&gt; Parser ActionMetadataField
</span><a href="#local-6989586621688702550"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">J.FromJSON</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688702542"><span id="local-6989586621688702544"><span id="local-6989586621688702546"><span id="local-6989586621688702548"><span class="annot"><span class="annottext">[ActionMetadataField] -&gt; Encoding
[ActionMetadataField] -&gt; Value
ActionMetadataField -&gt; Encoding
ActionMetadataField -&gt; Value
(ActionMetadataField -&gt; Value)
-&gt; (ActionMetadataField -&gt; Encoding)
-&gt; ([ActionMetadataField] -&gt; Value)
-&gt; ([ActionMetadataField] -&gt; Encoding)
-&gt; ToJSON ActionMetadataField
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [ActionMetadataField] -&gt; Encoding
$ctoEncodingList :: [ActionMetadataField] -&gt; Encoding
toJSONList :: [ActionMetadataField] -&gt; Value
$ctoJSONList :: [ActionMetadataField] -&gt; Value
toEncoding :: ActionMetadataField -&gt; Encoding
$ctoEncoding :: ActionMetadataField -&gt; Encoding
toJSON :: ActionMetadataField -&gt; Value
$ctoJSON :: ActionMetadataField -&gt; Value
</span><a href="#local-6989586621688702542"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">J.ToJSON</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#doesActionPermissionExist"><span class="hs-identifier hs-type">doesActionPermissionExist</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html#Metadata"><span class="hs-identifier hs-type">Metadata</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Action.html#ActionName"><span class="hs-identifier hs-type">ActionName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Session.html#RoleName"><span class="hs-identifier hs-type">RoleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-283"></span><span id="doesActionPermissionExist"><span class="annot"><span class="annottext">doesActionPermissionExist :: Metadata -&gt; ActionName -&gt; RoleName -&gt; Bool
</span><a href="Hasura.RQL.DDL.Action.html#doesActionPermissionExist"><span class="hs-identifier hs-var hs-var">doesActionPermissionExist</span></a></span></span><span> </span><span id="local-6989586621688702540"><span class="annot"><span class="annottext">Metadata
</span><a href="#local-6989586621688702540"><span class="hs-identifier hs-var">metadata</span></a></span></span><span> </span><span id="local-6989586621688702539"><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702539"><span class="hs-identifier hs-var">actionName</span></a></span></span><span> </span><span id="local-6989586621688702538"><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621688702538"><span class="hs-identifier hs-var">roleName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-284"></span><span>  </span><span class="annot"><span class="annottext">(ActionPermissionMetadata -&gt; Bool)
-&gt; [ActionPermissionMetadata] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoleName -&gt; RoleName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621688702538"><span class="hs-identifier hs-var">roleName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RoleName -&gt; Bool)
-&gt; (ActionPermissionMetadata -&gt; RoleName)
-&gt; ActionPermissionMetadata
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ActionPermissionMetadata -&gt; RoleName
</span><a href="Hasura.RQL.Types.Action.html#_apmRole"><span class="hs-identifier hs-var hs-var">_apmRole</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([ActionPermissionMetadata] -&gt; Bool)
-&gt; [ActionPermissionMetadata] -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Metadata
</span><a href="#local-6989586621688702540"><span class="hs-identifier hs-var">metadata</span></a></span><span> </span><span class="annot"><span class="annottext">Metadata
-&gt; Getting
     [ActionPermissionMetadata] Metadata [ActionPermissionMetadata]
-&gt; [ActionPermissionMetadata]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Actions -&gt; Const [ActionPermissionMetadata] Actions)
-&gt; Metadata -&gt; Const [ActionPermissionMetadata] Metadata
Lens' Metadata Actions
</span><a href="Hasura.RQL.Types.Metadata.html#metaActions"><span class="hs-identifier hs-var">metaActions</span></a></span><span> </span><span class="annot"><span class="annottext">((Actions -&gt; Const [ActionPermissionMetadata] Actions)
 -&gt; Metadata -&gt; Const [ActionPermissionMetadata] Metadata)
-&gt; (([ActionPermissionMetadata]
     -&gt; Const [ActionPermissionMetadata] [ActionPermissionMetadata])
    -&gt; Actions -&gt; Const [ActionPermissionMetadata] Actions)
-&gt; Getting
     [ActionPermissionMetadata] Metadata [ActionPermissionMetadata]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Index Actions -&gt; Traversal' Actions (IxValue Actions)
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Index Actions
ActionName
</span><a href="#local-6989586621688702539"><span class="hs-identifier hs-var">actionName</span></a></span><span> </span><span class="annot"><span class="annottext">((ActionMetadata
  -&gt; Const [ActionPermissionMetadata] ActionMetadata)
 -&gt; Actions -&gt; Const [ActionPermissionMetadata] Actions)
-&gt; (([ActionPermissionMetadata]
     -&gt; Const [ActionPermissionMetadata] [ActionPermissionMetadata])
    -&gt; ActionMetadata
    -&gt; Const [ActionPermissionMetadata] ActionMetadata)
-&gt; ([ActionPermissionMetadata]
    -&gt; Const [ActionPermissionMetadata] [ActionPermissionMetadata])
-&gt; Actions
-&gt; Const [ActionPermissionMetadata] Actions
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([ActionPermissionMetadata]
 -&gt; Const [ActionPermissionMetadata] [ActionPermissionMetadata])
-&gt; ActionMetadata
-&gt; Const [ActionPermissionMetadata] ActionMetadata
Lens' ActionMetadata [ActionPermissionMetadata]
</span><a href="Hasura.RQL.Types.Action.html#amPermissions"><span class="hs-identifier hs-var">amPermissions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-keyword">data</span><span> </span><span id="CreateActionPermission"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#CreateActionPermission"><span class="hs-identifier hs-var">CreateActionPermission</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CreateActionPermission"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#CreateActionPermission"><span class="hs-identifier hs-var">CreateActionPermission</span></a></span></span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_capAction"><span class="annot"><span class="annottext">CreateActionPermission -&gt; ActionName
</span><a href="Hasura.RQL.DDL.Action.html#_capAction"><span class="hs-identifier hs-var hs-var">_capAction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.RQL.Types.Action.html#ActionName"><span class="hs-identifier hs-type">ActionName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-288"></span><span>    </span><span id="_capRole"><span class="annot"><span class="annottext">CreateActionPermission -&gt; RoleName
</span><a href="Hasura.RQL.DDL.Action.html#_capRole"><span class="hs-identifier hs-var hs-var">_capRole</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Session.html#RoleName"><span class="hs-identifier hs-type">RoleName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-289"></span><span>    </span><span id="_capDefinition"><span class="annot"><span class="annottext">CreateActionPermission -&gt; Maybe Value
</span><a href="Hasura.RQL.DDL.Action.html#_capDefinition"><span class="hs-identifier hs-var hs-var">_capDefinition</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">J.Value</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-290"></span><span>    </span><span id="_capComment"><span class="annot"><span class="annottext">CreateActionPermission -&gt; Maybe Text
</span><a href="Hasura.RQL.DDL.Action.html#_capComment"><span class="hs-identifier hs-var hs-var">_capComment</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-special">$(</span><span id="local-6989586621688702526"><span id="local-6989586621688702528"><span class="hs-identifier">J.deriveFromJSON</span><span> </span><span class="hs-identifier">hasuraJSON</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">CreateActionPermission</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span id="local-6989586621688702525"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#runCreateActionPermission"><span class="hs-identifier hs-type">runCreateActionPermission</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688702525"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.Build.html#CacheRWM"><span class="hs-identifier hs-type">CacheRWM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688702525"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html#MetadataM"><span class="hs-identifier hs-type">MetadataM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688702525"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-297"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#CreateActionPermission"><span class="hs-identifier hs-type">CreateActionPermission</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-298"></span><span>  </span><span class="annot"><a href="#local-6989586621688702525"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span></span><span>
</span><span id="line-299"></span><span id="runCreateActionPermission"><span class="annot"><span class="annottext">runCreateActionPermission :: CreateActionPermission -&gt; m EncJSON
</span><a href="Hasura.RQL.DDL.Action.html#runCreateActionPermission"><span class="hs-identifier hs-var hs-var">runCreateActionPermission</span></a></span></span><span> </span><span id="local-6989586621688702524"><span class="annot"><span class="annottext">CreateActionPermission
</span><a href="#local-6989586621688702524"><span class="hs-identifier hs-var">createActionPermission</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-300"></span><span>  </span><span id="local-6989586621688702523"><span class="annot"><span class="annottext">Metadata
</span><a href="#local-6989586621688702523"><span class="hs-identifier hs-var">metadata</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Metadata
forall (m :: * -&gt; *). MetadataM m =&gt; m Metadata
</span><a href="Hasura.RQL.Types.Metadata.html#getMetadata"><span class="hs-identifier hs-var">getMetadata</span></a></span><span>
</span><span id="line-301"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Metadata -&gt; ActionName -&gt; RoleName -&gt; Bool
</span><a href="Hasura.RQL.DDL.Action.html#doesActionPermissionExist"><span class="hs-identifier hs-var">doesActionPermissionExist</span></a></span><span> </span><span class="annot"><span class="annottext">Metadata
</span><a href="#local-6989586621688702523"><span class="hs-identifier hs-var">metadata</span></a></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702521"><span class="hs-identifier hs-var">actionName</span></a></span><span> </span><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621688702520"><span class="hs-identifier hs-var">roleName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#AlreadyExists"><span class="hs-identifier hs-var">AlreadyExists</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-303"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;permission for role &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621688702520"><span class="hs-identifier hs-var">roleName</span></a></span><span>
</span><span id="line-304"></span><span>        </span><span class="annot"><span class="annottext">RoleName -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; is already defined on &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ActionName -&gt; Text
forall t. ToTxt t =&gt; Text -&gt; t -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3E%3E"><span class="hs-operator hs-var">&lt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702521"><span class="hs-identifier hs-var">actionName</span></a></span><span>
</span><span id="line-305"></span><span>  </span><span class="annot"><span class="annottext">MetadataObjId -&gt; MetadataModifier -&gt; m ()
forall (m :: * -&gt; *).
(QErrM m, CacheRWM m, MetadataM m) =&gt;
MetadataObjId -&gt; MetadataModifier -&gt; m ()
</span><a href="Hasura.RQL.Types.SchemaCache.Build.html#buildSchemaCacheFor"><span class="hs-identifier hs-var">buildSchemaCacheFor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionName -&gt; RoleName -&gt; MetadataObjId
</span><a href="Hasura.RQL.Types.Metadata.Object.html#MOActionPermission"><span class="hs-identifier hs-var">MOActionPermission</span></a></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702521"><span class="hs-identifier hs-var">actionName</span></a></span><span> </span><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621688702520"><span class="hs-identifier hs-var">roleName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(MetadataModifier -&gt; m ()) -&gt; MetadataModifier -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="annottext">(Metadata -&gt; Metadata) -&gt; MetadataModifier
</span><a href="Hasura.RQL.Types.Metadata.html#MetadataModifier"><span class="hs-identifier hs-var">MetadataModifier</span></a></span><span> </span><span class="annot"><span class="annottext">((Metadata -&gt; Metadata) -&gt; MetadataModifier)
-&gt; (Metadata -&gt; Metadata) -&gt; MetadataModifier
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-307"></span><span>      </span><span class="annot"><span class="annottext">(Actions -&gt; Identity Actions) -&gt; Metadata -&gt; Identity Metadata
Lens' Metadata Actions
</span><a href="Hasura.RQL.Types.Metadata.html#metaActions"><span class="hs-identifier hs-var">metaActions</span></a></span><span> </span><span class="annot"><span class="annottext">((Actions -&gt; Identity Actions) -&gt; Metadata -&gt; Identity Metadata)
-&gt; (([ActionPermissionMetadata]
     -&gt; Identity [ActionPermissionMetadata])
    -&gt; Actions -&gt; Identity Actions)
-&gt; ([ActionPermissionMetadata]
    -&gt; Identity [ActionPermissionMetadata])
-&gt; Metadata
-&gt; Identity Metadata
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Index Actions -&gt; Traversal' Actions (IxValue Actions)
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Index Actions
ActionName
</span><a href="#local-6989586621688702521"><span class="hs-identifier hs-var">actionName</span></a></span><span> </span><span class="annot"><span class="annottext">((ActionMetadata -&gt; Identity ActionMetadata)
 -&gt; Actions -&gt; Identity Actions)
-&gt; (([ActionPermissionMetadata]
     -&gt; Identity [ActionPermissionMetadata])
    -&gt; ActionMetadata -&gt; Identity ActionMetadata)
-&gt; ([ActionPermissionMetadata]
    -&gt; Identity [ActionPermissionMetadata])
-&gt; Actions
-&gt; Identity Actions
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([ActionPermissionMetadata] -&gt; Identity [ActionPermissionMetadata])
-&gt; ActionMetadata -&gt; Identity ActionMetadata
Lens' ActionMetadata [ActionPermissionMetadata]
</span><a href="Hasura.RQL.Types.Action.html#amPermissions"><span class="hs-identifier hs-var">amPermissions</span></a></span><span>
</span><span id="line-308"></span><span>        </span><span class="annot"><span class="annottext">(([ActionPermissionMetadata]
  -&gt; Identity [ActionPermissionMetadata])
 -&gt; Metadata -&gt; Identity Metadata)
-&gt; ([ActionPermissionMetadata] -&gt; [ActionPermissionMetadata])
-&gt; Metadata
-&gt; Metadata
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoleName -&gt; Maybe Text -&gt; ActionPermissionMetadata
</span><a href="Hasura.RQL.Types.Action.html#ActionPermissionMetadata"><span class="hs-identifier hs-var">ActionPermissionMetadata</span></a></span><span> </span><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621688702520"><span class="hs-identifier hs-var">roleName</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621688702516"><span class="hs-identifier hs-var">comment</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>  </span><span class="annot"><span class="annottext">EncJSON -&gt; m EncJSON
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">EncJSON
</span><a href="Hasura.RQL.Types.Common.html#successMsg"><span class="hs-identifier hs-var">successMsg</span></a></span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#CreateActionPermission"><span class="hs-identifier hs-type">CreateActionPermission</span></a></span><span> </span><span id="local-6989586621688702521"><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702521"><span class="hs-identifier hs-var">actionName</span></a></span></span><span> </span><span id="local-6989586621688702520"><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621688702520"><span class="hs-identifier hs-var">roleName</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621688702516"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621688702516"><span class="hs-identifier hs-var">comment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CreateActionPermission
</span><a href="#local-6989586621688702524"><span class="hs-identifier hs-var">createActionPermission</span></a></span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="hs-keyword">data</span><span> </span><span id="DropActionPermission"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#DropActionPermission"><span class="hs-identifier hs-var">DropActionPermission</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DropActionPermission"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#DropActionPermission"><span class="hs-identifier hs-var">DropActionPermission</span></a></span></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_dapAction"><span class="annot"><span class="annottext">DropActionPermission -&gt; ActionName
</span><a href="Hasura.RQL.DDL.Action.html#_dapAction"><span class="hs-identifier hs-var hs-var">_dapAction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.RQL.Types.Action.html#ActionName"><span class="hs-identifier hs-type">ActionName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-315"></span><span>    </span><span id="_dapRole"><span class="annot"><span class="annottext">DropActionPermission -&gt; RoleName
</span><a href="Hasura.RQL.DDL.Action.html#_dapRole"><span class="hs-identifier hs-var hs-var">_dapRole</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Session.html#RoleName"><span class="hs-identifier hs-type">RoleName</span></a></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688702507"><span id="local-6989586621688702509"><span id="local-6989586621688702511"><span class="annot"><span class="annottext">Int -&gt; DropActionPermission -&gt; ShowS
[DropActionPermission] -&gt; ShowS
DropActionPermission -&gt; String
(Int -&gt; DropActionPermission -&gt; ShowS)
-&gt; (DropActionPermission -&gt; String)
-&gt; ([DropActionPermission] -&gt; ShowS)
-&gt; Show DropActionPermission
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [DropActionPermission] -&gt; ShowS
$cshowList :: [DropActionPermission] -&gt; ShowS
show :: DropActionPermission -&gt; String
$cshow :: DropActionPermission -&gt; String
showsPrec :: Int -&gt; DropActionPermission -&gt; ShowS
$cshowsPrec :: Int -&gt; DropActionPermission -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688702503"><span id="local-6989586621688702505"><span class="annot"><span class="annottext">DropActionPermission -&gt; DropActionPermission -&gt; Bool
(DropActionPermission -&gt; DropActionPermission -&gt; Bool)
-&gt; (DropActionPermission -&gt; DropActionPermission -&gt; Bool)
-&gt; Eq DropActionPermission
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DropActionPermission -&gt; DropActionPermission -&gt; Bool
$c/= :: DropActionPermission -&gt; DropActionPermission -&gt; Bool
== :: DropActionPermission -&gt; DropActionPermission -&gt; Bool
$c== :: DropActionPermission -&gt; DropActionPermission -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-special">$(</span><span id="local-6989586621688702491"><span id="local-6989586621688702493"><span id="local-6989586621688702495"><span id="local-6989586621688702497"><span id="local-6989586621688702499"><span id="local-6989586621688702501"><span class="hs-identifier">J.deriveJSON</span><span> </span><span class="hs-identifier">hasuraJSON</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">DropActionPermission</span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span id="local-6989586621688702490"><span class="annot"><a href="Hasura.RQL.DDL.Action.html#runDropActionPermission"><span class="hs-identifier hs-type">runDropActionPermission</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688702490"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.Build.html#CacheRWM"><span class="hs-identifier hs-type">CacheRWM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688702490"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html#MetadataM"><span class="hs-identifier hs-type">MetadataM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688702490"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-323"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#DropActionPermission"><span class="hs-identifier hs-type">DropActionPermission</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><a href="#local-6989586621688702490"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span></span><span>
</span><span id="line-325"></span><span id="runDropActionPermission"><span class="annot"><span class="annottext">runDropActionPermission :: DropActionPermission -&gt; m EncJSON
</span><a href="Hasura.RQL.DDL.Action.html#runDropActionPermission"><span class="hs-identifier hs-var hs-var">runDropActionPermission</span></a></span></span><span> </span><span id="local-6989586621688702489"><span class="annot"><span class="annottext">DropActionPermission
</span><a href="#local-6989586621688702489"><span class="hs-identifier hs-var">dropActionPermission</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-326"></span><span>  </span><span id="local-6989586621688702488"><span class="annot"><span class="annottext">Metadata
</span><a href="#local-6989586621688702488"><span class="hs-identifier hs-var">metadata</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Metadata
forall (m :: * -&gt; *). MetadataM m =&gt; m Metadata
</span><a href="Hasura.RQL.Types.Metadata.html#getMetadata"><span class="hs-identifier hs-var">getMetadata</span></a></span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Metadata -&gt; ActionName -&gt; RoleName -&gt; Bool
</span><a href="Hasura.RQL.DDL.Action.html#doesActionPermissionExist"><span class="hs-identifier hs-var">doesActionPermissionExist</span></a></span><span> </span><span class="annot"><span class="annottext">Metadata
</span><a href="#local-6989586621688702488"><span class="hs-identifier hs-var">metadata</span></a></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702487"><span class="hs-identifier hs-var">actionName</span></a></span><span> </span><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621688702486"><span class="hs-identifier hs-var">roleName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-328"></span><span>    </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotExists"><span class="hs-identifier hs-var">NotExists</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-329"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;permission for role: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621688702486"><span class="hs-identifier hs-var">roleName</span></a></span><span> </span><span class="annot"><span class="annottext">RoleName -&gt; Text -&gt; Text
forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; is not defined on &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ActionName -&gt; Text
forall t. ToTxt t =&gt; Text -&gt; t -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3E%3E"><span class="hs-operator hs-var">&lt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702487"><span class="hs-identifier hs-var">actionName</span></a></span><span>
</span><span id="line-330"></span><span>  </span><span class="annot"><span class="annottext">MetadataObjId -&gt; MetadataModifier -&gt; m ()
forall (m :: * -&gt; *).
(QErrM m, CacheRWM m, MetadataM m) =&gt;
MetadataObjId -&gt; MetadataModifier -&gt; m ()
</span><a href="Hasura.RQL.Types.SchemaCache.Build.html#buildSchemaCacheFor"><span class="hs-identifier hs-var">buildSchemaCacheFor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionName -&gt; RoleName -&gt; MetadataObjId
</span><a href="Hasura.RQL.Types.Metadata.Object.html#MOActionPermission"><span class="hs-identifier hs-var">MOActionPermission</span></a></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702487"><span class="hs-identifier hs-var">actionName</span></a></span><span> </span><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621688702486"><span class="hs-identifier hs-var">roleName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(MetadataModifier -&gt; m ()) -&gt; MetadataModifier -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><span class="annottext">ActionName -&gt; RoleName -&gt; MetadataModifier
</span><a href="Hasura.RQL.DDL.Action.html#dropActionPermissionInMetadata"><span class="hs-identifier hs-var">dropActionPermissionInMetadata</span></a></span><span> </span><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702487"><span class="hs-identifier hs-var">actionName</span></a></span><span> </span><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621688702486"><span class="hs-identifier hs-var">roleName</span></a></span><span>
</span><span id="line-332"></span><span>  </span><span class="annot"><span class="annottext">EncJSON -&gt; m EncJSON
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">EncJSON
</span><a href="Hasura.RQL.Types.Common.html#successMsg"><span class="hs-identifier hs-var">successMsg</span></a></span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-334"></span><span>    </span><span id="local-6989586621688702487"><span class="annot"><span class="annottext">actionName :: ActionName
</span><a href="#local-6989586621688702487"><span class="hs-identifier hs-var hs-var">actionName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DropActionPermission -&gt; ActionName
</span><a href="Hasura.RQL.DDL.Action.html#_dapAction"><span class="hs-identifier hs-var hs-var">_dapAction</span></a></span><span> </span><span class="annot"><span class="annottext">DropActionPermission
</span><a href="#local-6989586621688702489"><span class="hs-identifier hs-var">dropActionPermission</span></a></span><span>
</span><span id="line-335"></span><span>    </span><span id="local-6989586621688702486"><span class="annot"><span class="annottext">roleName :: RoleName
</span><a href="#local-6989586621688702486"><span class="hs-identifier hs-var hs-var">roleName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DropActionPermission -&gt; RoleName
</span><a href="Hasura.RQL.DDL.Action.html#_dapRole"><span class="hs-identifier hs-var hs-var">_dapRole</span></a></span><span> </span><span class="annot"><span class="annottext">DropActionPermission
</span><a href="#local-6989586621688702489"><span class="hs-identifier hs-var">dropActionPermission</span></a></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="annot"><a href="Hasura.RQL.DDL.Action.html#dropActionPermissionInMetadata"><span class="hs-identifier hs-type">dropActionPermissionInMetadata</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Action.html#ActionName"><span class="hs-identifier hs-type">ActionName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Session.html#RoleName"><span class="hs-identifier hs-type">RoleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html#MetadataModifier"><span class="hs-identifier hs-type">MetadataModifier</span></a></span><span>
</span><span id="line-338"></span><span id="dropActionPermissionInMetadata"><span class="annot"><span class="annottext">dropActionPermissionInMetadata :: ActionName -&gt; RoleName -&gt; MetadataModifier
</span><a href="Hasura.RQL.DDL.Action.html#dropActionPermissionInMetadata"><span class="hs-identifier hs-var hs-var">dropActionPermissionInMetadata</span></a></span></span><span> </span><span id="local-6989586621688702485"><span class="annot"><span class="annottext">ActionName
</span><a href="#local-6989586621688702485"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621688702484"><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621688702484"><span class="hs-keyword hs-var">role</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-339"></span><span>  </span><span class="annot"><span class="annottext">(Metadata -&gt; Metadata) -&gt; MetadataModifier
</span><a href="Hasura.RQL.Types.Metadata.html#MetadataModifier"><span class="hs-identifier hs-var">MetadataModifier</span></a></span><span> </span><span class="annot"><span class="annottext">((Metadata -&gt; Metadata) -&gt; MetadataModifier)
-&gt; (Metadata -&gt; Metadata) -&gt; MetadataModifier
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><span class="annottext">(Actions -&gt; Identity Actions) -&gt; Metadata -&gt; Identity Metadata
Lens' Metadata Actions
</span><a href="Hasura.RQL.Types.Metadata.html#metaActions"><span class="hs-identifier hs-var">metaActions</span></a></span><span> </span><span class="annot"><span class="annottext">((Actions -&gt; Identity Actions) -&gt; Metadata -&gt; Identity Metadata)
-&gt; (([ActionPermissionMetadata]
     -&gt; Identity [ActionPermissionMetadata])
    -&gt; Actions -&gt; Identity Actions)
-&gt; ([ActionPermissionMetadata]
    -&gt; Identity [ActionPermissionMetadata])
-&gt; Metadata
-&gt; Identity Metadata
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Index Actions -&gt; Traversal' Actions (IxValue Actions)
forall m. Ixed m =&gt; Index m -&gt; Traversal' m (IxValue m)
</span><span class="hs-identifier hs-var">ix</span></span><span> </span><span class="annot"><span class="annottext">Index Actions
ActionName
</span><a href="#local-6989586621688702485"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">((ActionMetadata -&gt; Identity ActionMetadata)
 -&gt; Actions -&gt; Identity Actions)
-&gt; (([ActionPermissionMetadata]
     -&gt; Identity [ActionPermissionMetadata])
    -&gt; ActionMetadata -&gt; Identity ActionMetadata)
-&gt; ([ActionPermissionMetadata]
    -&gt; Identity [ActionPermissionMetadata])
-&gt; Actions
-&gt; Identity Actions
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([ActionPermissionMetadata] -&gt; Identity [ActionPermissionMetadata])
-&gt; ActionMetadata -&gt; Identity ActionMetadata
Lens' ActionMetadata [ActionPermissionMetadata]
</span><a href="Hasura.RQL.Types.Action.html#amPermissions"><span class="hs-identifier hs-var">amPermissions</span></a></span><span> </span><span class="annot"><span class="annottext">(([ActionPermissionMetadata]
  -&gt; Identity [ActionPermissionMetadata])
 -&gt; Metadata -&gt; Identity Metadata)
-&gt; ([ActionPermissionMetadata] -&gt; [ActionPermissionMetadata])
-&gt; Metadata
-&gt; Metadata
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">(ActionPermissionMetadata -&gt; Bool)
-&gt; [ActionPermissionMetadata] -&gt; [ActionPermissionMetadata]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RoleName -&gt; RoleName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(/=)</span></span><span> </span><span class="annot"><span class="annottext">RoleName
</span><a href="#local-6989586621688702484"><span class="hs-keyword hs-var">role</span></a></span><span> </span><span class="annot"><span class="annottext">(RoleName -&gt; Bool)
-&gt; (ActionPermissionMetadata -&gt; RoleName)
-&gt; ActionPermissionMetadata
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ActionPermissionMetadata -&gt; RoleName
</span><a href="Hasura.RQL.Types.Action.html#_apmRole"><span class="hs-identifier hs-var hs-var">_apmRole</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span></pre></body></html>