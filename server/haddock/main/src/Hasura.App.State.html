<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE Arrows #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hasura.App.State</span><span>
</span><span id="line-4"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * application state</span></span><span>
</span><span id="line-5"></span><span>    </span><span class="annot"><a href="Hasura.App.State.html#RebuildableAppContext"><span class="hs-identifier">RebuildableAppContext</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Hasura.App.State.html#AppEnv"><span class="hs-identifier">AppEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier">AppContext</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Hasura.App.State.html#Loggers"><span class="hs-identifier">Loggers</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><span class="hs-comment">-- * env access</span></span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Hasura.App.State.html#HasAppEnv"><span class="hs-identifier">HasAppEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><span class="hs-comment">-- * init functions</span></span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Hasura.App.State.html#buildRebuildableAppContext"><span class="hs-identifier">buildRebuildableAppContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Hasura.App.State.html#rebuildRebuildableAppContext"><span class="hs-identifier">rebuildRebuildableAppContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><span class="hs-comment">-- * subsets</span></span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Hasura.App.State.html#initSQLGenCtx"><span class="hs-identifier">initSQLGenCtx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Hasura.App.State.html#buildCacheStaticConfig"><span class="hs-identifier">buildCacheStaticConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Hasura.App.State.html#buildCacheDynamicConfig"><span class="hs-identifier">buildCacheDynamicConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/arrows-extra-1.0.0/opt/doc/html/arrows-extra/src/Control.Arrow.Extended.html"><span class="hs-identifier">Control.Arrow.Extended</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent.STM</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">STM</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/monad-control-1.0.3.1-db4229aec3d9c1011503cf06798714c732b74d731fab23998dd34d578ed6d457/share/doc/html/src/Control.Monad.Trans.Control.html"><span class="hs-identifier">Control.Monad.Trans.Control</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/monad-control-1.0.3.1-db4229aec3d9c1011503cf06798714c732b74d731fab23998dd34d578ed6d457/share/doc/html/src/Control.Monad.Trans.Control.html#MonadBaseControl"><span class="hs-identifier">MonadBaseControl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Environment.html"><span class="hs-identifier">Data.Environment</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashSet.html"><span class="hs-identifier">Data.HashSet</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.html"><span class="hs-identifier">Database.PG.Query</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PG</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.DataConnector.Agent.Client.html"><span class="hs-identifier">Hasura.Backends.DataConnector.Agent.Client</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.DataConnector.Agent.Client.html#AgentLicenseKey"><span class="hs-identifier">AgentLicenseKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html"><span class="hs-identifier">Hasura.Base.Error</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.CredentialCache.html"><span class="hs-identifier">Hasura.CredentialCache</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Eventing.Common.html"><span class="hs-identifier">Hasura.Eventing.Common</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Eventing.Common.html#LockedEventsCtx"><span class="hs-identifier">LockedEventsCtx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Eventing.EventTrigger.html"><span class="hs-identifier">Hasura.Eventing.EventTrigger</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.Subscription.Options.html"><span class="hs-identifier">Hasura.GraphQL.Execute.Subscription.Options</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.Subscription.State.html"><span class="hs-identifier">Hasura.GraphQL.Execute.Subscription.State</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ES</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html"><span class="hs-identifier">Hasura.GraphQL.Schema.Common</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaSampledFeatureFlags"><span class="hs-identifier">SchemaSampledFeatureFlags</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#sampleFeatureFlags"><span class="hs-identifier">sampleFeatureFlags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/incremental-1.0.0/opt/doc/html/incremental/src/Hasura.Incremental.html"><span class="hs-identifier">Hasura.Incremental</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Inc</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Logging.html"><span class="hs-identifier">Hasura.Logging</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Schema.Cache.Config.html"><span class="hs-identifier">Hasura.RQL.DDL.Schema.Cache.Config</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html"><span class="hs-identifier">Hasura.RQL.Types.BackendType</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html"><span class="hs-identifier">Hasura.RQL.Types.Common</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html"><span class="hs-identifier">Hasura.RQL.Types.Metadata</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html"><span class="hs-identifier">Hasura.RQL.Types.NamingCase</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Roles.html"><span class="hs-identifier">Hasura.RQL.Types.Roles</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Roles.html#RoleName"><span class="hs-identifier">RoleName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html"><span class="hs-identifier">Hasura.RQL.Types.Schema.Options</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Options</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html"><span class="hs-identifier">Hasura.RQL.Types.SchemaCache</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#MetadataResourceVersion"><span class="hs-identifier">MetadataResourceVersion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Auth.html"><span class="hs-identifier">Hasura.Server.Auth</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Cors.html"><span class="hs-identifier">Hasura.Server.Cors</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Cors</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Init.html"><span class="hs-identifier">Hasura.Server.Init</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html"><span class="hs-identifier">Hasura.Server.Logging</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Metrics.html"><span class="hs-identifier">Hasura.Server.Metrics</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Prometheus.html"><span class="hs-identifier">Hasura.Server.Prometheus</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html"><span class="hs-identifier">Hasura.Server.Types</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.ShutdownLatch.html"><span class="hs-identifier">Hasura.ShutdownLatch</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Tracing.html"><span class="hs-identifier">Hasura.Tracing</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tracing</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-client-0.7.13.1-88628f48a025e46598ca658ea231eb27d6340417f49e950fbf8c438edb3ebbdc/share/doc/html/src/Network.HTTP.Client.html"><span class="hs-identifier">Network.HTTP.Client</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HTTP</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/warp-3.3.23-50e5af9c5eb14662055d2de06b988a5b42d28f82be66b7cb868f97bc9156bd1b/share/doc/html/src/Network.Wai.Handler.Warp.html"><span class="hs-identifier">Network.Wai.Handler.Warp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/streaming-commons-0.2.2.5-cc4a99ff9106c788e5412c2109477d88d1ac7f67a40d41eec67e31f02a5d8dca/share/doc/html/src/Data.Streaming.Network.Internal.html#HostPreference"><span class="hs-identifier">HostPreference</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/websockets-0.12.7.3-ace9e650e85dd6f2f2179ec47bba2f5dfacb8e002a1c77fe7c2fbe7ac37aed32/share/doc/html/src/Network.WebSockets.Connection.html"><span class="hs-identifier">Network.WebSockets.Connection</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">WebSockets</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/refined-0.8-b40efcc9b0260e802a32460f94ca38ced336d3f5163ccc01fe8e32d7f56bcb6d/share/doc/html/src/Refined.html"><span class="hs-identifier">Refined</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/refined-0.8-b40efcc9b0260e802a32460f94ca38ced336d3f5163ccc01fe8e32d7f56bcb6d/share/doc/html/src/Refined.html#NonNegative"><span class="hs-identifier">NonNegative</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/refined-0.8-b40efcc9b0260e802a32460f94ca38ced336d3f5163ccc01fe8e32d7f56bcb6d/share/doc/html/src/Refined.Unsafe.Type.html#Refined"><span class="hs-identifier">Refined</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- application state</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">{- Note [Hasura Application State]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Hasura Application state represents the entire state of hasura.

Hasura Application State = AppEnv (static) + AppContext (dynamic)

Hasura Application State can be divided into two parts:

  1. Read-Only State (Static State):
  =================================
  The information required to build this state is provided only during the
  initialization of hasura. This information is immutable. If you want update any
  field in this state, you would need to shutdown the current instance and
  re-launch hausura with new information.

  Eg: If you want to run hasura in read-only mode, you would have to mention
      this information when hasura starts up. There is no way to make hasura
      run in read-only mode once it has booted up.

  2. Runtime Configurable State (Dynamic State):
  ==============================================
  The information present in this state can be updated during the runtime. This state
  is mutable and does not require a restart of hasura instance to take effect.

  The fields in the state are usually updated via Metadata API's or Hasura Console.

  Eg: You can change the entries in Allowlist via console and hasura need not restart
      for the changes to take effect.

-}</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-keyword">data</span><span> </span><span id="RebuildableAppContext"><span class="annot"><a href="Hasura.App.State.html#RebuildableAppContext"><span class="hs-identifier hs-var">RebuildableAppContext</span></a></span></span><span> </span><span id="local-6989586621688032858"><span class="annot"><a href="#local-6989586621688032858"><span class="hs-identifier hs-type">impl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RebuildableAppContext"><span class="annot"><a href="Hasura.App.State.html#RebuildableAppContext"><span class="hs-identifier hs-var">RebuildableAppContext</span></a></span></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="lastBuiltAppContext"><span class="annot"><span class="annottext">forall impl. RebuildableAppContext impl -&gt; AppContext
</span><a href="Hasura.App.State.html#lastBuiltAppContext"><span class="hs-identifier hs-var hs-var">lastBuiltAppContext</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span>    </span><span id="_racInvalidationMap"><span class="annot"><span class="annottext">forall impl. RebuildableAppContext impl -&gt; InvalidationKeys
</span><a href="Hasura.App.State.html#_racInvalidationMap"><span class="hs-identifier hs-var hs-var">_racInvalidationMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.App.State.html#InvalidationKeys"><span class="hs-identifier hs-type">InvalidationKeys</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>    </span><span id="_racRebuild"><span class="annot"><span class="annottext">forall impl.
RebuildableAppContext impl
-&gt; Rule
     (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
     (ServeOptions impl, Environment, InvalidationKeys,
      CheckFeatureFlag)
     AppContext
</span><a href="Hasura.App.State.html#_racRebuild"><span class="hs-identifier hs-var hs-var">_racRebuild</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-101"></span><span>      </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/incremental-1.0.0/opt/doc/html/incremental/src/Hasura.Incremental.Internal.Rule.html#Rule"><span class="hs-identifier hs-type">Inc.Rule</span></a></span><span>
</span><span id="line-102"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Logging.html#Logger"><span class="hs-identifier hs-type">L.Logger</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">L.Hasura</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-client-0.7.13.1-88628f48a025e46598ca658ea231eb27d6340417f49e950fbf8c438edb3ebbdc/share/doc/html/src/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">HTTP.Manager</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Init.Config.html#ServeOptions"><span class="hs-identifier hs-type">ServeOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688032858"><span class="hs-identifier hs-type">impl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Environment.html#Environment"><span class="hs-identifier hs-type">E.Environment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.App.State.html#InvalidationKeys"><span class="hs-identifier hs-type">InvalidationKeys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Init.FeatureFlag.html#CheckFeatureFlag"><span class="hs-identifier hs-type">CheckFeatureFlag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>        </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">-- | Represents the Read-Only Hasura State, these fields are immutable and the state</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- cannot be changed during runtime.</span><span>
</span><span id="line-109"></span><span class="hs-keyword">data</span><span> </span><span id="AppEnv"><span class="annot"><a href="Hasura.App.State.html#AppEnv"><span class="hs-identifier hs-var">AppEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AppEnv"><span class="annot"><a href="Hasura.App.State.html#AppEnv"><span class="hs-identifier hs-var">AppEnv</span></a></span></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="appEnvPort"><span class="annot"><span class="annottext">AppEnv -&gt; Port
</span><a href="Hasura.App.State.html#appEnvPort"><span class="hs-identifier hs-var hs-var">appEnvPort</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#Port"><span class="hs-identifier hs-type">Port</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-111"></span><span>    </span><span id="appEnvHost"><span class="annot"><span class="annottext">AppEnv -&gt; HostPreference
</span><a href="Hasura.App.State.html#appEnvHost"><span class="hs-identifier hs-var hs-var">appEnvHost</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/streaming-commons-0.2.2.5-cc4a99ff9106c788e5412c2109477d88d1ac7f67a40d41eec67e31f02a5d8dca/share/doc/html/src/Data.Streaming.Network.Internal.html#HostPreference"><span class="hs-identifier hs-type">HostPreference</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>    </span><span id="appEnvMetadataDbPool"><span class="annot"><span class="annottext">AppEnv -&gt; PGPool
</span><a href="Hasura.App.State.html#appEnvMetadataDbPool"><span class="hs-identifier hs-var hs-var">appEnvMetadataDbPool</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Pool.html#PGPool"><span class="hs-identifier hs-type">PG.PGPool</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>    </span><span id="appEnvIntrospectionDbPool"><span class="annot"><span class="annottext">AppEnv -&gt; Maybe PGPool
</span><a href="Hasura.App.State.html#appEnvIntrospectionDbPool"><span class="hs-identifier hs-var hs-var">appEnvIntrospectionDbPool</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Pool.html#PGPool"><span class="hs-identifier hs-type">PG.PGPool</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>    </span><span id="appEnvManager"><span class="annot"><span class="annottext">AppEnv -&gt; Manager
</span><a href="Hasura.App.State.html#appEnvManager"><span class="hs-identifier hs-var hs-var">appEnvManager</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-client-0.7.13.1-88628f48a025e46598ca658ea231eb27d6340417f49e950fbf8c438edb3ebbdc/share/doc/html/src/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">HTTP.Manager</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>    </span><span id="appEnvLoggers"><span class="annot"><span class="annottext">AppEnv -&gt; Loggers
</span><a href="Hasura.App.State.html#appEnvLoggers"><span class="hs-identifier hs-var hs-var">appEnvLoggers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.App.State.html#Loggers"><span class="hs-identifier hs-type">Loggers</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-116"></span><span>    </span><span id="appEnvMetadataVersionRef"><span class="annot"><span class="annottext">AppEnv -&gt; TMVar MetadataResourceVersion
</span><a href="Hasura.App.State.html#appEnvMetadataVersionRef"><span class="hs-identifier hs-var hs-var">appEnvMetadataVersionRef</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">STM.TMVar</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#MetadataResourceVersion"><span class="hs-identifier hs-type">MetadataResourceVersion</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-117"></span><span>    </span><span id="appEnvInstanceId"><span class="annot"><span class="annottext">AppEnv -&gt; InstanceId
</span><a href="Hasura.App.State.html#appEnvInstanceId"><span class="hs-identifier hs-var hs-var">appEnvInstanceId</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#InstanceId"><span class="hs-identifier hs-type">InstanceId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-118"></span><span>    </span><span id="appEnvEnableMaintenanceMode"><span class="annot"><span class="annottext">AppEnv -&gt; MaintenanceMode ()
</span><a href="Hasura.App.State.html#appEnvEnableMaintenanceMode"><span class="hs-identifier hs-var hs-var">appEnvEnableMaintenanceMode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#MaintenanceMode"><span class="hs-identifier hs-type">MaintenanceMode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-119"></span><span>    </span><span id="appEnvLoggingSettings"><span class="annot"><span class="annottext">AppEnv -&gt; LoggingSettings
</span><a href="Hasura.App.State.html#appEnvLoggingSettings"><span class="hs-identifier hs-var hs-var">appEnvLoggingSettings</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#LoggingSettings"><span class="hs-identifier hs-type">LoggingSettings</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-120"></span><span>    </span><span id="appEnvEventingMode"><span class="annot"><span class="annottext">AppEnv -&gt; EventingMode
</span><a href="Hasura.App.State.html#appEnvEventingMode"><span class="hs-identifier hs-var hs-var">appEnvEventingMode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#EventingMode"><span class="hs-identifier hs-type">EventingMode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-121"></span><span>    </span><span id="appEnvEnableReadOnlyMode"><span class="annot"><span class="annottext">AppEnv -&gt; ReadOnlyMode
</span><a href="Hasura.App.State.html#appEnvEnableReadOnlyMode"><span class="hs-identifier hs-var hs-var">appEnvEnableReadOnlyMode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#ReadOnlyMode"><span class="hs-identifier hs-type">ReadOnlyMode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-122"></span><span>    </span><span id="appEnvServerMetrics"><span class="annot"><span class="annottext">AppEnv -&gt; ServerMetrics
</span><a href="Hasura.App.State.html#appEnvServerMetrics"><span class="hs-identifier hs-var hs-var">appEnvServerMetrics</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Metrics.html#ServerMetrics"><span class="hs-identifier hs-type">ServerMetrics</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>    </span><span id="appEnvShutdownLatch"><span class="annot"><span class="annottext">AppEnv -&gt; ShutdownLatch
</span><a href="Hasura.App.State.html#appEnvShutdownLatch"><span class="hs-identifier hs-var hs-var">appEnvShutdownLatch</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.ShutdownLatch.html#ShutdownLatch"><span class="hs-identifier hs-type">ShutdownLatch</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-124"></span><span>    </span><span id="appEnvMetaVersionRef"><span class="annot"><span class="annottext">AppEnv -&gt; TMVar MetadataResourceVersion
</span><a href="Hasura.App.State.html#appEnvMetaVersionRef"><span class="hs-identifier hs-var hs-var">appEnvMetaVersionRef</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">STM.TMVar</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#MetadataResourceVersion"><span class="hs-identifier hs-type">MetadataResourceVersion</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-125"></span><span>    </span><span id="appEnvPrometheusMetrics"><span class="annot"><span class="annottext">AppEnv -&gt; PrometheusMetrics
</span><a href="Hasura.App.State.html#appEnvPrometheusMetrics"><span class="hs-identifier hs-var hs-var">appEnvPrometheusMetrics</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Prometheus.html#PrometheusMetrics"><span class="hs-identifier hs-type">PrometheusMetrics</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-126"></span><span>    </span><span id="appEnvTraceSamplingPolicy"><span class="annot"><span class="annottext">AppEnv -&gt; SamplingPolicy
</span><a href="Hasura.App.State.html#appEnvTraceSamplingPolicy"><span class="hs-identifier hs-var hs-var">appEnvTraceSamplingPolicy</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Tracing.Sampling.html#SamplingPolicy"><span class="hs-identifier hs-type">Tracing.SamplingPolicy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-127"></span><span>    </span><span id="appEnvSubscriptionState"><span class="annot"><span class="annottext">AppEnv -&gt; SubscriptionsState
</span><a href="Hasura.App.State.html#appEnvSubscriptionState"><span class="hs-identifier hs-var hs-var">appEnvSubscriptionState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.Subscription.State.html#SubscriptionsState"><span class="hs-identifier hs-type">ES.SubscriptionsState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-128"></span><span>    </span><span id="appEnvLockedEventsCtx"><span class="annot"><span class="annottext">AppEnv -&gt; LockedEventsCtx
</span><a href="Hasura.App.State.html#appEnvLockedEventsCtx"><span class="hs-identifier hs-var hs-var">appEnvLockedEventsCtx</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Eventing.Common.html#LockedEventsCtx"><span class="hs-identifier hs-type">LockedEventsCtx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-129"></span><span>    </span><span id="appEnvConnParams"><span class="annot"><span class="annottext">AppEnv -&gt; ConnParams
</span><a href="Hasura.App.State.html#appEnvConnParams"><span class="hs-identifier hs-var hs-var">appEnvConnParams</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Pool.html#ConnParams"><span class="hs-identifier hs-type">PG.ConnParams</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-130"></span><span>    </span><span id="appEnvTxIso"><span class="annot"><span class="annottext">AppEnv -&gt; TxIsolation
</span><a href="Hasura.App.State.html#appEnvTxIso"><span class="hs-identifier hs-var hs-var">appEnvTxIso</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Transaction.html#TxIsolation"><span class="hs-identifier hs-type">PG.TxIsolation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-131"></span><span>    </span><span id="appEnvConsoleAssetsDir"><span class="annot"><span class="annottext">AppEnv -&gt; Maybe Text
</span><a href="Hasura.App.State.html#appEnvConsoleAssetsDir"><span class="hs-identifier hs-var hs-var">appEnvConsoleAssetsDir</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/text-2.0.1-d0f6d61f5277bae932134563876cbceb4967915f364959864c72abbc2978d8ed/share/doc/html/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-132"></span><span>    </span><span id="appEnvConsoleSentryDsn"><span class="annot"><span class="annottext">AppEnv -&gt; Maybe Text
</span><a href="Hasura.App.State.html#appEnvConsoleSentryDsn"><span class="hs-identifier hs-var hs-var">appEnvConsoleSentryDsn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/text-2.0.1-d0f6d61f5277bae932134563876cbceb4967915f364959864c72abbc2978d8ed/share/doc/html/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-133"></span><span>    </span><span id="appEnvConnectionOptions"><span class="annot"><span class="annottext">AppEnv -&gt; ConnectionOptions
</span><a href="Hasura.App.State.html#appEnvConnectionOptions"><span class="hs-identifier hs-var hs-var">appEnvConnectionOptions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/websockets-0.12.7.3-ace9e650e85dd6f2f2179ec47bba2f5dfacb8e002a1c77fe7c2fbe7ac37aed32/share/doc/html/src/Network.WebSockets.Connection.Options.html#ConnectionOptions"><span class="hs-identifier hs-type">WebSockets.ConnectionOptions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-134"></span><span>    </span><span id="appEnvWebSocketKeepAlive"><span class="annot"><span class="annottext">AppEnv -&gt; KeepAliveDelay
</span><a href="Hasura.App.State.html#appEnvWebSocketKeepAlive"><span class="hs-identifier hs-var hs-var">appEnvWebSocketKeepAlive</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#KeepAliveDelay"><span class="hs-identifier hs-type">KeepAliveDelay</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-135"></span><span>    </span><span id="appEnvWebSocketConnectionInitTimeout"><span class="annot"><span class="annottext">AppEnv -&gt; WSConnectionInitTimeout
</span><a href="Hasura.App.State.html#appEnvWebSocketConnectionInitTimeout"><span class="hs-identifier hs-var hs-var">appEnvWebSocketConnectionInitTimeout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#WSConnectionInitTimeout"><span class="hs-identifier hs-type">WSConnectionInitTimeout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-136"></span><span>    </span><span id="appEnvGracefulShutdownTimeout"><span class="annot"><span class="annottext">AppEnv -&gt; Refined NonNegative Seconds
</span><a href="Hasura.App.State.html#appEnvGracefulShutdownTimeout"><span class="hs-identifier hs-var hs-var">appEnvGracefulShutdownTimeout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/refined-0.8-b40efcc9b0260e802a32460f94ca38ced336d3f5163ccc01fe8e32d7f56bcb6d/share/doc/html/src/Refined.Unsafe.Type.html#Refined"><span class="hs-identifier hs-type">Refined</span></a></span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/refined-0.8-b40efcc9b0260e802a32460f94ca38ced336d3f5163ccc01fe8e32d7f56bcb6d/share/doc/html/src/Refined.html#NonNegative"><span class="hs-identifier hs-type">NonNegative</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Data.Time.Clock.Units.html#Seconds"><span class="hs-identifier hs-type">Seconds</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-comment">-- TODO: Move this to `AppContext`. We are leaving this for now as this cannot be changed directly</span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-comment">-- by the user on the cloud dashboard and will also require a refactor in HasuraPro/App.hs</span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-comment">-- as this thread is initialised there before creating the `AppStateRef`. But eventually we need</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-comment">-- to do it for the Enterprise version.</span><span>
</span><span id="line-141"></span><span>    </span><span id="appEnvSchemaPollInterval"><span class="annot"><span class="annottext">AppEnv -&gt; OptionalInterval
</span><a href="Hasura.App.State.html#appEnvSchemaPollInterval"><span class="hs-identifier hs-var hs-var">appEnvSchemaPollInterval</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#OptionalInterval"><span class="hs-identifier hs-type">OptionalInterval</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-142"></span><span>    </span><span id="appEnvCheckFeatureFlag"><span class="annot"><span class="annottext">AppEnv -&gt; CheckFeatureFlag
</span><a href="Hasura.App.State.html#appEnvCheckFeatureFlag"><span class="hs-identifier hs-var hs-var">appEnvCheckFeatureFlag</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Init.FeatureFlag.html#CheckFeatureFlag"><span class="hs-identifier hs-type">CheckFeatureFlag</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-143"></span><span>    </span><span id="appEnvLicenseKeyCache"><span class="annot"><span class="annottext">AppEnv -&gt; Maybe (CredentialCache AgentLicenseKey)
</span><a href="Hasura.App.State.html#appEnvLicenseKeyCache"><span class="hs-identifier hs-var hs-var">appEnvLicenseKeyCache</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.CredentialCache.html#CredentialCache"><span class="hs-identifier hs-type">CredentialCache</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.DataConnector.Agent.Client.html#AgentLicenseKey"><span class="hs-identifier hs-type">AgentLicenseKey</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-144"></span><span>    </span><span id="appEnvMaxTotalHeaderLength"><span class="annot"><span class="annottext">AppEnv -&gt; Int
</span><a href="Hasura.App.State.html#appEnvMaxTotalHeaderLength"><span class="hs-identifier hs-var hs-var">appEnvMaxTotalHeaderLength</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-145"></span><span>    </span><span id="appEnvTriggersErrorLogLevelStatus"><span class="annot"><span class="annottext">AppEnv -&gt; TriggersErrorLogLevelStatus
</span><a href="Hasura.App.State.html#appEnvTriggersErrorLogLevelStatus"><span class="hs-identifier hs-var hs-var">appEnvTriggersErrorLogLevelStatus</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#TriggersErrorLogLevelStatus"><span class="hs-identifier hs-type">TriggersErrorLogLevelStatus</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-146"></span><span>    </span><span id="appEnvAsyncActionsFetchBatchSize"><span class="annot"><span class="annottext">AppEnv -&gt; Int
</span><a href="Hasura.App.State.html#appEnvAsyncActionsFetchBatchSize"><span class="hs-identifier hs-var hs-var">appEnvAsyncActionsFetchBatchSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-147"></span><span>    </span><span id="appEnvPersistedQueries"><span class="annot"><span class="annottext">AppEnv -&gt; PersistedQueriesState
</span><a href="Hasura.App.State.html#appEnvPersistedQueries"><span class="hs-identifier hs-var hs-var">appEnvPersistedQueries</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#PersistedQueriesState"><span class="hs-identifier hs-type">PersistedQueriesState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-148"></span><span>    </span><span id="appEnvPersistedQueriesTtl"><span class="annot"><span class="annottext">AppEnv -&gt; Int
</span><a href="Hasura.App.State.html#appEnvPersistedQueriesTtl"><span class="hs-identifier hs-var hs-var">appEnvPersistedQueriesTtl</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- | Represents the Dynamic Hasura State, these field are mutable and can be changed</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- during runtime.</span><span>
</span><span id="line-153"></span><span class="hs-keyword">data</span><span> </span><span id="AppContext"><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-var">AppContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AppContext"><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-var">AppContext</span></a></span></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="acAuthMode"><span class="annot"><span class="annottext">AppContext -&gt; AuthMode
</span><a href="Hasura.App.State.html#acAuthMode"><span class="hs-identifier hs-var hs-var">acAuthMode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Auth.html#AuthMode"><span class="hs-identifier hs-type">AuthMode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-155"></span><span>    </span><span id="acSQLGenCtx"><span class="annot"><span class="annottext">AppContext -&gt; SQLGenCtx
</span><a href="Hasura.App.State.html#acSQLGenCtx"><span class="hs-identifier hs-var hs-var">acSQLGenCtx</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SQLGenCtx"><span class="hs-identifier hs-type">SQLGenCtx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-156"></span><span>    </span><span id="acEnabledAPIs"><span class="annot"><span class="annottext">AppContext -&gt; HashSet API
</span><a href="Hasura.App.State.html#acEnabledAPIs"><span class="hs-identifier hs-var hs-var">acEnabledAPIs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashSet.Internal.html#HashSet"><span class="hs-identifier hs-type">Set.HashSet</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#API"><span class="hs-identifier hs-type">API</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-157"></span><span>    </span><span id="acEnableAllowlist"><span class="annot"><span class="annottext">AppContext -&gt; AllowListStatus
</span><a href="Hasura.App.State.html#acEnableAllowlist"><span class="hs-identifier hs-var hs-var">acEnableAllowlist</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#AllowListStatus"><span class="hs-identifier hs-type">AllowListStatus</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-158"></span><span>    </span><span id="acResponseInternalErrorsConfig"><span class="annot"><span class="annottext">AppContext -&gt; ResponseInternalErrorsConfig
</span><a href="Hasura.App.State.html#acResponseInternalErrorsConfig"><span class="hs-identifier hs-var hs-var">acResponseInternalErrorsConfig</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#ResponseInternalErrorsConfig"><span class="hs-identifier hs-type">ResponseInternalErrorsConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-159"></span><span>    </span><span id="acEnvironment"><span class="annot"><span class="annottext">AppContext -&gt; Environment
</span><a href="Hasura.App.State.html#acEnvironment"><span class="hs-identifier hs-var hs-var">acEnvironment</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Environment.html#Environment"><span class="hs-identifier hs-type">E.Environment</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-160"></span><span>    </span><span id="acRemoteSchemaPermsCtx"><span class="annot"><span class="annottext">AppContext -&gt; RemoteSchemaPermissions
</span><a href="Hasura.App.State.html#acRemoteSchemaPermsCtx"><span class="hs-identifier hs-var hs-var">acRemoteSchemaPermsCtx</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#RemoteSchemaPermissions"><span class="hs-identifier hs-type">Options.RemoteSchemaPermissions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-161"></span><span>    </span><span id="acFunctionPermsCtx"><span class="annot"><span class="annottext">AppContext -&gt; InferFunctionPermissions
</span><a href="Hasura.App.State.html#acFunctionPermsCtx"><span class="hs-identifier hs-var hs-var">acFunctionPermsCtx</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#InferFunctionPermissions"><span class="hs-identifier hs-type">Options.InferFunctionPermissions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-162"></span><span>    </span><span id="acExperimentalFeatures"><span class="annot"><span class="annottext">AppContext -&gt; HashSet ExperimentalFeature
</span><a href="Hasura.App.State.html#acExperimentalFeatures"><span class="hs-identifier hs-var hs-var">acExperimentalFeatures</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashSet.Internal.html#HashSet"><span class="hs-identifier hs-type">Set.HashSet</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#ExperimentalFeature"><span class="hs-identifier hs-type">ExperimentalFeature</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-163"></span><span>    </span><span id="acDefaultNamingConvention"><span class="annot"><span class="annottext">AppContext -&gt; NamingCase
</span><a href="Hasura.App.State.html#acDefaultNamingConvention"><span class="hs-identifier hs-var hs-var">acDefaultNamingConvention</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-164"></span><span>    </span><span id="acMetadataDefaults"><span class="annot"><span class="annottext">AppContext -&gt; MetadataDefaults
</span><a href="Hasura.App.State.html#acMetadataDefaults"><span class="hs-identifier hs-var hs-var">acMetadataDefaults</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html#MetadataDefaults"><span class="hs-identifier hs-type">MetadataDefaults</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-165"></span><span>    </span><span id="acLiveQueryOptions"><span class="annot"><span class="annottext">AppContext -&gt; LiveQueriesOptions
</span><a href="Hasura.App.State.html#acLiveQueryOptions"><span class="hs-identifier hs-var hs-var">acLiveQueryOptions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.Subscription.Options.html#LiveQueriesOptions"><span class="hs-identifier hs-type">LiveQueriesOptions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-166"></span><span>    </span><span id="acStreamQueryOptions"><span class="annot"><span class="annottext">AppContext -&gt; LiveQueriesOptions
</span><a href="Hasura.App.State.html#acStreamQueryOptions"><span class="hs-identifier hs-var hs-var">acStreamQueryOptions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.Subscription.Options.html#StreamQueriesOptions"><span class="hs-identifier hs-type">StreamQueriesOptions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-167"></span><span>    </span><span id="acCorsPolicy"><span class="annot"><span class="annottext">AppContext -&gt; CorsPolicy
</span><a href="Hasura.App.State.html#acCorsPolicy"><span class="hs-identifier hs-var hs-var">acCorsPolicy</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Cors.html#CorsPolicy"><span class="hs-identifier hs-type">Cors.CorsPolicy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-168"></span><span>    </span><span id="acConsoleStatus"><span class="annot"><span class="annottext">AppContext -&gt; ConsoleStatus
</span><a href="Hasura.App.State.html#acConsoleStatus"><span class="hs-identifier hs-var hs-var">acConsoleStatus</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#ConsoleStatus"><span class="hs-identifier hs-type">ConsoleStatus</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-169"></span><span>    </span><span id="acEnableTelemetry"><span class="annot"><span class="annottext">AppContext -&gt; TelemetryStatus
</span><a href="Hasura.App.State.html#acEnableTelemetry"><span class="hs-identifier hs-var hs-var">acEnableTelemetry</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#TelemetryStatus"><span class="hs-identifier hs-type">TelemetryStatus</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-170"></span><span>    </span><span id="acEventEngineCtx"><span class="annot"><span class="annottext">AppContext -&gt; EventEngineCtx
</span><a href="Hasura.App.State.html#acEventEngineCtx"><span class="hs-identifier hs-var hs-var">acEventEngineCtx</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Eventing.EventTrigger.html#EventEngineCtx"><span class="hs-identifier hs-type">EventEngineCtx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-171"></span><span>    </span><span id="acAsyncActionsFetchInterval"><span class="annot"><span class="annottext">AppContext -&gt; OptionalInterval
</span><a href="Hasura.App.State.html#acAsyncActionsFetchInterval"><span class="hs-identifier hs-var hs-var">acAsyncActionsFetchInterval</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#OptionalInterval"><span class="hs-identifier hs-type">OptionalInterval</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-172"></span><span>    </span><span id="acApolloFederationStatus"><span class="annot"><span class="annottext">AppContext -&gt; ApolloFederationStatus
</span><a href="Hasura.App.State.html#acApolloFederationStatus"><span class="hs-identifier hs-var hs-var">acApolloFederationStatus</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#ApolloFederationStatus"><span class="hs-identifier hs-type">ApolloFederationStatus</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-173"></span><span>    </span><span id="acCloseWebsocketsOnMetadataChangeStatus"><span class="annot"><span class="annottext">AppContext -&gt; CloseWebsocketsOnMetadataChangeStatus
</span><a href="Hasura.App.State.html#acCloseWebsocketsOnMetadataChangeStatus"><span class="hs-identifier hs-var hs-var">acCloseWebsocketsOnMetadataChangeStatus</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#CloseWebsocketsOnMetadataChangeStatus"><span class="hs-identifier hs-type">CloseWebsocketsOnMetadataChangeStatus</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-174"></span><span>    </span><span id="acSchemaSampledFeatureFlags"><span class="annot"><span class="annottext">AppContext -&gt; SchemaSampledFeatureFlags
</span><a href="Hasura.App.State.html#acSchemaSampledFeatureFlags"><span class="hs-identifier hs-var hs-var">acSchemaSampledFeatureFlags</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Common.html#SchemaSampledFeatureFlags"><span class="hs-identifier hs-type">SchemaSampledFeatureFlags</span></a></span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="annot"><span class="hs-comment">-- | Collection of the LoggerCtx, the regular Logger and the PGLogger</span></span><span>
</span><span id="line-178"></span><span class="hs-keyword">data</span><span> </span><span id="Loggers"><span class="annot"><a href="Hasura.App.State.html#Loggers"><span class="hs-identifier hs-var">Loggers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Loggers"><span class="annot"><a href="Hasura.App.State.html#Loggers"><span class="hs-identifier hs-var">Loggers</span></a></span></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_lsLoggerCtx"><span class="annot"><span class="annottext">Loggers -&gt; LoggerCtx Hasura
</span><a href="Hasura.App.State.html#_lsLoggerCtx"><span class="hs-identifier hs-var hs-var">_lsLoggerCtx</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Logging.html#LoggerCtx"><span class="hs-identifier hs-type">L.LoggerCtx</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">L.Hasura</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-180"></span><span>    </span><span id="_lsLogger"><span class="annot"><span class="annottext">Loggers -&gt; Logger Hasura
</span><a href="Hasura.App.State.html#_lsLogger"><span class="hs-identifier hs-var hs-var">_lsLogger</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Logging.html#Logger"><span class="hs-identifier hs-type">L.Logger</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">L.Hasura</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-181"></span><span>    </span><span id="_lsPgLogger"><span class="annot"><span class="annottext">Loggers -&gt; PGLogger
</span><a href="Hasura.App.State.html#_lsPgLogger"><span class="hs-identifier hs-var hs-var">_lsPgLogger</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Connection.html#PGLogger"><span class="hs-identifier hs-type">PG.PGLogger</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-keyword">data</span><span> </span><span id="InvalidationKeys"><span class="annot"><a href="Hasura.App.State.html#InvalidationKeys"><span class="hs-identifier hs-var">InvalidationKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="InvalidationKeys"><span class="annot"><a href="Hasura.App.State.html#InvalidationKeys"><span class="hs-identifier hs-var">InvalidationKeys</span></a></span></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- env access</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- | Provides access to the 'AppEnv'.</span><span>
</span><span id="line-190"></span><span class="hs-comment">--</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- This class is nothing more than an equivalent of @MonadReader AppEnv m@, but</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- it abstracts it, so that application code can be written without explicitly</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- relying on an explicit implementation of the app monad. It allows for the app</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- env to be passed implicitly instead of explictly in all of the app init code.</span><span>
</span><span id="line-195"></span><span class="hs-comment">--</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- This class is not meant to be used across the entirety of the codebase, as</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- using it brings in scope the types of all fields, creating dependencies</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- between unrelated parts of the codebase. It is only meant to be used at the</span><span>
</span><span id="line-199"></span><span class="hs-comment">-- top level; more specific parts of the code should only rely on the relevant</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- subset of the environment, exposed by small, local typeclasses. For instance,</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- at time of writing, this can be used to implement 'HasServerConfigCtx', as a</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- first step towards breaking it down.</span><span>
</span><span id="line-203"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621688032926"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="HasAppEnv"><span class="annot"><a href="Hasura.App.State.html#HasAppEnv"><span class="hs-identifier hs-var">HasAppEnv</span></a></span></span><span> </span><span id="local-6989586621688032926"><span class="annot"><a href="#local-6989586621688032926"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-204"></span><span>  </span><span id="askAppEnv"><span class="annot"><a href="Hasura.App.State.html#askAppEnv"><span class="hs-identifier hs-type">askAppEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621688032926"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.App.State.html#AppEnv"><span class="hs-identifier hs-type">AppEnv</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621688032932"><span id="local-6989586621688032933"><span class="hs-special">(</span><span class="annot"><a href="Hasura.App.State.html#HasAppEnv"><span class="hs-identifier hs-type">HasAppEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688032932"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.App.State.html#HasAppEnv"><span class="hs-identifier hs-type">HasAppEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621688032933"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688032932"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>  </span><span id="local-6989586621688033221"><span class="annot"><span class="annottext">askAppEnv :: ReaderT r m AppEnv
</span><a href="Hasura.App.State.html#askAppEnv"><span class="hs-identifier hs-var hs-var hs-var hs-var">askAppEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m AppEnv -&gt; ReaderT r m AppEnv
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ReaderT r m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m AppEnv
forall (m :: * -&gt; *). HasAppEnv m =&gt; m AppEnv
</span><a href="Hasura.App.State.html#askAppEnv"><span class="hs-identifier hs-var">askAppEnv</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621688032943"><span id="local-6989586621688032944"><span class="hs-special">(</span><span class="annot"><a href="Hasura.App.State.html#HasAppEnv"><span class="hs-identifier hs-type">HasAppEnv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688032943"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.App.State.html#HasAppEnv"><span class="hs-identifier hs-type">HasAppEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="#local-6989586621688032944"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688032943"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-210"></span><span>  </span><span id="local-6989586621688033234"><span class="annot"><span class="annottext">askAppEnv :: ExceptT e m AppEnv
</span><a href="Hasura.App.State.html#askAppEnv"><span class="hs-identifier hs-var hs-var hs-var hs-var">askAppEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m AppEnv -&gt; ExceptT e m AppEnv
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT e m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">m AppEnv
forall (m :: * -&gt; *). HasAppEnv m =&gt; m AppEnv
</span><a href="Hasura.App.State.html#askAppEnv"><span class="hs-identifier hs-var">askAppEnv</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- init functions</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="annot"><a href="Hasura.App.State.html#initInvalidationKeys"><span class="hs-identifier hs-type">initInvalidationKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.App.State.html#InvalidationKeys"><span class="hs-identifier hs-type">InvalidationKeys</span></a></span><span>
</span><span id="line-216"></span><span id="initInvalidationKeys"><span class="annot"><span class="annottext">initInvalidationKeys :: InvalidationKeys
</span><a href="Hasura.App.State.html#initInvalidationKeys"><span class="hs-identifier hs-var hs-var">initInvalidationKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InvalidationKeys
</span><a href="Hasura.App.State.html#InvalidationKeys"><span class="hs-identifier hs-var">InvalidationKeys</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-comment">-- | Function to build the 'AppContext' (given the 'ServeOptions') for the first</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- time</span><span>
</span><span id="line-220"></span><span id="local-6989586621688032946"><span class="annot"><a href="Hasura.App.State.html#buildRebuildableAppContext"><span class="hs-identifier hs-type">buildRebuildableAppContext</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Logging.html#Logger"><span class="hs-identifier hs-type">L.Logger</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">L.Hasura</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-client-0.7.13.1-88628f48a025e46598ca658ea231eb27d6340417f49e950fbf8c438edb3ebbdc/share/doc/html/src/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">HTTP.Manager</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><a href="Hasura.Server.Init.Config.html#ServeOptions"><span class="hs-identifier hs-type">ServeOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688032946"><span class="hs-identifier hs-type">impl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><a href="Hasura.Server.Init.FeatureFlag.html#CheckFeatureFlag"><span class="hs-identifier hs-type">CheckFeatureFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Environment.html#Environment"><span class="hs-identifier hs-type">E.Environment</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.App.State.html#RebuildableAppContext"><span class="hs-identifier hs-type">RebuildableAppContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688032946"><span class="hs-identifier hs-type">impl</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-228"></span><span id="buildRebuildableAppContext"><span class="annot"><span class="annottext">buildRebuildableAppContext :: forall impl.
(Logger Hasura, Manager)
-&gt; ServeOptions impl
-&gt; CheckFeatureFlag
-&gt; Environment
-&gt; ExceptT QErr IO (RebuildableAppContext impl)
</span><a href="Hasura.App.State.html#buildRebuildableAppContext"><span class="hs-identifier hs-var hs-var">buildRebuildableAppContext</span></a></span></span><span> </span><span id="local-6989586621688033270"><span class="annot"><span class="annottext">(Logger Hasura, Manager)
</span><a href="#local-6989586621688033270"><span class="hs-identifier hs-var">readerContext</span></a></span></span><span> </span><span id="local-6989586621688033271"><span class="annot"><span class="annottext">ServeOptions impl
</span><a href="#local-6989586621688033271"><span class="hs-identifier hs-var">serveOptions</span></a></span></span><span> </span><span id="local-6989586621688033272"><span class="annot"><span class="annottext">CheckFeatureFlag
</span><a href="#local-6989586621688033272"><span class="hs-identifier hs-var">checkFeatureFlag</span></a></span></span><span> </span><span id="local-6989586621688033273"><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621688033273"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-229"></span><span>  </span><span id="local-6989586621688033274"><span class="annot"><span class="annottext">Result
  (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
  (ServeOptions impl, Environment, InvalidationKeys,
   CheckFeatureFlag)
  AppContext
</span><a href="#local-6989586621688033274"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ReaderT
   (Logger Hasura, Manager)
   (ExceptT QErr IO)
   (Result
      (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
      (ServeOptions impl, Environment, InvalidationKeys,
       CheckFeatureFlag)
      AppContext)
 -&gt; (Logger Hasura, Manager)
 -&gt; ExceptT
      QErr
      IO
      (Result
         (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
         (ServeOptions impl, Environment, InvalidationKeys,
          CheckFeatureFlag)
         AppContext))
-&gt; (Logger Hasura, Manager)
-&gt; ReaderT
     (Logger Hasura, Manager)
     (ExceptT QErr IO)
     (Result
        (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
        (ServeOptions impl, Environment, InvalidationKeys,
         CheckFeatureFlag)
        AppContext)
-&gt; ExceptT
     QErr
     IO
     (Result
        (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
        (ServeOptions impl, Environment, InvalidationKeys,
         CheckFeatureFlag)
        AppContext)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">ReaderT
  (Logger Hasura, Manager)
  (ExceptT QErr IO)
  (Result
     (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
     (ServeOptions impl, Environment, InvalidationKeys,
      CheckFeatureFlag)
     AppContext)
-&gt; (Logger Hasura, Manager)
-&gt; ExceptT
     QErr
     IO
     (Result
        (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
        (ServeOptions impl, Environment, InvalidationKeys,
         CheckFeatureFlag)
        AppContext)
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">(Logger Hasura, Manager)
</span><a href="#local-6989586621688033270"><span class="hs-identifier hs-var">readerContext</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   (Logger Hasura, Manager)
   (ExceptT QErr IO)
   (Result
      (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
      (ServeOptions impl, Environment, InvalidationKeys,
       CheckFeatureFlag)
      AppContext)
 -&gt; ExceptT
      QErr
      IO
      (Result
         (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
         (ServeOptions impl, Environment, InvalidationKeys,
          CheckFeatureFlag)
         AppContext))
-&gt; ReaderT
     (Logger Hasura, Manager)
     (ExceptT QErr IO)
     (Result
        (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
        (ServeOptions impl, Environment, InvalidationKeys,
         CheckFeatureFlag)
        AppContext)
-&gt; ExceptT
     QErr
     IO
     (Result
        (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
        (ServeOptions impl, Environment, InvalidationKeys,
         CheckFeatureFlag)
        AppContext)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rule
  (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
  (ServeOptions impl, Environment, InvalidationKeys,
   CheckFeatureFlag)
  AppContext
-&gt; (ServeOptions impl, Environment, InvalidationKeys,
    CheckFeatureFlag)
-&gt; ReaderT
     (Logger Hasura, Manager)
     (ExceptT QErr IO)
     (Result
        (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
        (ServeOptions impl, Environment, InvalidationKeys,
         CheckFeatureFlag)
        AppContext)
forall (m :: * -&gt; *) a b.
Applicative m =&gt;
Rule m a b -&gt; a -&gt; m (Result m a b)
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/incremental-1.0.0/opt/doc/html/incremental/src/Hasura.Incremental.Internal.Rule.html#build"><span class="hs-identifier hs-var">Inc.build</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rule
  (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
  (ServeOptions impl, Environment, InvalidationKeys,
   CheckFeatureFlag)
  AppContext
forall (arr :: * -&gt; * -&gt; *) (m :: * -&gt; *) impl.
(ArrowChoice arr, ArrowCache m arr, MonadBaseControl IO m,
 MonadIO m, MonadError QErr m,
 MonadReader (Logger Hasura, Manager) m) =&gt;
arr
  (ServeOptions impl, Environment, InvalidationKeys,
   CheckFeatureFlag)
  AppContext
</span><a href="Hasura.App.State.html#buildAppContextRule"><span class="hs-identifier hs-var">buildAppContextRule</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ServeOptions impl
</span><a href="#local-6989586621688033271"><span class="hs-identifier hs-var">serveOptions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621688033273"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InvalidationKeys
</span><a href="Hasura.App.State.html#initInvalidationKeys"><span class="hs-identifier hs-var">initInvalidationKeys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CheckFeatureFlag
</span><a href="#local-6989586621688033272"><span class="hs-identifier hs-var">checkFeatureFlag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621688033279"><span class="annot"><span class="annottext">appContext :: AppContext
</span><a href="#local-6989586621688033279"><span class="hs-identifier hs-var hs-var">appContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
  (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
  (ServeOptions impl, Environment, InvalidationKeys,
   CheckFeatureFlag)
  AppContext
-&gt; AppContext
forall {k} (m :: k -&gt; *) a b. Result m a b -&gt; b
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/incremental-1.0.0/opt/doc/html/incremental/src/Hasura.Incremental.Internal.Rule.html#result"><span class="hs-identifier hs-var">Inc.result</span></a></span><span> </span><span class="annot"><span class="annottext">Result
  (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
  (ServeOptions impl, Environment, InvalidationKeys,
   CheckFeatureFlag)
  AppContext
</span><a href="#local-6989586621688033274"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621688033281"><span class="annot"><span class="annottext">rebuildableAppContext :: RebuildableAppContext impl
</span><a href="#local-6989586621688033281"><span class="hs-identifier hs-var hs-var">rebuildableAppContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppContext
-&gt; InvalidationKeys
-&gt; Rule
     (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
     (ServeOptions impl, Environment, InvalidationKeys,
      CheckFeatureFlag)
     AppContext
-&gt; RebuildableAppContext impl
forall impl.
AppContext
-&gt; InvalidationKeys
-&gt; Rule
     (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
     (ServeOptions impl, Environment, InvalidationKeys,
      CheckFeatureFlag)
     AppContext
-&gt; RebuildableAppContext impl
</span><a href="Hasura.App.State.html#RebuildableAppContext"><span class="hs-identifier hs-var">RebuildableAppContext</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621688033279"><span class="hs-identifier hs-var">appContext</span></a></span><span> </span><span class="annot"><span class="annottext">InvalidationKeys
</span><a href="Hasura.App.State.html#initInvalidationKeys"><span class="hs-identifier hs-var">initInvalidationKeys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result
  (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
  (ServeOptions impl, Environment, InvalidationKeys,
   CheckFeatureFlag)
  AppContext
-&gt; Rule
     (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
     (ServeOptions impl, Environment, InvalidationKeys,
      CheckFeatureFlag)
     AppContext
forall {k} (m :: k -&gt; *) a b. Result m a b -&gt; Rule m a b
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/incremental-1.0.0/opt/doc/html/incremental/src/Hasura.Incremental.Internal.Rule.html#rebuildRule"><span class="hs-identifier hs-var">Inc.rebuildRule</span></a></span><span> </span><span class="annot"><span class="annottext">Result
  (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
  (ServeOptions impl, Environment, InvalidationKeys,
   CheckFeatureFlag)
  AppContext
</span><a href="#local-6989586621688033274"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><span class="annottext">RebuildableAppContext impl
-&gt; ExceptT QErr IO (RebuildableAppContext impl)
forall a. a -&gt; ExceptT QErr IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">RebuildableAppContext impl
</span><a href="#local-6989586621688033281"><span class="hs-identifier hs-var">rebuildableAppContext</span></a></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">-- | Function to rebuild the 'AppContext' from a given 'RebuildableAppContext'</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- and a new 'ServeOptions'</span><span>
</span><span id="line-236"></span><span id="local-6989586621688033004"><span id="local-6989586621688033005"><span class="annot"><a href="Hasura.App.State.html#rebuildRebuildableAppContext"><span class="hs-identifier hs-type">rebuildRebuildableAppContext</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621688033004"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688033004"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Logging.html#Logger"><span class="hs-identifier hs-type">L.Logger</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">L.Hasura</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-client-0.7.13.1-88628f48a025e46598ca658ea231eb27d6340417f49e950fbf8c438edb3ebbdc/share/doc/html/src/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">HTTP.Manager</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><a href="Hasura.App.State.html#RebuildableAppContext"><span class="hs-identifier hs-type">RebuildableAppContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688033005"><span class="hs-identifier hs-type">impl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><a href="Hasura.Server.Init.Config.html#ServeOptions"><span class="hs-identifier hs-type">ServeOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688033005"><span class="hs-identifier hs-type">impl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><a href="Hasura.Server.Init.FeatureFlag.html#CheckFeatureFlag"><span class="hs-identifier hs-type">CheckFeatureFlag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Environment.html#Environment"><span class="hs-identifier hs-type">E.Environment</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><a href="#local-6989586621688033004"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.App.State.html#RebuildableAppContext"><span class="hs-identifier hs-type">RebuildableAppContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688033005"><span class="hs-identifier hs-type">impl</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-244"></span><span id="rebuildRebuildableAppContext"><span class="annot"><span class="annottext">rebuildRebuildableAppContext :: forall (m :: * -&gt; *) impl.
(MonadIO m, MonadError QErr m) =&gt;
(Logger Hasura, Manager)
-&gt; RebuildableAppContext impl
-&gt; ServeOptions impl
-&gt; CheckFeatureFlag
-&gt; Environment
-&gt; m (RebuildableAppContext impl)
</span><a href="Hasura.App.State.html#rebuildRebuildableAppContext"><span class="hs-identifier hs-var hs-var">rebuildRebuildableAppContext</span></a></span></span><span> </span><span id="local-6989586621688033297"><span class="annot"><span class="annottext">(Logger Hasura, Manager)
</span><a href="#local-6989586621688033297"><span class="hs-identifier hs-var">readerCtx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.App.State.html#RebuildableAppContext"><span class="hs-identifier hs-type">RebuildableAppContext</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">InvalidationKeys
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621688033298"><span class="annot"><span class="annottext">Rule
  (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
  (ServeOptions impl, Environment, InvalidationKeys,
   CheckFeatureFlag)
  AppContext
</span><a href="#local-6989586621688033298"><span class="hs-identifier hs-var">rule</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621688033299"><span class="annot"><span class="annottext">ServeOptions impl
</span><a href="#local-6989586621688033299"><span class="hs-identifier hs-var">serveOptions</span></a></span></span><span> </span><span id="local-6989586621688033300"><span class="annot"><span class="annottext">CheckFeatureFlag
</span><a href="#local-6989586621688033300"><span class="hs-identifier hs-var">checkFeatureFlag</span></a></span></span><span> </span><span id="local-6989586621688033301"><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621688033301"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688033302"><span class="annot"><span class="annottext">newInvalidationKeys :: InvalidationKeys
</span><a href="#local-6989586621688033302"><span class="hs-identifier hs-var hs-var">newInvalidationKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InvalidationKeys
</span><a href="Hasura.App.State.html#InvalidationKeys"><span class="hs-identifier hs-var">InvalidationKeys</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621688033303"><span class="annot"><span class="annottext">Result
  (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
  (ServeOptions impl, Environment, InvalidationKeys,
   CheckFeatureFlag)
  AppContext
</span><a href="#local-6989586621688033303"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><span class="annottext">m (Either
     QErr
     (Result
        (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
        (ServeOptions impl, Environment, InvalidationKeys,
         CheckFeatureFlag)
        AppContext))
-&gt; m (Result
        (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
        (ServeOptions impl, Environment, InvalidationKeys,
         CheckFeatureFlag)
        AppContext)
forall e (m :: * -&gt; *) a. MonadError e m =&gt; m (Either e a) -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html#liftEitherM"><span class="hs-identifier hs-var">liftEitherM</span></a></span><span>
</span><span id="line-248"></span><span>      </span><span class="annot"><span class="annottext">(m (Either
      QErr
      (Result
         (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
         (ServeOptions impl, Environment, InvalidationKeys,
          CheckFeatureFlag)
         AppContext))
 -&gt; m (Result
         (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
         (ServeOptions impl, Environment, InvalidationKeys,
          CheckFeatureFlag)
         AppContext))
-&gt; m (Either
        QErr
        (Result
           (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
           (ServeOptions impl, Environment, InvalidationKeys,
            CheckFeatureFlag)
           AppContext))
-&gt; m (Result
        (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
        (ServeOptions impl, Environment, InvalidationKeys,
         CheckFeatureFlag)
        AppContext)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO
  (Either
     QErr
     (Result
        (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
        (ServeOptions impl, Environment, InvalidationKeys,
         CheckFeatureFlag)
        AppContext))
-&gt; m (Either
        QErr
        (Result
           (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
           (ServeOptions impl, Environment, InvalidationKeys,
            CheckFeatureFlag)
           AppContext))
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span>
</span><span id="line-249"></span><span>      </span><span class="annot"><span class="annottext">(IO
   (Either
      QErr
      (Result
         (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
         (ServeOptions impl, Environment, InvalidationKeys,
          CheckFeatureFlag)
         AppContext))
 -&gt; m (Either
         QErr
         (Result
            (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
            (ServeOptions impl, Environment, InvalidationKeys,
             CheckFeatureFlag)
            AppContext)))
-&gt; IO
     (Either
        QErr
        (Result
           (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
           (ServeOptions impl, Environment, InvalidationKeys,
            CheckFeatureFlag)
           AppContext))
-&gt; m (Either
        QErr
        (Result
           (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
           (ServeOptions impl, Environment, InvalidationKeys,
            CheckFeatureFlag)
           AppContext))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExceptT
  QErr
  IO
  (Result
     (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
     (ServeOptions impl, Environment, InvalidationKeys,
      CheckFeatureFlag)
     AppContext)
-&gt; IO
     (Either
        QErr
        (Result
           (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
           (ServeOptions impl, Environment, InvalidationKeys,
            CheckFeatureFlag)
           AppContext))
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span>
</span><span id="line-250"></span><span>      </span><span class="annot"><span class="annottext">(ExceptT
   QErr
   IO
   (Result
      (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
      (ServeOptions impl, Environment, InvalidationKeys,
       CheckFeatureFlag)
      AppContext)
 -&gt; IO
      (Either
         QErr
         (Result
            (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
            (ServeOptions impl, Environment, InvalidationKeys,
             CheckFeatureFlag)
            AppContext)))
-&gt; ExceptT
     QErr
     IO
     (Result
        (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
        (ServeOptions impl, Environment, InvalidationKeys,
         CheckFeatureFlag)
        AppContext)
-&gt; IO
     (Either
        QErr
        (Result
           (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
           (ServeOptions impl, Environment, InvalidationKeys,
            CheckFeatureFlag)
           AppContext))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ReaderT
   (Logger Hasura, Manager)
   (ExceptT QErr IO)
   (Result
      (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
      (ServeOptions impl, Environment, InvalidationKeys,
       CheckFeatureFlag)
      AppContext)
 -&gt; (Logger Hasura, Manager)
 -&gt; ExceptT
      QErr
      IO
      (Result
         (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
         (ServeOptions impl, Environment, InvalidationKeys,
          CheckFeatureFlag)
         AppContext))
-&gt; (Logger Hasura, Manager)
-&gt; ReaderT
     (Logger Hasura, Manager)
     (ExceptT QErr IO)
     (Result
        (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
        (ServeOptions impl, Environment, InvalidationKeys,
         CheckFeatureFlag)
        AppContext)
-&gt; ExceptT
     QErr
     IO
     (Result
        (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
        (ServeOptions impl, Environment, InvalidationKeys,
         CheckFeatureFlag)
        AppContext)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">ReaderT
  (Logger Hasura, Manager)
  (ExceptT QErr IO)
  (Result
     (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
     (ServeOptions impl, Environment, InvalidationKeys,
      CheckFeatureFlag)
     AppContext)
-&gt; (Logger Hasura, Manager)
-&gt; ExceptT
     QErr
     IO
     (Result
        (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
        (ServeOptions impl, Environment, InvalidationKeys,
         CheckFeatureFlag)
        AppContext)
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">(Logger Hasura, Manager)
</span><a href="#local-6989586621688033297"><span class="hs-identifier hs-var">readerCtx</span></a></span><span>
</span><span id="line-251"></span><span>      </span><span class="annot"><span class="annottext">(ReaderT
   (Logger Hasura, Manager)
   (ExceptT QErr IO)
   (Result
      (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
      (ServeOptions impl, Environment, InvalidationKeys,
       CheckFeatureFlag)
      AppContext)
 -&gt; ExceptT
      QErr
      IO
      (Result
         (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
         (ServeOptions impl, Environment, InvalidationKeys,
          CheckFeatureFlag)
         AppContext))
-&gt; ReaderT
     (Logger Hasura, Manager)
     (ExceptT QErr IO)
     (Result
        (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
        (ServeOptions impl, Environment, InvalidationKeys,
         CheckFeatureFlag)
        AppContext)
-&gt; ExceptT
     QErr
     IO
     (Result
        (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
        (ServeOptions impl, Environment, InvalidationKeys,
         CheckFeatureFlag)
        AppContext)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rule
  (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
  (ServeOptions impl, Environment, InvalidationKeys,
   CheckFeatureFlag)
  AppContext
-&gt; (ServeOptions impl, Environment, InvalidationKeys,
    CheckFeatureFlag)
-&gt; ReaderT
     (Logger Hasura, Manager)
     (ExceptT QErr IO)
     (Result
        (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
        (ServeOptions impl, Environment, InvalidationKeys,
         CheckFeatureFlag)
        AppContext)
forall (m :: * -&gt; *) a b.
Applicative m =&gt;
Rule m a b -&gt; a -&gt; m (Result m a b)
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/incremental-1.0.0/opt/doc/html/incremental/src/Hasura.Incremental.Internal.Rule.html#build"><span class="hs-identifier hs-var">Inc.build</span></a></span><span> </span><span class="annot"><span class="annottext">Rule
  (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
  (ServeOptions impl, Environment, InvalidationKeys,
   CheckFeatureFlag)
  AppContext
</span><a href="#local-6989586621688033298"><span class="hs-identifier hs-var">rule</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ServeOptions impl
</span><a href="#local-6989586621688033299"><span class="hs-identifier hs-var">serveOptions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621688033301"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InvalidationKeys
</span><a href="#local-6989586621688033302"><span class="hs-identifier hs-var">newInvalidationKeys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CheckFeatureFlag
</span><a href="#local-6989586621688033300"><span class="hs-identifier hs-var">checkFeatureFlag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688033307"><span class="annot"><span class="annottext">appContext :: AppContext
</span><a href="#local-6989586621688033307"><span class="hs-identifier hs-var hs-var">appContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
  (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
  (ServeOptions impl, Environment, InvalidationKeys,
   CheckFeatureFlag)
  AppContext
-&gt; AppContext
forall {k} (m :: k -&gt; *) a b. Result m a b -&gt; b
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/incremental-1.0.0/opt/doc/html/incremental/src/Hasura.Incremental.Internal.Rule.html#result"><span class="hs-identifier hs-var">Inc.result</span></a></span><span> </span><span class="annot"><span class="annottext">Result
  (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
  (ServeOptions impl, Environment, InvalidationKeys,
   CheckFeatureFlag)
  AppContext
</span><a href="#local-6989586621688033303"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-253"></span><span>      </span><span class="hs-glyph">!</span><span id="local-6989586621688033308"><span class="annot"><span class="annottext">newCtx :: RebuildableAppContext impl
</span><a href="#local-6989586621688033308"><span class="hs-identifier hs-var hs-var">newCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AppContext
-&gt; InvalidationKeys
-&gt; Rule
     (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
     (ServeOptions impl, Environment, InvalidationKeys,
      CheckFeatureFlag)
     AppContext
-&gt; RebuildableAppContext impl
forall impl.
AppContext
-&gt; InvalidationKeys
-&gt; Rule
     (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
     (ServeOptions impl, Environment, InvalidationKeys,
      CheckFeatureFlag)
     AppContext
-&gt; RebuildableAppContext impl
</span><a href="Hasura.App.State.html#RebuildableAppContext"><span class="hs-identifier hs-var">RebuildableAppContext</span></a></span><span> </span><span class="annot"><span class="annottext">AppContext
</span><a href="#local-6989586621688033307"><span class="hs-identifier hs-var">appContext</span></a></span><span> </span><span class="annot"><span class="annottext">InvalidationKeys
</span><a href="#local-6989586621688033302"><span class="hs-identifier hs-var">newInvalidationKeys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result
  (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
  (ServeOptions impl, Environment, InvalidationKeys,
   CheckFeatureFlag)
  AppContext
-&gt; Rule
     (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
     (ServeOptions impl, Environment, InvalidationKeys,
      CheckFeatureFlag)
     AppContext
forall {k} (m :: k -&gt; *) a b. Result m a b -&gt; Rule m a b
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/incremental-1.0.0/opt/doc/html/incremental/src/Hasura.Incremental.Internal.Rule.html#rebuildRule"><span class="hs-identifier hs-var">Inc.rebuildRule</span></a></span><span> </span><span class="annot"><span class="annottext">Result
  (ReaderT (Logger Hasura, Manager) (ExceptT QErr IO))
  (ServeOptions impl, Environment, InvalidationKeys,
   CheckFeatureFlag)
  AppContext
</span><a href="#local-6989586621688033303"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>  </span><span class="annot"><span class="annottext">RebuildableAppContext impl -&gt; m (RebuildableAppContext impl)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">RebuildableAppContext impl
</span><a href="#local-6989586621688033308"><span class="hs-identifier hs-var">newCtx</span></a></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="annot"><a href="Hasura.App.State.html#buildAppContextRule"><span class="hs-identifier hs-type">buildAppContextRule</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621688032991"><span class="annot"><a href="#local-6989586621688032991"><span class="hs-identifier hs-type">arr</span></a></span></span><span> </span><span id="local-6989586621688032992"><span class="annot"><a href="#local-6989586621688032992"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621688032993"><span class="annot"><a href="#local-6989586621688032993"><span class="hs-identifier hs-type">impl</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ArrowChoice</span></span><span> </span><span class="annot"><a href="#local-6989586621688032991"><span class="hs-identifier hs-type">arr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/incremental-1.0.0/opt/doc/html/incremental/src/Hasura.Incremental.Internal.Cache.html#ArrowCache"><span class="hs-identifier hs-type">Inc.ArrowCache</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688032992"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688032991"><span class="hs-identifier hs-type">arr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/monad-control-1.0.3.1-db4229aec3d9c1011503cf06798714c732b74d731fab23998dd34d578ed6d457/share/doc/html/src/Control.Monad.Trans.Control.html#MonadBaseControl"><span class="hs-identifier hs-type">MonadBaseControl</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621688032992"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621688032992"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688032992"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Logging.html#Logger"><span class="hs-identifier hs-type">L.Logger</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">L.Hasura</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-client-0.7.13.1-88628f48a025e46598ca658ea231eb27d6340417f49e950fbf8c438edb3ebbdc/share/doc/html/src/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">HTTP.Manager</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621688032992"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Init.Config.html#ServeOptions"><span class="hs-identifier hs-type">ServeOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688032993"><span class="hs-identifier hs-type">impl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Environment.html#Environment"><span class="hs-identifier hs-type">E.Environment</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.App.State.html#InvalidationKeys"><span class="hs-identifier hs-type">InvalidationKeys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Init.FeatureFlag.html#CheckFeatureFlag"><span class="hs-identifier hs-type">CheckFeatureFlag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621688032991"><span class="hs-operator hs-type">`arr`</span></a></span><span> </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span>
</span><span id="line-266"></span><span id="buildAppContextRule"><span class="annot"><span class="annottext">buildAppContextRule :: forall (arr :: * -&gt; * -&gt; *) (m :: * -&gt; *) impl.
(ArrowChoice arr, ArrowCache m arr, MonadBaseControl IO m,
 MonadIO m, MonadError QErr m,
 MonadReader (Logger Hasura, Manager) m) =&gt;
arr
  (ServeOptions impl, Environment, InvalidationKeys,
   CheckFeatureFlag)
  AppContext
</span><a href="Hasura.App.State.html#buildAppContextRule"><span class="hs-identifier hs-var hs-var">buildAppContextRule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">proc</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Init.Config.html#ServeOptions"><span class="hs-identifier hs-type">ServeOptions</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688033355"><span id="local-6989586621688033356"><span id="local-6989586621688033357"><span id="local-6989586621688033358"><span id="local-6989586621688033359"><span id="local-6989586621688033360"><span id="local-6989586621688033361"><span id="local-6989586621688033362"><span id="local-6989586621688033363"><span id="local-6989586621688033364"><span id="local-6989586621688033365"><span id="local-6989586621688033366"><span id="local-6989586621688033367"><span id="local-6989586621688033368"><span id="local-6989586621688033369"><span id="local-6989586621688033370"><span id="local-6989586621688033371"><span id="local-6989586621688033372"><span id="local-6989586621688033373"><span id="local-6989586621688033374"><span id="local-6989586621688033375"><span id="local-6989586621688033376"><span id="local-6989586621688033377"><span id="local-6989586621688033378"><span id="local-6989586621688033379"><span id="local-6989586621688033380"><span id="local-6989586621688033381"><span id="local-6989586621688033382"><span id="local-6989586621688033383"><span id="local-6989586621688033384"><span id="local-6989586621688033385"><span id="local-6989586621688033386"><span id="local-6989586621688033387"><span id="local-6989586621688033388"><span id="local-6989586621688033389"><span id="local-6989586621688033390"><span id="local-6989586621688033391"><span id="local-6989586621688033392"><span id="local-6989586621688033393"><span id="local-6989586621688033394"><span id="local-6989586621688033395"><span id="local-6989586621688033396"><span id="local-6989586621688033397"><span id="local-6989586621688033398"><span id="local-6989586621688033399"><span id="local-6989586621688033400"><span id="local-6989586621688033401"><span id="local-6989586621688033402"><span id="local-6989586621688033403"><span id="local-6989586621688033404"><span class="annot"><span class="annottext">Int
[JWTConfig]
Maybe Text
Maybe RoleName
Maybe AuthHook
HostPreference
HashSet ExperimentalFeature
HashSet (EngineLogType impl)
HashSet AdminSecretHash
HashSet API
TxIsolation
ConnParams
Refined NonNegative Int
Refined NonNegative Milliseconds
Refined NonNegative Seconds
Refined Positive Int
ConnectionOptions
LiveQueriesOptions
NamingCase
RemoteSchemaPermissions
InferFunctionPermissions
RemoteNullForwardingPolicy
DangerouslyCollapseBooleans
StringifyNumbers
ExtensionsSchema
CorsConfig
PersistedQueriesState
CloseWebsocketsOnMetadataChangeStatus
TriggersErrorLogLevelStatus
ApolloFederationStatus
EventingMode
ReadOnlyMode
MaintenanceMode ()
LogLevel
MetadataQueryLoggingMode
MetadataDefaults
WSConnectionInitTimeout
KeepAliveDelay
OptionalInterval
Port
TelemetryStatus
DevModeStatus
AllowListStatus
AdminInternalErrorsStatus
ConsoleStatus
soPort :: Port
soHost :: HostPreference
soConnParams :: ConnParams
soTxIso :: TxIsolation
soAdminSecret :: HashSet AdminSecretHash
soAuthHook :: Maybe AuthHook
soJwtSecret :: [JWTConfig]
soUnAuthRole :: Maybe RoleName
soCorsConfig :: CorsConfig
soConsoleStatus :: ConsoleStatus
soConsoleAssetsDir :: Maybe Text
soConsoleSentryDsn :: Maybe Text
soEnableTelemetry :: TelemetryStatus
soStringifyNum :: StringifyNumbers
soDangerousBooleanCollapse :: DangerouslyCollapseBooleans
soRemoteNullForwardingPolicy :: RemoteNullForwardingPolicy
soEnabledAPIs :: HashSet API
soLiveQueryOpts :: LiveQueriesOptions
soStreamingQueryOpts :: LiveQueriesOptions
soEnableAllowList :: AllowListStatus
soEnabledLogTypes :: HashSet (EngineLogType impl)
soLogLevel :: LogLevel
soEventsHttpPoolSize :: Refined Positive Int
soEventsFetchInterval :: Refined NonNegative Milliseconds
soAsyncActionsFetchInterval :: OptionalInterval
soEnableRemoteSchemaPermissions :: RemoteSchemaPermissions
soConnectionOptions :: ConnectionOptions
soWebSocketKeepAlive :: KeepAliveDelay
soInferFunctionPermissions :: InferFunctionPermissions
soEnableMaintenanceMode :: MaintenanceMode ()
soSchemaPollInterval :: OptionalInterval
soExperimentalFeatures :: HashSet ExperimentalFeature
soEventsFetchBatchSize :: Refined NonNegative Int
soDevMode :: DevModeStatus
soAdminInternalErrors :: AdminInternalErrorsStatus
soGracefulShutdownTimeout :: Refined NonNegative Seconds
soWebSocketConnectionInitTimeout :: WSConnectionInitTimeout
soEventingMode :: EventingMode
soReadOnlyMode :: ReadOnlyMode
soEnableMetadataQueryLogging :: MetadataQueryLoggingMode
soDefaultNamingConvention :: NamingCase
soExtensionsSchema :: ExtensionsSchema
soMetadataDefaults :: MetadataDefaults
soApolloFederationStatus :: ApolloFederationStatus
soCloseWebsocketsOnMetadataChangeStatus :: CloseWebsocketsOnMetadataChangeStatus
soMaxTotalHeaderLength :: Int
soTriggersErrorLogLevelStatus :: TriggersErrorLogLevelStatus
soAsyncActionsFetchBatchSize :: Int
soPersistedQueries :: PersistedQueriesState
soPersistedQueriesTtl :: Int
soPort :: forall impl. ServeOptions impl -&gt; Port
soHost :: forall impl. ServeOptions impl -&gt; HostPreference
soConnParams :: forall impl. ServeOptions impl -&gt; ConnParams
soTxIso :: forall impl. ServeOptions impl -&gt; TxIsolation
soAdminSecret :: forall impl. ServeOptions impl -&gt; HashSet AdminSecretHash
soAuthHook :: forall impl. ServeOptions impl -&gt; Maybe AuthHook
soJwtSecret :: forall impl. ServeOptions impl -&gt; [JWTConfig]
soUnAuthRole :: forall impl. ServeOptions impl -&gt; Maybe RoleName
soCorsConfig :: forall impl. ServeOptions impl -&gt; CorsConfig
soConsoleStatus :: forall impl. ServeOptions impl -&gt; ConsoleStatus
soConsoleAssetsDir :: forall impl. ServeOptions impl -&gt; Maybe Text
soConsoleSentryDsn :: forall impl. ServeOptions impl -&gt; Maybe Text
soEnableTelemetry :: forall impl. ServeOptions impl -&gt; TelemetryStatus
soStringifyNum :: forall impl. ServeOptions impl -&gt; StringifyNumbers
soDangerousBooleanCollapse :: forall impl. ServeOptions impl -&gt; DangerouslyCollapseBooleans
soRemoteNullForwardingPolicy :: forall impl. ServeOptions impl -&gt; RemoteNullForwardingPolicy
soEnabledAPIs :: forall impl. ServeOptions impl -&gt; HashSet API
soLiveQueryOpts :: forall impl. ServeOptions impl -&gt; LiveQueriesOptions
soStreamingQueryOpts :: forall impl. ServeOptions impl -&gt; LiveQueriesOptions
soEnableAllowList :: forall impl. ServeOptions impl -&gt; AllowListStatus
soEnabledLogTypes :: forall impl. ServeOptions impl -&gt; HashSet (EngineLogType impl)
soLogLevel :: forall impl. ServeOptions impl -&gt; LogLevel
soEventsHttpPoolSize :: forall impl. ServeOptions impl -&gt; Refined Positive Int
soEventsFetchInterval :: forall impl. ServeOptions impl -&gt; Refined NonNegative Milliseconds
soAsyncActionsFetchInterval :: forall impl. ServeOptions impl -&gt; OptionalInterval
soEnableRemoteSchemaPermissions :: forall impl. ServeOptions impl -&gt; RemoteSchemaPermissions
soConnectionOptions :: forall impl. ServeOptions impl -&gt; ConnectionOptions
soWebSocketKeepAlive :: forall impl. ServeOptions impl -&gt; KeepAliveDelay
soInferFunctionPermissions :: forall impl. ServeOptions impl -&gt; InferFunctionPermissions
soEnableMaintenanceMode :: forall impl. ServeOptions impl -&gt; MaintenanceMode ()
soSchemaPollInterval :: forall impl. ServeOptions impl -&gt; OptionalInterval
soExperimentalFeatures :: forall impl. ServeOptions impl -&gt; HashSet ExperimentalFeature
soEventsFetchBatchSize :: forall impl. ServeOptions impl -&gt; Refined NonNegative Int
soDevMode :: forall impl. ServeOptions impl -&gt; DevModeStatus
soAdminInternalErrors :: forall impl. ServeOptions impl -&gt; AdminInternalErrorsStatus
soGracefulShutdownTimeout :: forall impl. ServeOptions impl -&gt; Refined NonNegative Seconds
soWebSocketConnectionInitTimeout :: forall impl. ServeOptions impl -&gt; WSConnectionInitTimeout
soEventingMode :: forall impl. ServeOptions impl -&gt; EventingMode
soReadOnlyMode :: forall impl. ServeOptions impl -&gt; ReadOnlyMode
soEnableMetadataQueryLogging :: forall impl. ServeOptions impl -&gt; MetadataQueryLoggingMode
soDefaultNamingConvention :: forall impl. ServeOptions impl -&gt; NamingCase
soExtensionsSchema :: forall impl. ServeOptions impl -&gt; ExtensionsSchema
soMetadataDefaults :: forall impl. ServeOptions impl -&gt; MetadataDefaults
soApolloFederationStatus :: forall impl. ServeOptions impl -&gt; ApolloFederationStatus
soCloseWebsocketsOnMetadataChangeStatus :: forall impl.
ServeOptions impl -&gt; CloseWebsocketsOnMetadataChangeStatus
soMaxTotalHeaderLength :: forall impl. ServeOptions impl -&gt; Int
soTriggersErrorLogLevelStatus :: forall impl. ServeOptions impl -&gt; TriggersErrorLogLevelStatus
soAsyncActionsFetchBatchSize :: forall impl. ServeOptions impl -&gt; Int
soPersistedQueries :: forall impl. ServeOptions impl -&gt; PersistedQueriesState
soPersistedQueriesTtl :: forall impl. ServeOptions impl -&gt; Int
</span><a href="#local-6989586621688033355"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span id="local-6989586621688033455"><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621688033455"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688033456"><span class="annot"><span class="annottext">InvalidationKeys
</span><a href="#local-6989586621688033456"><span class="hs-identifier hs-var">_keys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688033457"><span class="annot"><span class="annottext">CheckFeatureFlag
</span><a href="#local-6989586621688033457"><span class="hs-identifier hs-var">checkFeatureFlag</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-267"></span><span>  </span><span id="local-6989586621688033458"><span class="annot"><span class="annottext">SchemaSampledFeatureFlags
</span><a href="#local-6989586621688033458"><span class="hs-identifier hs-var">schemaSampledFeatureFlags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(CheckFeatureFlag -&gt; m SchemaSampledFeatureFlags)
-&gt; arr CheckFeatureFlag SchemaSampledFeatureFlags
forall a b. (a -&gt; m b) -&gt; arr a b
forall (m :: * -&gt; *) (arr :: * -&gt; * -&gt; *) a b.
ArrowKleisli m arr =&gt;
(a -&gt; m b) -&gt; arr a b
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/arrows-extra-1.0.0/opt/doc/html/arrows-extra/src/Control.Arrow.Extended.html#arrM"><span class="hs-identifier hs-var">arrM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO SchemaSampledFeatureFlags -&gt; m SchemaSampledFeatureFlags
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO SchemaSampledFeatureFlags -&gt; m SchemaSampledFeatureFlags)
-&gt; (CheckFeatureFlag -&gt; IO SchemaSampledFeatureFlags)
-&gt; CheckFeatureFlag
-&gt; m SchemaSampledFeatureFlags
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CheckFeatureFlag -&gt; IO SchemaSampledFeatureFlags
</span><a href="Hasura.GraphQL.Schema.Common.html#sampleFeatureFlags"><span class="hs-identifier hs-var">sampleFeatureFlags</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">CheckFeatureFlag
</span><a href="#local-6989586621688033457"><span class="hs-identifier hs-var">checkFeatureFlag</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621688033461"><span class="annot"><span class="annottext">AuthMode
</span><a href="#local-6989586621688033461"><span class="hs-identifier hs-var">authMode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">arr
  (HashSet AdminSecretHash, Maybe AuthHook, [JWTConfig],
   Maybe RoleName)
  AuthMode
</span><a href="#local-6989586621688033462"><span class="hs-identifier hs-var">buildAuthMode</span></a></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashSet AdminSecretHash
</span><a href="#local-6989586621688033359"><span class="hs-identifier hs-var">soAdminSecret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe AuthHook
</span><a href="#local-6989586621688033360"><span class="hs-identifier hs-var">soAuthHook</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[JWTConfig]
</span><a href="#local-6989586621688033361"><span class="hs-identifier hs-var">soJwtSecret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe RoleName
</span><a href="#local-6989586621688033362"><span class="hs-identifier hs-var">soUnAuthRole</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688033463"><span class="annot"><span class="annottext">sqlGenCtx :: SQLGenCtx
</span><a href="#local-6989586621688033463"><span class="hs-identifier hs-var hs-var">sqlGenCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashSet ExperimentalFeature
-&gt; StringifyNumbers
-&gt; DangerouslyCollapseBooleans
-&gt; RemoteNullForwardingPolicy
-&gt; SQLGenCtx
</span><a href="Hasura.App.State.html#initSQLGenCtx"><span class="hs-identifier hs-var">initSQLGenCtx</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet ExperimentalFeature
</span><a href="#local-6989586621688033386"><span class="hs-identifier hs-var">soExperimentalFeatures</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621688033368"><span class="hs-identifier hs-var">soStringifyNum</span></a></span><span> </span><span class="annot"><span class="annottext">DangerouslyCollapseBooleans
</span><a href="#local-6989586621688033369"><span class="hs-identifier hs-var">soDangerousBooleanCollapse</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteNullForwardingPolicy
</span><a href="#local-6989586621688033370"><span class="hs-identifier hs-var">soRemoteNullForwardingPolicy</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span id="local-6989586621688033464"><span class="annot"><span class="annottext">ResponseInternalErrorsConfig
</span><a href="#local-6989586621688033464"><span class="hs-identifier hs-var">responseInternalErrorsConfig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">arr
  (AdminInternalErrorsStatus, DevModeStatus)
  ResponseInternalErrorsConfig
</span><a href="#local-6989586621688033465"><span class="hs-identifier hs-var">buildResponseInternalErrorsConfig</span></a></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AdminInternalErrorsStatus
</span><a href="#local-6989586621688033389"><span class="hs-identifier hs-var">soAdminInternalErrors</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DevModeStatus
</span><a href="#local-6989586621688033388"><span class="hs-identifier hs-var">soDevMode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>  </span><span id="local-6989586621688033466"><span class="annot"><span class="annottext">EventEngineCtx
</span><a href="#local-6989586621688033466"><span class="hs-identifier hs-var">eventEngineCtx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">arr
  (Refined Positive Int, Refined NonNegative Milliseconds,
   Refined NonNegative Int)
  EventEngineCtx
</span><a href="#local-6989586621688033467"><span class="hs-identifier hs-var">buildEventEngineCtx</span></a></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Refined Positive Int
</span><a href="#local-6989586621688033377"><span class="hs-identifier hs-var">soEventsHttpPoolSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Refined NonNegative Milliseconds
</span><a href="#local-6989586621688033378"><span class="hs-identifier hs-var">soEventsFetchInterval</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Refined NonNegative Int
</span><a href="#local-6989586621688033387"><span class="hs-identifier hs-var">soEventsFetchBatchSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><span class="annottext">arr AppContext AppContext
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-glyph">-&lt;</span><span>
</span><span id="line-274"></span><span>      </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span>
</span><span id="line-275"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">acAuthMode :: AuthMode
</span><a href="Hasura.App.State.html#acAuthMode"><span class="hs-identifier hs-var">acAuthMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AuthMode
</span><a href="#local-6989586621688033461"><span class="hs-identifier hs-var">authMode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-276"></span><span>          </span><span class="annot"><span class="annottext">acSQLGenCtx :: SQLGenCtx
</span><a href="Hasura.App.State.html#acSQLGenCtx"><span class="hs-identifier hs-var">acSQLGenCtx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621688033463"><span class="hs-identifier hs-var">sqlGenCtx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-277"></span><span>          </span><span class="annot"><span class="annottext">acEnabledAPIs :: HashSet API
</span><a href="Hasura.App.State.html#acEnabledAPIs"><span class="hs-identifier hs-var">acEnabledAPIs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashSet API
</span><a href="#local-6989586621688033371"><span class="hs-identifier hs-var">soEnabledAPIs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-278"></span><span>          </span><span class="annot"><span class="annottext">acEnableAllowlist :: AllowListStatus
</span><a href="Hasura.App.State.html#acEnableAllowlist"><span class="hs-identifier hs-var">acEnableAllowlist</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AllowListStatus
</span><a href="#local-6989586621688033374"><span class="hs-identifier hs-var">soEnableAllowList</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-279"></span><span>          </span><span class="annot"><span class="annottext">acResponseInternalErrorsConfig :: ResponseInternalErrorsConfig
</span><a href="Hasura.App.State.html#acResponseInternalErrorsConfig"><span class="hs-identifier hs-var">acResponseInternalErrorsConfig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ResponseInternalErrorsConfig
</span><a href="#local-6989586621688033464"><span class="hs-identifier hs-var">responseInternalErrorsConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-280"></span><span>          </span><span class="annot"><span class="annottext">acEnvironment :: Environment
</span><a href="Hasura.App.State.html#acEnvironment"><span class="hs-identifier hs-var">acEnvironment</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621688033455"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-281"></span><span>          </span><span class="annot"><span class="annottext">acRemoteSchemaPermsCtx :: RemoteSchemaPermissions
</span><a href="Hasura.App.State.html#acRemoteSchemaPermsCtx"><span class="hs-identifier hs-var">acRemoteSchemaPermsCtx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RemoteSchemaPermissions
</span><a href="#local-6989586621688033380"><span class="hs-identifier hs-var">soEnableRemoteSchemaPermissions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-282"></span><span>          </span><span class="annot"><span class="annottext">acFunctionPermsCtx :: InferFunctionPermissions
</span><a href="Hasura.App.State.html#acFunctionPermsCtx"><span class="hs-identifier hs-var">acFunctionPermsCtx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InferFunctionPermissions
</span><a href="#local-6989586621688033383"><span class="hs-identifier hs-var">soInferFunctionPermissions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-283"></span><span>          </span><span class="annot"><span class="annottext">acExperimentalFeatures :: HashSet ExperimentalFeature
</span><a href="Hasura.App.State.html#acExperimentalFeatures"><span class="hs-identifier hs-var">acExperimentalFeatures</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashSet ExperimentalFeature
</span><a href="#local-6989586621688033386"><span class="hs-identifier hs-var">soExperimentalFeatures</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-284"></span><span>          </span><span class="annot"><span class="annottext">acDefaultNamingConvention :: NamingCase
</span><a href="Hasura.App.State.html#acDefaultNamingConvention"><span class="hs-identifier hs-var">acDefaultNamingConvention</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamingCase
</span><a href="#local-6989586621688033395"><span class="hs-identifier hs-var">soDefaultNamingConvention</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-285"></span><span>          </span><span class="annot"><span class="annottext">acMetadataDefaults :: MetadataDefaults
</span><a href="Hasura.App.State.html#acMetadataDefaults"><span class="hs-identifier hs-var">acMetadataDefaults</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MetadataDefaults
</span><a href="#local-6989586621688033397"><span class="hs-identifier hs-var">soMetadataDefaults</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-286"></span><span>          </span><span class="annot"><span class="annottext">acLiveQueryOptions :: LiveQueriesOptions
</span><a href="Hasura.App.State.html#acLiveQueryOptions"><span class="hs-identifier hs-var">acLiveQueryOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LiveQueriesOptions
</span><a href="#local-6989586621688033372"><span class="hs-identifier hs-var">soLiveQueryOpts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-287"></span><span>          </span><span class="annot"><span class="annottext">acStreamQueryOptions :: LiveQueriesOptions
</span><a href="Hasura.App.State.html#acStreamQueryOptions"><span class="hs-identifier hs-var">acStreamQueryOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LiveQueriesOptions
</span><a href="#local-6989586621688033373"><span class="hs-identifier hs-var">soStreamingQueryOpts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-288"></span><span>          </span><span class="annot"><span class="annottext">acCorsPolicy :: CorsPolicy
</span><a href="Hasura.App.State.html#acCorsPolicy"><span class="hs-identifier hs-var">acCorsPolicy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CorsConfig -&gt; CorsPolicy
</span><a href="Hasura.Server.Cors.html#mkDefaultCorsPolicy"><span class="hs-identifier hs-var">Cors.mkDefaultCorsPolicy</span></a></span><span> </span><span class="annot"><span class="annottext">CorsConfig
</span><a href="#local-6989586621688033363"><span class="hs-identifier hs-var">soCorsConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-289"></span><span>          </span><span class="annot"><span class="annottext">acConsoleStatus :: ConsoleStatus
</span><a href="Hasura.App.State.html#acConsoleStatus"><span class="hs-identifier hs-var">acConsoleStatus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsoleStatus
</span><a href="#local-6989586621688033364"><span class="hs-identifier hs-var">soConsoleStatus</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-290"></span><span>          </span><span class="annot"><span class="annottext">acEnableTelemetry :: TelemetryStatus
</span><a href="Hasura.App.State.html#acEnableTelemetry"><span class="hs-identifier hs-var">acEnableTelemetry</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TelemetryStatus
</span><a href="#local-6989586621688033367"><span class="hs-identifier hs-var">soEnableTelemetry</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-291"></span><span>          </span><span class="annot"><span class="annottext">acEventEngineCtx :: EventEngineCtx
</span><a href="Hasura.App.State.html#acEventEngineCtx"><span class="hs-identifier hs-var">acEventEngineCtx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EventEngineCtx
</span><a href="#local-6989586621688033466"><span class="hs-identifier hs-var">eventEngineCtx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-292"></span><span>          </span><span class="annot"><span class="annottext">acAsyncActionsFetchInterval :: OptionalInterval
</span><a href="Hasura.App.State.html#acAsyncActionsFetchInterval"><span class="hs-identifier hs-var">acAsyncActionsFetchInterval</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptionalInterval
</span><a href="#local-6989586621688033379"><span class="hs-identifier hs-var">soAsyncActionsFetchInterval</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-293"></span><span>          </span><span class="annot"><span class="annottext">acApolloFederationStatus :: ApolloFederationStatus
</span><a href="Hasura.App.State.html#acApolloFederationStatus"><span class="hs-identifier hs-var">acApolloFederationStatus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApolloFederationStatus
</span><a href="#local-6989586621688033398"><span class="hs-identifier hs-var">soApolloFederationStatus</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-294"></span><span>          </span><span class="annot"><span class="annottext">acCloseWebsocketsOnMetadataChangeStatus :: CloseWebsocketsOnMetadataChangeStatus
</span><a href="Hasura.App.State.html#acCloseWebsocketsOnMetadataChangeStatus"><span class="hs-identifier hs-var">acCloseWebsocketsOnMetadataChangeStatus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CloseWebsocketsOnMetadataChangeStatus
</span><a href="#local-6989586621688033399"><span class="hs-identifier hs-var">soCloseWebsocketsOnMetadataChangeStatus</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-295"></span><span>          </span><span class="annot"><span class="annottext">acSchemaSampledFeatureFlags :: SchemaSampledFeatureFlags
</span><a href="Hasura.App.State.html#acSchemaSampledFeatureFlags"><span class="hs-identifier hs-var">acSchemaSampledFeatureFlags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SchemaSampledFeatureFlags
</span><a href="#local-6989586621688033458"><span class="hs-identifier hs-var">schemaSampledFeatureFlags</span></a></span><span>
</span><span id="line-296"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-298"></span><span>    </span><span id="local-6989586621688033467"><span class="annot"><span class="annottext">buildEventEngineCtx :: arr
  (Refined Positive Int, Refined NonNegative Milliseconds,
   Refined NonNegative Int)
  EventEngineCtx
</span><a href="#local-6989586621688033467"><span class="hs-identifier hs-var hs-var">buildEventEngineCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">arr
  (Refined Positive Int, Refined NonNegative Milliseconds,
   Refined NonNegative Int)
  EventEngineCtx
-&gt; arr
     (Refined Positive Int, Refined NonNegative Milliseconds,
      Refined NonNegative Int)
     EventEngineCtx
forall a b. (Given Accesses =&gt; Eq a) =&gt; arr a b -&gt; arr a b
forall (m :: * -&gt; *) (arr :: * -&gt; * -&gt; *) a b.
(ArrowCache m arr, Given Accesses =&gt; Eq a) =&gt;
arr a b -&gt; arr a b
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/incremental-1.0.0/opt/doc/html/incremental/src/Hasura.Incremental.Internal.Cache.html#cache"><span class="hs-identifier hs-var">Inc.cache</span></a></span><span> </span><span class="hs-keyword">proc</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688033494"><span class="annot"><span class="annottext">Refined Positive Int
</span><a href="#local-6989586621688033494"><span class="hs-identifier hs-var">httpPoolSize</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688033495"><span class="annot"><span class="annottext">Refined NonNegative Milliseconds
</span><a href="#local-6989586621688033495"><span class="hs-identifier hs-var">fetchInterval</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688033496"><span class="annot"><span class="annottext">Refined NonNegative Int
</span><a href="#local-6989586621688033496"><span class="hs-identifier hs-var">fetchBatchSize</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-299"></span><span>      </span><span id="local-6989586621688033497"><span class="annot"><span class="annottext">EventEngineCtx
</span><a href="#local-6989586621688033497"><span class="hs-identifier hs-var">eventEngineCtx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">arr (m EventEngineCtx) EventEngineCtx
forall (m :: * -&gt; *) (arr :: * -&gt; * -&gt; *) a.
ArrowKleisli m arr =&gt;
arr (m a) a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/arrows-extra-1.0.0/opt/doc/html/arrows-extra/src/Control.Arrow.Extended.html#bindA"><span class="hs-identifier hs-var">bindA</span></a></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">Refined Positive Int
-&gt; Refined NonNegative Milliseconds
-&gt; Refined NonNegative Int
-&gt; m EventEngineCtx
forall (m :: * -&gt; *).
MonadIO m =&gt;
Refined Positive Int
-&gt; Refined NonNegative Milliseconds
-&gt; Refined NonNegative Int
-&gt; m EventEngineCtx
</span><a href="Hasura.Eventing.EventTrigger.html#initEventEngineCtx"><span class="hs-identifier hs-var">initEventEngineCtx</span></a></span><span> </span><span class="annot"><span class="annottext">Refined Positive Int
</span><a href="#local-6989586621688033494"><span class="hs-identifier hs-var">httpPoolSize</span></a></span><span> </span><span class="annot"><span class="annottext">Refined NonNegative Milliseconds
</span><a href="#local-6989586621688033495"><span class="hs-identifier hs-var">fetchInterval</span></a></span><span> </span><span class="annot"><span class="annottext">Refined NonNegative Int
</span><a href="#local-6989586621688033496"><span class="hs-identifier hs-var">fetchBatchSize</span></a></span><span>
</span><span id="line-300"></span><span>      </span><span class="annot"><span class="annottext">arr EventEngineCtx EventEngineCtx
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">EventEngineCtx
</span><a href="#local-6989586621688033497"><span class="hs-identifier hs-var">eventEngineCtx</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><a href="#local-6989586621688033462"><span class="hs-identifier hs-type">buildAuthMode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashSet.Internal.html#HashSet"><span class="hs-identifier hs-type">Set.HashSet</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.Auth.html#AdminSecretHash"><span class="hs-identifier hs-type">AdminSecretHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.Server.Auth.WebHook.html#AuthHook"><span class="hs-identifier hs-type">AuthHook</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.Server.Auth.JWT.html#JWTConfig"><span class="hs-identifier hs-type">JWTConfig</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Roles.html#RoleName"><span class="hs-identifier hs-type">RoleName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621688032991"><span class="hs-operator hs-type">`arr`</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.Auth.html#AuthMode"><span class="hs-identifier hs-type">AuthMode</span></a></span><span>
</span><span id="line-303"></span><span>    </span><span id="local-6989586621688033462"><span class="annot"><span class="annottext">buildAuthMode :: arr
  (HashSet AdminSecretHash, Maybe AuthHook, [JWTConfig],
   Maybe RoleName)
  AuthMode
</span><a href="#local-6989586621688033462"><span class="hs-identifier hs-var hs-var">buildAuthMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">arr
  (HashSet AdminSecretHash, Maybe AuthHook, [JWTConfig],
   Maybe RoleName)
  AuthMode
-&gt; arr
     (HashSet AdminSecretHash, Maybe AuthHook, [JWTConfig],
      Maybe RoleName)
     AuthMode
forall a b. (Given Accesses =&gt; Eq a) =&gt; arr a b -&gt; arr a b
forall (m :: * -&gt; *) (arr :: * -&gt; * -&gt; *) a b.
(ArrowCache m arr, Given Accesses =&gt; Eq a) =&gt;
arr a b -&gt; arr a b
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/incremental-1.0.0/opt/doc/html/incremental/src/Hasura.Incremental.Internal.Cache.html#cache"><span class="hs-identifier hs-var">Inc.cache</span></a></span><span> </span><span class="hs-keyword">proc</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688033500"><span class="annot"><span class="annottext">HashSet AdminSecretHash
</span><a href="#local-6989586621688033500"><span class="hs-identifier hs-var">adminSecretHashSet</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688033501"><span class="annot"><span class="annottext">Maybe AuthHook
</span><a href="#local-6989586621688033501"><span class="hs-identifier hs-var">webHook</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688033502"><span class="annot"><span class="annottext">[JWTConfig]
</span><a href="#local-6989586621688033502"><span class="hs-identifier hs-var">jwtSecrets</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688033503"><span class="annot"><span class="annottext">Maybe RoleName
</span><a href="#local-6989586621688033503"><span class="hs-identifier hs-var">unAuthRole</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-304"></span><span>      </span><span id="local-6989586621688033504"><span class="annot"><span class="annottext">AuthMode
</span><a href="#local-6989586621688033504"><span class="hs-identifier hs-var">authMode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-305"></span><span>        </span><span class="annot"><span class="annottext">arr (m AuthMode) AuthMode
forall (m :: * -&gt; *) (arr :: * -&gt; * -&gt; *) a.
ArrowKleisli m arr =&gt;
arr (m a) a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/arrows-extra-1.0.0/opt/doc/html/arrows-extra/src/Control.Arrow.Extended.html#bindA"><span class="hs-identifier hs-var">bindA</span></a></span><span>
</span><span id="line-306"></span><span>          </span><span class="hs-glyph">-&lt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-307"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621688033505"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621688033505"><span class="hs-identifier hs-var">logger</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688033506"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621688033506"><span class="hs-identifier hs-var">httpManager</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Logger Hasura, Manager)
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-308"></span><span>            </span><span id="local-6989586621688033508"><span class="annot"><span class="annottext">Either Text AuthMode
</span><a href="#local-6989586621688033508"><span class="hs-identifier hs-var">authModeRes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-309"></span><span>              </span><span class="annot"><span class="annottext">ExceptT Text m AuthMode -&gt; m (Either Text AuthMode)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span>
</span><span id="line-310"></span><span>                </span><span class="annot"><span class="annottext">(ExceptT Text m AuthMode -&gt; m (Either Text AuthMode))
-&gt; ExceptT Text m AuthMode -&gt; m (Either Text AuthMode)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashSet AdminSecretHash
-&gt; Maybe AuthHook
-&gt; [JWTConfig]
-&gt; Maybe RoleName
-&gt; Logger Hasura
-&gt; Manager
-&gt; ExceptT Text m AuthMode
forall (m :: * -&gt; *).
(MonadError Text m, MonadIO m, MonadBaseControl IO m) =&gt;
HashSet AdminSecretHash
-&gt; Maybe AuthHook
-&gt; [JWTConfig]
-&gt; Maybe RoleName
-&gt; Logger Hasura
-&gt; Manager
-&gt; m AuthMode
</span><a href="Hasura.Server.Auth.html#setupAuthMode"><span class="hs-identifier hs-var">setupAuthMode</span></a></span><span>
</span><span id="line-311"></span><span>                  </span><span class="annot"><span class="annottext">HashSet AdminSecretHash
</span><a href="#local-6989586621688033500"><span class="hs-identifier hs-var">adminSecretHashSet</span></a></span><span>
</span><span id="line-312"></span><span>                  </span><span class="annot"><span class="annottext">Maybe AuthHook
</span><a href="#local-6989586621688033501"><span class="hs-identifier hs-var">webHook</span></a></span><span>
</span><span id="line-313"></span><span>                  </span><span class="annot"><span class="annottext">[JWTConfig]
</span><a href="#local-6989586621688033502"><span class="hs-identifier hs-var">jwtSecrets</span></a></span><span>
</span><span id="line-314"></span><span>                  </span><span class="annot"><span class="annottext">Maybe RoleName
</span><a href="#local-6989586621688033503"><span class="hs-identifier hs-var">unAuthRole</span></a></span><span>
</span><span id="line-315"></span><span>                  </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621688033505"><span class="hs-identifier hs-var">logger</span></a></span><span>
</span><span id="line-316"></span><span>                  </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621688033506"><span class="hs-identifier hs-var">httpManager</span></a></span><span>
</span><span id="line-317"></span><span>            </span><span class="annot"><span class="annottext">Either Text AuthMode -&gt; (Text -&gt; m AuthMode) -&gt; m AuthMode
forall (m :: * -&gt; *) e a.
Applicative m =&gt;
Either e a -&gt; (e -&gt; m a) -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html#onLeft"><span class="hs-identifier hs-var">onLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Either Text AuthMode
</span><a href="#local-6989586621688033508"><span class="hs-identifier hs-var">authModeRes</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; m AuthMode
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#throw500"><span class="hs-identifier hs-var">throw500</span></a></span><span>
</span><span id="line-318"></span><span>      </span><span class="annot"><span class="annottext">arr AuthMode AuthMode
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">AuthMode
</span><a href="#local-6989586621688033504"><span class="hs-identifier hs-var">authMode</span></a></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><a href="#local-6989586621688033465"><span class="hs-identifier hs-type">buildResponseInternalErrorsConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Init.Config.html#AdminInternalErrorsStatus"><span class="hs-identifier hs-type">AdminInternalErrorsStatus</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#DevModeStatus"><span class="hs-identifier hs-type">DevModeStatus</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621688032991"><span class="hs-operator hs-type">`arr`</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#ResponseInternalErrorsConfig"><span class="hs-identifier hs-type">ResponseInternalErrorsConfig</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span id="local-6989586621688033465"><span class="annot"><span class="annottext">buildResponseInternalErrorsConfig :: arr
  (AdminInternalErrorsStatus, DevModeStatus)
  ResponseInternalErrorsConfig
</span><a href="#local-6989586621688033465"><span class="hs-identifier hs-var hs-var">buildResponseInternalErrorsConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">arr
  (AdminInternalErrorsStatus, DevModeStatus)
  ResponseInternalErrorsConfig
-&gt; arr
     (AdminInternalErrorsStatus, DevModeStatus)
     ResponseInternalErrorsConfig
forall a b. (Given Accesses =&gt; Eq a) =&gt; arr a b -&gt; arr a b
forall (m :: * -&gt; *) (arr :: * -&gt; * -&gt; *) a b.
(ArrowCache m arr, Given Accesses =&gt; Eq a) =&gt;
arr a b -&gt; arr a b
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/incremental-1.0.0/opt/doc/html/incremental/src/Hasura.Incremental.Internal.Cache.html#cache"><span class="hs-identifier hs-var">Inc.cache</span></a></span><span> </span><span class="hs-keyword">proc</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688033512"><span class="annot"><span class="annottext">AdminInternalErrorsStatus
</span><a href="#local-6989586621688033512"><span class="hs-identifier hs-var">adminInternalErrors</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688033513"><span class="annot"><span class="annottext">DevModeStatus
</span><a href="#local-6989586621688033513"><span class="hs-identifier hs-var">devMode</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-322"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688033514"><span class="annot"><span class="annottext">responseInternalErrorsConfig :: ResponseInternalErrorsConfig
</span><a href="#local-6989586621688033514"><span class="hs-identifier hs-var hs-var">responseInternalErrorsConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-323"></span><span>            </span><span class="hs-keyword">if</span><span>
</span><span id="line-324"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DevModeStatus -&gt; Bool
</span><a href="Hasura.Server.Init.Config.html#isDevModeEnabled"><span class="hs-identifier hs-var">isDevModeEnabled</span></a></span><span> </span><span class="annot"><span class="annottext">DevModeStatus
</span><a href="#local-6989586621688033513"><span class="hs-identifier hs-var">devMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResponseInternalErrorsConfig
</span><a href="Hasura.Server.Init.Config.html#InternalErrorsAllRequests"><span class="hs-identifier hs-var">InternalErrorsAllRequests</span></a></span><span>
</span><span id="line-325"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">AdminInternalErrorsStatus -&gt; Bool
</span><a href="Hasura.Server.Init.Config.html#isAdminInternalErrorsEnabled"><span class="hs-identifier hs-var">isAdminInternalErrorsEnabled</span></a></span><span> </span><span class="annot"><span class="annottext">AdminInternalErrorsStatus
</span><a href="#local-6989586621688033512"><span class="hs-identifier hs-var">adminInternalErrors</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResponseInternalErrorsConfig
</span><a href="Hasura.Server.Init.Config.html#InternalErrorsAdminOnly"><span class="hs-identifier hs-var">InternalErrorsAdminOnly</span></a></span><span>
</span><span id="line-326"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResponseInternalErrorsConfig
</span><a href="Hasura.Server.Init.Config.html#InternalErrorsDisabled"><span class="hs-identifier hs-var">InternalErrorsDisabled</span></a></span><span>
</span><span id="line-327"></span><span>      </span><span class="annot"><span class="annottext">arr ResponseInternalErrorsConfig ResponseInternalErrorsConfig
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span> </span><span class="hs-glyph">-&lt;</span><span> </span><span class="annot"><span class="annottext">ResponseInternalErrorsConfig
</span><a href="#local-6989586621688033514"><span class="hs-identifier hs-var">responseInternalErrorsConfig</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- subsets</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="annot"><a href="Hasura.App.State.html#initSQLGenCtx"><span class="hs-identifier hs-type">initSQLGenCtx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashSet.Internal.html#HashSet"><span class="hs-identifier hs-type">HashSet</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#ExperimentalFeature"><span class="hs-identifier hs-type">ExperimentalFeature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#DangerouslyCollapseBooleans"><span class="hs-identifier hs-type">Options.DangerouslyCollapseBooleans</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#RemoteNullForwardingPolicy"><span class="hs-identifier hs-type">Options.RemoteNullForwardingPolicy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SQLGenCtx"><span class="hs-identifier hs-type">SQLGenCtx</span></a></span><span>
</span><span id="line-333"></span><span id="initSQLGenCtx"><span class="annot"><span class="annottext">initSQLGenCtx :: HashSet ExperimentalFeature
-&gt; StringifyNumbers
-&gt; DangerouslyCollapseBooleans
-&gt; RemoteNullForwardingPolicy
-&gt; SQLGenCtx
</span><a href="Hasura.App.State.html#initSQLGenCtx"><span class="hs-identifier hs-var hs-var">initSQLGenCtx</span></a></span></span><span> </span><span id="local-6989586621688033520"><span class="annot"><span class="annottext">HashSet ExperimentalFeature
</span><a href="#local-6989586621688033520"><span class="hs-identifier hs-var">experimentalFeatures</span></a></span></span><span> </span><span id="local-6989586621688033521"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621688033521"><span class="hs-identifier hs-var">stringifyNum</span></a></span></span><span> </span><span id="local-6989586621688033522"><span class="annot"><span class="annottext">DangerouslyCollapseBooleans
</span><a href="#local-6989586621688033522"><span class="hs-identifier hs-var">dangerousBooleanCollapse</span></a></span></span><span> </span><span id="local-6989586621688033523"><span class="annot"><span class="annottext">RemoteNullForwardingPolicy
</span><a href="#local-6989586621688033523"><span class="hs-identifier hs-var">remoteNullForwardingPolicy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688033524"><span class="annot"><span class="annottext">optimizePermissionFilters :: OptimizePermissionFilters
</span><a href="#local-6989586621688033524"><span class="hs-identifier hs-var hs-var">optimizePermissionFilters</span></a></span></span><span>
</span><span id="line-335"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ExperimentalFeature
</span><a href="Hasura.Server.Types.html#EFOptimizePermissionFilters"><span class="hs-identifier hs-var">EFOptimizePermissionFilters</span></a></span><span> </span><span class="annot"><span class="annottext">ExperimentalFeature -&gt; HashSet ExperimentalFeature -&gt; Bool
forall a. Eq a =&gt; a -&gt; HashSet a -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">HashSet ExperimentalFeature
</span><a href="#local-6989586621688033520"><span class="hs-identifier hs-var">experimentalFeatures</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptimizePermissionFilters
</span><a href="Hasura.RQL.Types.Schema.Options.html#OptimizePermissionFilters"><span class="hs-identifier hs-var">Options.OptimizePermissionFilters</span></a></span><span>
</span><span id="line-336"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptimizePermissionFilters
</span><a href="Hasura.RQL.Types.Schema.Options.html#Don%27tOptimizePermissionFilters"><span class="hs-identifier hs-var">Options.Don'tOptimizePermissionFilters</span></a></span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span>      </span><span id="local-6989586621688033529"><span class="annot"><span class="annottext">bigqueryStringNumericInput :: BigQueryStringNumericInput
</span><a href="#local-6989586621688033529"><span class="hs-identifier hs-var hs-var">bigqueryStringNumericInput</span></a></span></span><span>
</span><span id="line-339"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ExperimentalFeature
</span><a href="Hasura.Server.Types.html#EFBigQueryStringNumericInput"><span class="hs-identifier hs-var">EFBigQueryStringNumericInput</span></a></span><span> </span><span class="annot"><span class="annottext">ExperimentalFeature -&gt; HashSet ExperimentalFeature -&gt; Bool
forall a. Eq a =&gt; a -&gt; HashSet a -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">HashSet ExperimentalFeature
</span><a href="#local-6989586621688033520"><span class="hs-identifier hs-var">experimentalFeatures</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BigQueryStringNumericInput
</span><a href="Hasura.RQL.Types.Schema.Options.html#EnableBigQueryStringNumericInput"><span class="hs-identifier hs-var">Options.EnableBigQueryStringNumericInput</span></a></span><span>
</span><span id="line-340"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BigQueryStringNumericInput
</span><a href="Hasura.RQL.Types.Schema.Options.html#DisableBigQueryStringNumericInput"><span class="hs-identifier hs-var">Options.DisableBigQueryStringNumericInput</span></a></span><span>
</span><span id="line-341"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
-&gt; DangerouslyCollapseBooleans
-&gt; RemoteNullForwardingPolicy
-&gt; OptimizePermissionFilters
-&gt; BigQueryStringNumericInput
-&gt; SQLGenCtx
</span><a href="Hasura.RQL.Types.Common.html#SQLGenCtx"><span class="hs-identifier hs-var">SQLGenCtx</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621688033521"><span class="hs-identifier hs-var">stringifyNum</span></a></span><span> </span><span class="annot"><span class="annottext">DangerouslyCollapseBooleans
</span><a href="#local-6989586621688033522"><span class="hs-identifier hs-var">dangerousBooleanCollapse</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteNullForwardingPolicy
</span><a href="#local-6989586621688033523"><span class="hs-identifier hs-var">remoteNullForwardingPolicy</span></a></span><span> </span><span class="annot"><span class="annottext">OptimizePermissionFilters
</span><a href="#local-6989586621688033524"><span class="hs-identifier hs-var">optimizePermissionFilters</span></a></span><span> </span><span class="annot"><span class="annottext">BigQueryStringNumericInput
</span><a href="#local-6989586621688033529"><span class="hs-identifier hs-var">bigqueryStringNumericInput</span></a></span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="annot"><a href="Hasura.App.State.html#buildCacheStaticConfig"><span class="hs-identifier hs-type">buildCacheStaticConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.App.State.html#AppEnv"><span class="hs-identifier hs-type">AppEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#CacheStaticConfig"><span class="hs-identifier hs-type">CacheStaticConfig</span></a></span><span>
</span><span id="line-344"></span><span id="buildCacheStaticConfig"><span class="annot"><span class="annottext">buildCacheStaticConfig :: AppEnv -&gt; CacheStaticConfig
</span><a href="Hasura.App.State.html#buildCacheStaticConfig"><span class="hs-identifier hs-var hs-var">buildCacheStaticConfig</span></a></span></span><span> </span><span class="annot"><a href="Hasura.App.State.html#AppEnv"><span class="hs-identifier hs-type">AppEnv</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688033534"><span id="local-6989586621688033535"><span id="local-6989586621688033536"><span id="local-6989586621688033537"><span id="local-6989586621688033538"><span id="local-6989586621688033539"><span id="local-6989586621688033540"><span id="local-6989586621688033541"><span id="local-6989586621688033542"><span id="local-6989586621688033543"><span id="local-6989586621688033544"><span id="local-6989586621688033545"><span id="local-6989586621688033546"><span id="local-6989586621688033547"><span id="local-6989586621688033548"><span id="local-6989586621688033549"><span id="local-6989586621688033550"><span id="local-6989586621688033551"><span id="local-6989586621688033552"><span id="local-6989586621688033553"><span id="local-6989586621688033554"><span id="local-6989586621688033555"><span id="local-6989586621688033556"><span id="local-6989586621688033557"><span id="local-6989586621688033558"><span id="local-6989586621688033559"><span id="local-6989586621688033560"><span id="local-6989586621688033561"><span id="local-6989586621688033562"><span id="local-6989586621688033563"><span id="local-6989586621688033564"><span id="local-6989586621688033565"><span id="local-6989586621688033566"><span id="local-6989586621688033567"><span id="local-6989586621688033568"><span class="annot"><span class="annottext">Int
Maybe Text
Maybe PGPool
Maybe (CredentialCache AgentLicenseKey)
SamplingPolicy
HostPreference
Manager
TxIsolation
ConnParams
PGPool
Refined NonNegative Seconds
TMVar MetadataResourceVersion
ConnectionOptions
CheckFeatureFlag
ServerMetrics
PersistedQueriesState
TriggersErrorLogLevelStatus
EventingMode
ReadOnlyMode
MaintenanceMode ()
InstanceId
PrometheusMetrics
ShutdownLatch
LoggingSettings
LockedEventsCtx
WSConnectionInitTimeout
KeepAliveDelay
OptionalInterval
Port
SubscriptionsState
Loggers
appEnvPort :: AppEnv -&gt; Port
appEnvHost :: AppEnv -&gt; HostPreference
appEnvMetadataDbPool :: AppEnv -&gt; PGPool
appEnvIntrospectionDbPool :: AppEnv -&gt; Maybe PGPool
appEnvManager :: AppEnv -&gt; Manager
appEnvLoggers :: AppEnv -&gt; Loggers
appEnvMetadataVersionRef :: AppEnv -&gt; TMVar MetadataResourceVersion
appEnvInstanceId :: AppEnv -&gt; InstanceId
appEnvEnableMaintenanceMode :: AppEnv -&gt; MaintenanceMode ()
appEnvLoggingSettings :: AppEnv -&gt; LoggingSettings
appEnvEventingMode :: AppEnv -&gt; EventingMode
appEnvEnableReadOnlyMode :: AppEnv -&gt; ReadOnlyMode
appEnvServerMetrics :: AppEnv -&gt; ServerMetrics
appEnvShutdownLatch :: AppEnv -&gt; ShutdownLatch
appEnvMetaVersionRef :: AppEnv -&gt; TMVar MetadataResourceVersion
appEnvPrometheusMetrics :: AppEnv -&gt; PrometheusMetrics
appEnvTraceSamplingPolicy :: AppEnv -&gt; SamplingPolicy
appEnvSubscriptionState :: AppEnv -&gt; SubscriptionsState
appEnvLockedEventsCtx :: AppEnv -&gt; LockedEventsCtx
appEnvConnParams :: AppEnv -&gt; ConnParams
appEnvTxIso :: AppEnv -&gt; TxIsolation
appEnvConsoleAssetsDir :: AppEnv -&gt; Maybe Text
appEnvConsoleSentryDsn :: AppEnv -&gt; Maybe Text
appEnvConnectionOptions :: AppEnv -&gt; ConnectionOptions
appEnvWebSocketKeepAlive :: AppEnv -&gt; KeepAliveDelay
appEnvWebSocketConnectionInitTimeout :: AppEnv -&gt; WSConnectionInitTimeout
appEnvGracefulShutdownTimeout :: AppEnv -&gt; Refined NonNegative Seconds
appEnvSchemaPollInterval :: AppEnv -&gt; OptionalInterval
appEnvCheckFeatureFlag :: AppEnv -&gt; CheckFeatureFlag
appEnvLicenseKeyCache :: AppEnv -&gt; Maybe (CredentialCache AgentLicenseKey)
appEnvMaxTotalHeaderLength :: AppEnv -&gt; Int
appEnvTriggersErrorLogLevelStatus :: AppEnv -&gt; TriggersErrorLogLevelStatus
appEnvAsyncActionsFetchBatchSize :: AppEnv -&gt; Int
appEnvPersistedQueries :: AppEnv -&gt; PersistedQueriesState
appEnvPersistedQueriesTtl :: AppEnv -&gt; Int
appEnvPort :: Port
appEnvHost :: HostPreference
appEnvMetadataDbPool :: PGPool
appEnvIntrospectionDbPool :: Maybe PGPool
appEnvManager :: Manager
appEnvLoggers :: Loggers
appEnvMetadataVersionRef :: TMVar MetadataResourceVersion
appEnvInstanceId :: InstanceId
appEnvEnableMaintenanceMode :: MaintenanceMode ()
appEnvLoggingSettings :: LoggingSettings
appEnvEventingMode :: EventingMode
appEnvEnableReadOnlyMode :: ReadOnlyMode
appEnvServerMetrics :: ServerMetrics
appEnvShutdownLatch :: ShutdownLatch
appEnvMetaVersionRef :: TMVar MetadataResourceVersion
appEnvPrometheusMetrics :: PrometheusMetrics
appEnvTraceSamplingPolicy :: SamplingPolicy
appEnvSubscriptionState :: SubscriptionsState
appEnvLockedEventsCtx :: LockedEventsCtx
appEnvConnParams :: ConnParams
appEnvTxIso :: TxIsolation
appEnvConsoleAssetsDir :: Maybe Text
appEnvConsoleSentryDsn :: Maybe Text
appEnvConnectionOptions :: ConnectionOptions
appEnvWebSocketKeepAlive :: KeepAliveDelay
appEnvWebSocketConnectionInitTimeout :: WSConnectionInitTimeout
appEnvGracefulShutdownTimeout :: Refined NonNegative Seconds
appEnvSchemaPollInterval :: OptionalInterval
appEnvCheckFeatureFlag :: CheckFeatureFlag
appEnvLicenseKeyCache :: Maybe (CredentialCache AgentLicenseKey)
appEnvMaxTotalHeaderLength :: Int
appEnvTriggersErrorLogLevelStatus :: TriggersErrorLogLevelStatus
appEnvAsyncActionsFetchBatchSize :: Int
appEnvPersistedQueries :: PersistedQueriesState
appEnvPersistedQueriesTtl :: Int
</span><a href="Hasura.App.State.html#appEnvPort"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-345"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#CacheStaticConfig"><span class="hs-identifier hs-type">CacheStaticConfig</span></a></span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_cscMaintenanceMode :: MaintenanceMode ()
</span><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#_cscMaintenanceMode"><span class="hs-identifier hs-var">_cscMaintenanceMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaintenanceMode ()
</span><a href="#local-6989586621688033542"><span class="hs-identifier hs-var">appEnvEnableMaintenanceMode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-347"></span><span>      </span><span class="annot"><span class="annottext">_cscEventingMode :: EventingMode
</span><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#_cscEventingMode"><span class="hs-identifier hs-var">_cscEventingMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EventingMode
</span><a href="#local-6989586621688033544"><span class="hs-identifier hs-var">appEnvEventingMode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-348"></span><span>      </span><span class="annot"><span class="annottext">_cscReadOnlyMode :: ReadOnlyMode
</span><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#_cscReadOnlyMode"><span class="hs-identifier hs-var">_cscReadOnlyMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadOnlyMode
</span><a href="#local-6989586621688033545"><span class="hs-identifier hs-var">appEnvEnableReadOnlyMode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-349"></span><span>      </span><span class="annot"><span class="annottext">_cscLogger :: Logger Hasura
</span><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#_cscLogger"><span class="hs-identifier hs-var">_cscLogger</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Loggers -&gt; Logger Hasura
</span><a href="Hasura.App.State.html#_lsLogger"><span class="hs-identifier hs-var">_lsLogger</span></a></span><span> </span><span class="annot"><span class="annottext">Loggers
</span><a href="#local-6989586621688033539"><span class="hs-identifier hs-var">appEnvLoggers</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-350"></span><span>      </span><span class="hs-comment">-- Native Queries are always enabled for Postgres in the OSS edition.</span><span>
</span><span id="line-351"></span><span>      </span><span class="annot"><span class="annottext">_cscAreNativeQueriesEnabled :: BackendType -&gt; Bool
</span><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#_cscAreNativeQueriesEnabled"><span class="hs-identifier hs-var">_cscAreNativeQueriesEnabled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-352"></span><span>        </span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><span class="annottext">PostgresKind
</span><a href="Hasura.RQL.Types.BackendType.html#Vanilla"><span class="hs-identifier hs-var">Vanilla</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-353"></span><span>        </span><span class="annot"><span class="annottext">BackendType
</span><a href="Hasura.RQL.Types.BackendType.html#DataConnector"><span class="hs-identifier hs-var">DataConnector</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-354"></span><span>        </span><span class="annot"><span class="annottext">BackendType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span>
</span><span id="line-355"></span><span>      </span><span class="annot"><span class="annottext">_cscAreStoredProceduresEnabled :: Bool
</span><a href="#local-6989586621688033578"><span class="hs-identifier hs-var">_cscAreStoredProceduresEnabled</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="annot"><a href="Hasura.App.State.html#buildCacheDynamicConfig"><span class="hs-identifier hs-type">buildCacheDynamicConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#CacheDynamicConfig"><span class="hs-identifier hs-type">CacheDynamicConfig</span></a></span><span>
</span><span id="line-359"></span><span id="buildCacheDynamicConfig"><span class="annot"><span class="annottext">buildCacheDynamicConfig :: AppContext -&gt; CacheDynamicConfig
</span><a href="Hasura.App.State.html#buildCacheDynamicConfig"><span class="hs-identifier hs-var hs-var">buildCacheDynamicConfig</span></a></span></span><span> </span><span class="annot"><a href="Hasura.App.State.html#AppContext"><span class="hs-identifier hs-type">AppContext</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688033579"><span id="local-6989586621688033580"><span id="local-6989586621688033581"><span id="local-6989586621688033582"><span id="local-6989586621688033583"><span id="local-6989586621688033584"><span id="local-6989586621688033585"><span id="local-6989586621688033586"><span id="local-6989586621688033587"><span id="local-6989586621688033588"><span id="local-6989586621688033589"><span id="local-6989586621688033590"><span id="local-6989586621688033591"><span id="local-6989586621688033592"><span id="local-6989586621688033593"><span id="local-6989586621688033594"><span id="local-6989586621688033595"><span id="local-6989586621688033596"><span id="local-6989586621688033597"><span id="local-6989586621688033598"><span id="local-6989586621688033599"><span class="annot"><span class="annottext">Environment
HashSet ExperimentalFeature
HashSet API
LiveQueriesOptions
NamingCase
RemoteSchemaPermissions
InferFunctionPermissions
SQLGenCtx
CorsPolicy
CloseWebsocketsOnMetadataChangeStatus
ApolloFederationStatus
AuthMode
MetadataDefaults
ResponseInternalErrorsConfig
OptionalInterval
TelemetryStatus
AllowListStatus
ConsoleStatus
SchemaSampledFeatureFlags
EventEngineCtx
acAuthMode :: AppContext -&gt; AuthMode
acSQLGenCtx :: AppContext -&gt; SQLGenCtx
acEnabledAPIs :: AppContext -&gt; HashSet API
acEnableAllowlist :: AppContext -&gt; AllowListStatus
acResponseInternalErrorsConfig :: AppContext -&gt; ResponseInternalErrorsConfig
acEnvironment :: AppContext -&gt; Environment
acRemoteSchemaPermsCtx :: AppContext -&gt; RemoteSchemaPermissions
acFunctionPermsCtx :: AppContext -&gt; InferFunctionPermissions
acExperimentalFeatures :: AppContext -&gt; HashSet ExperimentalFeature
acDefaultNamingConvention :: AppContext -&gt; NamingCase
acMetadataDefaults :: AppContext -&gt; MetadataDefaults
acLiveQueryOptions :: AppContext -&gt; LiveQueriesOptions
acStreamQueryOptions :: AppContext -&gt; LiveQueriesOptions
acCorsPolicy :: AppContext -&gt; CorsPolicy
acConsoleStatus :: AppContext -&gt; ConsoleStatus
acEnableTelemetry :: AppContext -&gt; TelemetryStatus
acEventEngineCtx :: AppContext -&gt; EventEngineCtx
acAsyncActionsFetchInterval :: AppContext -&gt; OptionalInterval
acApolloFederationStatus :: AppContext -&gt; ApolloFederationStatus
acCloseWebsocketsOnMetadataChangeStatus :: AppContext -&gt; CloseWebsocketsOnMetadataChangeStatus
acSchemaSampledFeatureFlags :: AppContext -&gt; SchemaSampledFeatureFlags
acAuthMode :: AuthMode
acSQLGenCtx :: SQLGenCtx
acEnabledAPIs :: HashSet API
acEnableAllowlist :: AllowListStatus
acResponseInternalErrorsConfig :: ResponseInternalErrorsConfig
acEnvironment :: Environment
acRemoteSchemaPermsCtx :: RemoteSchemaPermissions
acFunctionPermsCtx :: InferFunctionPermissions
acExperimentalFeatures :: HashSet ExperimentalFeature
acDefaultNamingConvention :: NamingCase
acMetadataDefaults :: MetadataDefaults
acLiveQueryOptions :: LiveQueriesOptions
acStreamQueryOptions :: LiveQueriesOptions
acCorsPolicy :: CorsPolicy
acConsoleStatus :: ConsoleStatus
acEnableTelemetry :: TelemetryStatus
acEventEngineCtx :: EventEngineCtx
acAsyncActionsFetchInterval :: OptionalInterval
acApolloFederationStatus :: ApolloFederationStatus
acCloseWebsocketsOnMetadataChangeStatus :: CloseWebsocketsOnMetadataChangeStatus
acSchemaSampledFeatureFlags :: SchemaSampledFeatureFlags
</span><a href="Hasura.App.State.html#acAuthMode"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-360"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#CacheDynamicConfig"><span class="hs-identifier hs-type">CacheDynamicConfig</span></a></span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_cdcFunctionPermsCtx :: InferFunctionPermissions
</span><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#_cdcFunctionPermsCtx"><span class="hs-identifier hs-var">_cdcFunctionPermsCtx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InferFunctionPermissions
</span><a href="#local-6989586621688033586"><span class="hs-identifier hs-var">acFunctionPermsCtx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-362"></span><span>      </span><span class="annot"><span class="annottext">_cdcRemoteSchemaPermsCtx :: RemoteSchemaPermissions
</span><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#_cdcRemoteSchemaPermsCtx"><span class="hs-identifier hs-var">_cdcRemoteSchemaPermsCtx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RemoteSchemaPermissions
</span><a href="#local-6989586621688033585"><span class="hs-identifier hs-var">acRemoteSchemaPermsCtx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-363"></span><span>      </span><span class="annot"><span class="annottext">_cdcSQLGenCtx :: SQLGenCtx
</span><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#_cdcSQLGenCtx"><span class="hs-identifier hs-var">_cdcSQLGenCtx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SQLGenCtx
</span><a href="#local-6989586621688033580"><span class="hs-identifier hs-var">acSQLGenCtx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-364"></span><span>      </span><span class="annot"><span class="annottext">_cdcExperimentalFeatures :: HashSet ExperimentalFeature
</span><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#_cdcExperimentalFeatures"><span class="hs-identifier hs-var">_cdcExperimentalFeatures</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashSet ExperimentalFeature
</span><a href="#local-6989586621688033587"><span class="hs-identifier hs-var">acExperimentalFeatures</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-365"></span><span>      </span><span class="annot"><span class="annottext">_cdcDefaultNamingConvention :: NamingCase
</span><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#_cdcDefaultNamingConvention"><span class="hs-identifier hs-var">_cdcDefaultNamingConvention</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamingCase
</span><a href="#local-6989586621688033588"><span class="hs-identifier hs-var">acDefaultNamingConvention</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-366"></span><span>      </span><span class="annot"><span class="annottext">_cdcMetadataDefaults :: MetadataDefaults
</span><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#_cdcMetadataDefaults"><span class="hs-identifier hs-var">_cdcMetadataDefaults</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MetadataDefaults
</span><a href="#local-6989586621688033589"><span class="hs-identifier hs-var">acMetadataDefaults</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-367"></span><span>      </span><span class="annot"><span class="annottext">_cdcApolloFederationStatus :: ApolloFederationStatus
</span><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#_cdcApolloFederationStatus"><span class="hs-identifier hs-var">_cdcApolloFederationStatus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApolloFederationStatus
</span><a href="#local-6989586621688033597"><span class="hs-identifier hs-var">acApolloFederationStatus</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-368"></span><span>      </span><span class="annot"><span class="annottext">_cdcCloseWebsocketsOnMetadataChangeStatus :: CloseWebsocketsOnMetadataChangeStatus
</span><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#_cdcCloseWebsocketsOnMetadataChangeStatus"><span class="hs-identifier hs-var">_cdcCloseWebsocketsOnMetadataChangeStatus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CloseWebsocketsOnMetadataChangeStatus
</span><a href="#local-6989586621688033598"><span class="hs-identifier hs-var">acCloseWebsocketsOnMetadataChangeStatus</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-369"></span><span>      </span><span class="annot"><span class="annottext">_cdcSchemaSampledFeatureFlags :: SchemaSampledFeatureFlags
</span><a href="Hasura.RQL.DDL.Schema.Cache.Config.html#_cdcSchemaSampledFeatureFlags"><span class="hs-identifier hs-var">_cdcSchemaSampledFeatureFlags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SchemaSampledFeatureFlags
</span><a href="#local-6989586621688033599"><span class="hs-identifier hs-var">acSchemaSampledFeatureFlags</span></a></span><span>
</span><span id="line-370"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-371"></span></pre></body></html>