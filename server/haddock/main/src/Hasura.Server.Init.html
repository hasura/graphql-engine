<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE QuasiQuotes #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | Arg and Env Parsing for initialisation of the engine along with</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- corresponding logging and other helper functionality.</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- This module is intended as the interface for options parsing and</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- its submodules should not need to be imported directly.</span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hasura.Server.Init</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Option Fetching and Merging</span></span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Hasura.Server.Init.html#mkHGEOptions"><span class="hs-identifier">mkHGEOptions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Hasura.Server.Init.html#mkServeOptions"><span class="hs-identifier">mkServeOptions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Hasura.Server.Init.html#processPostgresConnInfo"><span class="hs-identifier">processPostgresConnInfo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Metadata DB</span></span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Hasura.Server.Init.html#getDbId"><span class="hs-identifier">getDbId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Hasura.Server.Init.html#getPgVersion"><span class="hs-identifier">getPgVersion</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Re-exports</span></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html"><span class="hs-identifier">Hasura.Server.Init.Config</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Env.html"><span class="hs-identifier">Hasura.Server.Init.Env</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Arg.html"><span class="hs-identifier">Hasura.Server.Init.Arg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Logging.html"><span class="hs-identifier">Hasura.Server.Init.Logging</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Hasura.Server.Init.FeatureFlag.html"><span class="hs-identifier">Hasura.Server.Init.FeatureFlag</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">where</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashSet.html"><span class="hs-identifier">Data.HashSet</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HashSet</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/text-2.0.1-d0f6d61f5277bae932134563876cbceb4967915f364959864c72abbc2978d8ed/share/doc/html/src/Data.Text.html"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.html"><span class="hs-identifier">Database.PG.Query</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Query</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.html"><span class="hs-identifier">Hasura.Backends.Postgres.Connection</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Connection</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html"><span class="hs-identifier">Hasura.Base.Error</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Error</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.ApolloFederation.html"><span class="hs-identifier">Hasura.GraphQL.ApolloFederation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.ApolloFederation.html#getApolloFederationStatus"><span class="hs-identifier">getApolloFederationStatus</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.Subscription.Options.html"><span class="hs-identifier">Hasura.GraphQL.Execute.Subscription.Options</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Subscription.Options</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Logging.html"><span class="hs-identifier">Hasura.Logging</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Logging</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html"><span class="hs-identifier">Hasura.RQL.Types.Common</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Common</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html"><span class="hs-identifier">Hasura.RQL.Types.Schema.Options</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Options</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Auth.html"><span class="hs-identifier">Hasura.Server.Auth</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Auth</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Cors.html"><span class="hs-identifier">Hasura.Server.Cors</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Cors</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Arg.html"><span class="hs-identifier">Hasura.Server.Init.Arg</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html"><span class="hs-identifier">Hasura.Server.Init.Config</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Env.html"><span class="hs-identifier">Hasura.Server.Init.Env</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Init.FeatureFlag.html"><span class="hs-identifier">Hasura.Server.Init.FeatureFlag</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Logging.html"><span class="hs-identifier">Hasura.Server.Init.Logging</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html"><span class="hs-identifier">Hasura.Server.Logging</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Server.Logging</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html"><span class="hs-identifier">Hasura.Server.Types</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Types</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/websockets-0.12.7.3-ace9e650e85dd6f2f2179ec47bba2f5dfacb8e002a1c77fe7c2fbe7ac37aed32/share/doc/html/src/Network.WebSockets.html"><span class="hs-identifier">Network.WebSockets</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">WebSockets</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/refined-0.8-b40efcc9b0260e802a32460f94ca38ced336d3f5163ccc01fe8e32d7f56bcb6d/share/doc/html/src/Refined.html"><span class="hs-identifier">Refined</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/refined-0.8-b40efcc9b0260e802a32460f94ca38ced336d3f5163ccc01fe8e32d7f56bcb6d/share/doc/html/src/Refined.html#unrefine"><span class="hs-identifier">unrefine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- TODO(SOLOMON): Where does this note belong?</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">{- Note [ReadOnly Mode]
~~~~~~~~~~~~~~~~~~~~~~~~~

This mode starts the server in a (database) read-only mode. That is, only
read-only queries are allowed on users' database sources, and write
queries throw a runtime error. The use-case is for failsafe operations.
Metadata APIs are also disabled.

Following is the precise behaviour -
  1. For any GraphQL API (relay/hasura; http/websocket) - disable execution of
  mutations
  2. Metadata API is disabled
  3. /v2/query API - insert, delete, update, run_sql are disabled
  4. /v1/query API - insert, delete, update, run_sql are disabled
  5. No source catalog migrations are run
  6. During build schema cache phase, building event triggers are disabled (as
  they create corresponding database triggers)
-}</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Query the Metadata DB for the Metadata DB UUID.</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- TODO: Move into a dedicated Metadata module (ala Pro).</span><span>
</span><span id="line-78"></span><span class="annot"><a href="Hasura.Server.Init.html#getDbId"><span class="hs-identifier hs-type">getDbId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Transaction.html#TxE"><span class="hs-identifier hs-type">Query.TxE</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">Error.QErr</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#MetadataDbId"><span class="hs-identifier hs-type">Types.MetadataDbId</span></a></span><span>
</span><span id="line-79"></span><span id="getDbId"><span class="annot"><span class="annottext">getDbId :: TxE QErr MetadataDbId
</span><a href="Hasura.Server.Init.html#getDbId"><span class="hs-identifier hs-var hs-var">getDbId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><span class="annottext">Text -&gt; MetadataDbId
</span><a href="Hasura.Server.Types.html#MetadataDbId"><span class="hs-identifier hs-var">Types.MetadataDbId</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">(Text -&gt; MetadataDbId)
-&gt; (SingleRow (Identity Text) -&gt; Text)
-&gt; SingleRow (Identity Text)
-&gt; MetadataDbId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Identity Text -&gt; Text
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var">runIdentity</span></span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><span class="annottext">(Identity Text -&gt; Text)
-&gt; (SingleRow (Identity Text) -&gt; Identity Text)
-&gt; SingleRow (Identity Text)
-&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SingleRow (Identity Text) -&gt; Identity Text
forall a. SingleRow a -&gt; a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Class.html#getRow"><span class="hs-identifier hs-var">Query.getRow</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><span class="annottext">(SingleRow (Identity Text) -&gt; MetadataDbId)
-&gt; TxET QErr IO (SingleRow (Identity Text))
-&gt; TxE QErr MetadataDbId
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(PGTxErr -&gt; QErr)
-&gt; Query -&gt; () -&gt; Bool -&gt; TxET QErr IO (SingleRow (Identity Text))
forall (m :: * -&gt; *) a r e.
(MonadIO m, FromRes a, ToPrepArgs r) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; r -&gt; Bool -&gt; TxET e m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Transaction.html#withQE"><span class="hs-identifier hs-var">Query.withQE</span></a></span><span>
</span><span id="line-84"></span><span>      </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#defaultTxErrorHandler"><span class="hs-identifier hs-var">Connection.defaultTxErrorHandler</span></a></span><span>
</span><span id="line-85"></span><span>      </span><span class="annot"><span class="">[Query.sql|
    SELECT (hasura_uuid :: text) FROM hdb_catalog.hdb_version
  |]</span></span><span>
</span><span id="line-88"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="annot"><a href="Hasura.Server.Init.html#getPgVersion"><span class="hs-identifier hs-type">getPgVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Transaction.html#TxE"><span class="hs-identifier hs-type">Query.TxE</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">Error.QErr</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#PGVersion"><span class="hs-identifier hs-type">Types.PGVersion</span></a></span><span>
</span><span id="line-92"></span><span id="getPgVersion"><span class="annot"><span class="annottext">getPgVersion :: TxE QErr PGVersion
</span><a href="Hasura.Server.Init.html#getPgVersion"><span class="hs-identifier hs-var hs-var">getPgVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; PGVersion
</span><a href="Hasura.Server.Types.html#PGVersion"><span class="hs-identifier hs-var">Types.PGVersion</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; PGVersion) -&gt; TxET QErr IO Int -&gt; TxE QErr PGVersion
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TxET QErr IO Int
forall (m :: * -&gt; *) e. MonadIO m =&gt; TxET e m Int
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Transaction.html#serverVersion"><span class="hs-identifier hs-var">Query.serverVersion</span></a></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | Given the 'ServeOptionsRaw' parsed from the arg parser,</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- postprocess the db url and fetch env vars associated with the main</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- command parser, then process the subcommand raw values if</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- necessary.</span><span>
</span><span id="line-100"></span><span id="local-6989586621687649847"><span class="annot"><a href="Hasura.Server.Init.html#mkHGEOptions"><span class="hs-identifier hs-type">mkHGEOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Logging.html#EnabledLogTypes"><span class="hs-identifier hs-type">Logging.EnabledLogTypes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687649847"><span class="hs-identifier hs-type">impl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#HGEOptionsRaw"><span class="hs-identifier hs-type">HGEOptionsRaw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Init.Config.html#ServeOptionsRaw"><span class="hs-identifier hs-type">ServeOptionsRaw</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687649847"><span class="hs-identifier hs-type">impl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Env.html#WithEnv"><span class="hs-identifier hs-type">WithEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Init.Config.html#HGEOptions"><span class="hs-identifier hs-type">HGEOptions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Init.Config.html#ServeOptions"><span class="hs-identifier hs-type">ServeOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687649847"><span class="hs-identifier hs-type">impl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-102"></span><span id="mkHGEOptions"><span class="annot"><span class="annottext">mkHGEOptions :: forall impl.
EnabledLogTypes impl =&gt;
HGEOptionsRaw (ServeOptionsRaw impl)
-&gt; WithEnv (HGEOptions (ServeOptions impl))
</span><a href="Hasura.Server.Init.html#mkHGEOptions"><span class="hs-identifier hs-var hs-var">mkHGEOptions</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Init.Config.html#HGEOptionsRaw"><span class="hs-identifier hs-type">HGEOptionsRaw</span></a></span><span> </span><span id="local-6989586621687650106"><span class="annot"><span class="annottext">PostgresConnInfo (Maybe PostgresConnInfoRaw)
</span><a href="#local-6989586621687650106"><span class="hs-identifier hs-var">rawDbUrl</span></a></span></span><span> </span><span id="local-6989586621687650107"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621687650107"><span class="hs-identifier hs-var">rawMetadataDbUrl</span></a></span></span><span> </span><span id="local-6989586621687650108"><span class="annot"><span class="annottext">HGECommand (ServeOptionsRaw impl)
</span><a href="#local-6989586621687650108"><span class="hs-identifier hs-var">rawCmd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-103"></span><span>  </span><span id="local-6989586621687650109"><span class="annot"><span class="annottext">PostgresConnInfo (Maybe UrlConf)
</span><a href="#local-6989586621687650109"><span class="hs-identifier hs-var">dbUrl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PostgresConnInfo (Maybe PostgresConnInfoRaw)
-&gt; WithEnv (PostgresConnInfo (Maybe UrlConf))
</span><a href="Hasura.Server.Init.html#processPostgresConnInfo"><span class="hs-identifier hs-var">processPostgresConnInfo</span></a></span><span> </span><span class="annot"><span class="annottext">PostgresConnInfo (Maybe PostgresConnInfoRaw)
</span><a href="#local-6989586621687650106"><span class="hs-identifier hs-var">rawDbUrl</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span id="local-6989586621687650110"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621687650110"><span class="hs-identifier hs-var">metadataDbUrl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Option () -&gt; WithEnvT Identity (Maybe String)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option () -&gt; WithEnvT m (Maybe option)
</span><a href="Hasura.Server.Init.Env.html#withOption"><span class="hs-identifier hs-var">withOption</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621687650107"><span class="hs-identifier hs-var">rawMetadataDbUrl</span></a></span><span> </span><span class="annot"><span class="annottext">Option ()
</span><a href="Hasura.Server.Init.Arg.html#metadataDbUrlOption"><span class="hs-identifier hs-var">metadataDbUrlOption</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621687650113"><span class="annot"><span class="annottext">HGECommand (ServeOptions impl)
</span><a href="#local-6989586621687650113"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HGECommand (ServeOptionsRaw impl)
</span><a href="#local-6989586621687650108"><span class="hs-identifier hs-var">rawCmd</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><a href="Hasura.Server.Init.Config.html#HCServe"><span class="hs-identifier hs-type">HCServe</span></a></span><span> </span><span id="local-6989586621687650115"><span class="annot"><span class="annottext">ServeOptionsRaw impl
</span><a href="#local-6989586621687650115"><span class="hs-identifier hs-var">rso</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ServeOptions impl -&gt; HGECommand (ServeOptions impl)
forall a. a -&gt; HGECommand a
</span><a href="Hasura.Server.Init.Config.html#HCServe"><span class="hs-identifier hs-var">HCServe</span></a></span><span> </span><span class="annot"><span class="annottext">(ServeOptions impl -&gt; HGECommand (ServeOptions impl))
-&gt; WithEnvT Identity (ServeOptions impl)
-&gt; WithEnvT Identity (HGECommand (ServeOptions impl))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ServeOptionsRaw impl -&gt; WithEnvT Identity (ServeOptions impl)
forall impl.
EnabledLogTypes impl =&gt;
ServeOptionsRaw impl -&gt; WithEnv (ServeOptions impl)
</span><a href="Hasura.Server.Init.html#mkServeOptions"><span class="hs-identifier hs-var">mkServeOptions</span></a></span><span> </span><span class="annot"><span class="annottext">ServeOptionsRaw impl
</span><a href="#local-6989586621687650115"><span class="hs-identifier hs-var">rso</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="annottext">HGECommand (ServeOptionsRaw impl)
</span><a href="Hasura.Server.Init.Config.html#HCExport"><span class="hs-identifier hs-var">HCExport</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HGECommand (ServeOptions impl)
-&gt; WithEnvT Identity (HGECommand (ServeOptions impl))
forall a. a -&gt; WithEnvT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">HGECommand (ServeOptions impl)
forall a. HGECommand a
</span><a href="Hasura.Server.Init.Config.html#HCExport"><span class="hs-identifier hs-var">HCExport</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><span class="annottext">HGECommand (ServeOptionsRaw impl)
</span><a href="Hasura.Server.Init.Config.html#HCClean"><span class="hs-identifier hs-var">HCClean</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HGECommand (ServeOptions impl)
-&gt; WithEnvT Identity (HGECommand (ServeOptions impl))
forall a. a -&gt; WithEnvT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">HGECommand (ServeOptions impl)
forall a. HGECommand a
</span><a href="Hasura.Server.Init.Config.html#HCClean"><span class="hs-identifier hs-var">HCClean</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">HGECommand (ServeOptionsRaw impl)
</span><a href="Hasura.Server.Init.Config.html#HCVersion"><span class="hs-identifier hs-var">HCVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HGECommand (ServeOptions impl)
-&gt; WithEnvT Identity (HGECommand (ServeOptions impl))
forall a. a -&gt; WithEnvT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">HGECommand (ServeOptions impl)
forall a. HGECommand a
</span><a href="Hasura.Server.Init.Config.html#HCVersion"><span class="hs-identifier hs-var">HCVersion</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><a href="Hasura.Server.Init.Config.html#HCDowngrade"><span class="hs-identifier hs-type">HCDowngrade</span></a></span><span> </span><span id="local-6989586621687650120"><span class="annot"><span class="annottext">DowngradeOptions
</span><a href="#local-6989586621687650120"><span class="hs-identifier hs-var">tgt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HGECommand (ServeOptions impl)
-&gt; WithEnvT Identity (HGECommand (ServeOptions impl))
forall a. a -&gt; WithEnvT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DowngradeOptions -&gt; HGECommand (ServeOptions impl)
forall a. DowngradeOptions -&gt; HGECommand a
</span><a href="Hasura.Server.Init.Config.html#HCDowngrade"><span class="hs-identifier hs-var">HCDowngrade</span></a></span><span> </span><span class="annot"><span class="annottext">DowngradeOptions
</span><a href="#local-6989586621687650120"><span class="hs-identifier hs-var">tgt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="annottext">HGEOptions (ServeOptions impl)
-&gt; WithEnv (HGEOptions (ServeOptions impl))
forall a. a -&gt; WithEnvT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(HGEOptions (ServeOptions impl)
 -&gt; WithEnv (HGEOptions (ServeOptions impl)))
-&gt; HGEOptions (ServeOptions impl)
-&gt; WithEnv (HGEOptions (ServeOptions impl))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PostgresConnInfo (Maybe UrlConf)
-&gt; Maybe String
-&gt; HGECommand (ServeOptions impl)
-&gt; HGEOptions (ServeOptions impl)
forall impl.
PostgresConnInfo (Maybe UrlConf)
-&gt; Maybe String -&gt; HGECommand impl -&gt; HGEOptions impl
</span><a href="Hasura.Server.Init.Config.html#HGEOptions"><span class="hs-identifier hs-var">HGEOptions</span></a></span><span> </span><span class="annot"><span class="annottext">PostgresConnInfo (Maybe UrlConf)
</span><a href="#local-6989586621687650109"><span class="hs-identifier hs-var">dbUrl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621687650110"><span class="hs-identifier hs-var">metadataDbUrl</span></a></span><span> </span><span class="annot"><span class="annottext">HGECommand (ServeOptions impl)
</span><a href="#local-6989586621687650113"><span class="hs-identifier hs-var">cmd</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | 'PostressConnInfo' is a a tuple of some @a@ with a 'Maybe Int'</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- representing the retries setting. This function thus takes a</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- retries setting and a 'PostgresConnInfoRaw' from the arg parser and</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- merges those results with the contents of their corresponding env</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- vars.</span><span>
</span><span id="line-118"></span><span class="annot"><a href="Hasura.Server.Init.html#processPostgresConnInfo"><span class="hs-identifier hs-type">processPostgresConnInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><a href="Hasura.Server.Init.Config.html#PostgresConnInfo"><span class="hs-identifier hs-type">PostgresConnInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#PostgresConnInfoRaw"><span class="hs-identifier hs-type">PostgresConnInfoRaw</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><a href="Hasura.Server.Init.Env.html#WithEnv"><span class="hs-identifier hs-type">WithEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Init.Config.html#PostgresConnInfo"><span class="hs-identifier hs-type">PostgresConnInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#UrlConf"><span class="hs-identifier hs-type">Common.UrlConf</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span id="processPostgresConnInfo"><span class="annot"><span class="annottext">processPostgresConnInfo :: PostgresConnInfo (Maybe PostgresConnInfoRaw)
-&gt; WithEnv (PostgresConnInfo (Maybe UrlConf))
</span><a href="Hasura.Server.Init.html#processPostgresConnInfo"><span class="hs-identifier hs-var hs-var">processPostgresConnInfo</span></a></span></span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#PostgresConnInfo"><span class="hs-identifier hs-type">PostgresConnInfo</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687650123"><span id="local-6989586621687650124"><span class="annot"><span class="annottext">Maybe Int
Maybe PostgresConnInfoRaw
_pciDatabaseConn :: Maybe PostgresConnInfoRaw
_pciRetries :: Maybe Int
_pciDatabaseConn :: forall a. PostgresConnInfo a -&gt; a
_pciRetries :: forall a. PostgresConnInfo a -&gt; Maybe Int
</span><a href="#local-6989586621687650123"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621687650127"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687650127"><span class="hs-identifier hs-var">withEnvRetries</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Option () -&gt; WithEnvT Identity (Maybe Int)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option () -&gt; WithEnvT m (Maybe option)
</span><a href="Hasura.Server.Init.Env.html#withOption"><span class="hs-identifier hs-var">withOption</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687650124"><span class="hs-identifier hs-var">_pciRetries</span></a></span><span> </span><span class="annot"><span class="annottext">Option ()
</span><a href="Hasura.Server.Init.Arg.html#retriesNumOption"><span class="hs-identifier hs-var">retriesNumOption</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621687650129"><span class="annot"><span class="annottext">Maybe UrlConf
</span><a href="#local-6989586621687650129"><span class="hs-identifier hs-var">databaseUrl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe PostgresConnInfoRaw -&gt; WithEnv (Maybe UrlConf)
</span><a href="Hasura.Server.Init.html#rawConnInfoToUrlConf"><span class="hs-identifier hs-var">rawConnInfoToUrlConf</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PostgresConnInfoRaw
</span><a href="#local-6989586621687650123"><span class="hs-identifier hs-var">_pciDatabaseConn</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><span class="annottext">PostgresConnInfo (Maybe UrlConf)
-&gt; WithEnv (PostgresConnInfo (Maybe UrlConf))
forall a. a -&gt; WithEnvT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PostgresConnInfo (Maybe UrlConf)
 -&gt; WithEnv (PostgresConnInfo (Maybe UrlConf)))
-&gt; PostgresConnInfo (Maybe UrlConf)
-&gt; WithEnv (PostgresConnInfo (Maybe UrlConf))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe UrlConf -&gt; Maybe Int -&gt; PostgresConnInfo (Maybe UrlConf)
forall a. a -&gt; Maybe Int -&gt; PostgresConnInfo a
</span><a href="Hasura.Server.Init.Config.html#PostgresConnInfo"><span class="hs-identifier hs-var">PostgresConnInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UrlConf
</span><a href="#local-6989586621687650129"><span class="hs-identifier hs-var">databaseUrl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687650127"><span class="hs-identifier hs-var">withEnvRetries</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- | A helper function for 'processPostgresConnInfo' which fetches</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- postgres connection info from the 'WithEnv' and merges it with the</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- arg parser result.</span><span>
</span><span id="line-129"></span><span class="annot"><a href="Hasura.Server.Init.html#rawConnInfoToUrlConf"><span class="hs-identifier hs-type">rawConnInfoToUrlConf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#PostgresConnInfoRaw"><span class="hs-identifier hs-type">PostgresConnInfoRaw</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Env.html#WithEnv"><span class="hs-identifier hs-type">WithEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#UrlConf"><span class="hs-identifier hs-type">Common.UrlConf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span id="rawConnInfoToUrlConf"><span class="annot"><span class="annottext">rawConnInfoToUrlConf :: Maybe PostgresConnInfoRaw -&gt; WithEnv (Maybe UrlConf)
</span><a href="Hasura.Server.Init.html#rawConnInfoToUrlConf"><span class="hs-identifier hs-var hs-var">rawConnInfoToUrlConf</span></a></span></span><span> </span><span id="local-6989586621687650131"><span class="annot"><span class="annottext">Maybe PostgresConnInfoRaw
</span><a href="#local-6989586621687650131"><span class="hs-identifier hs-var">maybeRawConnInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-131"></span><span>  </span><span id="local-6989586621687650132"><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621687650132"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WithEnvT Identity [(String, String)]
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687650134"><span class="annot"><span class="annottext">databaseUrlEnvVar :: String
</span><a href="#local-6989586621687650134"><span class="hs-identifier hs-var hs-var">databaseUrlEnvVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Option () -&gt; String
forall def. Option def -&gt; String
</span><a href="Hasura.Server.Init.Config.html#_envVar"><span class="hs-identifier hs-var">_envVar</span></a></span><span> </span><span class="annot"><span class="annottext">Option ()
</span><a href="Hasura.Server.Init.Arg.html#databaseUrlOption"><span class="hs-identifier hs-var">databaseUrlOption</span></a></span><span>
</span><span id="line-133"></span><span>      </span><span id="local-6989586621687650137"><span class="annot"><span class="annottext">hasDatabaseUrlEnv :: Bool
</span><a href="#local-6989586621687650137"><span class="hs-identifier hs-var hs-var">hasDatabaseUrlEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((String, String) -&gt; Bool) -&gt; [(String, String)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621687650134"><span class="hs-identifier hs-var">databaseUrlEnvVar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool)
-&gt; ((String, String) -&gt; String) -&gt; (String, String) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String, String) -&gt; String
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621687650132"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span>  </span><span class="annot"><span class="annottext">Maybe UrlConf -&gt; WithEnv (Maybe UrlConf)
forall a. a -&gt; WithEnvT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe UrlConf -&gt; WithEnv (Maybe UrlConf))
-&gt; Maybe UrlConf -&gt; WithEnv (Maybe UrlConf)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe PostgresConnInfoRaw
</span><a href="#local-6989586621687650131"><span class="hs-identifier hs-var">maybeRawConnInfo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-comment">-- If no --database-url or connection options provided in CLI command</span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><span class="annottext">Maybe PostgresConnInfoRaw
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-138"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687650137"><span class="hs-identifier hs-var">hasDatabaseUrlEnv</span></a></span><span>
</span><span id="line-139"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-comment">-- Consider env variable as is in order to store it as @`UrlConf`</span><span>
</span><span id="line-140"></span><span>        </span><span class="hs-comment">-- in default source configuration in metadata</span><span>
</span><span id="line-141"></span><span>          </span><span class="annot"><span class="annottext">UrlConf -&gt; Maybe UrlConf
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(UrlConf -&gt; Maybe UrlConf) -&gt; UrlConf -&gt; Maybe UrlConf
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; UrlConf
</span><a href="Hasura.RQL.Types.Common.html#UrlFromEnv"><span class="hs-identifier hs-var">Common.UrlFromEnv</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; UrlConf) -&gt; Text -&gt; UrlConf
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/text-2.0.1-d0f6d61f5277bae932134563876cbceb4967915f364959864c72abbc2978d8ed/share/doc/html/src/Data.Text.html#pack"><span class="hs-identifier hs-var">Text.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621687650134"><span class="hs-identifier hs-var">databaseUrlEnvVar</span></a></span><span>
</span><span id="line-142"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe UrlConf
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621687650142"><span class="annot"><span class="annottext">PostgresConnInfoRaw
</span><a href="#local-6989586621687650142"><span class="hs-identifier hs-var">databaseConn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-144"></span><span>      </span><span class="annot"><span class="annottext">UrlConf -&gt; Maybe UrlConf
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(UrlConf -&gt; Maybe UrlConf)
-&gt; (Template -&gt; UrlConf) -&gt; Template -&gt; Maybe UrlConf
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">InputWebhook -&gt; UrlConf
</span><a href="Hasura.RQL.Types.Common.html#UrlValue"><span class="hs-identifier hs-var">Common.UrlValue</span></a></span><span> </span><span class="annot"><span class="annottext">(InputWebhook -&gt; UrlConf)
-&gt; (Template -&gt; InputWebhook) -&gt; Template -&gt; UrlConf
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Template -&gt; InputWebhook
</span><a href="Hasura.RQL.Types.Common.html#InputWebhook"><span class="hs-identifier hs-var">Common.InputWebhook</span></a></span><span> </span><span class="annot"><span class="annottext">(Template -&gt; Maybe UrlConf) -&gt; Template -&gt; Maybe UrlConf
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PostgresConnInfoRaw
</span><a href="#local-6989586621687650142"><span class="hs-identifier hs-var">databaseConn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><a href="Hasura.Server.Init.Config.html#PGConnDatabaseUrl"><span class="hs-identifier hs-type">PGConnDatabaseUrl</span></a></span><span> </span><span id="local-6989586621687650146"><span class="annot"><span class="annottext">Template
</span><a href="#local-6989586621687650146"><span class="hs-identifier hs-var">urlTemplate</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Template
</span><a href="#local-6989586621687650146"><span class="hs-identifier hs-var">urlTemplate</span></a></span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><a href="Hasura.Server.Init.Config.html#PGConnDetails"><span class="hs-identifier hs-type">PGConnDetails</span></a></span><span> </span><span id="local-6989586621687650148"><span class="annot"><span class="annottext">PostgresConnDetailsRaw
</span><a href="#local-6989586621687650148"><span class="hs-identifier hs-var">connDetails</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PostgresConnDetailsRaw -&gt; Template
</span><a href="Hasura.Server.Init.Config.html#rawConnDetailsToUrl"><span class="hs-identifier hs-var">rawConnDetailsToUrl</span></a></span><span> </span><span class="annot"><span class="annottext">PostgresConnDetailsRaw
</span><a href="#local-6989586621687650148"><span class="hs-identifier hs-var">connDetails</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- | Merge the results of the serve subcommmand arg parser with</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- corresponding values from the 'WithEnv' context.</span><span>
</span><span id="line-152"></span><span class="annot"><a href="Hasura.Server.Init.html#mkServeOptions"><span class="hs-identifier hs-type">mkServeOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687649864"><span class="annot"><a href="#local-6989586621687649864"><span class="hs-identifier hs-type">impl</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Logging.html#EnabledLogTypes"><span class="hs-identifier hs-type">Logging.EnabledLogTypes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687649864"><span class="hs-identifier hs-type">impl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#ServeOptionsRaw"><span class="hs-identifier hs-type">ServeOptionsRaw</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687649864"><span class="hs-identifier hs-type">impl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Env.html#WithEnv"><span class="hs-identifier hs-type">WithEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Init.Config.html#ServeOptions"><span class="hs-identifier hs-type">ServeOptions</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687649864"><span class="hs-identifier hs-type">impl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span id="mkServeOptions"><span class="annot"><span class="annottext">mkServeOptions :: forall impl.
EnabledLogTypes impl =&gt;
ServeOptionsRaw impl -&gt; WithEnv (ServeOptions impl)
</span><a href="Hasura.Server.Init.html#mkServeOptions"><span class="hs-identifier hs-var hs-var">mkServeOptions</span></a></span></span><span> </span><span id="local-6989586621687650362"><span class="annot"><span class="annottext">sor :: ServeOptionsRaw impl
</span><a href="#local-6989586621687650362"><span class="hs-identifier hs-var">sor</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Hasura.Server.Init.Config.html#ServeOptionsRaw"><span class="hs-identifier hs-type">ServeOptionsRaw</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687650363"><span id="local-6989586621687650364"><span id="local-6989586621687650365"><span id="local-6989586621687650366"><span id="local-6989586621687650367"><span id="local-6989586621687650368"><span id="local-6989586621687650369"><span id="local-6989586621687650370"><span id="local-6989586621687650371"><span id="local-6989586621687650372"><span id="local-6989586621687650373"><span id="local-6989586621687650374"><span id="local-6989586621687650375"><span id="local-6989586621687650376"><span id="local-6989586621687650377"><span id="local-6989586621687650378"><span id="local-6989586621687650379"><span id="local-6989586621687650380"><span id="local-6989586621687650381"><span id="local-6989586621687650382"><span id="local-6989586621687650383"><span id="local-6989586621687650384"><span id="local-6989586621687650385"><span id="local-6989586621687650386"><span id="local-6989586621687650387"><span id="local-6989586621687650388"><span id="local-6989586621687650389"><span id="local-6989586621687650390"><span id="local-6989586621687650391"><span id="local-6989586621687650392"><span id="local-6989586621687650393"><span id="local-6989586621687650394"><span id="local-6989586621687650395"><span id="local-6989586621687650396"><span id="local-6989586621687650397"><span id="local-6989586621687650398"><span id="local-6989586621687650399"><span id="local-6989586621687650400"><span id="local-6989586621687650401"><span id="local-6989586621687650402"><span id="local-6989586621687650403"><span id="local-6989586621687650404"><span id="local-6989586621687650405"><span id="local-6989586621687650406"><span id="local-6989586621687650407"><span id="local-6989586621687650408"><span id="local-6989586621687650409"><span id="local-6989586621687650410"><span class="annot"><span class="annottext">Maybe Int
Maybe Text
Maybe HostPreference
Maybe (HashSet ExperimentalFeature)
Maybe (HashSet (EngineLogType impl))
Maybe (HashSet API)
Maybe TxIsolation
Maybe (Refined NonNegative Int)
Maybe (Refined NonNegative Milliseconds)
Maybe (Refined NonNegative Seconds)
Maybe (Refined Positive Int)
Maybe RefetchInterval
Maybe BatchSize
Maybe NamingCase
Maybe RoleName
Maybe InferFunctionPermissions
Maybe RemoteNullForwardingPolicy
Maybe DangerouslyCollapseBooleans
Maybe ExtensionsSchema
Maybe CloseWebsocketsOnMetadataChangeStatus
Maybe TriggersErrorLogLevelStatus
Maybe ApolloFederationStatus
Maybe CorsConfig
Maybe LogLevel
Maybe JWTConfig
Maybe AdminSecretHash
Maybe MetadataDefaults
Maybe WSConnectionInitTimeout
Maybe KeepAliveDelay
Maybe OptionalInterval
Maybe Port
Maybe TelemetryStatus
Maybe AdminInternalErrorsStatus
CompressionOptions
RemoteSchemaPermissions
StringifyNumbers
MaintenanceMode ()
MetadataQueryLoggingMode
ConnParamsRaw
AuthHookRaw
WsReadCookieStatus
DevModeStatus
AllowListStatus
ConsoleStatus
rsoPort :: Maybe Port
rsoHost :: Maybe HostPreference
rsoConnParams :: ConnParamsRaw
rsoTxIso :: Maybe TxIsolation
rsoAdminSecret :: Maybe AdminSecretHash
rsoAuthHook :: AuthHookRaw
rsoJwtSecret :: Maybe JWTConfig
rsoUnAuthRole :: Maybe RoleName
rsoCorsConfig :: Maybe CorsConfig
rsoConsoleStatus :: ConsoleStatus
rsoConsoleAssetsDir :: Maybe Text
rsoConsoleSentryDsn :: Maybe Text
rsoEnableTelemetry :: Maybe TelemetryStatus
rsoWsReadCookie :: WsReadCookieStatus
rsoStringifyNum :: StringifyNumbers
rsoDangerousBooleanCollapse :: Maybe DangerouslyCollapseBooleans
rsoRemoteNullForwardingPolicy :: Maybe RemoteNullForwardingPolicy
rsoEnabledAPIs :: Maybe (HashSet API)
rsoMxRefetchInt :: Maybe RefetchInterval
rsoMxBatchSize :: Maybe BatchSize
rsoStreamingMxRefetchInt :: Maybe RefetchInterval
rsoStreamingMxBatchSize :: Maybe BatchSize
rsoEnableAllowList :: AllowListStatus
rsoEnabledLogTypes :: Maybe (HashSet (EngineLogType impl))
rsoLogLevel :: Maybe LogLevel
rsoDevMode :: DevModeStatus
rsoAdminInternalErrors :: Maybe AdminInternalErrorsStatus
rsoEventsHttpPoolSize :: Maybe (Refined Positive Int)
rsoEventsFetchInterval :: Maybe (Refined NonNegative Milliseconds)
rsoAsyncActionsFetchInterval :: Maybe OptionalInterval
rsoEnableRemoteSchemaPermissions :: RemoteSchemaPermissions
rsoWebSocketCompression :: CompressionOptions
rsoWebSocketKeepAlive :: Maybe KeepAliveDelay
rsoInferFunctionPermissions :: Maybe InferFunctionPermissions
rsoEnableMaintenanceMode :: MaintenanceMode ()
rsoSchemaPollInterval :: Maybe OptionalInterval
rsoExperimentalFeatures :: Maybe (HashSet ExperimentalFeature)
rsoEventsFetchBatchSize :: Maybe (Refined NonNegative Int)
rsoGracefulShutdownTimeout :: Maybe (Refined NonNegative Seconds)
rsoWebSocketConnectionInitTimeout :: Maybe WSConnectionInitTimeout
rsoEnableMetadataQueryLoggingEnv :: MetadataQueryLoggingMode
rsoDefaultNamingConvention :: Maybe NamingCase
rsoExtensionsSchema :: Maybe ExtensionsSchema
rsoMetadataDefaults :: Maybe MetadataDefaults
rsoApolloFederationStatus :: Maybe ApolloFederationStatus
rsoCloseWebsocketsOnMetadataChangeStatus :: Maybe CloseWebsocketsOnMetadataChangeStatus
rsoMaxTotalHeaderLength :: Maybe Int
rsoTriggersErrorLogLevelStatus :: Maybe TriggersErrorLogLevelStatus
rsoPort :: forall impl. ServeOptionsRaw impl -&gt; Maybe Port
rsoHost :: forall impl. ServeOptionsRaw impl -&gt; Maybe HostPreference
rsoConnParams :: forall impl. ServeOptionsRaw impl -&gt; ConnParamsRaw
rsoTxIso :: forall impl. ServeOptionsRaw impl -&gt; Maybe TxIsolation
rsoAdminSecret :: forall impl. ServeOptionsRaw impl -&gt; Maybe AdminSecretHash
rsoAuthHook :: forall impl. ServeOptionsRaw impl -&gt; AuthHookRaw
rsoJwtSecret :: forall impl. ServeOptionsRaw impl -&gt; Maybe JWTConfig
rsoUnAuthRole :: forall impl. ServeOptionsRaw impl -&gt; Maybe RoleName
rsoCorsConfig :: forall impl. ServeOptionsRaw impl -&gt; Maybe CorsConfig
rsoConsoleStatus :: forall impl. ServeOptionsRaw impl -&gt; ConsoleStatus
rsoConsoleAssetsDir :: forall impl. ServeOptionsRaw impl -&gt; Maybe Text
rsoConsoleSentryDsn :: forall impl. ServeOptionsRaw impl -&gt; Maybe Text
rsoEnableTelemetry :: forall impl. ServeOptionsRaw impl -&gt; Maybe TelemetryStatus
rsoWsReadCookie :: forall impl. ServeOptionsRaw impl -&gt; WsReadCookieStatus
rsoStringifyNum :: forall impl. ServeOptionsRaw impl -&gt; StringifyNumbers
rsoDangerousBooleanCollapse :: forall impl.
ServeOptionsRaw impl -&gt; Maybe DangerouslyCollapseBooleans
rsoRemoteNullForwardingPolicy :: forall impl.
ServeOptionsRaw impl -&gt; Maybe RemoteNullForwardingPolicy
rsoEnabledAPIs :: forall impl. ServeOptionsRaw impl -&gt; Maybe (HashSet API)
rsoMxRefetchInt :: forall impl. ServeOptionsRaw impl -&gt; Maybe RefetchInterval
rsoMxBatchSize :: forall impl. ServeOptionsRaw impl -&gt; Maybe BatchSize
rsoStreamingMxRefetchInt :: forall impl. ServeOptionsRaw impl -&gt; Maybe RefetchInterval
rsoStreamingMxBatchSize :: forall impl. ServeOptionsRaw impl -&gt; Maybe BatchSize
rsoEnableAllowList :: forall impl. ServeOptionsRaw impl -&gt; AllowListStatus
rsoEnabledLogTypes :: forall impl.
ServeOptionsRaw impl -&gt; Maybe (HashSet (EngineLogType impl))
rsoLogLevel :: forall impl. ServeOptionsRaw impl -&gt; Maybe LogLevel
rsoDevMode :: forall impl. ServeOptionsRaw impl -&gt; DevModeStatus
rsoAdminInternalErrors :: forall impl.
ServeOptionsRaw impl -&gt; Maybe AdminInternalErrorsStatus
rsoEventsHttpPoolSize :: forall impl. ServeOptionsRaw impl -&gt; Maybe (Refined Positive Int)
rsoEventsFetchInterval :: forall impl.
ServeOptionsRaw impl -&gt; Maybe (Refined NonNegative Milliseconds)
rsoAsyncActionsFetchInterval :: forall impl. ServeOptionsRaw impl -&gt; Maybe OptionalInterval
rsoEnableRemoteSchemaPermissions :: forall impl. ServeOptionsRaw impl -&gt; RemoteSchemaPermissions
rsoWebSocketCompression :: forall impl. ServeOptionsRaw impl -&gt; CompressionOptions
rsoWebSocketKeepAlive :: forall impl. ServeOptionsRaw impl -&gt; Maybe KeepAliveDelay
rsoInferFunctionPermissions :: forall impl. ServeOptionsRaw impl -&gt; Maybe InferFunctionPermissions
rsoEnableMaintenanceMode :: forall impl. ServeOptionsRaw impl -&gt; MaintenanceMode ()
rsoSchemaPollInterval :: forall impl. ServeOptionsRaw impl -&gt; Maybe OptionalInterval
rsoExperimentalFeatures :: forall impl.
ServeOptionsRaw impl -&gt; Maybe (HashSet ExperimentalFeature)
rsoEventsFetchBatchSize :: forall impl.
ServeOptionsRaw impl -&gt; Maybe (Refined NonNegative Int)
rsoGracefulShutdownTimeout :: forall impl.
ServeOptionsRaw impl -&gt; Maybe (Refined NonNegative Seconds)
rsoWebSocketConnectionInitTimeout :: forall impl. ServeOptionsRaw impl -&gt; Maybe WSConnectionInitTimeout
rsoEnableMetadataQueryLoggingEnv :: forall impl. ServeOptionsRaw impl -&gt; MetadataQueryLoggingMode
rsoDefaultNamingConvention :: forall impl. ServeOptionsRaw impl -&gt; Maybe NamingCase
rsoExtensionsSchema :: forall impl. ServeOptionsRaw impl -&gt; Maybe ExtensionsSchema
rsoMetadataDefaults :: forall impl. ServeOptionsRaw impl -&gt; Maybe MetadataDefaults
rsoApolloFederationStatus :: forall impl. ServeOptionsRaw impl -&gt; Maybe ApolloFederationStatus
rsoCloseWebsocketsOnMetadataChangeStatus :: forall impl.
ServeOptionsRaw impl -&gt; Maybe CloseWebsocketsOnMetadataChangeStatus
rsoMaxTotalHeaderLength :: forall impl. ServeOptionsRaw impl -&gt; Maybe Int
rsoTriggersErrorLogLevelStatus :: forall impl.
ServeOptionsRaw impl -&gt; Maybe TriggersErrorLogLevelStatus
</span><a href="#local-6989586621687650363"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-154"></span><span>  </span><span id="local-6989586621687650459"><span class="annot"><span class="annottext">Port
</span><a href="#local-6989586621687650459"><span class="hs-identifier hs-var">soPort</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Port -&gt; Option Port -&gt; WithEnvT Identity Port
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Port
</span><a href="#local-6989586621687650363"><span class="hs-identifier hs-var">rsoPort</span></a></span><span> </span><span class="annot"><span class="annottext">Option Port
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#servePortOption"><span class="hs-identifier hs-var">servePortOption</span></a></span><span>
</span><span id="line-155"></span><span>  </span><span id="local-6989586621687650462"><span class="annot"><span class="annottext">HostPreference
</span><a href="#local-6989586621687650462"><span class="hs-identifier hs-var">soHost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe HostPreference
-&gt; Option HostPreference -&gt; WithEnvT Identity HostPreference
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe HostPreference
</span><a href="#local-6989586621687650364"><span class="hs-identifier hs-var">rsoHost</span></a></span><span> </span><span class="annot"><span class="annottext">Option HostPreference
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#serveHostOption"><span class="hs-identifier hs-var">serveHostOption</span></a></span><span>
</span><span id="line-156"></span><span>  </span><span id="local-6989586621687650464"><span class="annot"><span class="annottext">ConnParams
</span><a href="#local-6989586621687650464"><span class="hs-identifier hs-var">soConnParams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ConnParamsRaw -&gt; WithEnvT Identity ConnParams
forall (m :: * -&gt; *).
Monad m =&gt;
ConnParamsRaw -&gt; WithEnvT m ConnParams
</span><a href="Hasura.Server.Init.html#mkConnParams"><span class="hs-identifier hs-var">mkConnParams</span></a></span><span> </span><span class="annot"><span class="annottext">ConnParamsRaw
</span><a href="#local-6989586621687650365"><span class="hs-identifier hs-var">rsoConnParams</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621687650466"><span class="annot"><span class="annottext">TxIsolation
</span><a href="#local-6989586621687650466"><span class="hs-identifier hs-var">soTxIso</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe TxIsolation
-&gt; Option TxIsolation -&gt; WithEnvT Identity TxIsolation
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TxIsolation
</span><a href="#local-6989586621687650366"><span class="hs-identifier hs-var">rsoTxIso</span></a></span><span> </span><span class="annot"><span class="annottext">Option TxIsolation
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#txIsolationOption"><span class="hs-identifier hs-var">txIsolationOption</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span id="local-6989586621687650468"><span class="annot"><span class="annottext">HashSet AdminSecretHash
</span><a href="#local-6989586621687650468"><span class="hs-identifier hs-var">soAdminSecret</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HashSet AdminSecretHash
-&gt; (AdminSecretHash -&gt; HashSet AdminSecretHash)
-&gt; Maybe AdminSecretHash
-&gt; HashSet AdminSecretHash
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">HashSet AdminSecretHash
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AdminSecretHash -&gt; HashSet AdminSecretHash
forall a. Hashable a =&gt; a -&gt; HashSet a
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashSet.Internal.html#singleton"><span class="hs-identifier hs-var">HashSet.singleton</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe AdminSecretHash -&gt; HashSet AdminSecretHash)
-&gt; WithEnvT Identity (Maybe AdminSecretHash)
-&gt; WithEnvT Identity (HashSet AdminSecretHash)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe AdminSecretHash
-&gt; [Option ()] -&gt; WithEnvT Identity (Maybe AdminSecretHash)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; [Option ()] -&gt; WithEnvT m (Maybe option)
</span><a href="Hasura.Server.Init.Env.html#withOptions"><span class="hs-identifier hs-var">withOptions</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe AdminSecretHash
</span><a href="#local-6989586621687650367"><span class="hs-identifier hs-var">rsoAdminSecret</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Option ()
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#adminSecretOption"><span class="hs-identifier hs-var">adminSecretOption</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Option ()
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#accessKeyOption"><span class="hs-identifier hs-var">accessKeyOption</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-159"></span><span>  </span><span id="local-6989586621687650474"><span class="annot"><span class="annottext">Maybe AuthHook
</span><a href="#local-6989586621687650474"><span class="hs-identifier hs-var">soAuthHook</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AuthHookRaw -&gt; WithEnvT Identity (Maybe AuthHook)
forall (m :: * -&gt; *).
Monad m =&gt;
AuthHookRaw -&gt; WithEnvT m (Maybe AuthHook)
</span><a href="Hasura.Server.Init.html#mkAuthHook"><span class="hs-identifier hs-var">mkAuthHook</span></a></span><span> </span><span class="annot"><span class="annottext">AuthHookRaw
</span><a href="#local-6989586621687650368"><span class="hs-identifier hs-var">rsoAuthHook</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span id="local-6989586621687650476"><span class="annot"><span class="annottext">[JWTConfig]
</span><a href="#local-6989586621687650476"><span class="hs-identifier hs-var">soJwtSecret</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe JWTConfig -&gt; [JWTConfig]
forall a. Maybe a -&gt; [a]
</span><span class="hs-identifier hs-var">maybeToList</span></span><span> </span><span class="annot"><span class="annottext">(Maybe JWTConfig -&gt; [JWTConfig])
-&gt; WithEnvT Identity (Maybe JWTConfig)
-&gt; WithEnvT Identity [JWTConfig]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe JWTConfig -&gt; Option () -&gt; WithEnvT Identity (Maybe JWTConfig)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option () -&gt; WithEnvT m (Maybe option)
</span><a href="Hasura.Server.Init.Env.html#withOption"><span class="hs-identifier hs-var">withOption</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe JWTConfig
</span><a href="#local-6989586621687650369"><span class="hs-identifier hs-var">rsoJwtSecret</span></a></span><span> </span><span class="annot"><span class="annottext">Option ()
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#jwtSecretOption"><span class="hs-identifier hs-var">jwtSecretOption</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621687650479"><span class="annot"><span class="annottext">Maybe RoleName
</span><a href="#local-6989586621687650479"><span class="hs-identifier hs-var">soUnAuthRole</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe RoleName -&gt; Option () -&gt; WithEnvT Identity (Maybe RoleName)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option () -&gt; WithEnvT m (Maybe option)
</span><a href="Hasura.Server.Init.Env.html#withOption"><span class="hs-identifier hs-var">withOption</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RoleName
</span><a href="#local-6989586621687650370"><span class="hs-identifier hs-var">rsoUnAuthRole</span></a></span><span> </span><span class="annot"><span class="annottext">Option ()
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#unAuthRoleOption"><span class="hs-identifier hs-var">unAuthRoleOption</span></a></span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621687650481"><span class="annot"><span class="annottext">CorsConfig
</span><a href="#local-6989586621687650481"><span class="hs-identifier hs-var">soCorsConfig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ServeOptionsRaw impl
-&gt; Maybe CorsConfig -&gt; WithEnvT Identity CorsConfig
forall (m :: * -&gt; *) imp.
Monad m =&gt;
ServeOptionsRaw imp -&gt; Maybe CorsConfig -&gt; WithEnvT m CorsConfig
</span><a href="Hasura.Server.Init.html#mkCorsConfig"><span class="hs-identifier hs-var">mkCorsConfig</span></a></span><span> </span><span class="annot"><span class="annottext">ServeOptionsRaw impl
</span><a href="#local-6989586621687650362"><span class="hs-identifier hs-var">sor</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CorsConfig
</span><a href="#local-6989586621687650371"><span class="hs-identifier hs-var">rsoCorsConfig</span></a></span><span>
</span><span id="line-163"></span><span>  </span><span id="local-6989586621687650483"><span class="annot"><span class="annottext">ConsoleStatus
</span><a href="#local-6989586621687650483"><span class="hs-identifier hs-var">soConsoleStatus</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ConsoleStatus
-&gt; (ConsoleStatus -&gt; Bool, Bool -&gt; ConsoleStatus)
-&gt; Option ConsoleStatus
-&gt; WithEnvT Identity ConsoleStatus
forall (m :: * -&gt; *) a.
Monad m =&gt;
a -&gt; (a -&gt; Bool, Bool -&gt; a) -&gt; Option a -&gt; WithEnvT m a
</span><a href="Hasura.Server.Init.Env.html#withOptionSwitch%27"><span class="hs-identifier hs-var">withOptionSwitch'</span></a></span><span> </span><span class="annot"><span class="annottext">ConsoleStatus
</span><a href="#local-6989586621687650372"><span class="hs-identifier hs-var">rsoConsoleStatus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConsoleStatus -&gt; Bool
</span><a href="Hasura.Server.Init.Config.html#isConsoleEnabled"><span class="hs-identifier hs-var">isConsoleEnabled</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConsoleStatus -&gt; ConsoleStatus -&gt; Bool -&gt; ConsoleStatus
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="annot"><span class="annottext">ConsoleStatus
</span><a href="Hasura.Server.Init.Config.html#ConsoleDisabled"><span class="hs-identifier hs-var">ConsoleDisabled</span></a></span><span> </span><span class="annot"><span class="annottext">ConsoleStatus
</span><a href="Hasura.Server.Init.Config.html#ConsoleEnabled"><span class="hs-identifier hs-var">ConsoleEnabled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Option ConsoleStatus
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#enableConsoleOption"><span class="hs-identifier hs-var">enableConsoleOption</span></a></span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621687650490"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621687650490"><span class="hs-identifier hs-var">soConsoleAssetsDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; Option () -&gt; WithEnvT Identity (Maybe Text)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option () -&gt; WithEnvT m (Maybe option)
</span><a href="Hasura.Server.Init.Env.html#withOption"><span class="hs-identifier hs-var">withOption</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621687650373"><span class="hs-identifier hs-var">rsoConsoleAssetsDir</span></a></span><span> </span><span class="annot"><span class="annottext">Option ()
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#consoleAssetsDirOption"><span class="hs-identifier hs-var">consoleAssetsDirOption</span></a></span><span>
</span><span id="line-165"></span><span>  </span><span id="local-6989586621687650492"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621687650492"><span class="hs-identifier hs-var">soConsoleSentryDsn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; Option () -&gt; WithEnvT Identity (Maybe Text)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option () -&gt; WithEnvT m (Maybe option)
</span><a href="Hasura.Server.Init.Env.html#withOption"><span class="hs-identifier hs-var">withOption</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621687650374"><span class="hs-identifier hs-var">rsoConsoleSentryDsn</span></a></span><span> </span><span class="annot"><span class="annottext">Option ()
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#consoleSentryDsnOption"><span class="hs-identifier hs-var">consoleSentryDsnOption</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621687650494"><span class="annot"><span class="annottext">TelemetryStatus
</span><a href="#local-6989586621687650494"><span class="hs-identifier hs-var">soEnableTelemetry</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe TelemetryStatus
-&gt; Option TelemetryStatus -&gt; WithEnvT Identity TelemetryStatus
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TelemetryStatus
</span><a href="#local-6989586621687650375"><span class="hs-identifier hs-var">rsoEnableTelemetry</span></a></span><span> </span><span class="annot"><span class="annottext">Option TelemetryStatus
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#enableTelemetryOption"><span class="hs-identifier hs-var">enableTelemetryOption</span></a></span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621687650496"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687650496"><span class="hs-identifier hs-var">soStringifyNum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687650377"><span class="hs-identifier hs-var">rsoStringifyNum</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-169"></span><span>      </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="Hasura.RQL.Types.Schema.Options.html#Don%27tStringifyNumbers"><span class="hs-identifier hs-var">Options.Don'tStringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe StringifyNumbers
-&gt; Option StringifyNumbers -&gt; WithEnvT Identity StringifyNumbers
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StringifyNumbers
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Option StringifyNumbers
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#stringifyNumOption"><span class="hs-identifier hs-var">stringifyNumOption</span></a></span><span>
</span><span id="line-170"></span><span>      </span><span id="local-6989586621687650499"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687650499"><span class="hs-identifier hs-var">stringifyNums</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StringifyNumbers -&gt; WithEnvT Identity StringifyNumbers
forall a. a -&gt; WithEnvT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687650499"><span class="hs-identifier hs-var">stringifyNums</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span id="local-6989586621687650500"><span class="annot"><span class="annottext">DangerouslyCollapseBooleans
</span><a href="#local-6989586621687650500"><span class="hs-identifier hs-var">soDangerousBooleanCollapse</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe DangerouslyCollapseBooleans
-&gt; Option DangerouslyCollapseBooleans
-&gt; WithEnvT Identity DangerouslyCollapseBooleans
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe DangerouslyCollapseBooleans
</span><a href="#local-6989586621687650378"><span class="hs-identifier hs-var">rsoDangerousBooleanCollapse</span></a></span><span> </span><span class="annot"><span class="annottext">Option DangerouslyCollapseBooleans
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#dangerousBooleanCollapseOption"><span class="hs-identifier hs-var">dangerousBooleanCollapseOption</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621687650502"><span class="annot"><span class="annottext">RemoteNullForwardingPolicy
</span><a href="#local-6989586621687650502"><span class="hs-identifier hs-var">soRemoteNullForwardingPolicy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe RemoteNullForwardingPolicy
-&gt; Option RemoteNullForwardingPolicy
-&gt; WithEnvT Identity RemoteNullForwardingPolicy
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RemoteNullForwardingPolicy
</span><a href="#local-6989586621687650379"><span class="hs-identifier hs-var">rsoRemoteNullForwardingPolicy</span></a></span><span> </span><span class="annot"><span class="annottext">Option RemoteNullForwardingPolicy
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#remoteNullForwardingPolicyOption"><span class="hs-identifier hs-var">remoteNullForwardingPolicyOption</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span id="local-6989586621687650504"><span class="annot"><span class="annottext">HashSet API
</span><a href="#local-6989586621687650504"><span class="hs-identifier hs-var">soEnabledAPIs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (HashSet API)
-&gt; Option (HashSet API) -&gt; WithEnvT Identity (HashSet API)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HashSet API)
</span><a href="#local-6989586621687650380"><span class="hs-identifier hs-var">rsoEnabledAPIs</span></a></span><span> </span><span class="annot"><span class="annottext">Option (HashSet API)
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#enabledAPIsOption"><span class="hs-identifier hs-var">enabledAPIsOption</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621687650506"><span class="annot"><span class="annottext">SubscriptionsOptions
</span><a href="#local-6989586621687650506"><span class="hs-identifier hs-var">soLiveQueryOpts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621687650507"><span class="annot"><span class="annottext">RefetchInterval
</span><a href="#local-6989586621687650507"><span class="hs-identifier hs-var">_lqoRefetchInterval</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe RefetchInterval
-&gt; Option RefetchInterval -&gt; WithEnvT Identity RefetchInterval
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RefetchInterval
</span><a href="#local-6989586621687650381"><span class="hs-identifier hs-var">rsoMxRefetchInt</span></a></span><span> </span><span class="annot"><span class="annottext">Option RefetchInterval
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#mxRefetchDelayOption"><span class="hs-identifier hs-var">mxRefetchDelayOption</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621687650509"><span class="annot"><span class="annottext">BatchSize
</span><a href="#local-6989586621687650509"><span class="hs-identifier hs-var">_lqoBatchSize</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe BatchSize -&gt; Option BatchSize -&gt; WithEnvT Identity BatchSize
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe BatchSize
</span><a href="#local-6989586621687650382"><span class="hs-identifier hs-var">rsoMxBatchSize</span></a></span><span> </span><span class="annot"><span class="annottext">Option BatchSize
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#mxBatchSizeOption"><span class="hs-identifier hs-var">mxBatchSizeOption</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">SubscriptionsOptions -&gt; WithEnvT Identity SubscriptionsOptions
forall a. a -&gt; WithEnvT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(SubscriptionsOptions -&gt; WithEnvT Identity SubscriptionsOptions)
-&gt; SubscriptionsOptions -&gt; WithEnvT Identity SubscriptionsOptions
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.Subscription.Options.html#SubscriptionsOptions"><span class="hs-identifier hs-type">Subscription.Options.SubscriptionsOptions</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">RefetchInterval
BatchSize
_lqoRefetchInterval :: RefetchInterval
_lqoBatchSize :: BatchSize
_lqoBatchSize :: BatchSize
_lqoRefetchInterval :: RefetchInterval
</span><a href="#local-6989586621687650507"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-178"></span><span>  </span><span id="local-6989586621687650514"><span class="annot"><span class="annottext">SubscriptionsOptions
</span><a href="#local-6989586621687650514"><span class="hs-identifier hs-var">soStreamingQueryOpts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621687650515"><span class="annot"><span class="annottext">RefetchInterval
</span><a href="#local-6989586621687650515"><span class="hs-identifier hs-var">_lqoRefetchInterval</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe RefetchInterval
-&gt; Option RefetchInterval -&gt; WithEnvT Identity RefetchInterval
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RefetchInterval
</span><a href="#local-6989586621687650383"><span class="hs-identifier hs-var">rsoStreamingMxRefetchInt</span></a></span><span> </span><span class="annot"><span class="annottext">Option RefetchInterval
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#streamingMxRefetchDelayOption"><span class="hs-identifier hs-var">streamingMxRefetchDelayOption</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span id="local-6989586621687650517"><span class="annot"><span class="annottext">BatchSize
</span><a href="#local-6989586621687650517"><span class="hs-identifier hs-var">_lqoBatchSize</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe BatchSize -&gt; Option BatchSize -&gt; WithEnvT Identity BatchSize
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe BatchSize
</span><a href="#local-6989586621687650384"><span class="hs-identifier hs-var">rsoStreamingMxBatchSize</span></a></span><span> </span><span class="annot"><span class="annottext">Option BatchSize
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#streamingMxBatchSizeOption"><span class="hs-identifier hs-var">streamingMxBatchSizeOption</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><span class="annottext">SubscriptionsOptions -&gt; WithEnvT Identity SubscriptionsOptions
forall a. a -&gt; WithEnvT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(SubscriptionsOptions -&gt; WithEnvT Identity SubscriptionsOptions)
-&gt; SubscriptionsOptions -&gt; WithEnvT Identity SubscriptionsOptions
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.Subscription.Options.html#SubscriptionsOptions"><span class="hs-identifier hs-type">Subscription.Options.SubscriptionsOptions</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">RefetchInterval
BatchSize
_lqoBatchSize :: BatchSize
_lqoRefetchInterval :: RefetchInterval
_lqoRefetchInterval :: RefetchInterval
_lqoBatchSize :: BatchSize
</span><a href="Hasura.GraphQL.Execute.Subscription.Options.html#_lqoBatchSize"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-182"></span><span>  </span><span id="local-6989586621687650519"><span class="annot"><span class="annottext">AllowListStatus
</span><a href="#local-6989586621687650519"><span class="hs-identifier hs-var">soEnableAllowList</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AllowListStatus
-&gt; (AllowListStatus -&gt; Bool, Bool -&gt; AllowListStatus)
-&gt; Option AllowListStatus
-&gt; WithEnvT Identity AllowListStatus
forall (m :: * -&gt; *) a.
Monad m =&gt;
a -&gt; (a -&gt; Bool, Bool -&gt; a) -&gt; Option a -&gt; WithEnvT m a
</span><a href="Hasura.Server.Init.Env.html#withOptionSwitch%27"><span class="hs-identifier hs-var">withOptionSwitch'</span></a></span><span> </span><span class="annot"><span class="annottext">AllowListStatus
</span><a href="#local-6989586621687650385"><span class="hs-identifier hs-var">rsoEnableAllowList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AllowListStatus -&gt; Bool
</span><a href="Hasura.Server.Init.Config.html#isAllowListEnabled"><span class="hs-identifier hs-var">isAllowListEnabled</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AllowListStatus -&gt; AllowListStatus -&gt; Bool -&gt; AllowListStatus
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="annot"><span class="annottext">AllowListStatus
</span><a href="Hasura.Server.Init.Config.html#AllowListDisabled"><span class="hs-identifier hs-var">AllowListDisabled</span></a></span><span> </span><span class="annot"><span class="annottext">AllowListStatus
</span><a href="Hasura.Server.Init.Config.html#AllowListEnabled"><span class="hs-identifier hs-var">AllowListEnabled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Option AllowListStatus
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#enableAllowlistOption"><span class="hs-identifier hs-var">enableAllowlistOption</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span id="local-6989586621687650524"><span class="annot"><span class="annottext">HashSet (EngineLogType impl)
</span><a href="#local-6989586621687650524"><span class="hs-identifier hs-var">soEnabledLogTypes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (HashSet (EngineLogType impl))
-&gt; Option (HashSet (EngineLogType impl))
-&gt; WithEnvT Identity (HashSet (EngineLogType impl))
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HashSet (EngineLogType impl))
</span><a href="#local-6989586621687650386"><span class="hs-identifier hs-var">rsoEnabledLogTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall impl.
EnabledLogTypes impl =&gt;
Option (HashSet (EngineLogType impl))
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#enabledLogsOption"><span class="hs-identifier hs-var">enabledLogsOption</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621687649864"><span class="hs-identifier hs-type">impl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>  </span><span id="local-6989586621687650526"><span class="annot"><span class="annottext">LogLevel
</span><a href="#local-6989586621687650526"><span class="hs-identifier hs-var">soLogLevel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe LogLevel -&gt; Option LogLevel -&gt; WithEnvT Identity LogLevel
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe LogLevel
</span><a href="#local-6989586621687650387"><span class="hs-identifier hs-var">rsoLogLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Option LogLevel
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#logLevelOption"><span class="hs-identifier hs-var">logLevelOption</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621687650528"><span class="annot"><span class="annottext">DevModeStatus
</span><a href="#local-6989586621687650528"><span class="hs-identifier hs-var">soDevMode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DevModeStatus
-&gt; (DevModeStatus -&gt; Bool, Bool -&gt; DevModeStatus)
-&gt; Option DevModeStatus
-&gt; WithEnvT Identity DevModeStatus
forall (m :: * -&gt; *) a.
Monad m =&gt;
a -&gt; (a -&gt; Bool, Bool -&gt; a) -&gt; Option a -&gt; WithEnvT m a
</span><a href="Hasura.Server.Init.Env.html#withOptionSwitch%27"><span class="hs-identifier hs-var">withOptionSwitch'</span></a></span><span> </span><span class="annot"><span class="annottext">DevModeStatus
</span><a href="#local-6989586621687650388"><span class="hs-identifier hs-var">rsoDevMode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DevModeStatus -&gt; Bool
</span><a href="Hasura.Server.Init.Config.html#isDevModeEnabled"><span class="hs-identifier hs-var">isDevModeEnabled</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DevModeStatus -&gt; DevModeStatus -&gt; Bool -&gt; DevModeStatus
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="annot"><span class="annottext">DevModeStatus
</span><a href="Hasura.Server.Init.Config.html#DevModeDisabled"><span class="hs-identifier hs-var">DevModeDisabled</span></a></span><span> </span><span class="annot"><span class="annottext">DevModeStatus
</span><a href="Hasura.Server.Init.Config.html#DevModeEnabled"><span class="hs-identifier hs-var">DevModeEnabled</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Option DevModeStatus
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#graphqlDevModeOption"><span class="hs-identifier hs-var">graphqlDevModeOption</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span id="local-6989586621687650533"><span class="annot"><span class="annottext">AdminInternalErrorsStatus
</span><a href="#local-6989586621687650533"><span class="hs-identifier hs-var">soAdminInternalErrors</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe AdminInternalErrorsStatus
-&gt; Option AdminInternalErrorsStatus
-&gt; WithEnvT Identity AdminInternalErrorsStatus
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe AdminInternalErrorsStatus
</span><a href="#local-6989586621687650389"><span class="hs-identifier hs-var">rsoAdminInternalErrors</span></a></span><span> </span><span class="annot"><span class="annottext">Option AdminInternalErrorsStatus
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#graphqlAdminInternalErrorsOption"><span class="hs-identifier hs-var">graphqlAdminInternalErrorsOption</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span id="local-6989586621687650535"><span class="annot"><span class="annottext">Refined Positive Int
</span><a href="#local-6989586621687650535"><span class="hs-identifier hs-var">soEventsHttpPoolSize</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Refined Positive Int)
-&gt; Option (Refined Positive Int)
-&gt; WithEnvT Identity (Refined Positive Int)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Refined Positive Int)
</span><a href="#local-6989586621687650390"><span class="hs-identifier hs-var">rsoEventsHttpPoolSize</span></a></span><span> </span><span class="annot"><span class="annottext">Option (Refined Positive Int)
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#graphqlEventsHttpPoolSizeOption"><span class="hs-identifier hs-var">graphqlEventsHttpPoolSizeOption</span></a></span><span>
</span><span id="line-188"></span><span>  </span><span id="local-6989586621687650537"><span class="annot"><span class="annottext">Refined NonNegative Milliseconds
</span><a href="#local-6989586621687650537"><span class="hs-identifier hs-var">soEventsFetchInterval</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Refined NonNegative Milliseconds)
-&gt; Option (Refined NonNegative Milliseconds)
-&gt; WithEnvT Identity (Refined NonNegative Milliseconds)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Refined NonNegative Milliseconds)
</span><a href="#local-6989586621687650391"><span class="hs-identifier hs-var">rsoEventsFetchInterval</span></a></span><span> </span><span class="annot"><span class="annottext">Option (Refined NonNegative Milliseconds)
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#graphqlEventsFetchIntervalOption"><span class="hs-identifier hs-var">graphqlEventsFetchIntervalOption</span></a></span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621687650539"><span class="annot"><span class="annottext">OptionalInterval
</span><a href="#local-6989586621687650539"><span class="hs-identifier hs-var">soAsyncActionsFetchInterval</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe OptionalInterval
-&gt; Option OptionalInterval -&gt; WithEnvT Identity OptionalInterval
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OptionalInterval
</span><a href="#local-6989586621687650392"><span class="hs-identifier hs-var">rsoAsyncActionsFetchInterval</span></a></span><span> </span><span class="annot"><span class="annottext">Option OptionalInterval
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#asyncActionsFetchIntervalOption"><span class="hs-identifier hs-var">asyncActionsFetchIntervalOption</span></a></span><span>
</span><span id="line-190"></span><span>  </span><span id="local-6989586621687650541"><span class="annot"><span class="annottext">RemoteSchemaPermissions
</span><a href="#local-6989586621687650541"><span class="hs-identifier hs-var">soEnableRemoteSchemaPermissions</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RemoteSchemaPermissions
</span><a href="#local-6989586621687650393"><span class="hs-identifier hs-var">rsoEnableRemoteSchemaPermissions</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-192"></span><span>      </span><span class="annot"><span class="annottext">RemoteSchemaPermissions
</span><a href="Hasura.RQL.Types.Schema.Options.html#DisableRemoteSchemaPermissions"><span class="hs-identifier hs-var">Options.DisableRemoteSchemaPermissions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe RemoteSchemaPermissions
-&gt; Option RemoteSchemaPermissions
-&gt; WithEnvT Identity RemoteSchemaPermissions
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RemoteSchemaPermissions
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Option RemoteSchemaPermissions
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#enableRemoteSchemaPermsOption"><span class="hs-identifier hs-var">enableRemoteSchemaPermsOption</span></a></span><span>
</span><span id="line-193"></span><span>      </span><span id="local-6989586621687650544"><span class="annot"><span class="annottext">RemoteSchemaPermissions
</span><a href="#local-6989586621687650544"><span class="hs-identifier hs-var">enableRemoteSchemaPermissions</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RemoteSchemaPermissions
-&gt; WithEnvT Identity RemoteSchemaPermissions
forall a. a -&gt; WithEnvT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaPermissions
</span><a href="#local-6989586621687650544"><span class="hs-identifier hs-var">enableRemoteSchemaPermissions</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621687650545"><span class="annot"><span class="annottext">CompressionOptions
</span><a href="#local-6989586621687650545"><span class="hs-identifier hs-var">webSocketCompressionFromEnv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><span class="annottext">CompressionOptions
-&gt; (CompressionOptions -&gt; Bool, Bool -&gt; CompressionOptions)
-&gt; Option CompressionOptions
-&gt; WithEnvT Identity CompressionOptions
forall (m :: * -&gt; *) a.
Monad m =&gt;
a -&gt; (a -&gt; Bool, Bool -&gt; a) -&gt; Option a -&gt; WithEnvT m a
</span><a href="Hasura.Server.Init.Env.html#withOptionSwitch%27"><span class="hs-identifier hs-var">withOptionSwitch'</span></a></span><span> </span><span class="annot"><span class="annottext">CompressionOptions
</span><a href="#local-6989586621687650394"><span class="hs-identifier hs-var">rsoWebSocketCompression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompressionOptions -&gt; Bool
</span><a href="Hasura.Server.Init.Config.html#isWebSocketCompressionEnabled"><span class="hs-identifier hs-var">isWebSocketCompressionEnabled</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CompressionOptions
-&gt; CompressionOptions -&gt; Bool -&gt; CompressionOptions
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="annot"><span class="annottext">CompressionOptions
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/websockets-0.12.7.3-ace9e650e85dd6f2f2179ec47bba2f5dfacb8e002a1c77fe7c2fbe7ac37aed32/share/doc/html/src/Network.WebSockets.Connection.Options.html#NoCompression"><span class="hs-identifier hs-var">WebSockets.NoCompression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PermessageDeflate -&gt; CompressionOptions
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/websockets-0.12.7.3-ace9e650e85dd6f2f2179ec47bba2f5dfacb8e002a1c77fe7c2fbe7ac37aed32/share/doc/html/src/Network.WebSockets.Connection.Options.html#PermessageDeflateCompression"><span class="hs-identifier hs-var">WebSockets.PermessageDeflateCompression</span></a></span><span> </span><span class="annot"><span class="annottext">PermessageDeflate
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/websockets-0.12.7.3-ace9e650e85dd6f2f2179ec47bba2f5dfacb8e002a1c77fe7c2fbe7ac37aed32/share/doc/html/src/Network.WebSockets.Connection.Options.html#defaultPermessageDeflate"><span class="hs-identifier hs-var">WebSockets.defaultPermessageDeflate</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Option CompressionOptions
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#webSocketCompressionOption"><span class="hs-identifier hs-var">webSocketCompressionOption</span></a></span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687650551"><span class="annot"><span class="annottext">soConnectionOptions :: ConnectionOptions
</span><a href="#local-6989586621687650551"><span class="hs-identifier hs-var hs-var">soConnectionOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConnectionOptions
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/websockets-0.12.7.3-ace9e650e85dd6f2f2179ec47bba2f5dfacb8e002a1c77fe7c2fbe7ac37aed32/share/doc/html/src/Network.WebSockets.Connection.Options.html#defaultConnectionOptions"><span class="hs-identifier hs-var">WebSockets.defaultConnectionOptions</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">connectionCompressionOptions :: CompressionOptions
</span><a href="#local-6989586621687650553"><span class="hs-identifier hs-var">WebSockets.connectionCompressionOptions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompressionOptions
</span><a href="#local-6989586621687650545"><span class="hs-identifier hs-var">webSocketCompressionFromEnv</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-197"></span><span>  </span><span id="local-6989586621687650554"><span class="annot"><span class="annottext">KeepAliveDelay
</span><a href="#local-6989586621687650554"><span class="hs-identifier hs-var">soWebSocketKeepAlive</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe KeepAliveDelay
-&gt; Option KeepAliveDelay -&gt; WithEnvT Identity KeepAliveDelay
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe KeepAliveDelay
</span><a href="#local-6989586621687650395"><span class="hs-identifier hs-var">rsoWebSocketKeepAlive</span></a></span><span> </span><span class="annot"><span class="annottext">Option KeepAliveDelay
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#webSocketKeepAliveOption"><span class="hs-identifier hs-var">webSocketKeepAliveOption</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span id="local-6989586621687650556"><span class="annot"><span class="annottext">InferFunctionPermissions
</span><a href="#local-6989586621687650556"><span class="hs-identifier hs-var">soInferFunctionPermissions</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe InferFunctionPermissions
-&gt; Option InferFunctionPermissions
-&gt; WithEnvT Identity InferFunctionPermissions
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe InferFunctionPermissions
</span><a href="#local-6989586621687650396"><span class="hs-identifier hs-var">rsoInferFunctionPermissions</span></a></span><span> </span><span class="annot"><span class="annottext">Option InferFunctionPermissions
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#inferFunctionPermsOption"><span class="hs-identifier hs-var">inferFunctionPermsOption</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span id="local-6989586621687650558"><span class="annot"><span class="annottext">MaintenanceMode ()
</span><a href="#local-6989586621687650558"><span class="hs-identifier hs-var">soEnableMaintenanceMode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MaintenanceMode ()
</span><a href="#local-6989586621687650397"><span class="hs-identifier hs-var">rsoEnableMaintenanceMode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><span class="annottext">MaintenanceMode ()
</span><a href="Hasura.Server.Types.html#MaintenanceModeDisabled"><span class="hs-identifier hs-var">Types.MaintenanceModeDisabled</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (MaintenanceMode ())
-&gt; Option (MaintenanceMode ())
-&gt; WithEnvT Identity (MaintenanceMode ())
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (MaintenanceMode ())
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Option (MaintenanceMode ())
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#enableMaintenanceModeOption"><span class="hs-identifier hs-var">enableMaintenanceModeOption</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621687650561"><span class="annot"><span class="annottext">MaintenanceMode ()
</span><a href="#local-6989586621687650561"><span class="hs-identifier hs-var">maintenanceModeEnabled</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MaintenanceMode () -&gt; WithEnvT Identity (MaintenanceMode ())
forall a. a -&gt; WithEnvT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode ()
</span><a href="#local-6989586621687650561"><span class="hs-identifier hs-var">maintenanceModeEnabled</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span id="local-6989586621687650562"><span class="annot"><span class="annottext">OptionalInterval
</span><a href="#local-6989586621687650562"><span class="hs-identifier hs-var">soSchemaPollInterval</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe OptionalInterval
-&gt; Option OptionalInterval -&gt; WithEnvT Identity OptionalInterval
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OptionalInterval
</span><a href="#local-6989586621687650398"><span class="hs-identifier hs-var">rsoSchemaPollInterval</span></a></span><span> </span><span class="annot"><span class="annottext">Option OptionalInterval
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#schemaPollIntervalOption"><span class="hs-identifier hs-var">schemaPollIntervalOption</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span id="local-6989586621687650564"><span class="annot"><span class="annottext">HashSet ExperimentalFeature
</span><a href="#local-6989586621687650564"><span class="hs-identifier hs-var">soExperimentalFeatures</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (HashSet ExperimentalFeature)
-&gt; Option (HashSet ExperimentalFeature)
-&gt; WithEnvT Identity (HashSet ExperimentalFeature)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (HashSet ExperimentalFeature)
</span><a href="#local-6989586621687650399"><span class="hs-identifier hs-var">rsoExperimentalFeatures</span></a></span><span> </span><span class="annot"><span class="annottext">Option (HashSet ExperimentalFeature)
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#experimentalFeaturesOption"><span class="hs-identifier hs-var">experimentalFeaturesOption</span></a></span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621687650566"><span class="annot"><span class="annottext">Refined NonNegative Int
</span><a href="#local-6989586621687650566"><span class="hs-identifier hs-var">soEventsFetchBatchSize</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Refined NonNegative Int)
-&gt; Option (Refined NonNegative Int)
-&gt; WithEnvT Identity (Refined NonNegative Int)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Refined NonNegative Int)
</span><a href="#local-6989586621687650400"><span class="hs-identifier hs-var">rsoEventsFetchBatchSize</span></a></span><span> </span><span class="annot"><span class="annottext">Option (Refined NonNegative Int)
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#eventsFetchBatchSizeOption"><span class="hs-identifier hs-var">eventsFetchBatchSizeOption</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621687650568"><span class="annot"><span class="annottext">Refined NonNegative Seconds
</span><a href="#local-6989586621687650568"><span class="hs-identifier hs-var">soGracefulShutdownTimeout</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Refined NonNegative Seconds)
-&gt; Option (Refined NonNegative Seconds)
-&gt; WithEnvT Identity (Refined NonNegative Seconds)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Refined NonNegative Seconds)
</span><a href="#local-6989586621687650401"><span class="hs-identifier hs-var">rsoGracefulShutdownTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Option (Refined NonNegative Seconds)
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#gracefulShutdownOption"><span class="hs-identifier hs-var">gracefulShutdownOption</span></a></span><span>
</span><span id="line-206"></span><span>  </span><span id="local-6989586621687650570"><span class="annot"><span class="annottext">WSConnectionInitTimeout
</span><a href="#local-6989586621687650570"><span class="hs-identifier hs-var">soWebSocketConnectionInitTimeout</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe WSConnectionInitTimeout
-&gt; Option WSConnectionInitTimeout
-&gt; WithEnvT Identity WSConnectionInitTimeout
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe WSConnectionInitTimeout
</span><a href="#local-6989586621687650402"><span class="hs-identifier hs-var">rsoWebSocketConnectionInitTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Option WSConnectionInitTimeout
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#webSocketConnectionInitTimeoutOption"><span class="hs-identifier hs-var">webSocketConnectionInitTimeoutOption</span></a></span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687650572"><span class="annot"><span class="annottext">soEventingMode :: EventingMode
</span><a href="#local-6989586621687650572"><span class="hs-identifier hs-var hs-var">soEventingMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EventingMode
</span><a href="Hasura.Server.Types.html#EventingEnabled"><span class="hs-identifier hs-var">Types.EventingEnabled</span></a></span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687650574"><span class="annot"><span class="annottext">soReadOnlyMode :: ReadOnlyMode
</span><a href="#local-6989586621687650574"><span class="hs-identifier hs-var hs-var">soReadOnlyMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadOnlyMode
</span><a href="Hasura.Server.Types.html#ReadOnlyModeDisabled"><span class="hs-identifier hs-var">Types.ReadOnlyModeDisabled</span></a></span><span>
</span><span id="line-209"></span><span>  </span><span id="local-6989586621687650576"><span class="annot"><span class="annottext">MetadataQueryLoggingMode
</span><a href="#local-6989586621687650576"><span class="hs-identifier hs-var">soEnableMetadataQueryLogging</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MetadataQueryLoggingMode
</span><a href="#local-6989586621687650403"><span class="hs-identifier hs-var">rsoEnableMetadataQueryLoggingEnv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><span class="annottext">MetadataQueryLoggingMode
</span><a href="Hasura.Server.Logging.html#MetadataQueryLoggingDisabled"><span class="hs-identifier hs-var">Server.Logging.MetadataQueryLoggingDisabled</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe MetadataQueryLoggingMode
-&gt; Option MetadataQueryLoggingMode
-&gt; WithEnvT Identity MetadataQueryLoggingMode
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe MetadataQueryLoggingMode
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Option MetadataQueryLoggingMode
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#enableMetadataQueryLoggingOption"><span class="hs-identifier hs-var">enableMetadataQueryLoggingOption</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span id="local-6989586621687650579"><span class="annot"><span class="annottext">MetadataQueryLoggingMode
</span><a href="#local-6989586621687650579"><span class="hs-identifier hs-var">metadataQueryLoggingEnabled</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MetadataQueryLoggingMode
-&gt; WithEnvT Identity MetadataQueryLoggingMode
forall a. a -&gt; WithEnvT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">MetadataQueryLoggingMode
</span><a href="#local-6989586621687650579"><span class="hs-identifier hs-var">metadataQueryLoggingEnabled</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span id="local-6989586621687650580"><span class="annot"><span class="annottext">NamingCase
</span><a href="#local-6989586621687650580"><span class="hs-identifier hs-var">soDefaultNamingConvention</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
-&gt; Option NamingCase -&gt; WithEnvT Identity NamingCase
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687650404"><span class="hs-identifier hs-var">rsoDefaultNamingConvention</span></a></span><span> </span><span class="annot"><span class="annottext">Option NamingCase
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#defaultNamingConventionOption"><span class="hs-identifier hs-var">defaultNamingConventionOption</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621687650582"><span class="annot"><span class="annottext">MetadataDefaults
</span><a href="#local-6989586621687650582"><span class="hs-identifier hs-var">soMetadataDefaults</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe MetadataDefaults
-&gt; Option MetadataDefaults -&gt; WithEnvT Identity MetadataDefaults
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe MetadataDefaults
</span><a href="#local-6989586621687650406"><span class="hs-identifier hs-var">rsoMetadataDefaults</span></a></span><span> </span><span class="annot"><span class="annottext">Option MetadataDefaults
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#metadataDefaultsOption"><span class="hs-identifier hs-var">metadataDefaultsOption</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span id="local-6989586621687650584"><span class="annot"><span class="annottext">ExtensionsSchema
</span><a href="#local-6989586621687650584"><span class="hs-identifier hs-var">soExtensionsSchema</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe ExtensionsSchema
-&gt; Option ExtensionsSchema -&gt; WithEnvT Identity ExtensionsSchema
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ExtensionsSchema
</span><a href="#local-6989586621687650405"><span class="hs-identifier hs-var">rsoExtensionsSchema</span></a></span><span> </span><span class="annot"><span class="annottext">Option ExtensionsSchema
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#metadataDBExtensionsSchemaOption"><span class="hs-identifier hs-var">metadataDBExtensionsSchemaOption</span></a></span><span>
</span><span id="line-215"></span><span>  </span><span id="local-6989586621687650586"><span class="annot"><span class="annottext">ApolloFederationStatus
</span><a href="#local-6989586621687650586"><span class="hs-identifier hs-var">soApolloFederationStatus</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-216"></span><span>    </span><span id="local-6989586621687650587"><span class="annot"><span class="annottext">Maybe ApolloFederationStatus
</span><a href="#local-6989586621687650587"><span class="hs-identifier hs-var">apolloFederationStatusOptionM</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Maybe ApolloFederationStatus)
-&gt; Option (Maybe ApolloFederationStatus)
-&gt; WithEnvT Identity (Maybe ApolloFederationStatus)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApolloFederationStatus -&gt; Maybe ApolloFederationStatus
forall a. a -&gt; Maybe a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ApolloFederationStatus -&gt; Maybe ApolloFederationStatus)
-&gt; Maybe ApolloFederationStatus
-&gt; Maybe (Maybe ApolloFederationStatus)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe ApolloFederationStatus
</span><a href="#local-6989586621687650407"><span class="hs-identifier hs-var">rsoApolloFederationStatus</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Option (Maybe ApolloFederationStatus)
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#apolloFederationStatusOption"><span class="hs-identifier hs-var">apolloFederationStatusOption</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="annottext">ApolloFederationStatus -&gt; WithEnvT Identity ApolloFederationStatus
forall a. a -&gt; WithEnvT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ApolloFederationStatus
 -&gt; WithEnvT Identity ApolloFederationStatus)
-&gt; ApolloFederationStatus
-&gt; WithEnvT Identity ApolloFederationStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashSet ExperimentalFeature
-&gt; Maybe ApolloFederationStatus -&gt; ApolloFederationStatus
</span><a href="Hasura.GraphQL.ApolloFederation.html#getApolloFederationStatus"><span class="hs-identifier hs-var">getApolloFederationStatus</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet ExperimentalFeature
</span><a href="#local-6989586621687650564"><span class="hs-identifier hs-var">soExperimentalFeatures</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ApolloFederationStatus
</span><a href="#local-6989586621687650587"><span class="hs-identifier hs-var">apolloFederationStatusOptionM</span></a></span><span>
</span><span id="line-218"></span><span>  </span><span id="local-6989586621687650589"><span class="annot"><span class="annottext">CloseWebsocketsOnMetadataChangeStatus
</span><a href="#local-6989586621687650589"><span class="hs-identifier hs-var">soCloseWebsocketsOnMetadataChangeStatus</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><span class="annottext">Maybe CloseWebsocketsOnMetadataChangeStatus
-&gt; Option CloseWebsocketsOnMetadataChangeStatus
-&gt; WithEnvT Identity CloseWebsocketsOnMetadataChangeStatus
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CloseWebsocketsOnMetadataChangeStatus
</span><a href="#local-6989586621687650408"><span class="hs-identifier hs-var">rsoCloseWebsocketsOnMetadataChangeStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Option CloseWebsocketsOnMetadataChangeStatus
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#closeWebsocketsOnMetadataChangeOption"><span class="hs-identifier hs-var">closeWebsocketsOnMetadataChangeOption</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span id="local-6989586621687650591"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621687650591"><span class="hs-identifier hs-var">soMaxTotalHeaderLength</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Option Int -&gt; WithEnvT Identity Int
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687650409"><span class="hs-identifier hs-var">rsoMaxTotalHeaderLength</span></a></span><span> </span><span class="annot"><span class="annottext">Option Int
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#maxTotalHeaderLengthOption"><span class="hs-identifier hs-var">maxTotalHeaderLengthOption</span></a></span><span>
</span><span id="line-221"></span><span>  </span><span id="local-6989586621687650593"><span class="annot"><span class="annottext">TriggersErrorLogLevelStatus
</span><a href="#local-6989586621687650593"><span class="hs-identifier hs-var">soTriggersErrorLogLevelStatus</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe TriggersErrorLogLevelStatus
-&gt; Option TriggersErrorLogLevelStatus
-&gt; WithEnvT Identity TriggersErrorLogLevelStatus
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TriggersErrorLogLevelStatus
</span><a href="#local-6989586621687650410"><span class="hs-identifier hs-var">rsoTriggersErrorLogLevelStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Option TriggersErrorLogLevelStatus
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#triggersErrorLogLevelStatusOption"><span class="hs-identifier hs-var">triggersErrorLogLevelStatusOption</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span class="annot"><span class="annottext">ServeOptions impl -&gt; WithEnv (ServeOptions impl)
forall a. a -&gt; WithEnvT Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#ServeOptions"><span class="hs-identifier hs-type">ServeOptions</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Int
[JWTConfig]
Maybe Text
Maybe RoleName
Maybe AuthHook
HostPreference
HashSet ExperimentalFeature
HashSet (EngineLogType impl)
HashSet AdminSecretHash
HashSet API
TxIsolation
ConnParams
Refined NonNegative Int
Refined NonNegative Milliseconds
Refined NonNegative Seconds
Refined Positive Int
ConnectionOptions
SubscriptionsOptions
NamingCase
RemoteSchemaPermissions
InferFunctionPermissions
RemoteNullForwardingPolicy
DangerouslyCollapseBooleans
StringifyNumbers
ExtensionsSchema
CloseWebsocketsOnMetadataChangeStatus
TriggersErrorLogLevelStatus
ApolloFederationStatus
EventingMode
ReadOnlyMode
MaintenanceMode ()
CorsConfig
LogLevel
MetadataQueryLoggingMode
MetadataDefaults
WSConnectionInitTimeout
KeepAliveDelay
OptionalInterval
Port
TelemetryStatus
DevModeStatus
AllowListStatus
AdminInternalErrorsStatus
ConsoleStatus
soPort :: Port
soHost :: HostPreference
soConnParams :: ConnParams
soTxIso :: TxIsolation
soAdminSecret :: HashSet AdminSecretHash
soAuthHook :: Maybe AuthHook
soJwtSecret :: [JWTConfig]
soUnAuthRole :: Maybe RoleName
soCorsConfig :: CorsConfig
soConsoleStatus :: ConsoleStatus
soConsoleAssetsDir :: Maybe Text
soConsoleSentryDsn :: Maybe Text
soEnableTelemetry :: TelemetryStatus
soStringifyNum :: StringifyNumbers
soDangerousBooleanCollapse :: DangerouslyCollapseBooleans
soRemoteNullForwardingPolicy :: RemoteNullForwardingPolicy
soEnabledAPIs :: HashSet API
soLiveQueryOpts :: SubscriptionsOptions
soStreamingQueryOpts :: SubscriptionsOptions
soEnableAllowList :: AllowListStatus
soEnabledLogTypes :: HashSet (EngineLogType impl)
soLogLevel :: LogLevel
soDevMode :: DevModeStatus
soAdminInternalErrors :: AdminInternalErrorsStatus
soEventsHttpPoolSize :: Refined Positive Int
soEventsFetchInterval :: Refined NonNegative Milliseconds
soAsyncActionsFetchInterval :: OptionalInterval
soEnableRemoteSchemaPermissions :: RemoteSchemaPermissions
soConnectionOptions :: ConnectionOptions
soWebSocketKeepAlive :: KeepAliveDelay
soInferFunctionPermissions :: InferFunctionPermissions
soEnableMaintenanceMode :: MaintenanceMode ()
soSchemaPollInterval :: OptionalInterval
soExperimentalFeatures :: HashSet ExperimentalFeature
soEventsFetchBatchSize :: Refined NonNegative Int
soGracefulShutdownTimeout :: Refined NonNegative Seconds
soWebSocketConnectionInitTimeout :: WSConnectionInitTimeout
soEventingMode :: EventingMode
soReadOnlyMode :: ReadOnlyMode
soEnableMetadataQueryLogging :: MetadataQueryLoggingMode
soDefaultNamingConvention :: NamingCase
soMetadataDefaults :: MetadataDefaults
soExtensionsSchema :: ExtensionsSchema
soApolloFederationStatus :: ApolloFederationStatus
soCloseWebsocketsOnMetadataChangeStatus :: CloseWebsocketsOnMetadataChangeStatus
soMaxTotalHeaderLength :: Int
soTriggersErrorLogLevelStatus :: TriggersErrorLogLevelStatus
soPort :: Port
soHost :: HostPreference
soConnParams :: ConnParams
soTxIso :: TxIsolation
soAdminSecret :: HashSet AdminSecretHash
soAuthHook :: Maybe AuthHook
soJwtSecret :: [JWTConfig]
soUnAuthRole :: Maybe RoleName
soCorsConfig :: CorsConfig
soConsoleStatus :: ConsoleStatus
soConsoleAssetsDir :: Maybe Text
soConsoleSentryDsn :: Maybe Text
soEnableTelemetry :: TelemetryStatus
soStringifyNum :: StringifyNumbers
soDangerousBooleanCollapse :: DangerouslyCollapseBooleans
soRemoteNullForwardingPolicy :: RemoteNullForwardingPolicy
soEnabledAPIs :: HashSet API
soLiveQueryOpts :: SubscriptionsOptions
soStreamingQueryOpts :: SubscriptionsOptions
soEnableAllowList :: AllowListStatus
soEnabledLogTypes :: HashSet (EngineLogType impl)
soLogLevel :: LogLevel
soEventsHttpPoolSize :: Refined Positive Int
soEventsFetchInterval :: Refined NonNegative Milliseconds
soAsyncActionsFetchInterval :: OptionalInterval
soEnableRemoteSchemaPermissions :: RemoteSchemaPermissions
soConnectionOptions :: ConnectionOptions
soWebSocketKeepAlive :: KeepAliveDelay
soInferFunctionPermissions :: InferFunctionPermissions
soEnableMaintenanceMode :: MaintenanceMode ()
soSchemaPollInterval :: OptionalInterval
soExperimentalFeatures :: HashSet ExperimentalFeature
soEventsFetchBatchSize :: Refined NonNegative Int
soDevMode :: DevModeStatus
soAdminInternalErrors :: AdminInternalErrorsStatus
soGracefulShutdownTimeout :: Refined NonNegative Seconds
soWebSocketConnectionInitTimeout :: WSConnectionInitTimeout
soEventingMode :: EventingMode
soReadOnlyMode :: ReadOnlyMode
soEnableMetadataQueryLogging :: MetadataQueryLoggingMode
soDefaultNamingConvention :: NamingCase
soExtensionsSchema :: ExtensionsSchema
soMetadataDefaults :: MetadataDefaults
soApolloFederationStatus :: ApolloFederationStatus
soCloseWebsocketsOnMetadataChangeStatus :: CloseWebsocketsOnMetadataChangeStatus
soMaxTotalHeaderLength :: Int
soTriggersErrorLogLevelStatus :: TriggersErrorLogLevelStatus
</span><a href="#local-6989586621687650459"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Fetch Postgres 'Query.ConnParams' components from the environment</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- and merge with the values consumed by the arg parser in</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- 'ConnParamsRaw'.</span><span>
</span><span id="line-227"></span><span id="local-6989586621687649984"><span class="annot"><a href="Hasura.Server.Init.html#mkConnParams"><span class="hs-identifier hs-type">mkConnParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621687649984"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#ConnParamsRaw"><span class="hs-identifier hs-type">ConnParamsRaw</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Env.html#WithEnvT"><span class="hs-identifier hs-type">WithEnvT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687649984"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Pool.html#ConnParams"><span class="hs-identifier hs-type">Query.ConnParams</span></a></span></span><span>
</span><span id="line-228"></span><span id="mkConnParams"><span class="annot"><span class="annottext">mkConnParams :: forall (m :: * -&gt; *).
Monad m =&gt;
ConnParamsRaw -&gt; WithEnvT m ConnParams
</span><a href="Hasura.Server.Init.html#mkConnParams"><span class="hs-identifier hs-var hs-var">mkConnParams</span></a></span></span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#ConnParamsRaw"><span class="hs-identifier hs-type">ConnParamsRaw</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687650690"><span id="local-6989586621687650691"><span id="local-6989586621687650692"><span id="local-6989586621687650693"><span id="local-6989586621687650694"><span id="local-6989586621687650695"><span class="annot"><span class="annottext">Maybe Bool
Maybe (Refined NonNegative Int)
Maybe (Refined NonNegative NominalDiffTime)
rcpStripes :: Maybe (Refined NonNegative Int)
rcpConns :: Maybe (Refined NonNegative Int)
rcpIdleTime :: Maybe (Refined NonNegative Int)
rcpConnLifetime :: Maybe (Refined NonNegative NominalDiffTime)
rcpAllowPrepare :: Maybe Bool
rcpPoolTimeout :: Maybe (Refined NonNegative NominalDiffTime)
rcpStripes :: ConnParamsRaw -&gt; Maybe (Refined NonNegative Int)
rcpConns :: ConnParamsRaw -&gt; Maybe (Refined NonNegative Int)
rcpIdleTime :: ConnParamsRaw -&gt; Maybe (Refined NonNegative Int)
rcpConnLifetime :: ConnParamsRaw -&gt; Maybe (Refined NonNegative NominalDiffTime)
rcpAllowPrepare :: ConnParamsRaw -&gt; Maybe Bool
rcpPoolTimeout :: ConnParamsRaw -&gt; Maybe (Refined NonNegative NominalDiffTime)
</span><a href="#local-6989586621687650690"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-229"></span><span>  </span><span id="local-6989586621687650702"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621687650702"><span class="hs-identifier hs-var">cpStripes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Refined NonNegative Int -&gt; Int
forall {k} (p :: k) x. Refined p x -&gt; x
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/refined-0.8-b40efcc9b0260e802a32460f94ca38ced336d3f5163ccc01fe8e32d7f56bcb6d/share/doc/html/src/Refined.html#unrefine"><span class="hs-identifier hs-var">unrefine</span></a></span><span> </span><span class="annot"><span class="annottext">(Refined NonNegative Int -&gt; Int)
-&gt; WithEnvT m (Refined NonNegative Int) -&gt; WithEnvT m Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Refined NonNegative Int)
-&gt; Option (Refined NonNegative Int)
-&gt; WithEnvT m (Refined NonNegative Int)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Refined NonNegative Int)
</span><a href="#local-6989586621687650690"><span class="hs-identifier hs-var">rcpStripes</span></a></span><span> </span><span class="annot"><span class="annottext">Option (Refined NonNegative Int)
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#pgStripesOption"><span class="hs-identifier hs-var">pgStripesOption</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-comment">-- Note: by Little's Law we can expect e.g. (with 50 max connections) a</span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-comment">-- hard throughput cap at 1000RPS when db queries take 50ms on average:</span><span>
</span><span id="line-232"></span><span>  </span><span id="local-6989586621687650704"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621687650704"><span class="hs-identifier hs-var">cpConns</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Refined NonNegative Int -&gt; Int
forall {k} (p :: k) x. Refined p x -&gt; x
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/refined-0.8-b40efcc9b0260e802a32460f94ca38ced336d3f5163ccc01fe8e32d7f56bcb6d/share/doc/html/src/Refined.html#unrefine"><span class="hs-identifier hs-var">unrefine</span></a></span><span> </span><span class="annot"><span class="annottext">(Refined NonNegative Int -&gt; Int)
-&gt; WithEnvT m (Refined NonNegative Int) -&gt; WithEnvT m Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Refined NonNegative Int)
-&gt; Option (Refined NonNegative Int)
-&gt; WithEnvT m (Refined NonNegative Int)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Refined NonNegative Int)
</span><a href="#local-6989586621687650691"><span class="hs-identifier hs-var">rcpConns</span></a></span><span> </span><span class="annot"><span class="annottext">Option (Refined NonNegative Int)
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#pgConnsOption"><span class="hs-identifier hs-var">pgConnsOption</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span id="local-6989586621687650706"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621687650706"><span class="hs-identifier hs-var">cpIdleTime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Refined NonNegative Int -&gt; Int
forall {k} (p :: k) x. Refined p x -&gt; x
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/refined-0.8-b40efcc9b0260e802a32460f94ca38ced336d3f5163ccc01fe8e32d7f56bcb6d/share/doc/html/src/Refined.html#unrefine"><span class="hs-identifier hs-var">unrefine</span></a></span><span> </span><span class="annot"><span class="annottext">(Refined NonNegative Int -&gt; Int)
-&gt; WithEnvT m (Refined NonNegative Int) -&gt; WithEnvT m Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Refined NonNegative Int)
-&gt; Option (Refined NonNegative Int)
-&gt; WithEnvT m (Refined NonNegative Int)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Refined NonNegative Int)
</span><a href="#local-6989586621687650692"><span class="hs-identifier hs-var">rcpIdleTime</span></a></span><span> </span><span class="annot"><span class="annottext">Option (Refined NonNegative Int)
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#pgTimeoutOption"><span class="hs-identifier hs-var">pgTimeoutOption</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span id="local-6989586621687650708"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687650708"><span class="hs-identifier hs-var">cpAllowPrepare</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Option Bool -&gt; WithEnvT m Bool
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621687650694"><span class="hs-identifier hs-var">rcpAllowPrepare</span></a></span><span> </span><span class="annot"><span class="annottext">Option Bool
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#pgUsePreparedStatementsOption"><span class="hs-identifier hs-var">pgUsePreparedStatementsOption</span></a></span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-comment">-- TODO: Add newtype to allow this:</span><span>
</span><span id="line-236"></span><span>  </span><span id="local-6989586621687650710"><span class="annot"><span class="annottext">Maybe NominalDiffTime
</span><a href="#local-6989586621687650710"><span class="hs-identifier hs-var">cpMbLifetime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-237"></span><span>    </span><span id="local-6989586621687650711"><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621687650711"><span class="hs-identifier hs-var">lifetime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Refined NonNegative NominalDiffTime -&gt; NominalDiffTime
forall {k} (p :: k) x. Refined p x -&gt; x
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/refined-0.8-b40efcc9b0260e802a32460f94ca38ced336d3f5163ccc01fe8e32d7f56bcb6d/share/doc/html/src/Refined.html#unrefine"><span class="hs-identifier hs-var">unrefine</span></a></span><span> </span><span class="annot"><span class="annottext">(Refined NonNegative NominalDiffTime -&gt; NominalDiffTime)
-&gt; WithEnvT m (Refined NonNegative NominalDiffTime)
-&gt; WithEnvT m NominalDiffTime
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Refined NonNegative NominalDiffTime)
-&gt; Option (Refined NonNegative NominalDiffTime)
-&gt; WithEnvT m (Refined NonNegative NominalDiffTime)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Refined NonNegative NominalDiffTime)
</span><a href="#local-6989586621687650693"><span class="hs-identifier hs-var">rcpConnLifetime</span></a></span><span> </span><span class="annot"><span class="annottext">Option (Refined NonNegative NominalDiffTime)
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#pgConnLifetimeOption"><span class="hs-identifier hs-var">pgConnLifetimeOption</span></a></span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621687650711"><span class="hs-identifier hs-var">lifetime</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; NominalDiffTime -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">0</span></span><span>
</span><span id="line-239"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe NominalDiffTime -&gt; WithEnvT m (Maybe NominalDiffTime)
forall a. a -&gt; WithEnvT m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe NominalDiffTime
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-240"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe NominalDiffTime -&gt; WithEnvT m (Maybe NominalDiffTime)
forall a. a -&gt; WithEnvT m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NominalDiffTime -&gt; Maybe NominalDiffTime
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621687650711"><span class="hs-identifier hs-var">lifetime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621687650713"><span class="annot"><span class="annottext">Maybe NominalDiffTime
</span><a href="#local-6989586621687650713"><span class="hs-identifier hs-var">cpTimeout</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Refined NonNegative NominalDiffTime -&gt; NominalDiffTime)
-&gt; Maybe (Refined NonNegative NominalDiffTime)
-&gt; Maybe NominalDiffTime
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Refined NonNegative NominalDiffTime -&gt; NominalDiffTime
forall {k} (p :: k) x. Refined p x -&gt; x
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/refined-0.8-b40efcc9b0260e802a32460f94ca38ced336d3f5163ccc01fe8e32d7f56bcb6d/share/doc/html/src/Refined.html#unrefine"><span class="hs-identifier hs-var">unrefine</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Refined NonNegative NominalDiffTime)
 -&gt; Maybe NominalDiffTime)
-&gt; WithEnvT m (Maybe (Refined NonNegative NominalDiffTime))
-&gt; WithEnvT m (Maybe NominalDiffTime)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Refined NonNegative NominalDiffTime)
-&gt; Option ()
-&gt; WithEnvT m (Maybe (Refined NonNegative NominalDiffTime))
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option () -&gt; WithEnvT m (Maybe option)
</span><a href="Hasura.Server.Init.Env.html#withOption"><span class="hs-identifier hs-var">withOption</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Refined NonNegative NominalDiffTime)
</span><a href="#local-6989586621687650695"><span class="hs-identifier hs-var">rcpPoolTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Option ()
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#pgPoolTimeoutOption"><span class="hs-identifier hs-var">pgPoolTimeoutOption</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687650715"><span class="annot"><span class="annottext">cpCancel :: Bool
</span><a href="#local-6989586621687650715"><span class="hs-identifier hs-var hs-var">cpCancel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><span class="annottext">ConnParams -&gt; WithEnvT m ConnParams
forall a. a -&gt; WithEnvT m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-244"></span><span>    </span><span class="annot"><span class="annottext">(ConnParams -&gt; WithEnvT m ConnParams)
-&gt; ConnParams -&gt; WithEnvT m ConnParams
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Pool.html#ConnParams"><span class="hs-identifier hs-type">Query.ConnParams</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Bool
Int
Maybe NominalDiffTime
cpStripes :: Int
cpConns :: Int
cpIdleTime :: Int
cpAllowPrepare :: Bool
cpMbLifetime :: Maybe NominalDiffTime
cpTimeout :: Maybe NominalDiffTime
cpCancel :: Bool
cpStripes :: Int
cpConns :: Int
cpIdleTime :: Int
cpAllowPrepare :: Bool
cpMbLifetime :: Maybe NominalDiffTime
cpTimeout :: Maybe NominalDiffTime
cpCancel :: Bool
</span><a href="#local-6989586621687650702"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-comment">-- | Fetch 'Auth.AuthHook' components from the environment and merge</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- with the values consumed by the arg parser in 'AuthHookRaw'.</span><span>
</span><span id="line-248"></span><span id="local-6989586621687649992"><span class="annot"><a href="Hasura.Server.Init.html#mkAuthHook"><span class="hs-identifier hs-type">mkAuthHook</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621687649992"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#AuthHookRaw"><span class="hs-identifier hs-type">AuthHookRaw</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Env.html#WithEnvT"><span class="hs-identifier hs-type">WithEnvT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687649992"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.Server.Auth.WebHook.html#AuthHook"><span class="hs-identifier hs-type">Auth.AuthHook</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-249"></span><span id="mkAuthHook"><span class="annot"><span class="annottext">mkAuthHook :: forall (m :: * -&gt; *).
Monad m =&gt;
AuthHookRaw -&gt; WithEnvT m (Maybe AuthHook)
</span><a href="Hasura.Server.Init.html#mkAuthHook"><span class="hs-identifier hs-var hs-var">mkAuthHook</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Init.Config.html#AuthHookRaw"><span class="hs-identifier hs-type">AuthHookRaw</span></a></span><span> </span><span id="local-6989586621687650745"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621687650745"><span class="hs-identifier hs-var">mUrl</span></a></span></span><span> </span><span id="local-6989586621687650746"><span class="annot"><span class="annottext">Maybe AuthHookType
</span><a href="#local-6989586621687650746"><span class="hs-identifier hs-var">mType</span></a></span></span><span> </span><span id="local-6989586621687650747"><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621687650747"><span class="hs-identifier hs-var">mSendRequestBody</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-250"></span><span>  </span><span id="local-6989586621687650748"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621687650748"><span class="hs-identifier hs-var">mUrlEnv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; Option () -&gt; WithEnvT m (Maybe Text)
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option () -&gt; WithEnvT m (Maybe option)
</span><a href="Hasura.Server.Init.Env.html#withOption"><span class="hs-identifier hs-var">withOption</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621687650745"><span class="hs-identifier hs-var">mUrl</span></a></span><span> </span><span class="annot"><span class="annottext">Option ()
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#authHookOption"><span class="hs-identifier hs-var">authHookOption</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-comment">-- Also support HASURA_GRAPHQL_AUTH_HOOK_TYPE</span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-comment">-- TODO (from master):- drop this in next major update &lt;--- (NOTE: This comment is from 2020-08-21)</span><span>
</span><span id="line-253"></span><span>  </span><span id="local-6989586621687650750"><span class="annot"><span class="annottext">AuthHookType
</span><a href="#local-6989586621687650750"><span class="hs-identifier hs-var">authMode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><span class="annottext">Maybe AuthHookType
-&gt; WithEnvT m AuthHookType -&gt; WithEnvT m AuthHookType
forall (m :: * -&gt; *) a. Applicative m =&gt; Maybe a -&gt; m a -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html#onNothing"><span class="hs-identifier hs-var">onNothing</span></a></span><span>
</span><span id="line-255"></span><span>      </span><span class="annot"><span class="annottext">Maybe AuthHookType
</span><a href="#local-6989586621687650746"><span class="hs-identifier hs-var">mType</span></a></span><span>
</span><span id="line-256"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">AuthHookType -&gt; Maybe AuthHookType -&gt; AuthHookType
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Option AuthHookType -&gt; AuthHookType
forall def. Option def -&gt; def
</span><a href="Hasura.Server.Init.Config.html#_default"><span class="hs-identifier hs-var">_default</span></a></span><span> </span><span class="annot"><span class="annottext">Option AuthHookType
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#authHookModeOption"><span class="hs-identifier hs-var">authHookModeOption</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>          </span><span class="annot"><span class="annottext">(Maybe AuthHookType -&gt; AuthHookType)
-&gt; WithEnvT m (Maybe AuthHookType) -&gt; WithEnvT m AuthHookType
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; WithEnvT m (Maybe AuthHookType)
forall (m :: * -&gt; *) a.
(Monad m, FromEnv a) =&gt;
[String] -&gt; WithEnvT m (Maybe a)
</span><a href="Hasura.Server.Init.Env.html#considerEnvs"><span class="hs-identifier hs-var">considerEnvs</span></a></span><span>
</span><span id="line-258"></span><span>            </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Option AuthHookType -&gt; String
forall def. Option def -&gt; String
</span><a href="Hasura.Server.Init.Config.html#_envVar"><span class="hs-identifier hs-var">_envVar</span></a></span><span> </span><span class="annot"><span class="annottext">Option AuthHookType
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#authHookModeOption"><span class="hs-identifier hs-var">authHookModeOption</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;HASURA_GRAPHQL_AUTH_HOOK_TYPE&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-259"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-comment">-- if authMode is `GET` then authSendRequestBody is set to `False`, otherwise we check for the config value</span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621687650756"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687650756"><span class="hs-identifier hs-var">authSendRequestBody</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AuthHookType
</span><a href="#local-6989586621687650750"><span class="hs-identifier hs-var">authMode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-263"></span><span>      </span><span class="annot"><span class="annottext">AuthHookType
</span><a href="Hasura.Server.Auth.WebHook.html#AHTGet"><span class="hs-identifier hs-var">Auth.AHTGet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; WithEnvT m Bool
forall a. a -&gt; WithEnvT m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-264"></span><span>      </span><span class="annot"><span class="annottext">AuthHookType
</span><a href="Hasura.Server.Auth.WebHook.html#AHTPost"><span class="hs-identifier hs-var">Auth.AHTPost</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><span class="annottext">Maybe Bool -&gt; WithEnvT m Bool -&gt; WithEnvT m Bool
forall (m :: * -&gt; *) a. Applicative m =&gt; Maybe a -&gt; m a -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html#onNothing"><span class="hs-identifier hs-var">onNothing</span></a></span><span>
</span><span id="line-266"></span><span>          </span><span class="annot"><span class="annottext">Maybe Bool
</span><a href="#local-6989586621687650747"><span class="hs-identifier hs-var">mSendRequestBody</span></a></span><span>
</span><span id="line-267"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool -&gt; Bool
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Option Bool -&gt; Bool
forall def. Option def -&gt; def
</span><a href="Hasura.Server.Init.Config.html#_default"><span class="hs-identifier hs-var">_default</span></a></span><span> </span><span class="annot"><span class="annottext">Option Bool
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#authHookSendRequestBodyOption"><span class="hs-identifier hs-var">authHookSendRequestBodyOption</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>              </span><span class="annot"><span class="annottext">(Maybe Bool -&gt; Bool) -&gt; WithEnvT m (Maybe Bool) -&gt; WithEnvT m Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; WithEnvT m (Maybe Bool)
forall (m :: * -&gt; *) a.
(Monad m, FromEnv a) =&gt;
[String] -&gt; WithEnvT m (Maybe a)
</span><a href="Hasura.Server.Init.Env.html#considerEnvs"><span class="hs-identifier hs-var">considerEnvs</span></a></span><span>
</span><span id="line-269"></span><span>                </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Option Bool -&gt; String
forall def. Option def -&gt; String
</span><a href="Hasura.Server.Init.Config.html#_envVar"><span class="hs-identifier hs-var">_envVar</span></a></span><span> </span><span class="annot"><span class="annottext">Option Bool
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#authHookSendRequestBodyOption"><span class="hs-identifier hs-var">authHookSendRequestBodyOption</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-270"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><span class="annottext">Maybe AuthHook -&gt; WithEnvT m (Maybe AuthHook)
forall a. a -&gt; WithEnvT m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe AuthHook -&gt; WithEnvT m (Maybe AuthHook))
-&gt; Maybe AuthHook -&gt; WithEnvT m (Maybe AuthHook)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621687650760"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687650760"><span class="hs-identifier hs-var">url</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; AuthHookType -&gt; Bool -&gt; AuthHook
</span><a href="Hasura.Server.Auth.WebHook.html#AuthHook"><span class="hs-identifier hs-var">Auth.AuthHook</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687650760"><span class="hs-identifier hs-var">url</span></a></span><span> </span><span class="annot"><span class="annottext">AuthHookType
</span><a href="#local-6989586621687650750"><span class="hs-identifier hs-var">authMode</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687650756"><span class="hs-identifier hs-var">authSendRequestBody</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; AuthHook) -&gt; Maybe Text -&gt; Maybe AuthHook
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621687650748"><span class="hs-identifier hs-var">mUrlEnv</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- | Fetch 'Cors.CorsConfig' settings from the environment and merge</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- with the settings consumed by the arg parser.</span><span>
</span><span id="line-275"></span><span id="local-6989586621687649994"><span id="local-6989586621687649995"><span class="annot"><a href="Hasura.Server.Init.html#mkCorsConfig"><span class="hs-identifier hs-type">mkCorsConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621687649994"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#ServeOptionsRaw"><span class="hs-identifier hs-type">ServeOptionsRaw</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687649995"><span class="hs-identifier hs-type">imp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.Server.Cors.html#CorsConfig"><span class="hs-identifier hs-type">Cors.CorsConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Init.Env.html#WithEnvT"><span class="hs-identifier hs-type">WithEnvT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687649994"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.Cors.html#CorsConfig"><span class="hs-identifier hs-type">Cors.CorsConfig</span></a></span></span></span><span>
</span><span id="line-276"></span><span id="mkCorsConfig"><span class="annot"><span class="annottext">mkCorsConfig :: forall (m :: * -&gt; *) imp.
Monad m =&gt;
ServeOptionsRaw imp -&gt; Maybe CorsConfig -&gt; WithEnvT m CorsConfig
</span><a href="Hasura.Server.Init.html#mkCorsConfig"><span class="hs-identifier hs-var hs-var">mkCorsConfig</span></a></span></span><span> </span><span class="annot"><a href="Hasura.Server.Init.Config.html#ServeOptionsRaw"><span class="hs-identifier hs-type">ServeOptionsRaw</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687650786"><span id="local-6989586621687650787"><span id="local-6989586621687650788"><span id="local-6989586621687650789"><span id="local-6989586621687650790"><span id="local-6989586621687650791"><span id="local-6989586621687650792"><span id="local-6989586621687650793"><span id="local-6989586621687650794"><span id="local-6989586621687650795"><span id="local-6989586621687650796"><span id="local-6989586621687650797"><span id="local-6989586621687650798"><span id="local-6989586621687650799"><span id="local-6989586621687650800"><span id="local-6989586621687650801"><span id="local-6989586621687650802"><span id="local-6989586621687650803"><span id="local-6989586621687650804"><span id="local-6989586621687650805"><span id="local-6989586621687650806"><span id="local-6989586621687650807"><span id="local-6989586621687650808"><span id="local-6989586621687650809"><span id="local-6989586621687650810"><span id="local-6989586621687650811"><span id="local-6989586621687650812"><span id="local-6989586621687650813"><span id="local-6989586621687650814"><span id="local-6989586621687650815"><span id="local-6989586621687650816"><span id="local-6989586621687650817"><span id="local-6989586621687650818"><span id="local-6989586621687650819"><span id="local-6989586621687650820"><span id="local-6989586621687650821"><span id="local-6989586621687650822"><span id="local-6989586621687650823"><span id="local-6989586621687650824"><span id="local-6989586621687650825"><span id="local-6989586621687650826"><span id="local-6989586621687650827"><span id="local-6989586621687650828"><span id="local-6989586621687650829"><span id="local-6989586621687650830"><span id="local-6989586621687650831"><span id="local-6989586621687650832"><span id="local-6989586621687650833"><span class="annot"><span class="annottext">Maybe Int
Maybe Text
Maybe HostPreference
Maybe (HashSet ExperimentalFeature)
Maybe (HashSet (EngineLogType imp))
Maybe (HashSet API)
Maybe TxIsolation
Maybe (Refined NonNegative Int)
Maybe (Refined NonNegative Milliseconds)
Maybe (Refined NonNegative Seconds)
Maybe (Refined Positive Int)
Maybe RefetchInterval
Maybe BatchSize
Maybe NamingCase
Maybe RoleName
Maybe InferFunctionPermissions
Maybe RemoteNullForwardingPolicy
Maybe DangerouslyCollapseBooleans
Maybe ExtensionsSchema
Maybe CloseWebsocketsOnMetadataChangeStatus
Maybe TriggersErrorLogLevelStatus
Maybe ApolloFederationStatus
Maybe CorsConfig
Maybe LogLevel
Maybe JWTConfig
Maybe AdminSecretHash
Maybe MetadataDefaults
Maybe WSConnectionInitTimeout
Maybe KeepAliveDelay
Maybe OptionalInterval
Maybe Port
Maybe TelemetryStatus
Maybe AdminInternalErrorsStatus
CompressionOptions
RemoteSchemaPermissions
StringifyNumbers
MaintenanceMode ()
MetadataQueryLoggingMode
ConnParamsRaw
AuthHookRaw
WsReadCookieStatus
DevModeStatus
AllowListStatus
ConsoleStatus
rsoPort :: forall impl. ServeOptionsRaw impl -&gt; Maybe Port
rsoHost :: forall impl. ServeOptionsRaw impl -&gt; Maybe HostPreference
rsoConnParams :: forall impl. ServeOptionsRaw impl -&gt; ConnParamsRaw
rsoTxIso :: forall impl. ServeOptionsRaw impl -&gt; Maybe TxIsolation
rsoAdminSecret :: forall impl. ServeOptionsRaw impl -&gt; Maybe AdminSecretHash
rsoAuthHook :: forall impl. ServeOptionsRaw impl -&gt; AuthHookRaw
rsoJwtSecret :: forall impl. ServeOptionsRaw impl -&gt; Maybe JWTConfig
rsoUnAuthRole :: forall impl. ServeOptionsRaw impl -&gt; Maybe RoleName
rsoCorsConfig :: forall impl. ServeOptionsRaw impl -&gt; Maybe CorsConfig
rsoConsoleStatus :: forall impl. ServeOptionsRaw impl -&gt; ConsoleStatus
rsoConsoleAssetsDir :: forall impl. ServeOptionsRaw impl -&gt; Maybe Text
rsoConsoleSentryDsn :: forall impl. ServeOptionsRaw impl -&gt; Maybe Text
rsoEnableTelemetry :: forall impl. ServeOptionsRaw impl -&gt; Maybe TelemetryStatus
rsoWsReadCookie :: forall impl. ServeOptionsRaw impl -&gt; WsReadCookieStatus
rsoStringifyNum :: forall impl. ServeOptionsRaw impl -&gt; StringifyNumbers
rsoDangerousBooleanCollapse :: forall impl.
ServeOptionsRaw impl -&gt; Maybe DangerouslyCollapseBooleans
rsoRemoteNullForwardingPolicy :: forall impl.
ServeOptionsRaw impl -&gt; Maybe RemoteNullForwardingPolicy
rsoEnabledAPIs :: forall impl. ServeOptionsRaw impl -&gt; Maybe (HashSet API)
rsoMxRefetchInt :: forall impl. ServeOptionsRaw impl -&gt; Maybe RefetchInterval
rsoMxBatchSize :: forall impl. ServeOptionsRaw impl -&gt; Maybe BatchSize
rsoStreamingMxRefetchInt :: forall impl. ServeOptionsRaw impl -&gt; Maybe RefetchInterval
rsoStreamingMxBatchSize :: forall impl. ServeOptionsRaw impl -&gt; Maybe BatchSize
rsoEnableAllowList :: forall impl. ServeOptionsRaw impl -&gt; AllowListStatus
rsoEnabledLogTypes :: forall impl.
ServeOptionsRaw impl -&gt; Maybe (HashSet (EngineLogType impl))
rsoLogLevel :: forall impl. ServeOptionsRaw impl -&gt; Maybe LogLevel
rsoDevMode :: forall impl. ServeOptionsRaw impl -&gt; DevModeStatus
rsoAdminInternalErrors :: forall impl.
ServeOptionsRaw impl -&gt; Maybe AdminInternalErrorsStatus
rsoEventsHttpPoolSize :: forall impl. ServeOptionsRaw impl -&gt; Maybe (Refined Positive Int)
rsoEventsFetchInterval :: forall impl.
ServeOptionsRaw impl -&gt; Maybe (Refined NonNegative Milliseconds)
rsoAsyncActionsFetchInterval :: forall impl. ServeOptionsRaw impl -&gt; Maybe OptionalInterval
rsoEnableRemoteSchemaPermissions :: forall impl. ServeOptionsRaw impl -&gt; RemoteSchemaPermissions
rsoWebSocketCompression :: forall impl. ServeOptionsRaw impl -&gt; CompressionOptions
rsoWebSocketKeepAlive :: forall impl. ServeOptionsRaw impl -&gt; Maybe KeepAliveDelay
rsoInferFunctionPermissions :: forall impl. ServeOptionsRaw impl -&gt; Maybe InferFunctionPermissions
rsoEnableMaintenanceMode :: forall impl. ServeOptionsRaw impl -&gt; MaintenanceMode ()
rsoSchemaPollInterval :: forall impl. ServeOptionsRaw impl -&gt; Maybe OptionalInterval
rsoExperimentalFeatures :: forall impl.
ServeOptionsRaw impl -&gt; Maybe (HashSet ExperimentalFeature)
rsoEventsFetchBatchSize :: forall impl.
ServeOptionsRaw impl -&gt; Maybe (Refined NonNegative Int)
rsoGracefulShutdownTimeout :: forall impl.
ServeOptionsRaw impl -&gt; Maybe (Refined NonNegative Seconds)
rsoWebSocketConnectionInitTimeout :: forall impl. ServeOptionsRaw impl -&gt; Maybe WSConnectionInitTimeout
rsoEnableMetadataQueryLoggingEnv :: forall impl. ServeOptionsRaw impl -&gt; MetadataQueryLoggingMode
rsoDefaultNamingConvention :: forall impl. ServeOptionsRaw impl -&gt; Maybe NamingCase
rsoExtensionsSchema :: forall impl. ServeOptionsRaw impl -&gt; Maybe ExtensionsSchema
rsoMetadataDefaults :: forall impl. ServeOptionsRaw impl -&gt; Maybe MetadataDefaults
rsoApolloFederationStatus :: forall impl. ServeOptionsRaw impl -&gt; Maybe ApolloFederationStatus
rsoCloseWebsocketsOnMetadataChangeStatus :: forall impl.
ServeOptionsRaw impl -&gt; Maybe CloseWebsocketsOnMetadataChangeStatus
rsoMaxTotalHeaderLength :: forall impl. ServeOptionsRaw impl -&gt; Maybe Int
rsoTriggersErrorLogLevelStatus :: forall impl.
ServeOptionsRaw impl -&gt; Maybe TriggersErrorLogLevelStatus
rsoPort :: Maybe Port
rsoHost :: Maybe HostPreference
rsoConnParams :: ConnParamsRaw
rsoTxIso :: Maybe TxIsolation
rsoAdminSecret :: Maybe AdminSecretHash
rsoAuthHook :: AuthHookRaw
rsoJwtSecret :: Maybe JWTConfig
rsoUnAuthRole :: Maybe RoleName
rsoCorsConfig :: Maybe CorsConfig
rsoConsoleStatus :: ConsoleStatus
rsoConsoleAssetsDir :: Maybe Text
rsoConsoleSentryDsn :: Maybe Text
rsoEnableTelemetry :: Maybe TelemetryStatus
rsoWsReadCookie :: WsReadCookieStatus
rsoStringifyNum :: StringifyNumbers
rsoDangerousBooleanCollapse :: Maybe DangerouslyCollapseBooleans
rsoRemoteNullForwardingPolicy :: Maybe RemoteNullForwardingPolicy
rsoEnabledAPIs :: Maybe (HashSet API)
rsoMxRefetchInt :: Maybe RefetchInterval
rsoMxBatchSize :: Maybe BatchSize
rsoStreamingMxRefetchInt :: Maybe RefetchInterval
rsoStreamingMxBatchSize :: Maybe BatchSize
rsoEnableAllowList :: AllowListStatus
rsoEnabledLogTypes :: Maybe (HashSet (EngineLogType imp))
rsoLogLevel :: Maybe LogLevel
rsoDevMode :: DevModeStatus
rsoAdminInternalErrors :: Maybe AdminInternalErrorsStatus
rsoEventsHttpPoolSize :: Maybe (Refined Positive Int)
rsoEventsFetchInterval :: Maybe (Refined NonNegative Milliseconds)
rsoAsyncActionsFetchInterval :: Maybe OptionalInterval
rsoEnableRemoteSchemaPermissions :: RemoteSchemaPermissions
rsoWebSocketCompression :: CompressionOptions
rsoWebSocketKeepAlive :: Maybe KeepAliveDelay
rsoInferFunctionPermissions :: Maybe InferFunctionPermissions
rsoEnableMaintenanceMode :: MaintenanceMode ()
rsoSchemaPollInterval :: Maybe OptionalInterval
rsoExperimentalFeatures :: Maybe (HashSet ExperimentalFeature)
rsoEventsFetchBatchSize :: Maybe (Refined NonNegative Int)
rsoGracefulShutdownTimeout :: Maybe (Refined NonNegative Seconds)
rsoWebSocketConnectionInitTimeout :: Maybe WSConnectionInitTimeout
rsoEnableMetadataQueryLoggingEnv :: MetadataQueryLoggingMode
rsoDefaultNamingConvention :: Maybe NamingCase
rsoExtensionsSchema :: Maybe ExtensionsSchema
rsoMetadataDefaults :: Maybe MetadataDefaults
rsoApolloFederationStatus :: Maybe ApolloFederationStatus
rsoCloseWebsocketsOnMetadataChangeStatus :: Maybe CloseWebsocketsOnMetadataChangeStatus
rsoMaxTotalHeaderLength :: Maybe Int
rsoTriggersErrorLogLevelStatus :: Maybe TriggersErrorLogLevelStatus
</span><a href="Hasura.Server.Init.Config.html#rsoPort"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621687650834"><span class="annot"><span class="annottext">Maybe CorsConfig
</span><a href="#local-6989586621687650834"><span class="hs-identifier hs-var">mCfg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-277"></span><span>  </span><span id="local-6989586621687650835"><span class="annot"><span class="annottext">CorsConfig
</span><a href="#local-6989586621687650835"><span class="hs-identifier hs-var">corsCfg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-278"></span><span>    </span><span id="local-6989586621687650836"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687650836"><span class="hs-identifier hs-var">corsDisabled</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Bool -&gt; Option Bool -&gt; WithEnvT m Bool
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Option Bool
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#disableCorsOption"><span class="hs-identifier hs-var">disableCorsOption</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687650836"><span class="hs-identifier hs-var">corsDisabled</span></a></span><span>
</span><span id="line-280"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">CorsConfig -&gt; WithEnvT m CorsConfig
forall a. a -&gt; WithEnvT m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; CorsConfig
</span><a href="Hasura.Server.Cors.html#CCDisabled"><span class="hs-identifier hs-var">Cors.CCDisabled</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; CorsConfig) -&gt; Bool -&gt; CorsConfig
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Option Bool -&gt; Bool
forall def. Option def -&gt; def
</span><a href="Hasura.Server.Init.Config.html#_default"><span class="hs-identifier hs-var">_default</span></a></span><span> </span><span class="annot"><span class="annottext">Option Bool
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#disableCorsOption"><span class="hs-identifier hs-var">disableCorsOption</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe CorsConfig -&gt; Option CorsConfig -&gt; WithEnvT m CorsConfig
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CorsConfig
</span><a href="#local-6989586621687650834"><span class="hs-identifier hs-var">mCfg</span></a></span><span> </span><span class="annot"><span class="annottext">Option CorsConfig
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#corsDomainOption"><span class="hs-identifier hs-var">corsDomainOption</span></a></span><span>
</span><span id="line-282"></span><span>  </span><span id="local-6989586621687650840"><span class="annot"><span class="annottext">WsReadCookieStatus
</span><a href="#local-6989586621687650840"><span class="hs-identifier hs-var">readCookVal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">WsReadCookieStatus
</span><a href="#local-6989586621687650799"><span class="hs-identifier hs-var">rsoWsReadCookie</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-284"></span><span>      </span><span class="annot"><span class="annottext">WsReadCookieStatus
</span><a href="Hasura.Server.Init.Config.html#WsReadCookieDisabled"><span class="hs-identifier hs-var">WsReadCookieDisabled</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe WsReadCookieStatus
-&gt; Option WsReadCookieStatus -&gt; WithEnvT m WsReadCookieStatus
forall (m :: * -&gt; *) option.
(Monad m, FromEnv option) =&gt;
Maybe option -&gt; Option option -&gt; WithEnvT m option
</span><a href="Hasura.Server.Init.Env.html#withOptionDefault"><span class="hs-identifier hs-var">withOptionDefault</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe WsReadCookieStatus
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Option WsReadCookieStatus
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#wsReadCookieOption"><span class="hs-identifier hs-var">wsReadCookieOption</span></a></span><span>
</span><span id="line-285"></span><span>      </span><span id="local-6989586621687650843"><span class="annot"><span class="annottext">WsReadCookieStatus
</span><a href="#local-6989586621687650843"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WsReadCookieStatus -&gt; WithEnvT m WsReadCookieStatus
forall a. a -&gt; WithEnvT m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">WsReadCookieStatus
</span><a href="#local-6989586621687650843"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621687650844"><span class="annot"><span class="annottext">WsReadCookieStatus
</span><a href="#local-6989586621687650844"><span class="hs-identifier hs-var">wsReadCookie</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CorsConfig -&gt; Bool
</span><a href="Hasura.Server.Cors.html#isCorsDisabled"><span class="hs-identifier hs-var">Cors.isCorsDisabled</span></a></span><span> </span><span class="annot"><span class="annottext">CorsConfig
</span><a href="#local-6989586621687650835"><span class="hs-identifier hs-var">corsCfg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WsReadCookieStatus
</span><a href="#local-6989586621687650840"><span class="hs-identifier hs-var">readCookVal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WsReadCookieStatus
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WsReadCookieStatus -&gt; WithEnvT m WsReadCookieStatus
forall a. a -&gt; WithEnvT m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">WsReadCookieStatus
</span><a href="#local-6989586621687650840"><span class="hs-identifier hs-var">readCookVal</span></a></span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WsReadCookieStatus
</span><a href="Hasura.Server.Init.Config.html#WsReadCookieEnabled"><span class="hs-identifier hs-var">WsReadCookieEnabled</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-289"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; WithEnvT m WsReadCookieStatus
forall a. String -&gt; WithEnvT m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span>
</span><span id="line-290"></span><span>        </span><span class="annot"><span class="annottext">(String -&gt; WithEnvT m WsReadCookieStatus)
-&gt; String -&gt; WithEnvT m WsReadCookieStatus
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Option WsReadCookieStatus -&gt; String
forall def. Option def -&gt; String
</span><a href="Hasura.Server.Init.Config.html#_envVar"><span class="hs-identifier hs-var">_envVar</span></a></span><span> </span><span class="annot"><span class="annottext">Option WsReadCookieStatus
</span><a href="Hasura.Server.Init.Arg.Command.Serve.html#wsReadCookieOption"><span class="hs-identifier hs-var">wsReadCookieOption</span></a></span><span>
</span><span id="line-291"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; can only be used when CORS is disabled&quot;</span></span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WsReadCookieStatus
</span><a href="Hasura.Server.Init.Config.html#WsReadCookieDisabled"><span class="hs-identifier hs-var">WsReadCookieDisabled</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WsReadCookieStatus -&gt; WithEnvT m WsReadCookieStatus
forall a. a -&gt; WithEnvT m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">WsReadCookieStatus
</span><a href="Hasura.Server.Init.Config.html#WsReadCookieDisabled"><span class="hs-identifier hs-var">WsReadCookieDisabled</span></a></span><span>
</span><span id="line-293"></span><span>  </span><span class="annot"><span class="annottext">CorsConfig -&gt; WithEnvT m CorsConfig
forall a. a -&gt; WithEnvT m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CorsConfig -&gt; WithEnvT m CorsConfig)
-&gt; CorsConfig -&gt; WithEnvT m CorsConfig
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CorsConfig
</span><a href="#local-6989586621687650835"><span class="hs-identifier hs-var">corsCfg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><a href="Hasura.Server.Cors.html#CCDisabled"><span class="hs-identifier hs-type">Cors.CCDisabled</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; CorsConfig
</span><a href="Hasura.Server.Cors.html#CCDisabled"><span class="hs-identifier hs-var">Cors.CCDisabled</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; CorsConfig) -&gt; Bool -&gt; CorsConfig
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WsReadCookieStatus -&gt; Bool
</span><a href="Hasura.Server.Init.Config.html#isWsReadCookieEnabled"><span class="hs-identifier hs-var">isWsReadCookieEnabled</span></a></span><span> </span><span class="annot"><span class="annottext">WsReadCookieStatus
</span><a href="#local-6989586621687650844"><span class="hs-identifier hs-var">wsReadCookie</span></a></span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><span class="annottext">CorsConfig
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CorsConfig
</span><a href="#local-6989586621687650835"><span class="hs-identifier hs-var">corsCfg</span></a></span><span>
</span><span id="line-296"></span></pre></body></html>