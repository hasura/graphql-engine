<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hasura.RQL.Types.Eventing.Backend</span><span>
</span><span id="line-2"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#BackendEventTrigger"><span class="hs-identifier">BackendEventTrigger</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-4"></span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Control</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadBaseControl</span></span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set.NonEmpty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/time-1.11.1.1/src"><span class="hs-identifier">Data.Time.Clock</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Time</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html"><span class="hs-identifier">Hasura.Backends.MSSQL.DDL.EventTrigger</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MSSQL</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html"><span class="hs-identifier">Hasura.Backends.Postgres.DDL.EventTrigger</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Postgres</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html"><span class="hs-identifier">Hasura.Base.Error</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.4.20220919/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html"><span class="hs-identifier">Hasura.RQL.Types.Backend</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Column.html"><span class="hs-identifier">Hasura.RQL.Types.Column</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier">ColumnInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html"><span class="hs-identifier">Hasura.RQL.Types.Common</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html"><span class="hs-identifier">Hasura.RQL.Types.EventTrigger</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html"><span class="hs-identifier">Hasura.RQL.Types.Eventing</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Source.html"><span class="hs-identifier">Hasura.RQL.Types.Source</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Table.html"><span class="hs-identifier">Hasura.RQL.Types.Table</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Table.html#PrimaryKey"><span class="hs-identifier">PrimaryKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.SQL.Backend.html"><span class="hs-identifier">Hasura.SQL.Backend</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html"><span class="hs-identifier">Hasura.Server.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Types.html#HasServerConfigCtx"><span class="hs-identifier">HasServerConfigCtx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#MaintenanceMode"><span class="hs-identifier">MaintenanceMode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#ServerConfigCtx"><span class="hs-identifier">ServerConfigCtx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Session.html"><span class="hs-identifier">Hasura.Session</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Session.html#UserInfo"><span class="hs-identifier">UserInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Tracing.html"><span class="hs-identifier">Hasura.Tracing</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tracing</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-comment">-- | The @BackendEventTrigger@ type class contains functions which interacts</span><span>
</span><span id="line-27"></span><span class="hs-comment">--   with the source database to perform event trigger related operations like</span><span>
</span><span id="line-28"></span><span class="hs-comment">--   fetching pending events from the database or inserting a new invocation log</span><span>
</span><span id="line-29"></span><span class="hs-comment">--   after processing an event.</span><span>
</span><span id="line-30"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="BackendEventTrigger"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#BackendEventTrigger"><span class="hs-identifier hs-var">BackendEventTrigger</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690378002"><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.SQL.Backend.html#BackendType"><span class="hs-identifier hs-type">BackendType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-comment">-- | insertManualEvent inserts the specified event in the event log table,</span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-comment">--   note that this method should also set the trace context and session</span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-comment">--   variables in the source database context (if available).</span><span>
</span><span id="line-34"></span><span>  </span><span id="insertManualEvent"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#insertManualEvent"><span class="hs-identifier hs-type">insertManualEvent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-35"></span><span>    </span><span id="local-6989586621690377997"><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377997"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377997"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#TableName"><span class="hs-identifier hs-type">TableName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerName"><span class="hs-identifier hs-type">TriggerName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Hasura.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.html#TraceContext"><span class="hs-identifier hs-type">Tracing.TraceContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="#local-6989586621690377997"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html#EventId"><span class="hs-identifier hs-type">EventId</span></a></span></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-comment">-- | @fetchUndeliveredEvents@ fetches the undelivered events from the source</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-comment">--   and locks those events for processing. The locking is done so that when</span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-comment">--   there are multiple instances of graphql-engine connected to the same</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-comment">--   source they don't end up processing the same events concurrently.</span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-comment">--   Also, it's crucial that the SQL query used to fetch events in this</span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-comment">--   function uses something like Postgres's `FOR UPDATE SKIP LOCKED`</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-comment">--   mechanism so that it skips past the events which are locked by the</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-comment">--   database and pick newer undelivered events to achieve maximum throughput.</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-comment">--   The locking mechanism for event triggers is timestamp based i.e. when an</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-comment">--   event is fetched from the database, the `locked` column will contain the</span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-comment">--   timestamp of when it was fetched from the database. Undelivered events</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-comment">--   will have `NULL` value as their `locked` column value.</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-comment">--   The idea behind having a timestamp based locking mechanism is that if the</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-comment">--   graphql-engine is shutdown abruptly with events being fetched by the</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-comment">--   events processor, it will be locked and after the shutdown it will remain</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-comment">--   locked. Now with a timestamp based lock, when the graphql-engine is</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-comment">--   started again it will also fetch events which have a `locked` value of</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-comment">--   older than 30 mins along with the undelivered events. So, this way no</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-comment">--   events remain in a `locked` state.</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-comment">--   When fetching the events from the event_log table we also include the</span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-comment">--   list of the triggers that exist in the metadata at that point of time,</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-comment">--   because we have seen in some cases there are events that do not belong to</span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-comment">--   any of the event triggers present in the metadata and those are fetched</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-comment">--   only to be failed saying the said event trigger doesn't exist. So, to</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-comment">--   avoid this (atleast, as much as possible) we get only the events of the</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-comment">--   event triggers we have in the metadata.</span><span>
</span><span id="line-74"></span><span>  </span><span id="fetchUndeliveredEvents"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#fetchUndeliveredEvents"><span class="hs-identifier hs-type">fetchUndeliveredEvents</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-75"></span><span>    </span><span id="local-6989586621690377986"><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377986"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377986"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SourceName"><span class="hs-identifier hs-type">SourceName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-comment">-- | List of trigger names which exist in the metadata</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerName"><span class="hs-identifier hs-type">TriggerName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><a href="Hasura.Server.Types.html#MaintenanceMode"><span class="hs-identifier hs-type">MaintenanceMode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#FetchBatchSize"><span class="hs-identifier hs-type">FetchBatchSize</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><a href="#local-6989586621690377986"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-comment">-- | Ad-hoc function to set a retry for an undelivered event</span><span>
</span><span id="line-85"></span><span>  </span><span id="setRetry"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#setRetry"><span class="hs-identifier hs-type">setRetry</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-86"></span><span>    </span><span id="local-6989586621690377981"><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377981"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377981"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/time-1.11.1.1/src"><span class="hs-identifier hs-type">Time.UTCTime</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><a href="Hasura.Server.Types.html#MaintenanceMode"><span class="hs-identifier hs-type">MaintenanceMode</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#MaintenanceModeVersion"><span class="hs-identifier hs-type">MaintenanceModeVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><a href="#local-6989586621690377981"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-comment">-- | @getMaintenanceModeVersion@ gets the source catalog version from the</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-comment">--   source</span><span>
</span><span id="line-95"></span><span>  </span><span id="getMaintenanceModeVersion"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#getMaintenanceModeVersion"><span class="hs-identifier hs-type">getMaintenanceModeVersion</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-96"></span><span>    </span><span id="local-6989586621690377978"><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377978"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377978"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><a href="#local-6989586621690377978"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#MaintenanceModeVersion"><span class="hs-identifier hs-type">MaintenanceModeVersion</span></a></span></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-comment">-- | @recordSuccess@ records a successful event invocation, it does a couple</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-comment">--   of things,</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-comment">--   1. Insert the invocation in the invocation logs table</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-comment">--   2. Mark the event as 'delivered' in the event_log table</span><span>
</span><span id="line-105"></span><span>  </span><span id="recordSuccess"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#recordSuccess"><span class="hs-identifier hs-type">recordSuccess</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-106"></span><span>    </span><span id="local-6989586621690377977"><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377977"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html#Invocation"><span class="hs-identifier hs-type">Invocation</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html#EventType"><span class="hs-identifier hs-type">EventType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><a href="Hasura.Server.Types.html#MaintenanceMode"><span class="hs-identifier hs-type">MaintenanceMode</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#MaintenanceModeVersion"><span class="hs-identifier hs-type">MaintenanceModeVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><a href="#local-6989586621690377977"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-comment">-- | @recordError@ records an erronous event invocation, it does a couple of</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-comment">--   things,</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-comment">--   1. Insert the invocation in the invocation logs table</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-comment">--   2. Depending on the value of `ProcessEventError`, it will either,</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-comment">--        - Set a retry for the given event</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-comment">--        - Mark the event as 'error'</span><span>
</span><span id="line-120"></span><span>  </span><span id="recordError"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#recordError"><span class="hs-identifier hs-type">recordError</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-121"></span><span>    </span><span id="local-6989586621690377974"><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377974"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html#Invocation"><span class="hs-identifier hs-type">Invocation</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html#EventType"><span class="hs-identifier hs-type">EventType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#ProcessEventError"><span class="hs-identifier hs-type">ProcessEventError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><a href="Hasura.Server.Types.html#MaintenanceMode"><span class="hs-identifier hs-type">MaintenanceMode</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#MaintenanceModeVersion"><span class="hs-identifier hs-type">MaintenanceModeVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><a href="#local-6989586621690377974"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-comment">-- | @recordError'@ records an erronous event invocation, it does a couple of</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-comment">--   things,</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-comment">--   1. If present, insert the invocation in the invocation logs table</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-comment">--   2. Depending on the value of `ProcessEventError`, it will either,</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-comment">--        - Set a retry for the given event</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-comment">--        - Mark the event as 'error'</span><span>
</span><span id="line-136"></span><span>  </span><span id="recordError%27"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#recordError%27"><span class="hs-identifier hs-type">recordError'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-137"></span><span>    </span><span id="local-6989586621690377972"><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377972"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#Event"><span class="hs-identifier hs-type">Event</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html#Invocation"><span class="hs-identifier hs-type">Invocation</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html#EventType"><span class="hs-identifier hs-type">EventType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#ProcessEventError"><span class="hs-identifier hs-type">ProcessEventError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><a href="Hasura.Server.Types.html#MaintenanceMode"><span class="hs-identifier hs-type">MaintenanceMode</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#MaintenanceModeVersion"><span class="hs-identifier hs-type">MaintenanceModeVersion</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><a href="#local-6989586621690377972"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-comment">-- | @dropTriggerAndArchiveEvents@ drops the database trigger and</span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-comment">--   marks all the events related to the event trigger as archived.</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-comment">--   See Note [Cleanup for dropped triggers]</span><span>
</span><span id="line-148"></span><span>  </span><span id="dropTriggerAndArchiveEvents"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#dropTriggerAndArchiveEvents"><span class="hs-identifier hs-type">dropTriggerAndArchiveEvents</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-149"></span><span>    </span><span id="local-6989586621690377971"><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377971"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377971"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerName"><span class="hs-identifier hs-type">TriggerName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#TableName"><span class="hs-identifier hs-type">TableName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><a href="#local-6989586621690377971"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-comment">-- | @dropDanglingSQLTriggger@ is used to delete the extraneous SQL triggers</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-comment">--   created by an event trigger. The extraneous SQL triggers can be created</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-comment">--   when an event trigger's definition is replaced to a new definition. For</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-comment">--   example, an event trigger `authors_all` had an INSERT and UPDATE trigger</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-comment">--   defined earlier and after it has UPDATE and DELETE triggers. So, in this</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-comment">--   case, we need to drop the trigger created by us earlier for the INSERT</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-comment">--   trigger.</span><span>
</span><span id="line-162"></span><span>  </span><span id="dropDanglingSQLTrigger"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#dropDanglingSQLTrigger"><span class="hs-identifier hs-type">dropDanglingSQLTrigger</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-163"></span><span>    </span><span id="local-6989586621690377970"><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377970"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377970"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-164"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerName"><span class="hs-identifier hs-type">TriggerName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#TableName"><span class="hs-identifier hs-type">TableName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">HashSet</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#Ops"><span class="hs-identifier hs-type">Ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><a href="#local-6989586621690377970"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span>  </span><span id="redeliverEvent"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#redeliverEvent"><span class="hs-identifier hs-type">redeliverEvent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621690377967"><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377967"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377967"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html#EventId"><span class="hs-identifier hs-type">EventId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><a href="#local-6989586621690377967"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-comment">-- | @unlockEventsInSource@ unlocks the cached locked events which were</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-comment">--   captured when a graceful shutdown is initiated, so that when the</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-comment">--   graphql-engine restarts these events can be fetched to process them</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-comment">--   immediately.</span><span>
</span><span id="line-180"></span><span>  </span><span id="unlockEventsInSource"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#unlockEventsInSource"><span class="hs-identifier hs-type">unlockEventsInSource</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621690377966"><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377966"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">NE.NESet</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.html#EventId"><span class="hs-identifier hs-type">EventId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><a href="#local-6989586621690377966"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-comment">-- | @createMissingSQLTriggers@ checks in the source whether all the triggers</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-comment">--   exist according to the event trigger's specification. If any SQL trigger doesn't</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-comment">--   exist then it will create it.</span><span>
</span><span id="line-189"></span><span>  </span><span id="createMissingSQLTriggers"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#createMissingSQLTriggers"><span class="hs-identifier hs-type">createMissingSQLTriggers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621690377964"><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377964"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377964"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377964"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#HasServerConfigCtx"><span class="hs-identifier hs-type">HasServerConfigCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377964"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#TableName"><span class="hs-identifier hs-type">TableName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Table.html#PrimaryKey"><span class="hs-identifier hs-type">PrimaryKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerName"><span class="hs-identifier hs-type">TriggerName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerOpsDef"><span class="hs-identifier hs-type">TriggerOpsDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><a href="#local-6989586621690377964"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span>  </span><span id="createTableEventTrigger"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#createTableEventTrigger"><span class="hs-identifier hs-type">createTableEventTrigger</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-199"></span><span>    </span><span id="local-6989586621690377958"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377958"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377958"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377958"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><a href="Hasura.Server.Types.html#ServerConfigCtx"><span class="hs-identifier hs-type">ServerConfigCtx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#TableName"><span class="hs-identifier hs-type">TableName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerName"><span class="hs-identifier hs-type">TriggerName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerOpsDef"><span class="hs-identifier hs-type">TriggerOpsDef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-comment">-- TODO: Naveen: Find a better way to pass these extra, backend specific</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-comment">-- parameters instead of adding a bunch of Maybes to the type class</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-comment">-- functions.</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-comment">-- Update event trigger on MS-SQL are only supported on tables with primary</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-comment">-- keys. Hence the PrimaryKey argument below.</span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Table.html#PrimaryKey"><span class="hs-identifier hs-type">PrimaryKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><a href="#local-6989586621690377958"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span>  </span><span id="checkIfTriggerExists"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#checkIfTriggerExists"><span class="hs-identifier hs-type">checkIfTriggerExists</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-216"></span><span>    </span><span id="local-6989586621690377956"><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377956"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377956"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerName"><span class="hs-identifier hs-type">TriggerName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">HashSet</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#Ops"><span class="hs-identifier hs-type">Ops</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><a href="#local-6989586621690377956"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-comment">-- | @addCleanupSchedules@ adds cleanup logs for given trigger names and cleanup configs.</span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-comment">--   This will perform the following steps:</span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-comment">--   1. Get last scheduled cleanup event and count.</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-comment">--   2. If count is less than 5, then add add more cleanup logs, else do nothing</span><span>
</span><span id="line-227"></span><span>  </span><span id="addCleanupSchedules"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#addCleanupSchedules"><span class="hs-identifier hs-type">addCleanupSchedules</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621690377955"><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377955"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377955"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerName"><span class="hs-identifier hs-type">TriggerName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#AutoTriggerLogCleanupConfig"><span class="hs-identifier hs-type">AutoTriggerLogCleanupConfig</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><a href="#local-6989586621690377955"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-comment">-- | @deleteAllScheduledCleanups@ deletes all scheduled cleanup logs for a given event trigger</span><span>
</span><span id="line-234"></span><span>  </span><span id="deleteAllScheduledCleanups"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#deleteAllScheduledCleanups"><span class="hs-identifier hs-type">deleteAllScheduledCleanups</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-235"></span><span>    </span><span id="local-6989586621690377953"><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377953"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377953"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerName"><span class="hs-identifier hs-type">TriggerName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-238"></span><span>    </span><span class="annot"><a href="#local-6989586621690377953"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-comment">-- | @getCleanupEventsForDeletion@ returns the cleanup logs that are to be deleted.</span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-comment">-- This will perform the following steps:</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-comment">-- 1. Get the scheduled cleanup events that were scheduled before current time.</span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-comment">-- 2. If there are multiple entries for the same trigger name with different scheduled time,</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-comment">--    then fetch the latest entry and mark others as dead.</span><span>
</span><span id="line-246"></span><span>  </span><span id="getCleanupEventsForDeletion"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#getCleanupEventsForDeletion"><span class="hs-identifier hs-type">getCleanupEventsForDeletion</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-247"></span><span>    </span><span id="local-6989586621690377952"><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377952"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377952"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><a href="#local-6989586621690377952"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerName"><span class="hs-identifier hs-type">TriggerName</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-comment">-- | @updateCleanupEventStatusToDead@ updates the event trigger cleanup logs as dead</span><span>
</span><span id="line-252"></span><span>  </span><span id="updateCleanupEventStatusToDead"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#updateCleanupEventStatusToDead"><span class="hs-identifier hs-type">updateCleanupEventStatusToDead</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-253"></span><span>    </span><span id="local-6989586621690377950"><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377950"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377950"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><a href="#local-6989586621690377950"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-comment">-- | @updateCleanupEventStatusToPaused@ updates the cleanup log status to `paused` if the event trigger configuration is paused.</span><span>
</span><span id="line-259"></span><span>  </span><span id="updateCleanupEventStatusToPaused"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#updateCleanupEventStatusToPaused"><span class="hs-identifier hs-type">updateCleanupEventStatusToPaused</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621690377949"><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377949"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377949"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><a href="#local-6989586621690377949"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-comment">-- | @updateCleanupEventStatusToCompleted@ updates the cleanup log status after the event logs are deleted.</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-comment">-- This will perform the following steps:</span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-comment">-- 1. Updates the cleanup config status to `completed`.</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-comment">-- 2. Updates the number of event logs and event invocation logs that were deleted for a trigger name</span><span>
</span><span id="line-270"></span><span>  </span><span id="updateCleanupEventStatusToCompleted"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#updateCleanupEventStatusToCompleted"><span class="hs-identifier hs-type">updateCleanupEventStatusToCompleted</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-271"></span><span>    </span><span id="local-6989586621690377948"><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377948"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377948"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-272"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-274"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#DeletedEventLogStats"><span class="hs-identifier hs-type">DeletedEventLogStats</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><a href="#local-6989586621690377948"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-comment">-- | @deleteEventTriggerLogs@ deletes the event logs (and event invocation logs) based on the cleanup configuration given</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-comment">-- This will perform the following steps:</span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-comment">-- 1. Select all the dead events based on criteria set in the cleanup config.</span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-comment">-- 2. Lock the events in the database so that other HGE instances don't pick them up for deletion.</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-comment">-- 3. Based on the config, perform the delete action.</span><span>
</span><span id="line-283"></span><span>  </span><span id="deleteEventTriggerLogs"><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#deleteEventTriggerLogs"><span class="hs-identifier hs-type">deleteEventTriggerLogs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-284"></span><span>    </span><span id="local-6989586621690377946"><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377946"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadError</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690377946"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#SourceConfig"><span class="hs-identifier hs-type">SourceConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690378002"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-286"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#TriggerLogCleanupConfig"><span class="hs-identifier hs-type">TriggerLogCleanupConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-287"></span><span>    </span><span class="annot"><a href="#local-6989586621690377946"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.EventTrigger.html#DeletedEventLogStats"><span class="hs-identifier hs-type">DeletedEventLogStats</span></a></span></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- TODO: move those instances to 'Backend/*/Instances/Eventing' and create a</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- corresponding 'Instances.hs' file in this directory to import them, similarly</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- to how we import instances for other backend classes. This would</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- significantly reduce the number of files in the core engine that end up</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- depending / importing backend-specific files.</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#BackendEventTrigger"><span class="hs-identifier hs-type">BackendEventTrigger</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-297"></span><span>  </span><span id="local-6989586621690377648"><span class="annot"><span class="annottext">insertManualEvent :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Vanilla)
-&gt; TableName ('Postgres 'Vanilla)
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
</span><a href="#local-6989586621690377648"><span class="hs-identifier hs-var hs-var hs-var hs-var">insertManualEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind)
-&gt; TableName ('Postgres pgKind)
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#insertManualEvent"><span class="hs-identifier hs-var">Postgres.insertManualEvent</span></a></span><span>
</span><span id="line-298"></span><span>  </span><span id="local-6989586621690377642"><span class="annot"><span class="annottext">fetchUndeliveredEvents :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Vanilla)
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event ('Postgres 'Vanilla)]
</span><a href="#local-6989586621690377642"><span class="hs-identifier hs-var hs-var hs-var hs-var">fetchUndeliveredEvents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind)
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event ('Postgres pgKind)]
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#fetchUndeliveredEvents"><span class="hs-identifier hs-var">Postgres.fetchUndeliveredEvents</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span id="local-6989586621690377636"><span class="annot"><span class="annottext">setRetry :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Vanilla)
-&gt; Event ('Postgres 'Vanilla)
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
</span><a href="#local-6989586621690377636"><span class="hs-identifier hs-var hs-var hs-var hs-var">setRetry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind)
-&gt; Event ('Postgres pgKind)
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#setRetry"><span class="hs-identifier hs-var">Postgres.setRetry</span></a></span><span>
</span><span id="line-300"></span><span>  </span><span id="local-6989586621690377630"><span class="annot"><span class="annottext">getMaintenanceModeVersion :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Vanilla) -&gt; m MaintenanceModeVersion
</span><a href="#local-6989586621690377630"><span class="hs-identifier hs-var hs-var hs-var hs-var">getMaintenanceModeVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind) -&gt; m MaintenanceModeVersion
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#getMaintenanceModeVersion"><span class="hs-identifier hs-var">Postgres.getMaintenanceModeVersion</span></a></span><span>
</span><span id="line-301"></span><span>  </span><span id="local-6989586621690377626"><span class="annot"><span class="annottext">recordSuccess :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig ('Postgres 'Vanilla)
-&gt; Event ('Postgres 'Vanilla)
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377626"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordSuccess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
MonadIO m =&gt;
SourceConfig ('Postgres pgKind)
-&gt; Event ('Postgres pgKind)
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#recordSuccess"><span class="hs-identifier hs-var">Postgres.recordSuccess</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span id="local-6989586621690377622"><span class="annot"><span class="annottext">recordError :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig ('Postgres 'Vanilla)
-&gt; Event ('Postgres 'Vanilla)
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377622"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
MonadIO m =&gt;
SourceConfig ('Postgres pgKind)
-&gt; Event ('Postgres pgKind)
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#recordError"><span class="hs-identifier hs-var">Postgres.recordError</span></a></span><span>
</span><span id="line-303"></span><span>  </span><span id="local-6989586621690377618"><span class="annot"><span class="annottext">recordError' :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig ('Postgres 'Vanilla)
-&gt; Event ('Postgres 'Vanilla)
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377618"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
MonadIO m =&gt;
SourceConfig ('Postgres pgKind)
-&gt; Event ('Postgres pgKind)
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#recordError%27"><span class="hs-identifier hs-var">Postgres.recordError'</span></a></span><span>
</span><span id="line-304"></span><span>  </span><span id="local-6989586621690377612"><span class="annot"><span class="annottext">dropTriggerAndArchiveEvents :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Vanilla)
-&gt; TriggerName -&gt; TableName ('Postgres 'Vanilla) -&gt; m ()
</span><a href="#local-6989586621690377612"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropTriggerAndArchiveEvents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind)
-&gt; TriggerName -&gt; QualifiedTable -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#dropTriggerAndArchiveEvents"><span class="hs-identifier hs-var">Postgres.dropTriggerAndArchiveEvents</span></a></span><span>
</span><span id="line-305"></span><span>  </span><span id="local-6989586621690377606"><span class="annot"><span class="annottext">dropDanglingSQLTrigger :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Vanilla)
-&gt; TriggerName
-&gt; TableName ('Postgres 'Vanilla)
-&gt; HashSet Ops
-&gt; m ()
</span><a href="#local-6989586621690377606"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropDanglingSQLTrigger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind)
-&gt; TriggerName -&gt; QualifiedTable -&gt; HashSet Ops -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#dropDanglingSQLTrigger"><span class="hs-identifier hs-var">Postgres.dropDanglingSQLTrigger</span></a></span><span>
</span><span id="line-306"></span><span>  </span><span id="local-6989586621690377600"><span class="annot"><span class="annottext">redeliverEvent :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Vanilla) -&gt; EventId -&gt; m ()
</span><a href="#local-6989586621690377600"><span class="hs-identifier hs-var hs-var hs-var hs-var">redeliverEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind) -&gt; EventId -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#redeliverEvent"><span class="hs-identifier hs-var">Postgres.redeliverEvent</span></a></span><span>
</span><span id="line-307"></span><span>  </span><span id="local-6989586621690377596"><span class="annot"><span class="annottext">unlockEventsInSource :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig ('Postgres 'Vanilla)
-&gt; NESet EventId -&gt; m (Either QErr Int)
</span><a href="#local-6989586621690377596"><span class="hs-identifier hs-var hs-var hs-var hs-var">unlockEventsInSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
MonadIO m =&gt;
SourceConfig ('Postgres pgKind)
-&gt; NESet EventId -&gt; m (Either QErr Int)
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#unlockEventsInSource"><span class="hs-identifier hs-var">Postgres.unlockEventsInSource</span></a></span><span>
</span><span id="line-308"></span><span>  </span><span id="local-6989586621690377581"><span class="annot"><span class="annottext">createTableEventTrigger :: forall (m :: * -&gt; *).
(MonadBaseControl IO m, MonadIO m, MonadError QErr m) =&gt;
ServerConfigCtx
-&gt; SourceConfig ('Postgres 'Vanilla)
-&gt; TableName ('Postgres 'Vanilla)
-&gt; [ColumnInfo ('Postgres 'Vanilla)]
-&gt; TriggerName
-&gt; TriggerOpsDef ('Postgres 'Vanilla)
-&gt; Maybe
     (PrimaryKey ('Postgres 'Vanilla) (ColumnInfo ('Postgres 'Vanilla)))
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377581"><span class="hs-identifier hs-var hs-var hs-var hs-var">createTableEventTrigger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(Backend ('Postgres pgKind), MonadIO m, MonadBaseControl IO m) =&gt;
ServerConfigCtx
-&gt; PGSourceConfig
-&gt; QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; TriggerName
-&gt; TriggerOpsDef ('Postgres pgKind)
-&gt; Maybe
     (PrimaryKey ('Postgres pgKind) (ColumnInfo ('Postgres pgKind)))
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#createTableEventTrigger"><span class="hs-identifier hs-var">Postgres.createTableEventTrigger</span></a></span><span>
</span><span id="line-309"></span><span>  </span><span id="local-6989586621690377569"><span class="annot"><span class="annottext">createMissingSQLTriggers :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m,
 Backend ('Postgres 'Vanilla), HasServerConfigCtx m) =&gt;
SourceConfig ('Postgres 'Vanilla)
-&gt; TableName ('Postgres 'Vanilla)
-&gt; ([ColumnInfo ('Postgres 'Vanilla)],
    Maybe
      (PrimaryKey
         ('Postgres 'Vanilla) (ColumnInfo ('Postgres 'Vanilla))))
-&gt; TriggerName
-&gt; TriggerOpsDef ('Postgres 'Vanilla)
-&gt; m ()
</span><a href="#local-6989586621690377569"><span class="hs-identifier hs-var hs-var hs-var hs-var">createMissingSQLTriggers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m,
 HasServerConfigCtx m, Backend ('Postgres pgKind)) =&gt;
PGSourceConfig
-&gt; TableName ('Postgres pgKind)
-&gt; ([ColumnInfo ('Postgres pgKind)],
    Maybe
      (PrimaryKey ('Postgres pgKind) (ColumnInfo ('Postgres pgKind))))
-&gt; TriggerName
-&gt; TriggerOpsDef ('Postgres pgKind)
-&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#createMissingSQLTriggers"><span class="hs-identifier hs-var">Postgres.createMissingSQLTriggers</span></a></span><span>
</span><span id="line-310"></span><span>  </span><span id="local-6989586621690377563"><span class="annot"><span class="annottext">checkIfTriggerExists :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Vanilla)
-&gt; TriggerName -&gt; HashSet Ops -&gt; m Bool
</span><a href="#local-6989586621690377563"><span class="hs-identifier hs-var hs-var hs-var hs-var">checkIfTriggerExists</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
PGSourceConfig -&gt; TriggerName -&gt; HashSet Ops -&gt; m Bool
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#checkIfTriggerExists"><span class="hs-identifier hs-var">Postgres.checkIfTriggerExists</span></a></span><span>
</span><span id="line-311"></span><span>  </span><span id="local-6989586621690377557"><span class="annot"><span class="annottext">addCleanupSchedules :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Vanilla)
-&gt; [(TriggerName, AutoTriggerLogCleanupConfig)] -&gt; m ()
</span><a href="#local-6989586621690377557"><span class="hs-identifier hs-var hs-var hs-var hs-var">addCleanupSchedules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
PGSourceConfig
-&gt; [(TriggerName, AutoTriggerLogCleanupConfig)] -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#addCleanupSchedules"><span class="hs-identifier hs-var">Postgres.addCleanupSchedules</span></a></span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621690377551"><span class="annot"><span class="annottext">deleteAllScheduledCleanups :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Vanilla) -&gt; TriggerName -&gt; m ()
</span><a href="#local-6989586621690377551"><span class="hs-identifier hs-var hs-var hs-var hs-var">deleteAllScheduledCleanups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
PGSourceConfig -&gt; TriggerName -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#deleteAllScheduledCleanups"><span class="hs-identifier hs-var">Postgres.deleteAllScheduledCleanups</span></a></span><span>
</span><span id="line-313"></span><span>  </span><span id="local-6989586621690377545"><span class="annot"><span class="annottext">getCleanupEventsForDeletion :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Vanilla) -&gt; m [(Text, TriggerName)]
</span><a href="#local-6989586621690377545"><span class="hs-identifier hs-var hs-var hs-var hs-var">getCleanupEventsForDeletion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
PGSourceConfig -&gt; m [(Text, TriggerName)]
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#getCleanupEventsForDeletion"><span class="hs-identifier hs-var">Postgres.getCleanupEventsForDeletion</span></a></span><span>
</span><span id="line-314"></span><span>  </span><span id="local-6989586621690377539"><span class="annot"><span class="annottext">updateCleanupEventStatusToDead :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Vanilla) -&gt; [Text] -&gt; m ()
</span><a href="#local-6989586621690377539"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToDead</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
PGSourceConfig -&gt; [Text] -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#updateCleanupEventStatusToDead"><span class="hs-identifier hs-var">Postgres.updateCleanupEventStatusToDead</span></a></span><span>
</span><span id="line-315"></span><span>  </span><span id="local-6989586621690377533"><span class="annot"><span class="annottext">updateCleanupEventStatusToPaused :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Vanilla) -&gt; Text -&gt; m ()
</span><a href="#local-6989586621690377533"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToPaused</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
PGSourceConfig -&gt; Text -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#updateCleanupEventStatusToPaused"><span class="hs-identifier hs-var">Postgres.updateCleanupEventStatusToPaused</span></a></span><span>
</span><span id="line-316"></span><span>  </span><span id="local-6989586621690377527"><span class="annot"><span class="annottext">updateCleanupEventStatusToCompleted :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Vanilla)
-&gt; Text -&gt; DeletedEventLogStats -&gt; m ()
</span><a href="#local-6989586621690377527"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToCompleted</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
PGSourceConfig -&gt; Text -&gt; DeletedEventLogStats -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#updateCleanupEventStatusToCompleted"><span class="hs-identifier hs-var">Postgres.updateCleanupEventStatusToCompleted</span></a></span><span>
</span><span id="line-317"></span><span>  </span><span id="local-6989586621690377521"><span class="annot"><span class="annottext">deleteEventTriggerLogs :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Vanilla)
-&gt; TriggerLogCleanupConfig -&gt; m DeletedEventLogStats
</span><a href="#local-6989586621690377521"><span class="hs-identifier hs-var hs-var hs-var hs-var">deleteEventTriggerLogs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
PGSourceConfig -&gt; TriggerLogCleanupConfig -&gt; m DeletedEventLogStats
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#deleteEventTriggerLogs"><span class="hs-identifier hs-var">Postgres.deleteEventTriggerLogs</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#BackendEventTrigger"><span class="hs-identifier hs-type">BackendEventTrigger</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Citus"><span class="hs-identifier hs-type">Citus</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-320"></span><span>  </span><span id="local-6989586621690377479"><span class="annot"><span class="annottext">insertManualEvent :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Citus)
-&gt; TableName ('Postgres 'Citus)
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
</span><a href="#local-6989586621690377479"><span class="hs-identifier hs-var hs-var hs-var hs-var">insertManualEvent</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TraceContext
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-321"></span><span>  </span><span id="local-6989586621690377472"><span class="annot"><span class="annottext">fetchUndeliveredEvents :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Citus)
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event ('Postgres 'Citus)]
</span><a href="#local-6989586621690377472"><span class="hs-identifier hs-var hs-var hs-var hs-var">fetchUndeliveredEvents</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TriggerName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FetchBatchSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-322"></span><span>  </span><span id="local-6989586621690377467"><span class="annot"><span class="annottext">setRetry :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Citus)
-&gt; Event ('Postgres 'Citus)
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
</span><a href="#local-6989586621690377467"><span class="hs-identifier hs-var hs-var hs-var hs-var">setRetry</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-323"></span><span>  </span><span id="local-6989586621690377460"><span class="annot"><span class="annottext">recordSuccess :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig ('Postgres 'Citus)
-&gt; Event ('Postgres 'Citus)
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377460"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordSuccess</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Invocation 'EventType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-324"></span><span>  </span><span id="local-6989586621690377454"><span class="annot"><span class="annottext">getMaintenanceModeVersion :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Citus) -&gt; m MaintenanceModeVersion
</span><a href="#local-6989586621690377454"><span class="hs-identifier hs-var hs-var hs-var hs-var">getMaintenanceModeVersion</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-325"></span><span>  </span><span id="local-6989586621690377449"><span class="annot"><span class="annottext">recordError :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig ('Postgres 'Citus)
-&gt; Event ('Postgres 'Citus)
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377449"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Invocation 'EventType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ProcessEventError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-326"></span><span>  </span><span id="local-6989586621690377444"><span class="annot"><span class="annottext">recordError' :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig ('Postgres 'Citus)
-&gt; Event ('Postgres 'Citus)
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377444"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError'</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Invocation 'EventType)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ProcessEventError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-327"></span><span>  </span><span id="local-6989586621690377439"><span class="annot"><span class="annottext">dropTriggerAndArchiveEvents :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Citus)
-&gt; TriggerName -&gt; TableName ('Postgres 'Citus) -&gt; m ()
</span><a href="#local-6989586621690377439"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropTriggerAndArchiveEvents</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-328"></span><span>  </span><span id="local-6989586621690377434"><span class="annot"><span class="annottext">dropDanglingSQLTrigger :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Citus)
-&gt; TriggerName
-&gt; TableName ('Postgres 'Citus)
-&gt; HashSet Ops
-&gt; m ()
</span><a href="#local-6989586621690377434"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropDanglingSQLTrigger</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HashSet Ops
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-329"></span><span>  </span><span id="local-6989586621690377429"><span class="annot"><span class="annottext">redeliverEvent :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Citus) -&gt; EventId -&gt; m ()
</span><a href="#local-6989586621690377429"><span class="hs-identifier hs-var hs-var hs-var hs-var">redeliverEvent</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">EventId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-330"></span><span>  </span><span id="local-6989586621690377424"><span class="annot"><span class="annottext">unlockEventsInSource :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig ('Postgres 'Citus)
-&gt; NESet EventId -&gt; m (Either QErr Int)
</span><a href="#local-6989586621690377424"><span class="hs-identifier hs-var hs-var hs-var hs-var">unlockEventsInSource</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NESet EventId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-331"></span><span>  </span><span id="local-6989586621690377417"><span class="annot"><span class="annottext">createTableEventTrigger :: forall (m :: * -&gt; *).
(MonadBaseControl IO m, MonadIO m, MonadError QErr m) =&gt;
ServerConfigCtx
-&gt; SourceConfig ('Postgres 'Citus)
-&gt; TableName ('Postgres 'Citus)
-&gt; [ColumnInfo ('Postgres 'Citus)]
-&gt; TriggerName
-&gt; TriggerOpsDef ('Postgres 'Citus)
-&gt; Maybe
     (PrimaryKey ('Postgres 'Citus) (ColumnInfo ('Postgres 'Citus)))
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377417"><span class="hs-identifier hs-var hs-var hs-var hs-var">createTableEventTrigger</span></a></span></span><span> </span><span class="annot"><span class="annottext">ServerConfigCtx
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres 'Citus)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerOpsDef ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe
  (PrimaryKey ('Postgres 'Citus) (ColumnInfo ('Postgres 'Citus)))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-332"></span><span>  </span><span id="local-6989586621690377409"><span class="annot"><span class="annottext">createMissingSQLTriggers :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m,
 Backend ('Postgres 'Citus), HasServerConfigCtx m) =&gt;
SourceConfig ('Postgres 'Citus)
-&gt; TableName ('Postgres 'Citus)
-&gt; ([ColumnInfo ('Postgres 'Citus)],
    Maybe
      (PrimaryKey ('Postgres 'Citus) (ColumnInfo ('Postgres 'Citus))))
-&gt; TriggerName
-&gt; TriggerOpsDef ('Postgres 'Citus)
-&gt; m ()
</span><a href="#local-6989586621690377409"><span class="hs-identifier hs-var hs-var hs-var hs-var">createMissingSQLTriggers</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">([ColumnInfo ('Postgres 'Citus)],
 Maybe
   (PrimaryKey ('Postgres 'Citus) (ColumnInfo ('Postgres 'Citus))))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerOpsDef ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-333"></span><span>  </span><span id="local-6989586621690377404"><span class="annot"><span class="annottext">checkIfTriggerExists :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Citus)
-&gt; TriggerName -&gt; HashSet Ops -&gt; m Bool
</span><a href="#local-6989586621690377404"><span class="hs-identifier hs-var hs-var hs-var hs-var">checkIfTriggerExists</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HashSet Ops
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-334"></span><span>  </span><span id="local-6989586621690377399"><span class="annot"><span class="annottext">addCleanupSchedules :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Citus)
-&gt; [(TriggerName, AutoTriggerLogCleanupConfig)] -&gt; m ()
</span><a href="#local-6989586621690377399"><span class="hs-identifier hs-var hs-var hs-var hs-var">addCleanupSchedules</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(TriggerName, AutoTriggerLogCleanupConfig)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-335"></span><span>  </span><span id="local-6989586621690377394"><span class="annot"><span class="annottext">deleteAllScheduledCleanups :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Citus) -&gt; TriggerName -&gt; m ()
</span><a href="#local-6989586621690377394"><span class="hs-identifier hs-var hs-var hs-var hs-var">deleteAllScheduledCleanups</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-336"></span><span>  </span><span id="local-6989586621690377389"><span class="annot"><span class="annottext">getCleanupEventsForDeletion :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Citus) -&gt; m [(Text, TriggerName)]
</span><a href="#local-6989586621690377389"><span class="hs-identifier hs-var hs-var hs-var hs-var">getCleanupEventsForDeletion</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-337"></span><span>  </span><span id="local-6989586621690377384"><span class="annot"><span class="annottext">updateCleanupEventStatusToDead :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Citus) -&gt; [Text] -&gt; m ()
</span><a href="#local-6989586621690377384"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToDead</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-338"></span><span>  </span><span id="local-6989586621690377379"><span class="annot"><span class="annottext">updateCleanupEventStatusToPaused :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Citus) -&gt; Text -&gt; m ()
</span><a href="#local-6989586621690377379"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToPaused</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-339"></span><span>  </span><span id="local-6989586621690377374"><span class="annot"><span class="annottext">updateCleanupEventStatusToCompleted :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Citus)
-&gt; Text -&gt; DeletedEventLogStats -&gt; m ()
</span><a href="#local-6989586621690377374"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToCompleted</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DeletedEventLogStats
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-340"></span><span>  </span><span id="local-6989586621690377369"><span class="annot"><span class="annottext">deleteEventTriggerLogs :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Citus)
-&gt; TriggerLogCleanupConfig -&gt; m DeletedEventLogStats
</span><a href="#local-6989586621690377369"><span class="hs-identifier hs-var hs-var hs-var hs-var">deleteEventTriggerLogs</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig ('Postgres 'Citus)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerLogCleanupConfig
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Citus sources&quot;</span></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#BackendEventTrigger"><span class="hs-identifier hs-type">BackendEventTrigger</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Cockroach"><span class="hs-identifier hs-type">Cockroach</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-343"></span><span>  </span><span id="local-6989586621690377329"><span class="annot"><span class="annottext">insertManualEvent :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Cockroach)
-&gt; TableName ('Postgres 'Cockroach)
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
</span><a href="#local-6989586621690377329"><span class="hs-identifier hs-var hs-var hs-var hs-var">insertManualEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind)
-&gt; TableName ('Postgres pgKind)
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#insertManualEvent"><span class="hs-identifier hs-var">Postgres.insertManualEvent</span></a></span><span>
</span><span id="line-344"></span><span>  </span><span id="local-6989586621690377324"><span class="annot"><span class="annottext">fetchUndeliveredEvents :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Cockroach)
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event ('Postgres 'Cockroach)]
</span><a href="#local-6989586621690377324"><span class="hs-identifier hs-var hs-var hs-var hs-var">fetchUndeliveredEvents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind)
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event ('Postgres pgKind)]
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#fetchUndeliveredEvents"><span class="hs-identifier hs-var">Postgres.fetchUndeliveredEvents</span></a></span><span>
</span><span id="line-345"></span><span>  </span><span id="local-6989586621690377319"><span class="annot"><span class="annottext">setRetry :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Cockroach)
-&gt; Event ('Postgres 'Cockroach)
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
</span><a href="#local-6989586621690377319"><span class="hs-identifier hs-var hs-var hs-var hs-var">setRetry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind)
-&gt; Event ('Postgres pgKind)
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#setRetry"><span class="hs-identifier hs-var">Postgres.setRetry</span></a></span><span>
</span><span id="line-346"></span><span>  </span><span id="local-6989586621690377314"><span class="annot"><span class="annottext">getMaintenanceModeVersion :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Cockroach) -&gt; m MaintenanceModeVersion
</span><a href="#local-6989586621690377314"><span class="hs-identifier hs-var hs-var hs-var hs-var">getMaintenanceModeVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind) -&gt; m MaintenanceModeVersion
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#getMaintenanceModeVersion"><span class="hs-identifier hs-var">Postgres.getMaintenanceModeVersion</span></a></span><span>
</span><span id="line-347"></span><span>  </span><span id="local-6989586621690377311"><span class="annot"><span class="annottext">recordSuccess :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig ('Postgres 'Cockroach)
-&gt; Event ('Postgres 'Cockroach)
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377311"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordSuccess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
MonadIO m =&gt;
SourceConfig ('Postgres pgKind)
-&gt; Event ('Postgres pgKind)
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#recordSuccess"><span class="hs-identifier hs-var">Postgres.recordSuccess</span></a></span><span>
</span><span id="line-348"></span><span>  </span><span id="local-6989586621690377308"><span class="annot"><span class="annottext">recordError :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig ('Postgres 'Cockroach)
-&gt; Event ('Postgres 'Cockroach)
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377308"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
MonadIO m =&gt;
SourceConfig ('Postgres pgKind)
-&gt; Event ('Postgres pgKind)
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#recordError"><span class="hs-identifier hs-var">Postgres.recordError</span></a></span><span>
</span><span id="line-349"></span><span>  </span><span id="local-6989586621690377305"><span class="annot"><span class="annottext">recordError' :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig ('Postgres 'Cockroach)
-&gt; Event ('Postgres 'Cockroach)
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377305"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
MonadIO m =&gt;
SourceConfig ('Postgres pgKind)
-&gt; Event ('Postgres pgKind)
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#recordError%27"><span class="hs-identifier hs-var">Postgres.recordError'</span></a></span><span>
</span><span id="line-350"></span><span>  </span><span id="local-6989586621690377300"><span class="annot"><span class="annottext">dropTriggerAndArchiveEvents :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Cockroach)
-&gt; TriggerName -&gt; TableName ('Postgres 'Cockroach) -&gt; m ()
</span><a href="#local-6989586621690377300"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropTriggerAndArchiveEvents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind)
-&gt; TriggerName -&gt; QualifiedTable -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#dropTriggerAndArchiveEvents"><span class="hs-identifier hs-var">Postgres.dropTriggerAndArchiveEvents</span></a></span><span>
</span><span id="line-351"></span><span>  </span><span id="local-6989586621690377295"><span class="annot"><span class="annottext">dropDanglingSQLTrigger :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Cockroach)
-&gt; TriggerName
-&gt; TableName ('Postgres 'Cockroach)
-&gt; HashSet Ops
-&gt; m ()
</span><a href="#local-6989586621690377295"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropDanglingSQLTrigger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind)
-&gt; TriggerName -&gt; QualifiedTable -&gt; HashSet Ops -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#dropDanglingSQLTrigger"><span class="hs-identifier hs-var">Postgres.dropDanglingSQLTrigger</span></a></span><span>
</span><span id="line-352"></span><span>  </span><span id="local-6989586621690377290"><span class="annot"><span class="annottext">redeliverEvent :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Cockroach) -&gt; EventId -&gt; m ()
</span><a href="#local-6989586621690377290"><span class="hs-identifier hs-var hs-var hs-var hs-var">redeliverEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres pgKind) -&gt; EventId -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#redeliverEvent"><span class="hs-identifier hs-var">Postgres.redeliverEvent</span></a></span><span>
</span><span id="line-353"></span><span>  </span><span id="local-6989586621690377287"><span class="annot"><span class="annottext">unlockEventsInSource :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig ('Postgres 'Cockroach)
-&gt; NESet EventId -&gt; m (Either QErr Int)
</span><a href="#local-6989586621690377287"><span class="hs-identifier hs-var hs-var hs-var hs-var">unlockEventsInSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
MonadIO m =&gt;
SourceConfig ('Postgres pgKind)
-&gt; NESet EventId -&gt; m (Either QErr Int)
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#unlockEventsInSource"><span class="hs-identifier hs-var">Postgres.unlockEventsInSource</span></a></span><span>
</span><span id="line-354"></span><span>  </span><span id="local-6989586621690377273"><span class="annot"><span class="annottext">createTableEventTrigger :: forall (m :: * -&gt; *).
(MonadBaseControl IO m, MonadIO m, MonadError QErr m) =&gt;
ServerConfigCtx
-&gt; SourceConfig ('Postgres 'Cockroach)
-&gt; TableName ('Postgres 'Cockroach)
-&gt; [ColumnInfo ('Postgres 'Cockroach)]
-&gt; TriggerName
-&gt; TriggerOpsDef ('Postgres 'Cockroach)
-&gt; Maybe
     (PrimaryKey
        ('Postgres 'Cockroach) (ColumnInfo ('Postgres 'Cockroach)))
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377273"><span class="hs-identifier hs-var hs-var hs-var hs-var">createTableEventTrigger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(Backend ('Postgres pgKind), MonadIO m, MonadBaseControl IO m) =&gt;
ServerConfigCtx
-&gt; PGSourceConfig
-&gt; QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; TriggerName
-&gt; TriggerOpsDef ('Postgres pgKind)
-&gt; Maybe
     (PrimaryKey ('Postgres pgKind) (ColumnInfo ('Postgres pgKind)))
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#createTableEventTrigger"><span class="hs-identifier hs-var">Postgres.createTableEventTrigger</span></a></span><span>
</span><span id="line-355"></span><span>  </span><span id="local-6989586621690377262"><span class="annot"><span class="annottext">createMissingSQLTriggers :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m,
 Backend ('Postgres 'Cockroach), HasServerConfigCtx m) =&gt;
SourceConfig ('Postgres 'Cockroach)
-&gt; TableName ('Postgres 'Cockroach)
-&gt; ([ColumnInfo ('Postgres 'Cockroach)],
    Maybe
      (PrimaryKey
         ('Postgres 'Cockroach) (ColumnInfo ('Postgres 'Cockroach))))
-&gt; TriggerName
-&gt; TriggerOpsDef ('Postgres 'Cockroach)
-&gt; m ()
</span><a href="#local-6989586621690377262"><span class="hs-identifier hs-var hs-var hs-var hs-var">createMissingSQLTriggers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m,
 HasServerConfigCtx m, Backend ('Postgres pgKind)) =&gt;
PGSourceConfig
-&gt; TableName ('Postgres pgKind)
-&gt; ([ColumnInfo ('Postgres pgKind)],
    Maybe
      (PrimaryKey ('Postgres pgKind) (ColumnInfo ('Postgres pgKind))))
-&gt; TriggerName
-&gt; TriggerOpsDef ('Postgres pgKind)
-&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#createMissingSQLTriggers"><span class="hs-identifier hs-var">Postgres.createMissingSQLTriggers</span></a></span><span>
</span><span id="line-356"></span><span>  </span><span id="local-6989586621690377257"><span class="annot"><span class="annottext">checkIfTriggerExists :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Cockroach)
-&gt; TriggerName -&gt; HashSet Ops -&gt; m Bool
</span><a href="#local-6989586621690377257"><span class="hs-identifier hs-var hs-var hs-var hs-var">checkIfTriggerExists</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
PGSourceConfig -&gt; TriggerName -&gt; HashSet Ops -&gt; m Bool
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#checkIfTriggerExists"><span class="hs-identifier hs-var">Postgres.checkIfTriggerExists</span></a></span><span>
</span><span id="line-357"></span><span>  </span><span id="local-6989586621690377252"><span class="annot"><span class="annottext">addCleanupSchedules :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Cockroach)
-&gt; [(TriggerName, AutoTriggerLogCleanupConfig)] -&gt; m ()
</span><a href="#local-6989586621690377252"><span class="hs-identifier hs-var hs-var hs-var hs-var">addCleanupSchedules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
PGSourceConfig
-&gt; [(TriggerName, AutoTriggerLogCleanupConfig)] -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#addCleanupSchedules"><span class="hs-identifier hs-var">Postgres.addCleanupSchedules</span></a></span><span>
</span><span id="line-358"></span><span>  </span><span id="local-6989586621690377247"><span class="annot"><span class="annottext">deleteAllScheduledCleanups :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Cockroach) -&gt; TriggerName -&gt; m ()
</span><a href="#local-6989586621690377247"><span class="hs-identifier hs-var hs-var hs-var hs-var">deleteAllScheduledCleanups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
PGSourceConfig -&gt; TriggerName -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#deleteAllScheduledCleanups"><span class="hs-identifier hs-var">Postgres.deleteAllScheduledCleanups</span></a></span><span>
</span><span id="line-359"></span><span>  </span><span id="local-6989586621690377242"><span class="annot"><span class="annottext">getCleanupEventsForDeletion :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Cockroach) -&gt; m [(Text, TriggerName)]
</span><a href="#local-6989586621690377242"><span class="hs-identifier hs-var hs-var hs-var hs-var">getCleanupEventsForDeletion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
PGSourceConfig -&gt; m [(Text, TriggerName)]
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#getCleanupEventsForDeletion"><span class="hs-identifier hs-var">Postgres.getCleanupEventsForDeletion</span></a></span><span>
</span><span id="line-360"></span><span>  </span><span id="local-6989586621690377237"><span class="annot"><span class="annottext">updateCleanupEventStatusToDead :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Cockroach) -&gt; [Text] -&gt; m ()
</span><a href="#local-6989586621690377237"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToDead</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
PGSourceConfig -&gt; [Text] -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#updateCleanupEventStatusToDead"><span class="hs-identifier hs-var">Postgres.updateCleanupEventStatusToDead</span></a></span><span>
</span><span id="line-361"></span><span>  </span><span id="local-6989586621690377232"><span class="annot"><span class="annottext">updateCleanupEventStatusToPaused :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Cockroach) -&gt; Text -&gt; m ()
</span><a href="#local-6989586621690377232"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToPaused</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
PGSourceConfig -&gt; Text -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#updateCleanupEventStatusToPaused"><span class="hs-identifier hs-var">Postgres.updateCleanupEventStatusToPaused</span></a></span><span>
</span><span id="line-362"></span><span>  </span><span id="local-6989586621690377227"><span class="annot"><span class="annottext">updateCleanupEventStatusToCompleted :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Cockroach)
-&gt; Text -&gt; DeletedEventLogStats -&gt; m ()
</span><a href="#local-6989586621690377227"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToCompleted</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
PGSourceConfig -&gt; Text -&gt; DeletedEventLogStats -&gt; m ()
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#updateCleanupEventStatusToCompleted"><span class="hs-identifier hs-var">Postgres.updateCleanupEventStatusToCompleted</span></a></span><span>
</span><span id="line-363"></span><span>  </span><span id="local-6989586621690377222"><span class="annot"><span class="annottext">deleteEventTriggerLogs :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig ('Postgres 'Cockroach)
-&gt; TriggerLogCleanupConfig -&gt; m DeletedEventLogStats
</span><a href="#local-6989586621690377222"><span class="hs-identifier hs-var hs-var hs-var hs-var">deleteEventTriggerLogs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
PGSourceConfig -&gt; TriggerLogCleanupConfig -&gt; m DeletedEventLogStats
</span><a href="Hasura.Backends.Postgres.DDL.EventTrigger.html#deleteEventTriggerLogs"><span class="hs-identifier hs-var">Postgres.deleteEventTriggerLogs</span></a></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#BackendEventTrigger"><span class="hs-identifier hs-type">BackendEventTrigger</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#MSSQL"><span class="hs-identifier hs-type">MSSQL</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-366"></span><span>  </span><span id="local-6989586621690377192"><span class="annot"><span class="annottext">insertManualEvent :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MSSQL
-&gt; TableName 'MSSQL
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
</span><a href="#local-6989586621690377192"><span class="hs-identifier hs-var hs-var hs-var hs-var">insertManualEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig
-&gt; TableName
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#insertManualEvent"><span class="hs-identifier hs-var">MSSQL.insertManualEvent</span></a></span><span>
</span><span id="line-367"></span><span>  </span><span id="local-6989586621690377186"><span class="annot"><span class="annottext">fetchUndeliveredEvents :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MSSQL
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event 'MSSQL]
</span><a href="#local-6989586621690377186"><span class="hs-identifier hs-var hs-var hs-var hs-var">fetchUndeliveredEvents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event 'MSSQL]
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#fetchUndeliveredEvents"><span class="hs-identifier hs-var">MSSQL.fetchUndeliveredEvents</span></a></span><span>
</span><span id="line-368"></span><span>  </span><span id="local-6989586621690377180"><span class="annot"><span class="annottext">setRetry :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MSSQL
-&gt; Event 'MSSQL
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
</span><a href="#local-6989586621690377180"><span class="hs-identifier hs-var hs-var hs-var hs-var">setRetry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig
-&gt; Event 'MSSQL
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#setRetry"><span class="hs-identifier hs-var">MSSQL.setRetry</span></a></span><span>
</span><span id="line-369"></span><span>  </span><span id="local-6989586621690377176"><span class="annot"><span class="annottext">recordSuccess :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig 'MSSQL
-&gt; Event 'MSSQL
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377176"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordSuccess</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadIO m =&gt;
MSSQLSourceConfig
-&gt; Event 'MSSQL
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#recordSuccess"><span class="hs-identifier hs-var">MSSQL.recordSuccess</span></a></span><span>
</span><span id="line-370"></span><span>  </span><span id="local-6989586621690377170"><span class="annot"><span class="annottext">getMaintenanceModeVersion :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MSSQL -&gt; m MaintenanceModeVersion
</span><a href="#local-6989586621690377170"><span class="hs-identifier hs-var hs-var hs-var hs-var">getMaintenanceModeVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig -&gt; m MaintenanceModeVersion
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#getMaintenanceModeVersion"><span class="hs-identifier hs-var">MSSQL.getMaintenanceModeVersion</span></a></span><span>
</span><span id="line-371"></span><span>  </span><span id="local-6989586621690377166"><span class="annot"><span class="annottext">recordError :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig 'MSSQL
-&gt; Event 'MSSQL
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377166"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadIO m =&gt;
MSSQLSourceConfig
-&gt; Event 'MSSQL
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#recordError"><span class="hs-identifier hs-var">MSSQL.recordError</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span id="local-6989586621690377162"><span class="annot"><span class="annottext">recordError' :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig 'MSSQL
-&gt; Event 'MSSQL
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377162"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadIO m =&gt;
MSSQLSourceConfig
-&gt; Event 'MSSQL
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#recordError%27"><span class="hs-identifier hs-var">MSSQL.recordError'</span></a></span><span>
</span><span id="line-373"></span><span>  </span><span id="local-6989586621690377156"><span class="annot"><span class="annottext">dropTriggerAndArchiveEvents :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MSSQL -&gt; TriggerName -&gt; TableName 'MSSQL -&gt; m ()
</span><a href="#local-6989586621690377156"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropTriggerAndArchiveEvents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig -&gt; TriggerName -&gt; TableName -&gt; m ()
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#dropTriggerAndArchiveEvents"><span class="hs-identifier hs-var">MSSQL.dropTriggerAndArchiveEvents</span></a></span><span>
</span><span id="line-374"></span><span>  </span><span id="local-6989586621690377150"><span class="annot"><span class="annottext">redeliverEvent :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MSSQL -&gt; EventId -&gt; m ()
</span><a href="#local-6989586621690377150"><span class="hs-identifier hs-var hs-var hs-var hs-var">redeliverEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig -&gt; EventId -&gt; m ()
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#redeliverEvent"><span class="hs-identifier hs-var">MSSQL.redeliverEvent</span></a></span><span>
</span><span id="line-375"></span><span>  </span><span id="local-6989586621690377146"><span class="annot"><span class="annottext">unlockEventsInSource :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig 'MSSQL -&gt; NESet EventId -&gt; m (Either QErr Int)
</span><a href="#local-6989586621690377146"><span class="hs-identifier hs-var hs-var hs-var hs-var">unlockEventsInSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadIO m =&gt;
MSSQLSourceConfig -&gt; NESet EventId -&gt; m (Either QErr Int)
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#unlockEventsInSource"><span class="hs-identifier hs-var">MSSQL.unlockEventsInSource</span></a></span><span>
</span><span id="line-376"></span><span>  </span><span id="local-6989586621690377140"><span class="annot"><span class="annottext">dropDanglingSQLTrigger :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MSSQL
-&gt; TriggerName -&gt; TableName 'MSSQL -&gt; HashSet Ops -&gt; m ()
</span><a href="#local-6989586621690377140"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropDanglingSQLTrigger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig
-&gt; TriggerName -&gt; TableName -&gt; HashSet Ops -&gt; m ()
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#dropDanglingSQLTrigger"><span class="hs-identifier hs-var">MSSQL.dropDanglingSQLTrigger</span></a></span><span>
</span><span id="line-377"></span><span>  </span><span id="local-6989586621690377134"><span class="annot"><span class="annottext">createTableEventTrigger :: forall (m :: * -&gt; *).
(MonadBaseControl IO m, MonadIO m, MonadError QErr m) =&gt;
ServerConfigCtx
-&gt; SourceConfig 'MSSQL
-&gt; TableName 'MSSQL
-&gt; [ColumnInfo 'MSSQL]
-&gt; TriggerName
-&gt; TriggerOpsDef 'MSSQL
-&gt; Maybe (PrimaryKey 'MSSQL (ColumnInfo 'MSSQL))
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377134"><span class="hs-identifier hs-var hs-var hs-var hs-var">createTableEventTrigger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadIO m =&gt;
ServerConfigCtx
-&gt; MSSQLSourceConfig
-&gt; TableName
-&gt; [ColumnInfo 'MSSQL]
-&gt; TriggerName
-&gt; TriggerOpsDef 'MSSQL
-&gt; Maybe (PrimaryKey 'MSSQL (ColumnInfo 'MSSQL))
-&gt; m (Either QErr ())
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#createTableEventTrigger"><span class="hs-identifier hs-var">MSSQL.createTableEventTrigger</span></a></span><span>
</span><span id="line-378"></span><span>  </span><span id="local-6989586621690377124"><span class="annot"><span class="annottext">createMissingSQLTriggers :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m,
 Backend 'MSSQL, HasServerConfigCtx m) =&gt;
SourceConfig 'MSSQL
-&gt; TableName 'MSSQL
-&gt; ([ColumnInfo 'MSSQL],
    Maybe (PrimaryKey 'MSSQL (ColumnInfo 'MSSQL)))
-&gt; TriggerName
-&gt; TriggerOpsDef 'MSSQL
-&gt; m ()
</span><a href="#local-6989586621690377124"><span class="hs-identifier hs-var hs-var hs-var hs-var">createMissingSQLTriggers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m) =&gt;
MSSQLSourceConfig
-&gt; TableName
-&gt; ([ColumnInfo 'MSSQL],
    Maybe (PrimaryKey 'MSSQL (ColumnInfo 'MSSQL)))
-&gt; TriggerName
-&gt; TriggerOpsDef 'MSSQL
-&gt; m ()
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#createMissingSQLTriggers"><span class="hs-identifier hs-var">MSSQL.createMissingSQLTriggers</span></a></span><span>
</span><span id="line-379"></span><span>  </span><span id="local-6989586621690377118"><span class="annot"><span class="annottext">checkIfTriggerExists :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MSSQL -&gt; TriggerName -&gt; HashSet Ops -&gt; m Bool
</span><a href="#local-6989586621690377118"><span class="hs-identifier hs-var hs-var hs-var hs-var">checkIfTriggerExists</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig -&gt; TriggerName -&gt; HashSet Ops -&gt; m Bool
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#checkIfTriggerExists"><span class="hs-identifier hs-var">MSSQL.checkIfTriggerExists</span></a></span><span>
</span><span id="line-380"></span><span>  </span><span id="local-6989586621690377112"><span class="annot"><span class="annottext">addCleanupSchedules :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MSSQL
-&gt; [(TriggerName, AutoTriggerLogCleanupConfig)] -&gt; m ()
</span><a href="#local-6989586621690377112"><span class="hs-identifier hs-var hs-var hs-var hs-var">addCleanupSchedules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig
-&gt; [(TriggerName, AutoTriggerLogCleanupConfig)] -&gt; m ()
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#addCleanupSchedules"><span class="hs-identifier hs-var">MSSQL.addCleanupSchedules</span></a></span><span>
</span><span id="line-381"></span><span>  </span><span id="local-6989586621690377106"><span class="annot"><span class="annottext">deleteAllScheduledCleanups :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MSSQL -&gt; TriggerName -&gt; m ()
</span><a href="#local-6989586621690377106"><span class="hs-identifier hs-var hs-var hs-var hs-var">deleteAllScheduledCleanups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig -&gt; TriggerName -&gt; m ()
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#deleteAllScheduledCleanups"><span class="hs-identifier hs-var">MSSQL.deleteAllScheduledCleanups</span></a></span><span>
</span><span id="line-382"></span><span>  </span><span id="local-6989586621690377100"><span class="annot"><span class="annottext">getCleanupEventsForDeletion :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MSSQL -&gt; m [(Text, TriggerName)]
</span><a href="#local-6989586621690377100"><span class="hs-identifier hs-var hs-var hs-var hs-var">getCleanupEventsForDeletion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig -&gt; m [(Text, TriggerName)]
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#getCleanupEventsForDeletion"><span class="hs-identifier hs-var">MSSQL.getCleanupEventsForDeletion</span></a></span><span>
</span><span id="line-383"></span><span>  </span><span id="local-6989586621690377094"><span class="annot"><span class="annottext">updateCleanupEventStatusToDead :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MSSQL -&gt; [Text] -&gt; m ()
</span><a href="#local-6989586621690377094"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToDead</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig -&gt; [Text] -&gt; m ()
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#updateCleanupEventStatusToDead"><span class="hs-identifier hs-var">MSSQL.updateCleanupEventStatusToDead</span></a></span><span>
</span><span id="line-384"></span><span>  </span><span id="local-6989586621690377088"><span class="annot"><span class="annottext">updateCleanupEventStatusToPaused :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MSSQL -&gt; Text -&gt; m ()
</span><a href="#local-6989586621690377088"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToPaused</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig -&gt; Text -&gt; m ()
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#updateCleanupEventStatusToPaused"><span class="hs-identifier hs-var">MSSQL.updateCleanupEventStatusToPaused</span></a></span><span>
</span><span id="line-385"></span><span>  </span><span id="local-6989586621690377082"><span class="annot"><span class="annottext">updateCleanupEventStatusToCompleted :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MSSQL -&gt; Text -&gt; DeletedEventLogStats -&gt; m ()
</span><a href="#local-6989586621690377082"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToCompleted</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig -&gt; Text -&gt; DeletedEventLogStats -&gt; m ()
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#updateCleanupEventStatusToCompleted"><span class="hs-identifier hs-var">MSSQL.updateCleanupEventStatusToCompleted</span></a></span><span>
</span><span id="line-386"></span><span>  </span><span id="local-6989586621690377076"><span class="annot"><span class="annottext">deleteEventTriggerLogs :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MSSQL
-&gt; TriggerLogCleanupConfig -&gt; m DeletedEventLogStats
</span><a href="#local-6989586621690377076"><span class="hs-identifier hs-var hs-var hs-var hs-var">deleteEventTriggerLogs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
MSSQLSourceConfig
-&gt; TriggerLogCleanupConfig -&gt; m DeletedEventLogStats
</span><a href="Hasura.Backends.MSSQL.DDL.EventTrigger.html#deleteEventTriggerLogs"><span class="hs-identifier hs-var">MSSQL.deleteEventTriggerLogs</span></a></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#BackendEventTrigger"><span class="hs-identifier hs-type">BackendEventTrigger</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#BigQuery"><span class="hs-identifier hs-type">BigQuery</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-389"></span><span>  </span><span id="local-6989586621690377045"><span class="annot"><span class="annottext">insertManualEvent :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'BigQuery
-&gt; TableName 'BigQuery
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
</span><a href="#local-6989586621690377045"><span class="hs-identifier hs-var hs-var hs-var hs-var">insertManualEvent</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TraceContext
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-390"></span><span>  </span><span id="local-6989586621690377040"><span class="annot"><span class="annottext">fetchUndeliveredEvents :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'BigQuery
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event 'BigQuery]
</span><a href="#local-6989586621690377040"><span class="hs-identifier hs-var hs-var hs-var hs-var">fetchUndeliveredEvents</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TriggerName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FetchBatchSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-391"></span><span>  </span><span id="local-6989586621690377035"><span class="annot"><span class="annottext">setRetry :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'BigQuery
-&gt; Event 'BigQuery
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
</span><a href="#local-6989586621690377035"><span class="hs-identifier hs-var hs-var hs-var hs-var">setRetry</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-392"></span><span>  </span><span id="local-6989586621690377030"><span class="annot"><span class="annottext">recordSuccess :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig 'BigQuery
-&gt; Event 'BigQuery
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377030"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordSuccess</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Invocation 'EventType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-393"></span><span>  </span><span id="local-6989586621690377025"><span class="annot"><span class="annottext">getMaintenanceModeVersion :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'BigQuery -&gt; m MaintenanceModeVersion
</span><a href="#local-6989586621690377025"><span class="hs-identifier hs-var hs-var hs-var hs-var">getMaintenanceModeVersion</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-394"></span><span>  </span><span id="local-6989586621690377020"><span class="annot"><span class="annottext">recordError :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig 'BigQuery
-&gt; Event 'BigQuery
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377020"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Invocation 'EventType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ProcessEventError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-395"></span><span>  </span><span id="local-6989586621690377015"><span class="annot"><span class="annottext">recordError' :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig 'BigQuery
-&gt; Event 'BigQuery
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690377015"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError'</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Invocation 'EventType)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ProcessEventError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-396"></span><span>  </span><span id="local-6989586621690377010"><span class="annot"><span class="annottext">dropTriggerAndArchiveEvents :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'BigQuery
-&gt; TriggerName -&gt; TableName 'BigQuery -&gt; m ()
</span><a href="#local-6989586621690377010"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropTriggerAndArchiveEvents</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-397"></span><span>  </span><span id="local-6989586621690377005"><span class="annot"><span class="annottext">dropDanglingSQLTrigger :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'BigQuery
-&gt; TriggerName -&gt; TableName 'BigQuery -&gt; HashSet Ops -&gt; m ()
</span><a href="#local-6989586621690377005"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropDanglingSQLTrigger</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HashSet Ops
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-398"></span><span>  </span><span id="local-6989586621690377000"><span class="annot"><span class="annottext">redeliverEvent :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'BigQuery -&gt; EventId -&gt; m ()
</span><a href="#local-6989586621690377000"><span class="hs-identifier hs-var hs-var hs-var hs-var">redeliverEvent</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">EventId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-399"></span><span>  </span><span id="local-6989586621690376995"><span class="annot"><span class="annottext">unlockEventsInSource :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig 'BigQuery -&gt; NESet EventId -&gt; m (Either QErr Int)
</span><a href="#local-6989586621690376995"><span class="hs-identifier hs-var hs-var hs-var hs-var">unlockEventsInSource</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NESet EventId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-400"></span><span>  </span><span id="local-6989586621690376988"><span class="annot"><span class="annottext">createTableEventTrigger :: forall (m :: * -&gt; *).
(MonadBaseControl IO m, MonadIO m, MonadError QErr m) =&gt;
ServerConfigCtx
-&gt; SourceConfig 'BigQuery
-&gt; TableName 'BigQuery
-&gt; [ColumnInfo 'BigQuery]
-&gt; TriggerName
-&gt; TriggerOpsDef 'BigQuery
-&gt; Maybe (PrimaryKey 'BigQuery (ColumnInfo 'BigQuery))
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690376988"><span class="hs-identifier hs-var hs-var hs-var hs-var">createTableEventTrigger</span></a></span></span><span> </span><span class="annot"><span class="annottext">ServerConfigCtx
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo 'BigQuery]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerOpsDef 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (PrimaryKey 'BigQuery (ColumnInfo 'BigQuery))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-401"></span><span>  </span><span id="local-6989586621690376980"><span class="annot"><span class="annottext">createMissingSQLTriggers :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m,
 Backend 'BigQuery, HasServerConfigCtx m) =&gt;
SourceConfig 'BigQuery
-&gt; TableName 'BigQuery
-&gt; ([ColumnInfo 'BigQuery],
    Maybe (PrimaryKey 'BigQuery (ColumnInfo 'BigQuery)))
-&gt; TriggerName
-&gt; TriggerOpsDef 'BigQuery
-&gt; m ()
</span><a href="#local-6989586621690376980"><span class="hs-identifier hs-var hs-var hs-var hs-var">createMissingSQLTriggers</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">([ColumnInfo 'BigQuery],
 Maybe (PrimaryKey 'BigQuery (ColumnInfo 'BigQuery)))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerOpsDef 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-402"></span><span>  </span><span id="local-6989586621690376975"><span class="annot"><span class="annottext">checkIfTriggerExists :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'BigQuery -&gt; TriggerName -&gt; HashSet Ops -&gt; m Bool
</span><a href="#local-6989586621690376975"><span class="hs-identifier hs-var hs-var hs-var hs-var">checkIfTriggerExists</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HashSet Ops
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-403"></span><span>  </span><span id="local-6989586621690376970"><span class="annot"><span class="annottext">addCleanupSchedules :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'BigQuery
-&gt; [(TriggerName, AutoTriggerLogCleanupConfig)] -&gt; m ()
</span><a href="#local-6989586621690376970"><span class="hs-identifier hs-var hs-var hs-var hs-var">addCleanupSchedules</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(TriggerName, AutoTriggerLogCleanupConfig)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-404"></span><span>  </span><span id="local-6989586621690376965"><span class="annot"><span class="annottext">deleteAllScheduledCleanups :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'BigQuery -&gt; TriggerName -&gt; m ()
</span><a href="#local-6989586621690376965"><span class="hs-identifier hs-var hs-var hs-var hs-var">deleteAllScheduledCleanups</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-405"></span><span>  </span><span id="local-6989586621690376960"><span class="annot"><span class="annottext">getCleanupEventsForDeletion :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'BigQuery -&gt; m [(Text, TriggerName)]
</span><a href="#local-6989586621690376960"><span class="hs-identifier hs-var hs-var hs-var hs-var">getCleanupEventsForDeletion</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-406"></span><span>  </span><span id="local-6989586621690376955"><span class="annot"><span class="annottext">updateCleanupEventStatusToDead :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'BigQuery -&gt; [Text] -&gt; m ()
</span><a href="#local-6989586621690376955"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToDead</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-407"></span><span>  </span><span id="local-6989586621690376950"><span class="annot"><span class="annottext">updateCleanupEventStatusToPaused :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'BigQuery -&gt; Text -&gt; m ()
</span><a href="#local-6989586621690376950"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToPaused</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-408"></span><span>  </span><span id="local-6989586621690376945"><span class="annot"><span class="annottext">updateCleanupEventStatusToCompleted :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'BigQuery -&gt; Text -&gt; DeletedEventLogStats -&gt; m ()
</span><a href="#local-6989586621690376945"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToCompleted</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DeletedEventLogStats
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-409"></span><span>  </span><span id="local-6989586621690376940"><span class="annot"><span class="annottext">deleteEventTriggerLogs :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'BigQuery
-&gt; TriggerLogCleanupConfig -&gt; m DeletedEventLogStats
</span><a href="#local-6989586621690376940"><span class="hs-identifier hs-var hs-var hs-var hs-var">deleteEventTriggerLogs</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'BigQuery
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerLogCleanupConfig
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for BigQuery sources&quot;</span></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#BackendEventTrigger"><span class="hs-identifier hs-type">BackendEventTrigger</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#MySQL"><span class="hs-identifier hs-type">MySQL</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-412"></span><span>  </span><span id="local-6989586621690376910"><span class="annot"><span class="annottext">insertManualEvent :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MySQL
-&gt; TableName 'MySQL
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
</span><a href="#local-6989586621690376910"><span class="hs-identifier hs-var hs-var hs-var hs-var">insertManualEvent</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TraceContext
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-413"></span><span>  </span><span id="local-6989586621690376905"><span class="annot"><span class="annottext">fetchUndeliveredEvents :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MySQL
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event 'MySQL]
</span><a href="#local-6989586621690376905"><span class="hs-identifier hs-var hs-var hs-var hs-var">fetchUndeliveredEvents</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TriggerName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FetchBatchSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-414"></span><span>  </span><span id="local-6989586621690376900"><span class="annot"><span class="annottext">setRetry :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MySQL
-&gt; Event 'MySQL
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
</span><a href="#local-6989586621690376900"><span class="hs-identifier hs-var hs-var hs-var hs-var">setRetry</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-415"></span><span>  </span><span id="local-6989586621690376895"><span class="annot"><span class="annottext">recordSuccess :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig 'MySQL
-&gt; Event 'MySQL
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690376895"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordSuccess</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Invocation 'EventType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-416"></span><span>  </span><span id="local-6989586621690376890"><span class="annot"><span class="annottext">getMaintenanceModeVersion :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MySQL -&gt; m MaintenanceModeVersion
</span><a href="#local-6989586621690376890"><span class="hs-identifier hs-var hs-var hs-var hs-var">getMaintenanceModeVersion</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-417"></span><span>  </span><span id="local-6989586621690376885"><span class="annot"><span class="annottext">recordError :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig 'MySQL
-&gt; Event 'MySQL
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690376885"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Invocation 'EventType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ProcessEventError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-418"></span><span>  </span><span id="local-6989586621690376880"><span class="annot"><span class="annottext">recordError' :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig 'MySQL
-&gt; Event 'MySQL
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690376880"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError'</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Invocation 'EventType)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ProcessEventError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-419"></span><span>  </span><span id="local-6989586621690376875"><span class="annot"><span class="annottext">dropTriggerAndArchiveEvents :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MySQL -&gt; TriggerName -&gt; TableName 'MySQL -&gt; m ()
</span><a href="#local-6989586621690376875"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropTriggerAndArchiveEvents</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-420"></span><span>  </span><span id="local-6989586621690376870"><span class="annot"><span class="annottext">dropDanglingSQLTrigger :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MySQL
-&gt; TriggerName -&gt; TableName 'MySQL -&gt; HashSet Ops -&gt; m ()
</span><a href="#local-6989586621690376870"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropDanglingSQLTrigger</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HashSet Ops
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-421"></span><span>  </span><span id="local-6989586621690376865"><span class="annot"><span class="annottext">redeliverEvent :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MySQL -&gt; EventId -&gt; m ()
</span><a href="#local-6989586621690376865"><span class="hs-identifier hs-var hs-var hs-var hs-var">redeliverEvent</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">EventId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-422"></span><span>  </span><span id="local-6989586621690376860"><span class="annot"><span class="annottext">unlockEventsInSource :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig 'MySQL -&gt; NESet EventId -&gt; m (Either QErr Int)
</span><a href="#local-6989586621690376860"><span class="hs-identifier hs-var hs-var hs-var hs-var">unlockEventsInSource</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NESet EventId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-423"></span><span>  </span><span id="local-6989586621690376853"><span class="annot"><span class="annottext">createTableEventTrigger :: forall (m :: * -&gt; *).
(MonadBaseControl IO m, MonadIO m, MonadError QErr m) =&gt;
ServerConfigCtx
-&gt; SourceConfig 'MySQL
-&gt; TableName 'MySQL
-&gt; [ColumnInfo 'MySQL]
-&gt; TriggerName
-&gt; TriggerOpsDef 'MySQL
-&gt; Maybe (PrimaryKey 'MySQL (ColumnInfo 'MySQL))
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690376853"><span class="hs-identifier hs-var hs-var hs-var hs-var">createTableEventTrigger</span></a></span></span><span> </span><span class="annot"><span class="annottext">ServerConfigCtx
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo 'MySQL]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerOpsDef 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (PrimaryKey 'MySQL (ColumnInfo 'MySQL))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-424"></span><span>  </span><span id="local-6989586621690376845"><span class="annot"><span class="annottext">createMissingSQLTriggers :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m,
 Backend 'MySQL, HasServerConfigCtx m) =&gt;
SourceConfig 'MySQL
-&gt; TableName 'MySQL
-&gt; ([ColumnInfo 'MySQL],
    Maybe (PrimaryKey 'MySQL (ColumnInfo 'MySQL)))
-&gt; TriggerName
-&gt; TriggerOpsDef 'MySQL
-&gt; m ()
</span><a href="#local-6989586621690376845"><span class="hs-identifier hs-var hs-var hs-var hs-var">createMissingSQLTriggers</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">([ColumnInfo 'MySQL],
 Maybe (PrimaryKey 'MySQL (ColumnInfo 'MySQL)))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerOpsDef 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-425"></span><span>  </span><span id="local-6989586621690376840"><span class="annot"><span class="annottext">checkIfTriggerExists :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MySQL -&gt; TriggerName -&gt; HashSet Ops -&gt; m Bool
</span><a href="#local-6989586621690376840"><span class="hs-identifier hs-var hs-var hs-var hs-var">checkIfTriggerExists</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HashSet Ops
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-426"></span><span>  </span><span id="local-6989586621690376835"><span class="annot"><span class="annottext">addCleanupSchedules :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MySQL
-&gt; [(TriggerName, AutoTriggerLogCleanupConfig)] -&gt; m ()
</span><a href="#local-6989586621690376835"><span class="hs-identifier hs-var hs-var hs-var hs-var">addCleanupSchedules</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(TriggerName, AutoTriggerLogCleanupConfig)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-427"></span><span>  </span><span id="local-6989586621690376830"><span class="annot"><span class="annottext">deleteAllScheduledCleanups :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MySQL -&gt; TriggerName -&gt; m ()
</span><a href="#local-6989586621690376830"><span class="hs-identifier hs-var hs-var hs-var hs-var">deleteAllScheduledCleanups</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-428"></span><span>  </span><span id="local-6989586621690376825"><span class="annot"><span class="annottext">getCleanupEventsForDeletion :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MySQL -&gt; m [(Text, TriggerName)]
</span><a href="#local-6989586621690376825"><span class="hs-identifier hs-var hs-var hs-var hs-var">getCleanupEventsForDeletion</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-429"></span><span>  </span><span id="local-6989586621690376820"><span class="annot"><span class="annottext">updateCleanupEventStatusToDead :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MySQL -&gt; [Text] -&gt; m ()
</span><a href="#local-6989586621690376820"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToDead</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-430"></span><span>  </span><span id="local-6989586621690376815"><span class="annot"><span class="annottext">updateCleanupEventStatusToPaused :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MySQL -&gt; Text -&gt; m ()
</span><a href="#local-6989586621690376815"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToPaused</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-431"></span><span>  </span><span id="local-6989586621690376810"><span class="annot"><span class="annottext">updateCleanupEventStatusToCompleted :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MySQL -&gt; Text -&gt; DeletedEventLogStats -&gt; m ()
</span><a href="#local-6989586621690376810"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToCompleted</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DeletedEventLogStats
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-432"></span><span>  </span><span id="local-6989586621690376805"><span class="annot"><span class="annottext">deleteEventTriggerLogs :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'MySQL
-&gt; TriggerLogCleanupConfig -&gt; m DeletedEventLogStats
</span><a href="#local-6989586621690376805"><span class="hs-identifier hs-var hs-var hs-var hs-var">deleteEventTriggerLogs</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'MySQL
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerLogCleanupConfig
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for MySQL sources&quot;</span></span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span class="hs-comment">-- TODO(jkachmar): See if there isn't a way to define the function that</span><span>
</span><span id="line-437"></span><span class="hs-comment">-- implement these methods in the 'Hasura.Experimental.Adapters' module</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- hierarchy just to keep everything as tidy as possible for that section of</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- code.</span><span>
</span><span id="line-440"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Eventing.Backend.html#BackendEventTrigger"><span class="hs-identifier hs-type">BackendEventTrigger</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#DataConnector"><span class="hs-identifier hs-type">DataConnector</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-441"></span><span>  </span><span id="local-6989586621690376775"><span class="annot"><span class="annottext">insertManualEvent :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'DataConnector
-&gt; TableName 'DataConnector
-&gt; TriggerName
-&gt; Value
-&gt; UserInfo
-&gt; TraceContext
-&gt; m EventId
</span><a href="#local-6989586621690376775"><span class="hs-identifier hs-var hs-var hs-var hs-var">insertManualEvent</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TraceContext
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-442"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-443"></span><span>  </span><span id="local-6989586621690376770"><span class="annot"><span class="annottext">fetchUndeliveredEvents :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'DataConnector
-&gt; SourceName
-&gt; [TriggerName]
-&gt; MaintenanceMode ()
-&gt; FetchBatchSize
-&gt; m [Event 'DataConnector]
</span><a href="#local-6989586621690376770"><span class="hs-identifier hs-var hs-var hs-var hs-var">fetchUndeliveredEvents</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TriggerName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">FetchBatchSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-444"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-445"></span><span>  </span><span id="local-6989586621690376765"><span class="annot"><span class="annottext">setRetry :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'DataConnector
-&gt; Event 'DataConnector
-&gt; UTCTime
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m ()
</span><a href="#local-6989586621690376765"><span class="hs-identifier hs-var hs-var hs-var hs-var">setRetry</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-446"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-447"></span><span>  </span><span id="local-6989586621690376760"><span class="annot"><span class="annottext">recordSuccess :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig 'DataConnector
-&gt; Event 'DataConnector
-&gt; Invocation 'EventType
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690376760"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordSuccess</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Invocation 'EventType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-448"></span><span>    </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-449"></span><span>  </span><span id="local-6989586621690376755"><span class="annot"><span class="annottext">getMaintenanceModeVersion :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'DataConnector -&gt; m MaintenanceModeVersion
</span><a href="#local-6989586621690376755"><span class="hs-identifier hs-var hs-var hs-var hs-var">getMaintenanceModeVersion</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-450"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-451"></span><span>  </span><span id="local-6989586621690376750"><span class="annot"><span class="annottext">recordError :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig 'DataConnector
-&gt; Event 'DataConnector
-&gt; Invocation 'EventType
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690376750"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Invocation 'EventType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ProcessEventError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-452"></span><span>    </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-453"></span><span>  </span><span id="local-6989586621690376745"><span class="annot"><span class="annottext">recordError' :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig 'DataConnector
-&gt; Event 'DataConnector
-&gt; Maybe (Invocation 'EventType)
-&gt; ProcessEventError
-&gt; MaintenanceMode MaintenanceModeVersion
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690376745"><span class="hs-identifier hs-var hs-var hs-var hs-var">recordError'</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Invocation 'EventType)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ProcessEventError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MaintenanceMode MaintenanceModeVersion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-454"></span><span>    </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-455"></span><span>  </span><span id="local-6989586621690376740"><span class="annot"><span class="annottext">dropTriggerAndArchiveEvents :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'DataConnector
-&gt; TriggerName -&gt; TableName 'DataConnector -&gt; m ()
</span><a href="#local-6989586621690376740"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropTriggerAndArchiveEvents</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-456"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-457"></span><span>  </span><span id="local-6989586621690376735"><span class="annot"><span class="annottext">dropDanglingSQLTrigger :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'DataConnector
-&gt; TriggerName -&gt; TableName 'DataConnector -&gt; HashSet Ops -&gt; m ()
</span><a href="#local-6989586621690376735"><span class="hs-identifier hs-var hs-var hs-var hs-var">dropDanglingSQLTrigger</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HashSet Ops
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-458"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend&quot;</span></span><span>
</span><span id="line-459"></span><span>  </span><span id="local-6989586621690376730"><span class="annot"><span class="annottext">redeliverEvent :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'DataConnector -&gt; EventId -&gt; m ()
</span><a href="#local-6989586621690376730"><span class="hs-identifier hs-var hs-var hs-var hs-var">redeliverEvent</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">EventId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-460"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-461"></span><span>  </span><span id="local-6989586621690376725"><span class="annot"><span class="annottext">unlockEventsInSource :: forall (m :: * -&gt; *).
MonadIO m =&gt;
SourceConfig 'DataConnector -&gt; NESet EventId -&gt; m (Either QErr Int)
</span><a href="#local-6989586621690376725"><span class="hs-identifier hs-var hs-var hs-var hs-var">unlockEventsInSource</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">NESet EventId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-462"></span><span>    </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-463"></span><span>  </span><span id="local-6989586621690376718"><span class="annot"><span class="annottext">createTableEventTrigger :: forall (m :: * -&gt; *).
(MonadBaseControl IO m, MonadIO m, MonadError QErr m) =&gt;
ServerConfigCtx
-&gt; SourceConfig 'DataConnector
-&gt; TableName 'DataConnector
-&gt; [ColumnInfo 'DataConnector]
-&gt; TriggerName
-&gt; TriggerOpsDef 'DataConnector
-&gt; Maybe (PrimaryKey 'DataConnector (ColumnInfo 'DataConnector))
-&gt; m (Either QErr ())
</span><a href="#local-6989586621690376718"><span class="hs-identifier hs-var hs-var hs-var hs-var">createTableEventTrigger</span></a></span></span><span> </span><span class="annot"><span class="annottext">ServerConfigCtx
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo 'DataConnector]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerOpsDef 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (PrimaryKey 'DataConnector (ColumnInfo 'DataConnector))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-464"></span><span>    </span><span class="annot"><span class="annottext">forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for the Data Connector backend.&quot;</span></span><span>
</span><span id="line-465"></span><span>  </span><span id="local-6989586621690376710"><span class="annot"><span class="annottext">createMissingSQLTriggers :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m, MonadBaseControl IO m,
 Backend 'DataConnector, HasServerConfigCtx m) =&gt;
SourceConfig 'DataConnector
-&gt; TableName 'DataConnector
-&gt; ([ColumnInfo 'DataConnector],
    Maybe (PrimaryKey 'DataConnector (ColumnInfo 'DataConnector)))
-&gt; TriggerName
-&gt; TriggerOpsDef 'DataConnector
-&gt; m ()
</span><a href="#local-6989586621690376710"><span class="hs-identifier hs-var hs-var hs-var hs-var">createMissingSQLTriggers</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TableName 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">([ColumnInfo 'DataConnector],
 Maybe (PrimaryKey 'DataConnector (ColumnInfo 'DataConnector)))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerOpsDef 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Data Connector backend.&quot;</span></span><span>
</span><span id="line-466"></span><span>  </span><span id="local-6989586621690376705"><span class="annot"><span class="annottext">checkIfTriggerExists :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'DataConnector -&gt; TriggerName -&gt; HashSet Ops -&gt; m Bool
</span><a href="#local-6989586621690376705"><span class="hs-identifier hs-var hs-var hs-var hs-var">checkIfTriggerExists</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HashSet Ops
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Data Connector backend.&quot;</span></span><span>
</span><span id="line-467"></span><span>  </span><span id="local-6989586621690376700"><span class="annot"><span class="annottext">addCleanupSchedules :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'DataConnector
-&gt; [(TriggerName, AutoTriggerLogCleanupConfig)] -&gt; m ()
</span><a href="#local-6989586621690376700"><span class="hs-identifier hs-var hs-var hs-var hs-var">addCleanupSchedules</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(TriggerName, AutoTriggerLogCleanupConfig)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Data Connector backend.&quot;</span></span><span>
</span><span id="line-468"></span><span>  </span><span id="local-6989586621690376695"><span class="annot"><span class="annottext">deleteAllScheduledCleanups :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'DataConnector -&gt; TriggerName -&gt; m ()
</span><a href="#local-6989586621690376695"><span class="hs-identifier hs-var hs-var hs-var hs-var">deleteAllScheduledCleanups</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Data Connector backend.&quot;</span></span><span>
</span><span id="line-469"></span><span>  </span><span id="local-6989586621690376690"><span class="annot"><span class="annottext">getCleanupEventsForDeletion :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'DataConnector -&gt; m [(Text, TriggerName)]
</span><a href="#local-6989586621690376690"><span class="hs-identifier hs-var hs-var hs-var hs-var">getCleanupEventsForDeletion</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Data Connector sources&quot;</span></span><span>
</span><span id="line-470"></span><span>  </span><span id="local-6989586621690376685"><span class="annot"><span class="annottext">updateCleanupEventStatusToDead :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'DataConnector -&gt; [Text] -&gt; m ()
</span><a href="#local-6989586621690376685"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToDead</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Data Connector sources&quot;</span></span><span>
</span><span id="line-471"></span><span>  </span><span id="local-6989586621690376680"><span class="annot"><span class="annottext">updateCleanupEventStatusToPaused :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'DataConnector -&gt; Text -&gt; m ()
</span><a href="#local-6989586621690376680"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToPaused</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Data Connector sources&quot;</span></span><span>
</span><span id="line-472"></span><span>  </span><span id="local-6989586621690376675"><span class="annot"><span class="annottext">updateCleanupEventStatusToCompleted :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'DataConnector -&gt; Text -&gt; DeletedEventLogStats -&gt; m ()
</span><a href="#local-6989586621690376675"><span class="hs-identifier hs-var hs-var hs-var hs-var">updateCleanupEventStatusToCompleted</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DeletedEventLogStats
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Data Connector sources&quot;</span></span><span>
</span><span id="line-473"></span><span>  </span><span id="local-6989586621690376670"><span class="annot"><span class="annottext">deleteEventTriggerLogs :: forall (m :: * -&gt; *).
(MonadIO m, MonadError QErr m) =&gt;
SourceConfig 'DataConnector
-&gt; TriggerLogCleanupConfig -&gt; m DeletedEventLogStats
</span><a href="#local-6989586621690376670"><span class="hs-identifier hs-var hs-var hs-var hs-var">deleteEventTriggerLogs</span></a></span></span><span> </span><span class="annot"><span class="annottext">SourceConfig 'DataConnector
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TriggerLogCleanupConfig
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#NotSupported"><span class="hs-identifier hs-var">NotSupported</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Event triggers are not supported for Data Connector sources&quot;</span></span><span>
</span><span id="line-474"></span></pre></body></html>