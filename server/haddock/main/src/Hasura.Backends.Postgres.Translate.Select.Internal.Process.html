<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | This module defines functions that translate from the Postgres IR into</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Postgres SQL AST.</span><span>
</span><span id="line-3"></span><span class="hs-comment">--</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- NOTE: These functions 'processAnnAggregateSelect', 'processAnnSimpleSelect',</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- 'processConnectionSelect', are all mutually recursive.</span><span>
</span><span id="line-6"></span><span class="hs-comment">--</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- These functions are generally called from the top level functions in</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Translate.Select, and the call stack looks like:</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">--     * 'selectQuerySQL' -&gt; 'mkSQLSelect' -&gt; 'processAnnSimpleSelect' -&gt; 'processSelectParams'/'processAnnFields'</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">--     * 'selectAggregateQuerySQL' -&gt; 'mkAggregateSelect' -&gt; 'processAnnAggregateSelect' -&gt; 'processSelectParams'/'processAnnFields'</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">--     * 'connetionSelectQuerySQL' -&gt; 'mkConnectionSelect' -&gt; 'processConnectionSelection' -&gt; 'processSelectParams'</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- 'SelectSource' consists of a prefix, a source, a boolean conditional</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- expression, and info on whether sorting or slicing is done (needed to handle</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- the LIMIT optimisation)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Select.Internal.Process</span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processAnnAggregateSelect"><span class="hs-identifier">processAnnAggregateSelect</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processAnnSimpleSelect"><span class="hs-identifier">processAnnSimpleSelect</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processConnectionSelect"><span class="hs-identifier">processConnectionSelect</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">where</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashMap.Strict.html"><span class="hs-identifier">Data.HashMap.Strict</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HashMap</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/insert-ordered-containers-0.2.5.1-b5ad8e22c80bc291a2f581fb78a4448e46180aa38110e81c957f693abd1dc222/share/doc/html/src/Data.HashMap.Strict.InsOrd.html"><span class="hs-identifier">Data.HashMap.Strict.InsOrd</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">InsOrdHashMap</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html"><span class="hs-identifier">Data.Text.Extended</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html#ToTxt"><span class="hs-identifier">ToTxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html#toTxt"><span class="hs-identifier">toTxt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.NonEmpty.html"><span class="hs-identifier">Data.Text.NonEmpty</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TNE</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html"><span class="hs-identifier">Hasura.Backends.Postgres.SQL.DML</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html"><span class="hs-identifier">Hasura.Backends.Postgres.SQL.Types</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.BoolExp.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.BoolExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.BoolExp.html#toSQLBoolExp"><span class="hs-identifier">toSQLBoolExp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.BoolExp.html#withRedactionExp"><span class="hs-identifier">withRedactionExp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Column.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Column</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Column.html#toJSONableExp"><span class="hs-identifier">toJSONableExp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.AnnotatedFieldJSON.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Select.AnnotatedFieldJSON</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Select.Internal.Aliases</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#contextualizeAggregateInput"><span class="hs-identifier">contextualizeAggregateInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#contextualizeBaseTableColumn"><span class="hs-identifier">contextualizeBaseTableColumn</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#contextualizeField"><span class="hs-identifier">contextualizeField</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkAnnOrderByAlias"><span class="hs-identifier">mkAnnOrderByAlias</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkArrayRelationAlias"><span class="hs-identifier">mkArrayRelationAlias</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkArrayRelationSourcePrefix"><span class="hs-identifier">mkArrayRelationSourcePrefix</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkBaseTableIdentifier"><span class="hs-identifier">mkBaseTableIdentifier</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkComputedFieldTableIdentifier"><span class="hs-identifier">mkComputedFieldTableIdentifier</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkObjectRelationTableAlias"><span class="hs-identifier">mkObjectRelationTableAlias</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkOrderByFieldName"><span class="hs-identifier">mkOrderByFieldName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Extractor.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Select.Internal.Extractor</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Extractor.html#aggregateFieldsToExtractorExps"><span class="hs-identifier">aggregateFieldsToExtractorExps</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Extractor.html#asJsonAggExtr"><span class="hs-identifier">asJsonAggExtr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Extractor.html#mkRawComputedFieldExpression"><span class="hs-identifier">mkRawComputedFieldExpression</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Extractor.html#withColumnOp"><span class="hs-identifier">withColumnOp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Extractor.html#withJsonAggExtr"><span class="hs-identifier">withJsonAggExtr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Select.Internal.Helpers</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#cursorIdentifier"><span class="hs-identifier">cursorIdentifier</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#cursorsSelectAliasIdentifier"><span class="hs-identifier">cursorsSelectAliasIdentifier</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#encodeBase64"><span class="hs-identifier">encodeBase64</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#endCursorIdentifier"><span class="hs-identifier">endCursorIdentifier</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#fromTableRowArgs"><span class="hs-identifier">fromTableRowArgs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#hasNextPageIdentifier"><span class="hs-identifier">hasNextPageIdentifier</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#hasPreviousPageIdentifier"><span class="hs-identifier">hasPreviousPageIdentifier</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#nativeQueryNameToAlias"><span class="hs-identifier">nativeQueryNameToAlias</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#pageInfoSelectAliasIdentifier"><span class="hs-identifier">pageInfoSelectAliasIdentifier</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#startCursorIdentifier"><span class="hs-identifier">startCursorIdentifier</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#withForceAggregation"><span class="hs-identifier">withForceAggregation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.JoinTree.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Select.Internal.JoinTree</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.JoinTree.html#withWriteArrayConnection"><span class="hs-identifier">withWriteArrayConnection</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.JoinTree.html#withWriteArrayRelation"><span class="hs-identifier">withWriteArrayRelation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.JoinTree.html#withWriteComputedFieldTableSet"><span class="hs-identifier">withWriteComputedFieldTableSet</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.JoinTree.html#withWriteObjectRelation"><span class="hs-identifier">withWriteObjectRelation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.OrderBy.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Select.Internal.OrderBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.OrderBy.html#processOrderByItems"><span class="hs-identifier">processOrderByItems</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Types</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Types.Aggregates.html"><span class="hs-identifier">Hasura.Backends.Postgres.Types.Aggregates</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html"><span class="hs-identifier">Hasura.Base.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier">QErr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Node.html"><span class="hs-identifier">Hasura.GraphQL.Schema.Node</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Schema.Node.html#currentNodeIdVersion"><span class="hs-identifier">currentNodeIdVersion</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Schema.Node.html#nodeIdVersionInt"><span class="hs-identifier">nodeIdVersionInt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.NativeQuery.IR.html"><span class="hs-identifier">Hasura.NativeQuery.IR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.NativeQuery.IR.html#NativeQuery"><span class="hs-identifier">NativeQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.BoolExp.html"><span class="hs-identifier">Hasura.RQL.IR.BoolExp</span></a></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.OrderBy.html"><span class="hs-identifier">Hasura.RQL.IR.OrderBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.OrderBy.html#OrderByItemG"><span class="hs-identifier">OrderByItemG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.OrderBy.html#OrderByItemG"><span class="hs-identifier">OrderByItemG</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.OrderBy.html#obiColumn"><span class="hs-identifier">obiColumn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html"><span class="hs-identifier">Hasura.RQL.IR.Select</span></a></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html"><span class="hs-identifier">Hasura.RQL.Types.Backend</span></a></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html"><span class="hs-identifier">Hasura.RQL.Types.BackendType</span></a></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Column.html"><span class="hs-identifier">Hasura.RQL.Types.Column</span></a></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html"><span class="hs-identifier">Hasura.RQL.Types.Common</span></a></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html"><span class="hs-identifier">Hasura.RQL.Types.NamingCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html#NamingCase"><span class="hs-identifier">NamingCase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html"><span class="hs-identifier">Hasura.RQL.Types.Relationships.Local</span></a></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html"><span class="hs-identifier">Hasura.RQL.Types.Schema.Options</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Options</span></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Session.html"><span class="hs-identifier">Hasura.RQL.Types.Session</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier">UserInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processSelectParams"><span class="hs-identifier hs-type">processSelectParams</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687793059"><span class="annot"><a href="#local-6989586621687793059"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621687793053"><span class="annot"><a href="#local-6989586621687793053"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793053"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#NativeQueryFreshIdStore"><span class="hs-identifier hs-type">NativeQueryFreshIdStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793053"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadWriter</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SelectWriter"><span class="hs-identifier hs-type">SelectWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793053"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793059"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687793053"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793053"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SourcePrefixes"><span class="hs-identifier hs-type">SourcePrefixes</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SimilarArrayFields"><span class="hs-identifier hs-type">SimilarArrayFields</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Select.From.html#SelectFrom"><span class="hs-identifier hs-type">SelectFrom</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793059"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#PermissionLimitSubQuery"><span class="hs-identifier hs-type">PermissionLimitSubQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Select.TablePerm.html#TablePerm"><span class="hs-identifier hs-type">TablePerm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793059"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Select.Args.html#SelectArgs"><span class="hs-identifier hs-type">SelectArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793059"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="#local-6989586621687793053"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SelectSource"><span class="hs-identifier hs-type">SelectSource</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#ColumnAlias"><span class="hs-identifier hs-type">S.ColumnAlias</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span> </span><span class="hs-comment">-- Order by cursor</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span id="processSelectParams"><span class="annot"><span class="annottext">processSelectParams :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m,
 MonadState NativeQueryFreshIdStore m, MonadWriter SelectWriter m,
 Backend ('Postgres pgKind), MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; SimilarArrayFields
-&gt; SelectFrom ('Postgres pgKind)
-&gt; PermissionLimitSubQuery
-&gt; TablePerm ('Postgres pgKind)
-&gt; SelectArgs ('Postgres pgKind)
-&gt; m (SelectSource, [(ColumnAlias, SQLExp)], Maybe SQLExp)
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processSelectParams"><span class="hs-identifier hs-var hs-var">processSelectParams</span></a></span></span><span>
</span><span id="line-116"></span><span>  </span><span id="local-6989586621687793589"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687793589"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span>
</span><span id="line-117"></span><span>  </span><span id="local-6989586621687793590"><span class="annot"><span class="annottext">SourcePrefixes
</span><a href="#local-6989586621687793590"><span class="hs-identifier hs-var">sourcePrefixes</span></a></span></span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621687793591"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793591"><span class="hs-identifier hs-var">fieldAlias</span></a></span></span><span>
</span><span id="line-119"></span><span>  </span><span id="local-6989586621687793592"><span class="annot"><span class="annottext">SimilarArrayFields
</span><a href="#local-6989586621687793592"><span class="hs-identifier hs-var">similarArrFields</span></a></span></span><span>
</span><span id="line-120"></span><span>  </span><span id="local-6989586621687793593"><span class="annot"><span class="annottext">SelectFrom ('Postgres pgKind)
</span><a href="#local-6989586621687793593"><span class="hs-identifier hs-var">selectFrom</span></a></span></span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621687793594"><span class="annot"><span class="annottext">PermissionLimitSubQuery
</span><a href="#local-6989586621687793594"><span class="hs-identifier hs-var">permLimitSubQ</span></a></span></span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621687793595"><span class="annot"><span class="annottext">TablePerm ('Postgres pgKind)
</span><a href="#local-6989586621687793595"><span class="hs-identifier hs-var">tablePermissions</span></a></span></span><span>
</span><span id="line-123"></span><span>  </span><span id="local-6989586621687793596"><span class="annot"><span class="annottext">SelectArgs ('Postgres pgKind)
</span><a href="#local-6989586621687793596"><span class="hs-identifier hs-var">tableArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687793597"><span class="annot"><span class="annottext">prefix :: TableIdentifier
</span><a href="#local-6989586621687793597"><span class="hs-identifier hs-var hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identifier -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#identifierToTableIdentifier"><span class="hs-identifier hs-var">identifierToTableIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">(Identifier -&gt; TableIdentifier) -&gt; Identifier -&gt; TableIdentifier
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SourcePrefixes -&gt; Identifier
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#_pfBase"><span class="hs-identifier hs-var">_pfBase</span></a></span><span> </span><span class="annot"><span class="annottext">SourcePrefixes
</span><a href="#local-6989586621687793590"><span class="hs-identifier hs-var">sourcePrefixes</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621687793600"><span class="annot"><span class="annottext">Qual
</span><a href="#local-6989586621687793600"><span class="hs-identifier hs-var">selectSourceQual</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687793601"><span class="annot"><span class="annottext">FromItem
</span><a href="#local-6989586621687793601"><span class="hs-identifier hs-var">fromItem</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TableIdentifier
-&gt; SelectFrom ('Postgres pgKind) -&gt; m (Qual, FromItem)
</span><a href="#local-6989586621687793602"><span class="hs-identifier hs-var">selectFromToQual</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793597"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">SelectFrom ('Postgres pgKind)
</span><a href="#local-6989586621687793593"><span class="hs-identifier hs-var">selectFrom</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621687793603"><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)]
</span><a href="#local-6989586621687793603"><span class="hs-identifier hs-var">additionalExtrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687793604"><span class="annot"><span class="annottext">SelectSorting
</span><a href="#local-6989586621687793604"><span class="hs-identifier hs-var">selectSorting</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687793605"><span class="annot"><span class="annottext">Maybe SQLExp
</span><a href="#local-6989586621687793605"><span class="hs-identifier hs-var">cursorExp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-127"></span><span>      </span><span class="annot"><span class="annottext">UserInfo
-&gt; TableIdentifier
-&gt; Qual
-&gt; FieldName
-&gt; SimilarArrayFields
-&gt; Maybe (NonEmpty (AnnDistinctColumn ('Postgres pgKind) SQLExp))
-&gt; Maybe (NonEmpty (AnnotatedOrderByItem ('Postgres pgKind)))
-&gt; m ([(ColumnAlias, SQLExp)], SelectSorting, Maybe SQLExp)
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m, MonadIO m,
 MonadWriter SelectWriter m, Backend ('Postgres pgKind),
 MonadError QErr m) =&gt;
UserInfo
-&gt; TableIdentifier
-&gt; Qual
-&gt; FieldName
-&gt; SimilarArrayFields
-&gt; Maybe (NonEmpty (AnnDistinctColumn ('Postgres pgKind) SQLExp))
-&gt; Maybe (NonEmpty (AnnotatedOrderByItem ('Postgres pgKind)))
-&gt; m ([(ColumnAlias, SQLExp)], SelectSorting, Maybe SQLExp)
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.OrderBy.html#processOrderByItems"><span class="hs-identifier hs-var">processOrderByItems</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687793589"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Identifier -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#identifierToTableIdentifier"><span class="hs-identifier hs-var">identifierToTableIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Identifier
</span><a href="#local-6989586621687793606"><span class="hs-identifier hs-var">thisSourcePrefix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Qual
</span><a href="#local-6989586621687793600"><span class="hs-identifier hs-var">selectSourceQual</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793591"><span class="hs-identifier hs-var">fieldAlias</span></a></span><span> </span><span class="annot"><span class="annottext">SimilarArrayFields
</span><a href="#local-6989586621687793592"><span class="hs-identifier hs-var">similarArrFields</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe
  (NonEmpty
     (AnnDistinctColumn
        ('Postgres pgKind) (SQLExpression ('Postgres pgKind))))
Maybe (NonEmpty (AnnDistinctColumn ('Postgres pgKind) SQLExp))
</span><a href="#local-6989586621687793607"><span class="hs-identifier hs-var">distM</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (NonEmpty (AnnotatedOrderByItem ('Postgres pgKind)))
</span><a href="#local-6989586621687793608"><span class="hs-identifier hs-var">orderByM</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621687793609"><span class="annot"><span class="annottext">BoolExp
</span><a href="#local-6989586621687793609"><span class="hs-identifier hs-var">finalWhere</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-129"></span><span>      </span><span class="annot"><span class="annottext">UserInfo -&gt; Qual -&gt; AnnBoolExpSQL ('Postgres pgKind) -&gt; m BoolExp
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(Backend ('Postgres pgKind), MonadIO m, MonadError QErr m) =&gt;
UserInfo -&gt; Qual -&gt; AnnBoolExpSQL ('Postgres pgKind) -&gt; m BoolExp
</span><a href="Hasura.Backends.Postgres.Translate.BoolExp.html#toSQLBoolExp"><span class="hs-identifier hs-var">toSQLBoolExp</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687793589"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Qual
</span><a href="#local-6989586621687793600"><span class="hs-identifier hs-var">selectSourceQual</span></a></span><span>
</span><span id="line-130"></span><span>        </span><span class="annot"><span class="annottext">(AnnBoolExpSQL ('Postgres pgKind) -&gt; m BoolExp)
-&gt; AnnBoolExpSQL ('Postgres pgKind) -&gt; m BoolExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AnnBoolExp ('Postgres pgKind) SQLExp
-&gt; (AnnBoolExp ('Postgres pgKind) SQLExp
    -&gt; AnnBoolExp ('Postgres pgKind) SQLExp)
-&gt; Maybe (AnnBoolExp ('Postgres pgKind) SQLExp)
-&gt; AnnBoolExp ('Postgres pgKind) SQLExp
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">AnnBoolExpSQL ('Postgres pgKind)
AnnBoolExp ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793611"><span class="hs-identifier hs-var">permFilter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnBoolExp ('Postgres pgKind) SQLExp
-&gt; AnnBoolExp ('Postgres pgKind) SQLExp
-&gt; AnnBoolExp ('Postgres pgKind) SQLExp
forall (backend :: BackendType) scalar.
AnnBoolExp backend scalar
-&gt; AnnBoolExp backend scalar -&gt; AnnBoolExp backend scalar
</span><a href="Hasura.RQL.IR.BoolExp.html#andAnnBoolExps"><span class="hs-identifier hs-var">andAnnBoolExps</span></a></span><span> </span><span class="annot"><span class="annottext">AnnBoolExpSQL ('Postgres pgKind)
AnnBoolExp ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793611"><span class="hs-identifier hs-var">permFilter</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (AnnBoolExpSQL ('Postgres pgKind))
Maybe (AnnBoolExp ('Postgres pgKind) SQLExp)
</span><a href="#local-6989586621687793613"><span class="hs-identifier hs-var">whereM</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687793614"><span class="annot"><span class="annottext">sortingAndSlicing :: SortingAndSlicing
</span><a href="#local-6989586621687793614"><span class="hs-identifier hs-var hs-var">sortingAndSlicing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectSorting -&gt; SelectSlicing -&gt; SortingAndSlicing
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#SortingAndSlicing"><span class="hs-identifier hs-var">SortingAndSlicing</span></a></span><span> </span><span class="annot"><span class="annottext">SelectSorting
</span><a href="#local-6989586621687793604"><span class="hs-identifier hs-var">selectSorting</span></a></span><span> </span><span class="annot"><span class="annottext">SelectSlicing
</span><a href="#local-6989586621687793616"><span class="hs-identifier hs-var">selectSlicing</span></a></span><span>
</span><span id="line-132"></span><span>        </span><span id="local-6989586621687793617"><span class="annot"><span class="annottext">selectSource :: SelectSource
</span><a href="#local-6989586621687793617"><span class="hs-identifier hs-var hs-var">selectSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-133"></span><span>          </span><span class="annot"><span class="annottext">Identifier
-&gt; FromItem -&gt; BoolExp -&gt; SortingAndSlicing -&gt; SelectSource
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#SelectSource"><span class="hs-identifier hs-var">SelectSource</span></a></span><span>
</span><span id="line-134"></span><span>            </span><span class="annot"><span class="annottext">Identifier
</span><a href="#local-6989586621687793606"><span class="hs-identifier hs-var">thisSourcePrefix</span></a></span><span>
</span><span id="line-135"></span><span>            </span><span class="annot"><span class="annottext">FromItem
</span><a href="#local-6989586621687793601"><span class="hs-identifier hs-var">fromItem</span></a></span><span>
</span><span id="line-136"></span><span>            </span><span class="annot"><span class="annottext">BoolExp
</span><a href="#local-6989586621687793609"><span class="hs-identifier hs-var">finalWhere</span></a></span><span>
</span><span id="line-137"></span><span>            </span><span class="annot"><span class="annottext">SortingAndSlicing
</span><a href="#local-6989586621687793614"><span class="hs-identifier hs-var">sortingAndSlicing</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><span class="annottext">(SelectSource, [(ColumnAlias, SQLExp)], Maybe SQLExp)
-&gt; m (SelectSource, [(ColumnAlias, SQLExp)], Maybe SQLExp)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-139"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687793617"><span class="hs-identifier hs-var">selectSource</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)]
</span><a href="#local-6989586621687793603"><span class="hs-identifier hs-var">additionalExtrs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><span class="annottext">Maybe SQLExp
</span><a href="#local-6989586621687793605"><span class="hs-identifier hs-var">cursorExp</span></a></span><span>
</span><span id="line-142"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-144"></span><span>      </span><span id="local-6989586621687793606"><span class="annot"><span class="annottext">thisSourcePrefix :: Identifier
</span><a href="#local-6989586621687793606"><span class="hs-identifier hs-var hs-var">thisSourcePrefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourcePrefixes -&gt; Identifier
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#_pfThis"><span class="hs-identifier hs-var">_pfThis</span></a></span><span> </span><span class="annot"><span class="annottext">SourcePrefixes
</span><a href="#local-6989586621687793590"><span class="hs-identifier hs-var">sourcePrefixes</span></a></span><span>
</span><span id="line-145"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.Args.html#SelectArgs"><span class="hs-identifier hs-type">SelectArgs</span></a></span><span> </span><span id="local-6989586621687793613"><span class="annot"><span class="annottext">Maybe (AnnBoolExpSQL ('Postgres pgKind))
</span><a href="#local-6989586621687793613"><span class="hs-identifier hs-var">whereM</span></a></span></span><span> </span><span id="local-6989586621687793608"><span class="annot"><span class="annottext">Maybe (NonEmpty (AnnotatedOrderByItem ('Postgres pgKind)))
</span><a href="#local-6989586621687793608"><span class="hs-identifier hs-var">orderByM</span></a></span></span><span> </span><span id="local-6989586621687793620"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687793620"><span class="hs-identifier hs-var">inpLimitM</span></a></span></span><span> </span><span id="local-6989586621687793621"><span class="annot"><span class="annottext">Maybe Int64
</span><a href="#local-6989586621687793621"><span class="hs-identifier hs-var">offsetM</span></a></span></span><span> </span><span id="local-6989586621687793607"><span class="annot"><span class="annottext">Maybe
  (NonEmpty
     (AnnDistinctColumn
        ('Postgres pgKind) (SQLExpression ('Postgres pgKind))))
</span><a href="#local-6989586621687793607"><span class="hs-identifier hs-var">distM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectArgs ('Postgres pgKind)
</span><a href="#local-6989586621687793596"><span class="hs-identifier hs-var">tableArgs</span></a></span><span>
</span><span id="line-146"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.TablePerm.html#TablePerm"><span class="hs-identifier hs-type">TablePerm</span></a></span><span> </span><span id="local-6989586621687793611"><span class="annot"><span class="annottext">AnnBoolExpSQL ('Postgres pgKind)
</span><a href="#local-6989586621687793611"><span class="hs-identifier hs-var">permFilter</span></a></span></span><span> </span><span id="local-6989586621687793623"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687793623"><span class="hs-identifier hs-var">permLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TablePerm ('Postgres pgKind)
</span><a href="#local-6989586621687793595"><span class="hs-identifier hs-var">tablePermissions</span></a></span><span>
</span><span id="line-147"></span><span>      </span><span id="local-6989586621687793616"><span class="annot"><span class="annottext">selectSlicing :: SelectSlicing
</span><a href="#local-6989586621687793616"><span class="hs-identifier hs-var hs-var">selectSlicing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Maybe Int64 -&gt; SelectSlicing
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#SelectSlicing"><span class="hs-identifier hs-var">SelectSlicing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687793625"><span class="hs-identifier hs-var">finalLimit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int64
</span><a href="#local-6989586621687793621"><span class="hs-identifier hs-var">offsetM</span></a></span><span>
</span><span id="line-148"></span><span>      </span><span id="local-6989586621687793625"><span class="annot"><span class="annottext">finalLimit :: Maybe Int
</span><a href="#local-6989586621687793625"><span class="hs-identifier hs-var hs-var">finalLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-comment">-- if sub query is required, then only use input limit</span><span>
</span><span id="line-150"></span><span>        </span><span class="hs-comment">--    because permission limit is being applied in subquery</span><span>
</span><span id="line-151"></span><span>        </span><span class="hs-comment">-- else compare input and permission limits</span><span>
</span><span id="line-152"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PermissionLimitSubQuery
</span><a href="#local-6989586621687793594"><span class="hs-identifier hs-var">permLimitSubQ</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-153"></span><span>          </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#PLSQRequired"><span class="hs-identifier hs-type">PLSQRequired</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687793620"><span class="hs-identifier hs-var">inpLimitM</span></a></span><span>
</span><span id="line-154"></span><span>          </span><span class="annot"><span class="annottext">PermissionLimitSubQuery
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#PLSQNotRequired"><span class="hs-identifier hs-var">PLSQNotRequired</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687793628"><span class="hs-identifier hs-var">compareLimits</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>      </span><span id="local-6989586621687793628"><span class="annot"><span class="annottext">compareLimits :: Maybe Int
</span><a href="#local-6989586621687793628"><span class="hs-identifier hs-var hs-var">compareLimits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-157"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687793620"><span class="hs-identifier hs-var">inpLimitM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687793623"><span class="hs-identifier hs-var">permLimit</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-158"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621687793629"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687793629"><span class="hs-identifier hs-var">inpLim</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687793629"><span class="hs-identifier hs-var">inpLim</span></a></span><span>
</span><span id="line-159"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687793630"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687793630"><span class="hs-identifier hs-var">permLim</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687793630"><span class="hs-identifier hs-var">permLim</span></a></span><span>
</span><span id="line-160"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621687793631"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621687793631"><span class="hs-identifier hs-var">inp</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621687793632"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621687793632"><span class="hs-identifier hs-var">perm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621687793631"><span class="hs-identifier hs-var">inp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621687793632"><span class="hs-identifier hs-var">perm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span>      </span><span class="annot"><a href="#local-6989586621687793602"><span class="hs-identifier hs-type">selectFromToQual</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#TableIdentifier"><span class="hs-identifier hs-type">TableIdentifier</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.From.html#SelectFrom"><span class="hs-identifier hs-type">SelectFrom</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793059"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621687793053"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#Qual"><span class="hs-identifier hs-type">S.Qual</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#FromItem"><span class="hs-identifier hs-type">S.FromItem</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>      </span><span id="local-6989586621687793602"><span class="annot"><span class="annottext">selectFromToQual :: TableIdentifier
-&gt; SelectFrom ('Postgres pgKind) -&gt; m (Qual, FromItem)
</span><a href="#local-6989586621687793602"><span class="hs-identifier hs-var hs-var">selectFromToQual</span></a></span></span><span> </span><span id="local-6989586621687793634"><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793634"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-164"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.From.html#FromTable"><span class="hs-identifier hs-type">FromTable</span></a></span><span> </span><span id="local-6989586621687793636"><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
</span><a href="#local-6989586621687793636"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Qual, FromItem) -&gt; m (Qual, FromItem)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">((Qual, FromItem) -&gt; m (Qual, FromItem))
-&gt; (Qual, FromItem) -&gt; m (Qual, FromItem)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedTable -&gt; Qual
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#QualTable"><span class="hs-identifier hs-var">S.QualTable</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
QualifiedTable
</span><a href="#local-6989586621687793636"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QualifiedTable -&gt; Maybe TableAlias -&gt; FromItem
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#FISimple"><span class="hs-identifier hs-var">S.FISimple</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
QualifiedTable
</span><a href="#local-6989586621687793636"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TableAlias
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.From.html#FromIdentifier"><span class="hs-identifier hs-type">FromIdentifier</span></a></span><span> </span><span id="local-6989586621687793640"><span class="annot"><span class="annottext">FIIdentifier
</span><a href="#local-6989586621687793640"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-166"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687793641"><span class="annot"><span class="annottext">ti :: TableIdentifier
</span><a href="#local-6989586621687793641"><span class="hs-identifier hs-var hs-var">ti</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#TableIdentifier"><span class="hs-identifier hs-var">TableIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; TableIdentifier) -&gt; Text -&gt; TableIdentifier
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FIIdentifier -&gt; Text
</span><a href="Hasura.RQL.IR.Select.From.html#%24sel%3AunFIIdentifier%3AFIIdentifier"><span class="hs-identifier hs-var">unFIIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">FIIdentifier
</span><a href="#local-6989586621687793640"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-167"></span><span>          </span><span class="annot"><span class="annottext">(Qual, FromItem) -&gt; m (Qual, FromItem)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">((Qual, FromItem) -&gt; m (Qual, FromItem))
-&gt; (Qual, FromItem) -&gt; m (Qual, FromItem)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableIdentifier -&gt; Maybe TypeAnn -&gt; Qual
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#QualifiedIdentifier"><span class="hs-identifier hs-var">S.QualifiedIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793641"><span class="hs-identifier hs-var">ti</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TypeAnn
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TableIdentifier -&gt; FromItem
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#FIIdentifier"><span class="hs-identifier hs-var">S.FIIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793641"><span class="hs-identifier hs-var">ti</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.From.html#FromFunction"><span class="hs-identifier hs-type">FromFunction</span></a></span><span> </span><span id="local-6989586621687793647"><span class="annot"><span class="annottext">FunctionName ('Postgres pgKind)
</span><a href="#local-6989586621687793647"><span class="hs-identifier hs-var">qf</span></a></span></span><span> </span><span id="local-6989586621687793648"><span class="annot"><span class="annottext">FunctionArgsExp
  ('Postgres pgKind) (SQLExpression ('Postgres pgKind))
</span><a href="#local-6989586621687793648"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621687793649"><span class="annot"><span class="annottext">Maybe [(Column ('Postgres pgKind), ScalarType ('Postgres pgKind))]
</span><a href="#local-6989586621687793649"><span class="hs-identifier hs-var">defListM</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687793650"><span class="annot"><span class="annottext">fi :: FromItem
</span><a href="#local-6989586621687793650"><span class="hs-identifier hs-var hs-var">fi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-170"></span><span>                </span><span class="annot"><span class="annottext">FunctionExp -&gt; FromItem
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#FIFunc"><span class="hs-identifier hs-var">S.FIFunc</span></a></span><span>
</span><span id="line-171"></span><span>                  </span><span class="annot"><span class="annottext">(FunctionExp -&gt; FromItem) -&gt; FunctionExp -&gt; FromItem
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QualifiedFunction
-&gt; FunctionArgs -&gt; Maybe FunctionAlias -&gt; FunctionExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#FunctionExp"><span class="hs-identifier hs-var">S.FunctionExp</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionName ('Postgres pgKind)
QualifiedFunction
</span><a href="#local-6989586621687793647"><span class="hs-identifier hs-var">qf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableIdentifier
-&gt; FunctionArgsExpG (ArgumentExp SQLExp) -&gt; FunctionArgs
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#fromTableRowArgs"><span class="hs-identifier hs-var">fromTableRowArgs</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793634"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionArgsExp
  ('Postgres pgKind) (SQLExpression ('Postgres pgKind))
FunctionArgsExpG (ArgumentExp SQLExp)
</span><a href="#local-6989586621687793648"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>                  </span><span class="annot"><span class="annottext">(Maybe FunctionAlias -&gt; FunctionExp)
-&gt; Maybe FunctionAlias -&gt; FunctionExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FunctionAlias -&gt; Maybe FunctionAlias
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-173"></span><span>                  </span><span class="annot"><span class="annottext">(FunctionAlias -&gt; Maybe FunctionAlias)
-&gt; FunctionAlias -&gt; Maybe FunctionAlias
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QualifiedFunction
-&gt; Maybe [(ColumnAlias, PGScalarType)] -&gt; FunctionAlias
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#mkFunctionAlias"><span class="hs-identifier hs-var">S.mkFunctionAlias</span></a></span><span>
</span><span id="line-174"></span><span>                    </span><span class="annot"><span class="annottext">FunctionName ('Postgres pgKind)
QualifiedFunction
</span><a href="#local-6989586621687793647"><span class="hs-identifier hs-var">qf</span></a></span><span>
</span><span id="line-175"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([(PGCol, PGScalarType)] -&gt; [(ColumnAlias, PGScalarType)])
-&gt; Maybe [(PGCol, PGScalarType)]
-&gt; Maybe [(ColumnAlias, PGScalarType)]
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((PGCol, PGScalarType) -&gt; (ColumnAlias, PGScalarType))
-&gt; [(PGCol, PGScalarType)] -&gt; [(ColumnAlias, PGScalarType)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PGCol -&gt; ColumnAlias)
-&gt; (PGCol, PGScalarType) -&gt; (ColumnAlias, PGScalarType)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">PGCol -&gt; ColumnAlias
forall a. IsIdentifier a =&gt; a -&gt; ColumnAlias
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#toColumnAlias"><span class="hs-identifier hs-var">S.toColumnAlias</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [(Column ('Postgres pgKind), ScalarType ('Postgres pgKind))]
Maybe [(PGCol, PGScalarType)]
</span><a href="#local-6989586621687793649"><span class="hs-identifier hs-var">defListM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>          </span><span class="annot"><span class="annottext">(Qual, FromItem) -&gt; m (Qual, FromItem)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">((Qual, FromItem) -&gt; m (Qual, FromItem))
-&gt; (Qual, FromItem) -&gt; m (Qual, FromItem)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableIdentifier -&gt; Maybe TypeAnn -&gt; Qual
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#QualifiedIdentifier"><span class="hs-identifier hs-var">S.QualifiedIdentifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#TableIdentifier"><span class="hs-identifier hs-var">TableIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; TableIdentifier) -&gt; Text -&gt; TableIdentifier
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QualifiedFunction -&gt; Text
forall a. ToTxt a =&gt; QualifiedObject a -&gt; Text
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#qualifiedObjectToText"><span class="hs-identifier hs-var">qualifiedObjectToText</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionName ('Postgres pgKind)
QualifiedFunction
</span><a href="#local-6989586621687793647"><span class="hs-identifier hs-var">qf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe TypeAnn
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FromItem
</span><a href="#local-6989586621687793650"><span class="hs-identifier hs-var">fi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.From.html#FromStoredProcedure"><span class="hs-identifier hs-type">FromStoredProcedure</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m (Qual, FromItem)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;selectFromToQual: FromStoredProcedure&quot;</span></span><span>
</span><span id="line-178"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.From.html#FromNativeQuery"><span class="hs-identifier hs-type">FromNativeQuery</span></a></span><span> </span><span id="local-6989586621687793659"><span class="annot"><span class="annottext">NativeQuery ('Postgres pgKind) (SQLExpression ('Postgres pgKind))
</span><a href="#local-6989586621687793659"><span class="hs-identifier hs-var">nq</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-179"></span><span>          </span><span id="local-6989586621687793660"><span class="annot"><span class="annottext">TableAlias
</span><a href="#local-6989586621687793660"><span class="hs-identifier hs-var">cteName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NativeQuery ('Postgres pgKind) SQLExp -&gt; m TableAlias
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadWriter SelectWriter m,
 MonadState NativeQueryFreshIdStore m) =&gt;
NativeQuery ('Postgres pgKind) SQLExp -&gt; m TableAlias
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#fromNativeQuery"><span class="hs-identifier hs-var">fromNativeQuery</span></a></span><span> </span><span class="annot"><span class="annottext">NativeQuery ('Postgres pgKind) (SQLExpression ('Postgres pgKind))
NativeQuery ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793659"><span class="hs-identifier hs-var">nq</span></a></span><span>
</span><span id="line-180"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687793662"><span class="annot"><span class="annottext">ta :: TableIdentifier
</span><a href="#local-6989586621687793662"><span class="hs-identifier hs-var hs-var">ta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TableAlias -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#tableAliasToIdentifier"><span class="hs-identifier hs-var">S.tableAliasToIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableAlias
</span><a href="#local-6989586621687793660"><span class="hs-identifier hs-var">cteName</span></a></span><span>
</span><span id="line-181"></span><span>          </span><span class="annot"><span class="annottext">(Qual, FromItem) -&gt; m (Qual, FromItem)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">((Qual, FromItem) -&gt; m (Qual, FromItem))
-&gt; (Qual, FromItem) -&gt; m (Qual, FromItem)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableIdentifier -&gt; Maybe TypeAnn -&gt; Qual
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#QualifiedIdentifier"><span class="hs-identifier hs-var">S.QualifiedIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793662"><span class="hs-identifier hs-var">ta</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TypeAnn
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TableIdentifier -&gt; FromItem
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#FIIdentifier"><span class="hs-identifier hs-var">S.FIIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793662"><span class="hs-identifier hs-var">ta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#fromNativeQuery"><span class="hs-identifier hs-type">fromNativeQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687793147"><span class="annot"><a href="#local-6989586621687793147"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621687793146"><span class="annot"><a href="#local-6989586621687793146"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadWriter</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SelectWriter"><span class="hs-identifier hs-type">SelectWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793146"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#NativeQueryFreshIdStore"><span class="hs-identifier hs-type">NativeQueryFreshIdStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793146"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><a href="Hasura.NativeQuery.IR.html#NativeQuery"><span class="hs-identifier hs-type">NativeQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793147"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><a href="#local-6989586621687793146"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#TableAlias"><span class="hs-identifier hs-type">S.TableAlias</span></a></span><span>
</span><span id="line-190"></span><span id="fromNativeQuery"><span class="annot"><span class="annottext">fromNativeQuery :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadWriter SelectWriter m,
 MonadState NativeQueryFreshIdStore m) =&gt;
NativeQuery ('Postgres pgKind) SQLExp -&gt; m TableAlias
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#fromNativeQuery"><span class="hs-identifier hs-var hs-var">fromNativeQuery</span></a></span></span><span> </span><span id="local-6989586621687793686"><span class="annot"><span class="annottext">NativeQuery ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793686"><span class="hs-identifier hs-var">nq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-191"></span><span>  </span><span id="local-6989586621687793687"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621687793687"><span class="hs-identifier hs-var">freshId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NativeQueryFreshIdStore -&gt; Int
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#nqNextFreshId"><span class="hs-identifier hs-var">nqNextFreshId</span></a></span><span> </span><span class="annot"><span class="annottext">(NativeQueryFreshIdStore -&gt; Int)
-&gt; m NativeQueryFreshIdStore -&gt; m Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m NativeQueryFreshIdStore
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-192"></span><span>  </span><span class="annot"><span class="annottext">(NativeQueryFreshIdStore -&gt; NativeQueryFreshIdStore) -&gt; m ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">NativeQueryFreshIdStore -&gt; NativeQueryFreshIdStore
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-comment">-- we are going to cram our SQL in a CTE, and this is what we will call it</span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687793693"><span class="annot"><span class="annottext">cteName :: TableAlias
</span><a href="#local-6989586621687793693"><span class="hs-identifier hs-var hs-var">cteName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NativeQueryName -&gt; Int -&gt; TableAlias
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#nativeQueryNameToAlias"><span class="hs-identifier hs-var">nativeQueryNameToAlias</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NativeQuery ('Postgres pgKind) SQLExp -&gt; NativeQueryName
forall (b :: BackendType) field.
NativeQuery b field -&gt; NativeQueryName
</span><a href="Hasura.NativeQuery.IR.html#nqRootFieldName"><span class="hs-identifier hs-var">nqRootFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">NativeQuery ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793686"><span class="hs-identifier hs-var">nq</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621687793687"><span class="hs-identifier hs-var">freshId</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-comment">-- emit the query itself to the Writer</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><span class="annottext">SelectWriter -&gt; m ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="annottext">(SelectWriter -&gt; m ()) -&gt; SelectWriter -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SelectWriter
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-200"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">_swCustomSQLCTEs :: CustomSQLCTEs
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#_swCustomSQLCTEs"><span class="hs-identifier hs-var">_swCustomSQLCTEs</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-201"></span><span>          </span><span class="annot"><span class="annottext">HashMap TableAlias (InterpolatedQuery SQLExp) -&gt; CustomSQLCTEs
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#CustomSQLCTEs"><span class="hs-identifier hs-var">CustomSQLCTEs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableAlias
-&gt; InterpolatedQuery SQLExp
-&gt; HashMap TableAlias (InterpolatedQuery SQLExp)
forall k v. Hashable k =&gt; k -&gt; v -&gt; HashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashMap.Internal.Strict.html#singleton"><span class="hs-identifier hs-var">HashMap.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">TableAlias
</span><a href="#local-6989586621687793693"><span class="hs-identifier hs-var">cteName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NativeQuery ('Postgres pgKind) SQLExp -&gt; InterpolatedQuery SQLExp
forall (b :: BackendType) field.
NativeQuery b field -&gt; InterpolatedQuery field
</span><a href="Hasura.NativeQuery.IR.html#nqInterpolatedQuery"><span class="hs-identifier hs-var">nqInterpolatedQuery</span></a></span><span> </span><span class="annot"><span class="annottext">NativeQuery ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793686"><span class="hs-identifier hs-var">nq</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><span class="annottext">TableAlias -&gt; m TableAlias
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TableAlias
</span><a href="#local-6989586621687793693"><span class="hs-identifier hs-var">cteName</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processAnnAggregateSelect"><span class="hs-identifier hs-type">processAnnAggregateSelect</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687793174"><span class="annot"><a href="#local-6989586621687793174"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621687793173"><span class="annot"><a href="#local-6989586621687793173"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793173"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadWriter</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SelectWriter"><span class="hs-identifier hs-type">SelectWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793173"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#NativeQueryFreshIdStore"><span class="hs-identifier hs-type">NativeQueryFreshIdStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793173"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793174"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.AnnotatedFieldJSON.html#PostgresAnnotatedFieldJSON"><span class="hs-identifier hs-type">PostgresAnnotatedFieldJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793174"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687793173"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793173"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-216"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SourcePrefixes"><span class="hs-identifier hs-type">SourcePrefixes</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnAggregateSelect"><span class="hs-identifier hs-type">AnnAggregateSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793174"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-220"></span><span>  </span><span class="annot"><a href="#local-6989586621687793173"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SelectSource"><span class="hs-identifier hs-type">SelectSource</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-222"></span><span>      </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/insert-ordered-containers-0.2.5.1-b5ad8e22c80bc291a2f581fb78a4448e46180aa38110e81c957f693abd1dc222/share/doc/html/src/Data.HashMap.Strict.InsOrd.html#InsOrdHashMap"><span class="hs-identifier hs-type">InsOrdHashMap</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#ColumnAlias"><span class="hs-identifier hs-type">S.ColumnAlias</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-223"></span><span>      </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#Extractor"><span class="hs-identifier hs-type">S.Extractor</span></a></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span id="processAnnAggregateSelect"><span class="annot"><span class="annottext">processAnnAggregateSelect :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m, MonadWriter SelectWriter m,
 MonadState NativeQueryFreshIdStore m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind, MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; AnnAggregateSelect ('Postgres pgKind)
-&gt; m (SelectSource, InsOrdHashMap ColumnAlias SQLExp, Extractor)
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processAnnAggregateSelect"><span class="hs-identifier hs-var hs-var">processAnnAggregateSelect</span></a></span></span><span> </span><span id="local-6989586621687793776"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687793776"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621687793777"><span class="annot"><span class="annottext">SourcePrefixes
</span><a href="#local-6989586621687793777"><span class="hs-identifier hs-var">sourcePrefixes</span></a></span></span><span> </span><span id="local-6989586621687793778"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793778"><span class="hs-identifier hs-var">fieldAlias</span></a></span></span><span> </span><span id="local-6989586621687793779"><span class="annot"><span class="annottext">AnnAggregateSelect ('Postgres pgKind)
</span><a href="#local-6989586621687793779"><span class="hs-identifier hs-var">annAggSel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621687793780"><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687793780"><span class="hs-identifier hs-var">selectSource</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687793781"><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)]
</span><a href="#local-6989586621687793781"><span class="hs-identifier hs-var">orderByAndDistinctExtrs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe SQLExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="annottext">UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; SimilarArrayFields
-&gt; SelectFrom ('Postgres pgKind)
-&gt; PermissionLimitSubQuery
-&gt; TablePerm ('Postgres pgKind)
-&gt; SelectArgs ('Postgres pgKind)
-&gt; m (SelectSource, [(ColumnAlias, SQLExp)], Maybe SQLExp)
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m,
 MonadState NativeQueryFreshIdStore m, MonadWriter SelectWriter m,
 Backend ('Postgres pgKind), MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; SimilarArrayFields
-&gt; SelectFrom ('Postgres pgKind)
-&gt; PermissionLimitSubQuery
-&gt; TablePerm ('Postgres pgKind)
-&gt; SelectArgs ('Postgres pgKind)
-&gt; m (SelectSource, [(ColumnAlias, SQLExp)], Maybe SQLExp)
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processSelectParams"><span class="hs-identifier hs-var">processSelectParams</span></a></span><span>
</span><span id="line-228"></span><span>      </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687793776"><span class="hs-identifier hs-var">userInfo</span></a></span><span>
</span><span id="line-229"></span><span>      </span><span class="annot"><span class="annottext">SourcePrefixes
</span><a href="#local-6989586621687793777"><span class="hs-identifier hs-var">sourcePrefixes</span></a></span><span>
</span><span id="line-230"></span><span>      </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793778"><span class="hs-identifier hs-var">fieldAlias</span></a></span><span>
</span><span id="line-231"></span><span>      </span><span class="annot"><span class="annottext">SimilarArrayFields
</span><a href="#local-6989586621687793782"><span class="hs-identifier hs-var">similarArrayFields</span></a></span><span>
</span><span id="line-232"></span><span>      </span><span class="annot"><span class="annottext">SelectFrom ('Postgres pgKind)
</span><a href="#local-6989586621687793783"><span class="hs-identifier hs-var">tableFrom</span></a></span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><span class="annottext">PermissionLimitSubQuery
</span><a href="#local-6989586621687793784"><span class="hs-identifier hs-var">permLimitSubQuery</span></a></span><span>
</span><span id="line-234"></span><span>      </span><span class="annot"><span class="annottext">TablePerm ('Postgres pgKind)
</span><a href="#local-6989586621687793785"><span class="hs-identifier hs-var">tablePermissions</span></a></span><span>
</span><span id="line-235"></span><span>      </span><span class="annot"><span class="annottext">SelectArgs ('Postgres pgKind)
</span><a href="#local-6989586621687793786"><span class="hs-identifier hs-var">tableArgs</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687793787"><span class="annot"><span class="annottext">thisSourcePrefix :: TableIdentifier
</span><a href="#local-6989586621687793787"><span class="hs-identifier hs-var hs-var">thisSourcePrefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identifier -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#identifierToTableIdentifier"><span class="hs-identifier hs-var">identifierToTableIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">(Identifier -&gt; TableIdentifier) -&gt; Identifier -&gt; TableIdentifier
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SourcePrefixes -&gt; Identifier
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#_pfThis"><span class="hs-identifier hs-var">_pfThis</span></a></span><span> </span><span class="annot"><span class="annottext">SourcePrefixes
</span><a href="#local-6989586621687793777"><span class="hs-identifier hs-var">sourcePrefixes</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span id="local-6989586621687793788"><span class="annot"><span class="annottext">[(FieldName, ([(ColumnAlias, SQLExp)], SQLExp))]
</span><a href="#local-6989586621687793788"><span class="hs-identifier hs-var">processedFields</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-238"></span><span>    </span><span class="annot"><span class="annottext">((FieldName, TableAggregateFieldG ('Postgres pgKind) Void SQLExp)
 -&gt; m (FieldName, ([(ColumnAlias, SQLExp)], SQLExp)))
-&gt; [(FieldName,
     TableAggregateFieldG ('Postgres pgKind) Void SQLExp)]
-&gt; m [(FieldName, ([(ColumnAlias, SQLExp)], SQLExp))]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span>
</span><span id="line-239"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621687793790"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793790"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687793791"><span class="annot"><span class="annottext">TableAggregateFieldG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687793791"><span class="hs-identifier hs-var">field</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-240"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793790"><span class="hs-identifier hs-var">fieldName</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>            </span><span class="annot"><span class="annottext">(([(ColumnAlias, SQLExp)], SQLExp)
 -&gt; (FieldName, ([(ColumnAlias, SQLExp)], SQLExp)))
-&gt; m ([(ColumnAlias, SQLExp)], SQLExp)
-&gt; m (FieldName, ([(ColumnAlias, SQLExp)], SQLExp))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TableAggregateFieldG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687793791"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-242"></span><span>              </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#TAFAgg"><span class="hs-identifier hs-type">TAFAgg</span></a></span><span> </span><span id="local-6989586621687793793"><span class="annot"><span class="annottext">AggregateFields ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793793"><span class="hs-identifier hs-var">aggFields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-243"></span><span>                </span><span id="local-6989586621687793794"><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)]
</span><a href="#local-6989586621687793794"><span class="hs-identifier hs-var">extractorExps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TableIdentifier
-&gt; UserInfo
-&gt; AggregateFields ('Postgres pgKind) SQLExp
-&gt; m [(ColumnAlias, SQLExp)]
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(Backend ('Postgres pgKind), MonadIO m, MonadError QErr m) =&gt;
TableIdentifier
-&gt; UserInfo
-&gt; AggregateFields ('Postgres pgKind) SQLExp
-&gt; m [(ColumnAlias, SQLExp)]
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Extractor.html#aggregateFieldsToExtractorExps"><span class="hs-identifier hs-var">aggregateFieldsToExtractorExps</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793787"><span class="hs-identifier hs-var">thisSourcePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687793776"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">AggregateFields ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793793"><span class="hs-identifier hs-var">aggFields</span></a></span><span>
</span><span id="line-244"></span><span>                </span><span class="annot"><span class="annottext">([(ColumnAlias, SQLExp)], SQLExp)
-&gt; m ([(ColumnAlias, SQLExp)], SQLExp)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-245"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)]
</span><a href="#local-6989586621687793794"><span class="hs-identifier hs-var">extractorExps</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-246"></span><span>                    </span><span class="annot"><span class="annottext">TableIdentifier
-&gt; AggregateFields ('Postgres pgKind) SQLExp
-&gt; StringifyNumbers
-&gt; SQLExp
forall (pgKind :: PostgresKind).
TableIdentifier
-&gt; AggregateFields ('Postgres pgKind) SQLExp
-&gt; StringifyNumbers
-&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#aggregateFieldToExp"><span class="hs-identifier hs-var">aggregateFieldToExp</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793787"><span class="hs-identifier hs-var">thisSourcePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">AggregateFields ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793793"><span class="hs-identifier hs-var">aggFields</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687793796"><span class="hs-identifier hs-var">strfyNum</span></a></span><span>
</span><span id="line-247"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>              </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#TAFNodes"><span class="hs-identifier hs-type">TAFNodes</span></a></span><span> </span><span class="annot"><span class="annottext">XNodesAgg ('Postgres pgKind)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687793798"><span class="annot"><span class="annottext">AnnFieldsG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687793798"><span class="hs-identifier hs-var">annFields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-249"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687793799"><span class="annot"><span class="annottext">nodesColumnAlias :: ColumnAlias
</span><a href="#local-6989586621687793799"><span class="hs-identifier hs-var hs-var">nodesColumnAlias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TableIdentifier -&gt; FieldName -&gt; ColumnAlias
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#contextualizeField"><span class="hs-identifier hs-var">contextualizeField</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793787"><span class="hs-identifier hs-var">thisSourcePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793790"><span class="hs-identifier hs-var">fieldName</span></a></span><span>
</span><span id="line-250"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ColumnAlias
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687793800"><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687793800"><span class="hs-identifier hs-var">nodesExtractorExp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserInfo
-&gt; TableIdentifier
-&gt; FieldName
-&gt; AnnFields ('Postgres pgKind)
-&gt; Maybe NamingCase
-&gt; m (ColumnAlias, SQLExp)
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m, MonadWriter SelectWriter m,
 MonadState NativeQueryFreshIdStore m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind, MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; TableIdentifier
-&gt; FieldName
-&gt; AnnFields ('Postgres pgKind)
-&gt; Maybe NamingCase
-&gt; m (ColumnAlias, SQLExp)
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processAnnFields"><span class="hs-identifier hs-var">processAnnFields</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687793776"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793787"><span class="hs-identifier hs-var">thisSourcePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793790"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">AnnFields ('Postgres pgKind)
AnnFieldsG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687793798"><span class="hs-identifier hs-var">annFields</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687793801"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-251"></span><span>                </span><span class="annot"><span class="annottext">([(ColumnAlias, SQLExp)], SQLExp)
-&gt; m ([(ColumnAlias, SQLExp)], SQLExp)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-252"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ColumnAlias
</span><a href="#local-6989586621687793799"><span class="hs-identifier hs-var">nodesColumnAlias</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687793800"><span class="hs-identifier hs-var">nodesExtractorExp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-253"></span><span>                    </span><span class="annot"><span class="annottext">PermissionLimitSubQuery
-&gt; Maybe OrderByExp -&gt; ColumnAlias -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Extractor.html#withJsonAggExtr"><span class="hs-identifier hs-var">withJsonAggExtr</span></a></span><span> </span><span class="annot"><span class="annottext">PermissionLimitSubQuery
</span><a href="#local-6989586621687793784"><span class="hs-identifier hs-var">permLimitSubQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectSource -&gt; Maybe OrderByExp
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#orderByForJsonAgg"><span class="hs-identifier hs-var">orderByForJsonAgg</span></a></span><span> </span><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687793780"><span class="hs-identifier hs-var">selectSource</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ColumnAlias
</span><a href="#local-6989586621687793799"><span class="hs-identifier hs-var">nodesColumnAlias</span></a></span><span>
</span><span id="line-254"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>              </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#TAFGroupBy"><span class="hs-identifier hs-type">TAFGroupBy</span></a></span><span> </span><span id="local-6989586621687793804"><span class="annot"><span class="annottext">XGroupBy ('Postgres pgKind)
</span><a href="#local-6989586621687793804"><span class="hs-identifier hs-var">_xGroupBy</span></a></span></span><span> </span><span id="local-6989586621687793805"><span class="annot"><span class="annottext">GroupByG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687793805"><span class="hs-identifier hs-var">_groupBy</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m ([(ColumnAlias, SQLExp)], SQLExp)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;processAnnAggregateSelect: group_by is not yet supported&quot;</span></span><span>
</span><span id="line-256"></span><span>              </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#TAFExp"><span class="hs-identifier hs-type">TAFExp</span></a></span><span> </span><span id="local-6989586621687793807"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687793807"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-257"></span><span>                </span><span class="annot"><span class="annottext">([(ColumnAlias, SQLExp)], SQLExp)
-&gt; m ([(ColumnAlias, SQLExp)], SQLExp)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-258"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-259"></span><span>                    </span><span class="annot"><span class="annottext">TypeAnn -&gt; SQLExp -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#withForceAggregation"><span class="hs-identifier hs-var">withForceAggregation</span></a></span><span> </span><span class="annot"><span class="annottext">TypeAnn
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#textTypeAnn"><span class="hs-identifier hs-var">S.textTypeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687793807"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-260"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><span class="annottext">Fields
  (TableAggregateFieldG
     ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind)))
[(FieldName, TableAggregateFieldG ('Postgres pgKind) Void SQLExp)]
</span><a href="#local-6989586621687793810"><span class="hs-identifier hs-var">aggSelFields</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687793811"><span class="annot"><span class="annottext">topLevelExtractor :: Extractor
</span><a href="#local-6989586621687793811"><span class="hs-identifier hs-var hs-var">topLevelExtractor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><span class="annottext">(SQLExp -&gt; Maybe ColumnAlias -&gt; Extractor)
-&gt; Maybe ColumnAlias -&gt; SQLExp -&gt; Extractor
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; Maybe ColumnAlias -&gt; Extractor
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#Extractor"><span class="hs-identifier hs-var">S.Extractor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ColumnAlias -&gt; Maybe ColumnAlias
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ColumnAlias -&gt; Maybe ColumnAlias)
-&gt; ColumnAlias -&gt; Maybe ColumnAlias
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Identifier -&gt; ColumnAlias
forall a. IsIdentifier a =&gt; a -&gt; ColumnAlias
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#toColumnAlias"><span class="hs-identifier hs-var">S.toColumnAlias</span></a></span><span> </span><span class="annot"><span class="annottext">(Identifier -&gt; ColumnAlias) -&gt; Identifier -&gt; ColumnAlias
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Identifier
forall a. IsIdentifier a =&gt; a -&gt; Identifier
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#toIdentifier"><span class="hs-identifier hs-var">toIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793778"><span class="hs-identifier hs-var">fieldAlias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>          </span><span class="annot"><span class="annottext">(SQLExp -&gt; Extractor) -&gt; SQLExp -&gt; Extractor
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SQLExp] -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#applyJsonBuildObj"><span class="hs-identifier hs-var">S.applyJsonBuildObj</span></a></span><span>
</span><span id="line-267"></span><span>          </span><span class="annot"><span class="annottext">([SQLExp] -&gt; SQLExp) -&gt; [SQLExp] -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(((FieldName, SQLExp) -&gt; [SQLExp])
 -&gt; [(FieldName, SQLExp)] -&gt; [SQLExp])
-&gt; [(FieldName, SQLExp)]
-&gt; ((FieldName, SQLExp) -&gt; [SQLExp])
-&gt; [SQLExp]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((FieldName, SQLExp) -&gt; [SQLExp])
-&gt; [(FieldName, SQLExp)] -&gt; [SQLExp]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((FieldName, ([(ColumnAlias, SQLExp)], SQLExp))
 -&gt; (FieldName, SQLExp))
-&gt; [(FieldName, ([(ColumnAlias, SQLExp)], SQLExp))]
-&gt; [(FieldName, SQLExp)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(([(ColumnAlias, SQLExp)], SQLExp) -&gt; SQLExp)
-&gt; (FieldName, ([(ColumnAlias, SQLExp)], SQLExp))
-&gt; (FieldName, SQLExp)
forall b c d. (b -&gt; c) -&gt; (d, b) -&gt; (d, c)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">([(ColumnAlias, SQLExp)], SQLExp) -&gt; SQLExp
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(FieldName, ([(ColumnAlias, SQLExp)], SQLExp))]
</span><a href="#local-6989586621687793788"><span class="hs-identifier hs-var">processedFields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>          </span><span class="annot"><span class="annottext">(((FieldName, SQLExp) -&gt; [SQLExp]) -&gt; [SQLExp])
-&gt; ((FieldName, SQLExp) -&gt; [SQLExp]) -&gt; [SQLExp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span id="local-6989586621687793820"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687793820"><span class="hs-identifier hs-var">fieldText</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687793821"><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687793821"><span class="hs-identifier hs-var">fieldExp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687793820"><span class="hs-identifier hs-var">fieldText</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687793821"><span class="hs-identifier hs-var">fieldExp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-269"></span><span>      </span><span id="local-6989586621687793822"><span class="annot"><span class="annottext">nodeExtractors :: InsOrdHashMap ColumnAlias SQLExp
</span><a href="#local-6989586621687793822"><span class="hs-identifier hs-var hs-var">nodeExtractors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-270"></span><span>        </span><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)] -&gt; InsOrdHashMap ColumnAlias SQLExp
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; InsOrdHashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/insert-ordered-containers-0.2.5.1-b5ad8e22c80bc291a2f581fb78a4448e46180aa38110e81c957f693abd1dc222/share/doc/html/src/Data.HashMap.Strict.InsOrd.html#fromList"><span class="hs-identifier hs-var">InsOrdHashMap.fromList</span></a></span><span>
</span><span id="line-271"></span><span>          </span><span class="annot"><span class="annottext">([(ColumnAlias, SQLExp)] -&gt; InsOrdHashMap ColumnAlias SQLExp)
-&gt; [(ColumnAlias, SQLExp)] -&gt; InsOrdHashMap ColumnAlias SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((FieldName, ([(ColumnAlias, SQLExp)], SQLExp))
 -&gt; [(ColumnAlias, SQLExp)])
-&gt; [(FieldName, ([(ColumnAlias, SQLExp)], SQLExp))]
-&gt; [(ColumnAlias, SQLExp)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([(ColumnAlias, SQLExp)], SQLExp) -&gt; [(ColumnAlias, SQLExp)]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(([(ColumnAlias, SQLExp)], SQLExp) -&gt; [(ColumnAlias, SQLExp)])
-&gt; ((FieldName, ([(ColumnAlias, SQLExp)], SQLExp))
    -&gt; ([(ColumnAlias, SQLExp)], SQLExp))
-&gt; (FieldName, ([(ColumnAlias, SQLExp)], SQLExp))
-&gt; [(ColumnAlias, SQLExp)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FieldName, ([(ColumnAlias, SQLExp)], SQLExp))
-&gt; ([(ColumnAlias, SQLExp)], SQLExp)
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(FieldName, ([(ColumnAlias, SQLExp)], SQLExp))]
</span><a href="#local-6989586621687793788"><span class="hs-identifier hs-var">processedFields</span></a></span><span>
</span><span id="line-272"></span><span>          </span><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)]
-&gt; [(ColumnAlias, SQLExp)] -&gt; [(ColumnAlias, SQLExp)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)]
</span><a href="#local-6989586621687793781"><span class="hs-identifier hs-var">orderByAndDistinctExtrs</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span>  </span><span class="annot"><span class="annottext">(SelectSource, InsOrdHashMap ColumnAlias SQLExp, Extractor)
-&gt; m (SelectSource, InsOrdHashMap ColumnAlias SQLExp, Extractor)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687793780"><span class="hs-identifier hs-var">selectSource</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap ColumnAlias SQLExp
</span><a href="#local-6989586621687793822"><span class="hs-identifier hs-var">nodeExtractors</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Extractor
</span><a href="#local-6989586621687793811"><span class="hs-identifier hs-var">topLevelExtractor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Select.AnnSelectG.html#AnnSelectG"><span class="hs-identifier hs-type">AnnSelectG</span></a></span><span> </span><span id="local-6989586621687793810"><span class="annot"><span class="annottext">Fields
  (TableAggregateFieldG
     ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind)))
</span><a href="#local-6989586621687793810"><span class="hs-identifier hs-var">aggSelFields</span></a></span></span><span> </span><span id="local-6989586621687793783"><span class="annot"><span class="annottext">SelectFrom ('Postgres pgKind)
</span><a href="#local-6989586621687793783"><span class="hs-identifier hs-var">tableFrom</span></a></span></span><span> </span><span id="local-6989586621687793785"><span class="annot"><span class="annottext">TablePerm ('Postgres pgKind)
</span><a href="#local-6989586621687793785"><span class="hs-identifier hs-var">tablePermissions</span></a></span></span><span> </span><span id="local-6989586621687793786"><span class="annot"><span class="annottext">SelectArgs ('Postgres pgKind)
</span><a href="#local-6989586621687793786"><span class="hs-identifier hs-var">tableArgs</span></a></span></span><span> </span><span id="local-6989586621687793796"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687793796"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span id="local-6989586621687793801"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687793801"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnnAggregateSelect ('Postgres pgKind)
</span><a href="#local-6989586621687793779"><span class="hs-identifier hs-var">annAggSel</span></a></span><span>
</span><span id="line-277"></span><span>    </span><span id="local-6989586621687793827"><span class="annot"><span class="annottext">permLimit :: Maybe Int
</span><a href="#local-6989586621687793827"><span class="hs-identifier hs-var hs-var">permLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TablePermG ('Postgres pgKind) SQLExp -&gt; Maybe Int
forall (b :: BackendType) v. TablePermG b v -&gt; Maybe Int
</span><a href="Hasura.RQL.IR.Select.TablePerm.html#%24sel%3A_tpLimit%3ATablePerm"><span class="hs-identifier hs-var">_tpLimit</span></a></span><span> </span><span class="annot"><span class="annottext">TablePerm ('Postgres pgKind)
TablePermG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793785"><span class="hs-identifier hs-var">tablePermissions</span></a></span><span>
</span><span id="line-278"></span><span>    </span><span id="local-6989586621687793829"><span class="annot"><span class="annottext">orderBy :: Maybe (NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) SQLExp))
</span><a href="#local-6989586621687793829"><span class="hs-identifier hs-var hs-var">orderBy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectArgsG ('Postgres pgKind) SQLExp
-&gt; Maybe
     (NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) SQLExp))
forall (b :: BackendType) v.
SelectArgsG b v -&gt; Maybe (NonEmpty (AnnotatedOrderByItemG b v))
</span><a href="Hasura.RQL.IR.Select.Args.html#%24sel%3A_saOrderBy%3ASelectArgs"><span class="hs-identifier hs-var">_saOrderBy</span></a></span><span> </span><span class="annot"><span class="annottext">SelectArgs ('Postgres pgKind)
SelectArgsG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793786"><span class="hs-identifier hs-var">tableArgs</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span id="local-6989586621687793784"><span class="annot"><span class="annottext">permLimitSubQuery :: PermissionLimitSubQuery
</span><a href="#local-6989586621687793784"><span class="hs-identifier hs-var hs-var">permLimitSubQuery</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int
-&gt; Fields
     (TableAggregateFieldG
        ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind)))
-&gt; Maybe (NonEmpty (AnnotatedOrderByItem ('Postgres pgKind)))
-&gt; PermissionLimitSubQuery
</span><a href="#local-6989586621687793831"><span class="hs-identifier hs-var">mkPermissionLimitSubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687793827"><span class="hs-identifier hs-var">permLimit</span></a></span><span> </span><span class="annot"><span class="annottext">Fields
  (TableAggregateFieldG
     ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind)))
</span><a href="#local-6989586621687793810"><span class="hs-identifier hs-var">aggSelFields</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (NonEmpty (AnnotatedOrderByItem ('Postgres pgKind)))
Maybe (NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) SQLExp))
</span><a href="#local-6989586621687793829"><span class="hs-identifier hs-var">orderBy</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span id="local-6989586621687793782"><span class="annot"><span class="annottext">similarArrayFields :: SimilarArrayFields
</span><a href="#local-6989586621687793782"><span class="hs-identifier hs-var hs-var">similarArrayFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SimilarArrayFields] -&gt; SimilarArrayFields
forall k v. (Eq k, Hashable k) =&gt; [HashMap k v] -&gt; HashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashMap.Internal.html#unions"><span class="hs-identifier hs-var">HashMap.unions</span></a></span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><span class="annottext">([SimilarArrayFields] -&gt; SimilarArrayFields)
-&gt; [SimilarArrayFields] -&gt; SimilarArrayFields
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((TableAggregateFieldG ('Postgres pgKind) Void SQLExp
  -&gt; SimilarArrayFields)
 -&gt; [TableAggregateFieldG ('Postgres pgKind) Void SQLExp]
 -&gt; [SimilarArrayFields])
-&gt; [TableAggregateFieldG ('Postgres pgKind) Void SQLExp]
-&gt; (TableAggregateFieldG ('Postgres pgKind) Void SQLExp
    -&gt; SimilarArrayFields)
-&gt; [SimilarArrayFields]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(TableAggregateFieldG ('Postgres pgKind) Void SQLExp
 -&gt; SimilarArrayFields)
-&gt; [TableAggregateFieldG ('Postgres pgKind) Void SQLExp]
-&gt; [SimilarArrayFields]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((FieldName, TableAggregateFieldG ('Postgres pgKind) Void SQLExp)
 -&gt; TableAggregateFieldG ('Postgres pgKind) Void SQLExp)
-&gt; [(FieldName,
     TableAggregateFieldG ('Postgres pgKind) Void SQLExp)]
-&gt; [TableAggregateFieldG ('Postgres pgKind) Void SQLExp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(FieldName, TableAggregateFieldG ('Postgres pgKind) Void SQLExp)
-&gt; TableAggregateFieldG ('Postgres pgKind) Void SQLExp
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">Fields
  (TableAggregateFieldG
     ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind)))
[(FieldName, TableAggregateFieldG ('Postgres pgKind) Void SQLExp)]
</span><a href="#local-6989586621687793810"><span class="hs-identifier hs-var">aggSelFields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><span class="annottext">((TableAggregateFieldG ('Postgres pgKind) Void SQLExp
  -&gt; SimilarArrayFields)
 -&gt; [SimilarArrayFields])
-&gt; (TableAggregateFieldG ('Postgres pgKind) Void SQLExp
    -&gt; SimilarArrayFields)
-&gt; [SimilarArrayFields]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-283"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#TAFAgg"><span class="hs-identifier hs-type">TAFAgg</span></a></span><span> </span><span class="annot"><span class="annottext">AggregateFields ('Postgres pgKind) SQLExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SimilarArrayFields
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-284"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#TAFNodes"><span class="hs-identifier hs-type">TAFNodes</span></a></span><span> </span><span class="annot"><span class="annottext">XNodesAgg ('Postgres pgKind)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687793833"><span class="annot"><span class="annottext">AnnFieldsG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687793833"><span class="hs-identifier hs-var">annFlds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-285"></span><span>          </span><span class="annot"><span class="annottext">AnnFieldsG ('Postgres pgKind) Void SQLExp
-&gt; Maybe
     (NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) SQLExp))
-&gt; SimilarArrayFields
forall (pgKind :: PostgresKind) v.
(Backend ('Postgres pgKind), Eq v) =&gt;
AnnFieldsG ('Postgres pgKind) Void v
-&gt; Maybe (NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) v))
-&gt; SimilarArrayFields
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#mkSimilarArrayFields"><span class="hs-identifier hs-var">mkSimilarArrayFields</span></a></span><span> </span><span class="annot"><span class="annottext">AnnFieldsG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687793833"><span class="hs-identifier hs-var">annFlds</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) SQLExp))
</span><a href="#local-6989586621687793829"><span class="hs-identifier hs-var">orderBy</span></a></span><span>
</span><span id="line-286"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#TAFGroupBy"><span class="hs-identifier hs-type">TAFGroupBy</span></a></span><span> </span><span id="local-6989586621687793835"><span class="annot"><span class="annottext">XGroupBy ('Postgres pgKind)
</span><a href="#local-6989586621687793835"><span class="hs-identifier hs-var">_xGroupBy</span></a></span></span><span> </span><span id="local-6989586621687793836"><span class="annot"><span class="annottext">GroupByG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687793836"><span class="hs-identifier hs-var">_groupBy</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SimilarArrayFields
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;similarArrayFields: group_by is not yet supported&quot;</span></span><span>
</span><span id="line-287"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#TAFExp"><span class="hs-identifier hs-type">TAFExp</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SimilarArrayFields
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><a href="#local-6989586621687793831"><span class="hs-identifier hs-type">mkPermissionLimitSubQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-290"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-291"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#TableAggregateFields"><span class="hs-identifier hs-type">TableAggregateFields</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793174"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-292"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NE.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.OrderBy.html#AnnotatedOrderByItem"><span class="hs-identifier hs-type">AnnotatedOrderByItem</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793174"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-293"></span><span>      </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#PermissionLimitSubQuery"><span class="hs-identifier hs-type">PermissionLimitSubQuery</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span id="local-6989586621687793831"><span class="annot"><span class="annottext">mkPermissionLimitSubQuery :: Maybe Int
-&gt; Fields
     (TableAggregateFieldG
        ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind)))
-&gt; Maybe (NonEmpty (AnnotatedOrderByItem ('Postgres pgKind)))
-&gt; PermissionLimitSubQuery
</span><a href="#local-6989586621687793831"><span class="hs-identifier hs-var hs-var">mkPermissionLimitSubQuery</span></a></span></span><span> </span><span id="local-6989586621687793838"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687793838"><span class="hs-identifier hs-var">permLimit'</span></a></span></span><span> </span><span id="local-6989586621687793839"><span class="annot"><span class="annottext">Fields
  (TableAggregateFieldG
     ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind)))
</span><a href="#local-6989586621687793839"><span class="hs-identifier hs-var">aggFields</span></a></span></span><span> </span><span id="local-6989586621687793840"><span class="annot"><span class="annottext">Maybe (NonEmpty (AnnotatedOrderByItem ('Postgres pgKind)))
</span><a href="#local-6989586621687793840"><span class="hs-identifier hs-var">orderBys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-295"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687793838"><span class="hs-identifier hs-var">permLimit'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-296"></span><span>        </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PermissionLimitSubQuery
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#PLSQNotRequired"><span class="hs-identifier hs-var">PLSQNotRequired</span></a></span><span>
</span><span id="line-297"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621687793841"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621687793841"><span class="hs-identifier hs-var">limit</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-298"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687793842"><span class="hs-identifier hs-var">hasAggregateField</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687793844"><span class="hs-identifier hs-var">hasAggOrderBy</span></a></span><span>
</span><span id="line-299"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; PermissionLimitSubQuery
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#PLSQRequired"><span class="hs-identifier hs-var">PLSQRequired</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621687793841"><span class="hs-identifier hs-var">limit</span></a></span><span>
</span><span id="line-300"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PermissionLimitSubQuery
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#PLSQNotRequired"><span class="hs-identifier hs-var">PLSQNotRequired</span></a></span><span>
</span><span id="line-301"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-302"></span><span>        </span><span id="local-6989586621687793842"><span class="annot"><span class="annottext">hasAggregateField :: Bool
</span><a href="#local-6989586621687793842"><span class="hs-identifier hs-var hs-var">hasAggregateField</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TableAggregateFieldG ('Postgres pgKind) Void SQLExp -&gt; Bool)
 -&gt; [TableAggregateFieldG ('Postgres pgKind) Void SQLExp] -&gt; Bool)
-&gt; [TableAggregateFieldG ('Postgres pgKind) Void SQLExp]
-&gt; (TableAggregateFieldG ('Postgres pgKind) Void SQLExp -&gt; Bool)
-&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(TableAggregateFieldG ('Postgres pgKind) Void SQLExp -&gt; Bool)
-&gt; [TableAggregateFieldG ('Postgres pgKind) Void SQLExp] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((FieldName, TableAggregateFieldG ('Postgres pgKind) Void SQLExp)
 -&gt; TableAggregateFieldG ('Postgres pgKind) Void SQLExp)
-&gt; [(FieldName,
     TableAggregateFieldG ('Postgres pgKind) Void SQLExp)]
-&gt; [TableAggregateFieldG ('Postgres pgKind) Void SQLExp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(FieldName, TableAggregateFieldG ('Postgres pgKind) Void SQLExp)
-&gt; TableAggregateFieldG ('Postgres pgKind) Void SQLExp
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">Fields
  (TableAggregateFieldG
     ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind)))
[(FieldName, TableAggregateFieldG ('Postgres pgKind) Void SQLExp)]
</span><a href="#local-6989586621687793839"><span class="hs-identifier hs-var">aggFields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>          </span><span class="annot"><span class="annottext">((TableAggregateFieldG ('Postgres pgKind) Void SQLExp -&gt; Bool)
 -&gt; Bool)
-&gt; (TableAggregateFieldG ('Postgres pgKind) Void SQLExp -&gt; Bool)
-&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-304"></span><span>            </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#TAFAgg"><span class="hs-identifier hs-type">TAFAgg</span></a></span><span> </span><span class="annot"><span class="annottext">AggregateFields ('Postgres pgKind) SQLExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-305"></span><span>            </span><span class="annot"><span class="annottext">TableAggregateFieldG ('Postgres pgKind) Void SQLExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span>        </span><span id="local-6989586621687793844"><span class="annot"><span class="annottext">hasAggOrderBy :: Bool
</span><a href="#local-6989586621687793844"><span class="hs-identifier hs-var hs-var">hasAggOrderBy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (NonEmpty (AnnotatedOrderByItem ('Postgres pgKind)))
</span><a href="#local-6989586621687793840"><span class="hs-identifier hs-var">orderBys</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-308"></span><span>          </span><span class="annot"><span class="annottext">Maybe (NonEmpty (AnnotatedOrderByItem ('Postgres pgKind)))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-309"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621687793846"><span class="annot"><span class="annottext">NonEmpty (AnnotatedOrderByItem ('Postgres pgKind))
</span><a href="#local-6989586621687793846"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((AnnotatedOrderByElement ('Postgres pgKind) SQLExp -&gt; Bool)
 -&gt; [AnnotatedOrderByElement ('Postgres pgKind) SQLExp] -&gt; Bool)
-&gt; [AnnotatedOrderByElement ('Postgres pgKind) SQLExp]
-&gt; (AnnotatedOrderByElement ('Postgres pgKind) SQLExp -&gt; Bool)
-&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(AnnotatedOrderByElement ('Postgres pgKind) SQLExp -&gt; Bool)
-&gt; [AnnotatedOrderByElement ('Postgres pgKind) SQLExp] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AnnotatedOrderByItemG ('Postgres pgKind) SQLExp
 -&gt; [AnnotatedOrderByElement ('Postgres pgKind) SQLExp])
-&gt; [AnnotatedOrderByItemG ('Postgres pgKind) SQLExp]
-&gt; [AnnotatedOrderByElement ('Postgres pgKind) SQLExp]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">AnnotatedOrderByItemG ('Postgres pgKind) SQLExp
-&gt; [AnnotatedOrderByElement ('Postgres pgKind) SQLExp]
forall a. OrderByItemG ('Postgres pgKind) a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">([AnnotatedOrderByItemG ('Postgres pgKind) SQLExp]
 -&gt; [AnnotatedOrderByElement ('Postgres pgKind) SQLExp])
-&gt; [AnnotatedOrderByItemG ('Postgres pgKind) SQLExp]
-&gt; [AnnotatedOrderByElement ('Postgres pgKind) SQLExp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) SQLExp)
-&gt; [AnnotatedOrderByItemG ('Postgres pgKind) SQLExp]
forall a. NonEmpty a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (AnnotatedOrderByItem ('Postgres pgKind))
NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) SQLExp)
</span><a href="#local-6989586621687793846"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>            </span><span class="annot"><span class="annottext">((AnnotatedOrderByElement ('Postgres pgKind) SQLExp -&gt; Bool)
 -&gt; Bool)
-&gt; (AnnotatedOrderByElement ('Postgres pgKind) SQLExp -&gt; Bool)
-&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-311"></span><span>              </span><span class="annot"><a href="Hasura.RQL.IR.Select.OrderBy.html#AOCArrayAggregation"><span class="hs-identifier hs-type">AOCArrayAggregation</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-312"></span><span>              </span><span class="annot"><span class="annottext">AnnotatedOrderByElement ('Postgres pgKind) SQLExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processAnnFields"><span class="hs-identifier hs-type">processAnnFields</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687793205"><span class="annot"><a href="#local-6989586621687793205"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621687793204"><span class="annot"><a href="#local-6989586621687793204"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793204"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadWriter</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SelectWriter"><span class="hs-identifier hs-type">SelectWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793204"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#NativeQueryFreshIdStore"><span class="hs-identifier hs-type">NativeQueryFreshIdStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793204"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793205"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.AnnotatedFieldJSON.html#PostgresAnnotatedFieldJSON"><span class="hs-identifier hs-type">PostgresAnnotatedFieldJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793205"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-321"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687793204"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793204"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-323"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-325"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#TableIdentifier"><span class="hs-identifier hs-type">TableIdentifier</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnFields"><span class="hs-identifier hs-type">AnnFields</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793205"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-328"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-329"></span><span>  </span><span class="annot"><a href="#local-6989586621687793204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#ColumnAlias"><span class="hs-identifier hs-type">S.ColumnAlias</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span id="processAnnFields"><span class="annot"><span class="annottext">processAnnFields :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m, MonadWriter SelectWriter m,
 MonadState NativeQueryFreshIdStore m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind, MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; TableIdentifier
-&gt; FieldName
-&gt; AnnFields ('Postgres pgKind)
-&gt; Maybe NamingCase
-&gt; m (ColumnAlias, SQLExp)
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processAnnFields"><span class="hs-identifier hs-var hs-var">processAnnFields</span></a></span></span><span> </span><span id="local-6989586621687793956"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687793956"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621687793957"><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793957"><span class="hs-identifier hs-var">sourcePrefix</span></a></span></span><span> </span><span id="local-6989586621687793958"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793958"><span class="hs-identifier hs-var">fieldAlias</span></a></span></span><span> </span><span id="local-6989586621687793959"><span class="annot"><span class="annottext">AnnFields ('Postgres pgKind)
</span><a href="#local-6989586621687793959"><span class="hs-identifier hs-var">annFields</span></a></span></span><span> </span><span id="local-6989586621687793960"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687793960"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-331"></span><span>  </span><span id="local-6989586621687793961"><span class="annot"><span class="annottext">[(FieldName, SQLExp)]
</span><a href="#local-6989586621687793961"><span class="hs-identifier hs-var">fieldExps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(FieldName, AnnFieldG ('Postgres pgKind) Void SQLExp)]
-&gt; ((FieldName, AnnFieldG ('Postgres pgKind) Void SQLExp)
    -&gt; m (FieldName, SQLExp))
-&gt; m [(FieldName, SQLExp)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">AnnFields ('Postgres pgKind)
[(FieldName, AnnFieldG ('Postgres pgKind) Void SQLExp)]
</span><a href="#local-6989586621687793959"><span class="hs-identifier hs-var">annFields</span></a></span><span> </span><span class="annot"><span class="annottext">(((FieldName, AnnFieldG ('Postgres pgKind) Void SQLExp)
  -&gt; m (FieldName, SQLExp))
 -&gt; m [(FieldName, SQLExp)])
-&gt; ((FieldName, AnnFieldG ('Postgres pgKind) Void SQLExp)
    -&gt; m (FieldName, SQLExp))
-&gt; m [(FieldName, SQLExp)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621687793963"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793963"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687793964"><span class="annot"><span class="annottext">AnnFieldG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687793964"><span class="hs-identifier hs-var">field</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793963"><span class="hs-identifier hs-var">fieldName</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>      </span><span class="annot"><span class="annottext">(SQLExp -&gt; (FieldName, SQLExp))
-&gt; m SQLExp -&gt; m (FieldName, SQLExp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AnnFieldG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687793964"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-334"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFExpression"><span class="hs-identifier hs-type">AFExpression</span></a></span><span> </span><span id="local-6989586621687793966"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687793966"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; m SQLExp
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(SQLExp -&gt; m SQLExp) -&gt; SQLExp -&gt; m SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687793966"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-335"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFNodeId"><span class="hs-identifier hs-type">AFNodeId</span></a></span><span> </span><span class="annot"><span class="annottext">XRelay ('Postgres pgKind)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687793968"><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621687793968"><span class="hs-identifier hs-var">sn</span></a></span></span><span> </span><span id="local-6989586621687793969"><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
</span><a href="#local-6989586621687793969"><span class="hs-identifier hs-var">tn</span></a></span></span><span> </span><span id="local-6989586621687793970"><span class="annot"><span class="annottext">PrimaryKeyColumns ('Postgres pgKind)
</span><a href="#local-6989586621687793970"><span class="hs-identifier hs-var">pKeys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; m SQLExp
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(SQLExp -&gt; m SQLExp) -&gt; SQLExp -&gt; m SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SourceName
-&gt; QualifiedTable -&gt; PrimaryKeyColumns ('Postgres pgKind) -&gt; SQLExp
</span><a href="#local-6989586621687793971"><span class="hs-identifier hs-var">mkNodeId</span></a></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621687793968"><span class="hs-identifier hs-var">sn</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
QualifiedTable
</span><a href="#local-6989586621687793969"><span class="hs-identifier hs-var">tn</span></a></span><span> </span><span class="annot"><span class="annottext">PrimaryKeyColumns ('Postgres pgKind)
</span><a href="#local-6989586621687793970"><span class="hs-identifier hs-var">pKeys</span></a></span><span>
</span><span id="line-336"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFColumn"><span class="hs-identifier hs-type">AFColumn</span></a></span><span> </span><span id="local-6989586621687793973"><span class="annot"><span class="annottext">AnnColumnField ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793973"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AnnColumnField ('Postgres pgKind) SQLExp -&gt; m SQLExp
</span><a href="#local-6989586621687793974"><span class="hs-identifier hs-var">toSQLCol</span></a></span><span> </span><span class="annot"><span class="annottext">AnnColumnField ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793973"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-337"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFObjectRelation"><span class="hs-identifier hs-type">AFObjectRelation</span></a></span><span> </span><span id="local-6989586621687793976"><span class="annot"><span class="annottext">ObjectRelationSelectG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687793976"><span class="hs-identifier hs-var">objSel</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (ObjectRelationSource, InsOrdHashMap ColumnAlias SQLExp, SQLExp)
-&gt; m SQLExp
forall (m :: * -&gt; *) a.
MonadWriter SelectWriter m =&gt;
m (ObjectRelationSource, InsOrdHashMap ColumnAlias SQLExp, a)
-&gt; m a
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.JoinTree.html#withWriteObjectRelation"><span class="hs-identifier hs-var">withWriteObjectRelation</span></a></span><span> </span><span class="annot"><span class="annottext">(m (ObjectRelationSource, InsOrdHashMap ColumnAlias SQLExp, SQLExp)
 -&gt; m SQLExp)
-&gt; m (ObjectRelationSource, InsOrdHashMap ColumnAlias SQLExp,
      SQLExp)
-&gt; m SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-338"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.RelationSelect.html#AnnRelationSelectG"><span class="hs-identifier hs-type">AnnRelationSelectG</span></a></span><span> </span><span id="local-6989586621687793978"><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687793978"><span class="hs-identifier hs-var">relName</span></a></span></span><span> </span><span id="local-6989586621687793979"><span class="annot"><span class="annottext">HashMap (Column ('Postgres pgKind)) (Column ('Postgres pgKind))
</span><a href="#local-6989586621687793979"><span class="hs-identifier hs-var">relMapping</span></a></span></span><span> </span><span id="local-6989586621687793980"><span class="annot"><span class="annottext">Nullable
</span><a href="#local-6989586621687793980"><span class="hs-identifier hs-var">nullable</span></a></span></span><span> </span><span id="local-6989586621687793981"><span class="annot"><span class="annottext">AnnObjectSelectG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687793981"><span class="hs-identifier hs-var">annObjSel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ObjectRelationSelectG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687793976"><span class="hs-identifier hs-var">objSel</span></a></span><span>
</span><span id="line-339"></span><span>              </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnObjectSelectG"><span class="hs-identifier hs-type">AnnObjectSelectG</span></a></span><span> </span><span id="local-6989586621687793983"><span class="annot"><span class="annottext">[(FieldName, AnnFieldG ('Postgres pgKind) Void SQLExp)]
</span><a href="#local-6989586621687793983"><span class="hs-identifier hs-var">objAnnFields</span></a></span></span><span> </span><span id="local-6989586621687793984"><span class="annot"><span class="annottext">SelectFromG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793984"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621687793985"><span class="annot"><span class="annottext">AnnBoolExp ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793985"><span class="hs-identifier hs-var">targetFilter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnnObjectSelectG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687793981"><span class="hs-identifier hs-var">annObjSel</span></a></span><span>
</span><span id="line-340"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621687793986"><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793986"><span class="hs-identifier hs-var">objRelSourcePrefix</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687793987"><span class="annot"><span class="annottext">FromItem
</span><a href="#local-6989586621687793987"><span class="hs-identifier hs-var">ident</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687793988"><span class="annot"><span class="annottext">BoolExp
</span><a href="#local-6989586621687793988"><span class="hs-identifier hs-var">filterExp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SelectFromG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793984"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-341"></span><span>            </span><span class="annot"><a href="Hasura.RQL.IR.Select.From.html#FromNativeQuery"><span class="hs-identifier hs-type">FromNativeQuery</span></a></span><span> </span><span id="local-6989586621687793989"><span class="annot"><span class="annottext">NativeQuery ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793989"><span class="hs-identifier hs-var">nq</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-342"></span><span>              </span><span id="local-6989586621687793990"><span class="annot"><span class="annottext">TableAlias
</span><a href="#local-6989586621687793990"><span class="hs-identifier hs-var">cteName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NativeQuery ('Postgres pgKind) SQLExp -&gt; m TableAlias
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadWriter SelectWriter m,
 MonadState NativeQueryFreshIdStore m) =&gt;
NativeQuery ('Postgres pgKind) SQLExp -&gt; m TableAlias
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#fromNativeQuery"><span class="hs-identifier hs-var">fromNativeQuery</span></a></span><span> </span><span class="annot"><span class="annottext">NativeQuery ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793989"><span class="hs-identifier hs-var">nq</span></a></span><span>
</span><span id="line-343"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687793991"><span class="annot"><span class="annottext">nativeQueryIdentifier :: TableIdentifier
</span><a href="#local-6989586621687793991"><span class="hs-identifier hs-var hs-var">nativeQueryIdentifier</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TableAlias -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#tableAliasToIdentifier"><span class="hs-identifier hs-var">S.tableAliasToIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableAlias
</span><a href="#local-6989586621687793990"><span class="hs-identifier hs-var">cteName</span></a></span><span>
</span><span id="line-344"></span><span>              </span><span id="local-6989586621687793992"><span class="annot"><span class="annottext">BoolExp
</span><a href="#local-6989586621687793992"><span class="hs-identifier hs-var">boolExp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserInfo -&gt; Qual -&gt; AnnBoolExpSQL ('Postgres pgKind) -&gt; m BoolExp
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(Backend ('Postgres pgKind), MonadIO m, MonadError QErr m) =&gt;
UserInfo -&gt; Qual -&gt; AnnBoolExpSQL ('Postgres pgKind) -&gt; m BoolExp
</span><a href="Hasura.Backends.Postgres.Translate.BoolExp.html#toSQLBoolExp"><span class="hs-identifier hs-var">toSQLBoolExp</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687793956"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableIdentifier -&gt; Maybe TypeAnn -&gt; Qual
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#QualifiedIdentifier"><span class="hs-identifier hs-var">S.QualifiedIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793991"><span class="hs-identifier hs-var">nativeQueryIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TypeAnn
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AnnBoolExpSQL ('Postgres pgKind)
AnnBoolExp ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793985"><span class="hs-identifier hs-var">targetFilter</span></a></span><span>
</span><span id="line-345"></span><span>              </span><span class="annot"><span class="annottext">(TableIdentifier, FromItem, BoolExp)
-&gt; m (TableIdentifier, FromItem, BoolExp)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-346"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">TableIdentifier -&gt; RelName -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkObjectRelationTableAlias"><span class="hs-identifier hs-var">mkObjectRelationTableAlias</span></a></span><span>
</span><span id="line-347"></span><span>                    </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793957"><span class="hs-identifier hs-var">sourcePrefix</span></a></span><span>
</span><span id="line-348"></span><span>                    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687793978"><span class="hs-identifier hs-var">relName</span></a></span><span>
</span><span id="line-349"></span><span>                        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">getRelTxt :: NonEmptyText
</span><a href="Hasura.RQL.Types.Common.html#getRelTxt"><span class="hs-identifier hs-var">getRelTxt</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-350"></span><span>                            </span><span class="annot"><span class="annottext">RelName -&gt; NonEmptyText
</span><a href="Hasura.RQL.Types.Common.html#getRelTxt"><span class="hs-identifier hs-var">getRelTxt</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687793978"><span class="hs-identifier hs-var">relName</span></a></span><span>
</span><span id="line-351"></span><span>                              </span><span class="annot"><span class="annottext">NonEmptyText -&gt; NonEmptyText -&gt; NonEmptyText
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; NonEmptyText
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.NonEmpty.html#mkNonEmptyTextUnsafe"><span class="hs-identifier hs-var">TNE.mkNonEmptyTextUnsafe</span></a></span><span>
</span><span id="line-352"></span><span>                                </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Identifier -&gt; Text
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#getIdenTxt"><span class="hs-identifier hs-var">getIdenTxt</span></a></span><span>
</span><span id="line-353"></span><span>                                    </span><span class="annot"><span class="annottext">(Identifier -&gt; Text) -&gt; Identifier -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TableAlias -&gt; Identifier
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#getTableAlias"><span class="hs-identifier hs-var">S.getTableAlias</span></a></span><span> </span><span class="annot"><span class="annottext">TableAlias
</span><a href="#local-6989586621687793990"><span class="hs-identifier hs-var">cteName</span></a></span><span>
</span><span id="line-354"></span><span>                                </span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>                        </span><span class="hs-special">}</span><span>
</span><span id="line-356"></span><span>                    </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-357"></span><span>                  </span><span class="annot"><span class="annottext">TableIdentifier -&gt; FromItem
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#FIIdentifier"><span class="hs-identifier hs-var">S.FIIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793991"><span class="hs-identifier hs-var">nativeQueryIdentifier</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-358"></span><span>                  </span><span class="annot"><span class="annottext">BoolExp
</span><a href="#local-6989586621687793992"><span class="hs-identifier hs-var">boolExp</span></a></span><span>
</span><span id="line-359"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>            </span><span class="annot"><a href="Hasura.RQL.IR.Select.From.html#FromTable"><span class="hs-identifier hs-type">FromTable</span></a></span><span> </span><span id="local-6989586621687793997"><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
</span><a href="#local-6989586621687793997"><span class="hs-identifier hs-var">tableFrom</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-361"></span><span>              </span><span id="local-6989586621687793998"><span class="annot"><span class="annottext">BoolExp
</span><a href="#local-6989586621687793998"><span class="hs-identifier hs-var">boolExp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserInfo -&gt; Qual -&gt; AnnBoolExpSQL ('Postgres pgKind) -&gt; m BoolExp
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(Backend ('Postgres pgKind), MonadIO m, MonadError QErr m) =&gt;
UserInfo -&gt; Qual -&gt; AnnBoolExpSQL ('Postgres pgKind) -&gt; m BoolExp
</span><a href="Hasura.Backends.Postgres.Translate.BoolExp.html#toSQLBoolExp"><span class="hs-identifier hs-var">toSQLBoolExp</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687793956"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedTable -&gt; Qual
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#QualTable"><span class="hs-identifier hs-var">S.QualTable</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
QualifiedTable
</span><a href="#local-6989586621687793997"><span class="hs-identifier hs-var">tableFrom</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AnnBoolExpSQL ('Postgres pgKind)
AnnBoolExp ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793985"><span class="hs-identifier hs-var">targetFilter</span></a></span><span>
</span><span id="line-362"></span><span>              </span><span class="annot"><span class="annottext">(TableIdentifier, FromItem, BoolExp)
-&gt; m (TableIdentifier, FromItem, BoolExp)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-363"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">TableIdentifier -&gt; RelName -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkObjectRelationTableAlias"><span class="hs-identifier hs-var">mkObjectRelationTableAlias</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793957"><span class="hs-identifier hs-var">sourcePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687793978"><span class="hs-identifier hs-var">relName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-364"></span><span>                  </span><span class="annot"><span class="annottext">QualifiedTable -&gt; Maybe TableAlias -&gt; FromItem
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#FISimple"><span class="hs-identifier hs-var">S.FISimple</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres pgKind)
QualifiedTable
</span><a href="#local-6989586621687793997"><span class="hs-identifier hs-var">tableFrom</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TableAlias
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-365"></span><span>                  </span><span class="annot"><span class="annottext">BoolExp
</span><a href="#local-6989586621687793998"><span class="hs-identifier hs-var">boolExp</span></a></span><span>
</span><span id="line-366"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>            </span><span id="local-6989586621687793999"><span class="annot"><span class="annottext">SelectFromG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793999"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m (TableIdentifier, FromItem, BoolExp)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; m (TableIdentifier, FromItem, BoolExp))
-&gt; [Char] -&gt; m (TableIdentifier, FromItem, BoolExp)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;processAnnFields: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SelectFromG ('Postgres pgKind) SQLExp -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">SelectFromG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687793999"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-368"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687794001"><span class="annot"><span class="annottext">sourcePrefixes :: SourcePrefixes
</span><a href="#local-6989586621687794001"><span class="hs-identifier hs-var hs-var">sourcePrefixes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TableIdentifier -&gt; SourcePrefixes
</span><a href="#local-6989586621687794002"><span class="hs-identifier hs-var">mkSourcePrefixes</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793986"><span class="hs-identifier hs-var">objRelSourcePrefix</span></a></span><span>
</span><span id="line-369"></span><span>              </span><span id="local-6989586621687794003"><span class="annot"><span class="annottext">selectSource :: ObjectSelectSource
</span><a href="#local-6989586621687794003"><span class="hs-identifier hs-var hs-var">selectSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identifier -&gt; FromItem -&gt; BoolExp -&gt; ObjectSelectSource
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#ObjectSelectSource"><span class="hs-identifier hs-var">ObjectSelectSource</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourcePrefixes -&gt; Identifier
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#_pfThis"><span class="hs-identifier hs-var">_pfThis</span></a></span><span> </span><span class="annot"><span class="annottext">SourcePrefixes
</span><a href="#local-6989586621687794001"><span class="hs-identifier hs-var">sourcePrefixes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FromItem
</span><a href="#local-6989586621687793987"><span class="hs-identifier hs-var">ident</span></a></span><span> </span><span class="annot"><span class="annottext">BoolExp
</span><a href="#local-6989586621687793988"><span class="hs-identifier hs-var">filterExp</span></a></span><span>
</span><span id="line-370"></span><span>              </span><span id="local-6989586621687794005"><span class="annot"><span class="annottext">objRelSource :: ObjectRelationSource
</span><a href="#local-6989586621687794005"><span class="hs-identifier hs-var hs-var">objRelSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RelName
-&gt; HashMap PGCol PGCol
-&gt; ObjectSelectSource
-&gt; Nullable
-&gt; ObjectRelationSource
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#ObjectRelationSource"><span class="hs-identifier hs-var">ObjectRelationSource</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621687793978"><span class="hs-identifier hs-var">relName</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap (Column ('Postgres pgKind)) (Column ('Postgres pgKind))
HashMap PGCol PGCol
</span><a href="#local-6989586621687793979"><span class="hs-identifier hs-var">relMapping</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectSelectSource
</span><a href="#local-6989586621687794003"><span class="hs-identifier hs-var">selectSource</span></a></span><span> </span><span class="annot"><span class="annottext">Nullable
</span><a href="#local-6989586621687793980"><span class="hs-identifier hs-var">nullable</span></a></span><span>
</span><span id="line-371"></span><span>          </span><span id="local-6989586621687794007"><span class="annot"><span class="annottext">(ColumnAlias, SQLExp)
</span><a href="#local-6989586621687794007"><span class="hs-identifier hs-var">annFieldsExtr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserInfo
-&gt; TableIdentifier
-&gt; FieldName
-&gt; AnnFields ('Postgres pgKind)
-&gt; Maybe NamingCase
-&gt; m (ColumnAlias, SQLExp)
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m, MonadWriter SelectWriter m,
 MonadState NativeQueryFreshIdStore m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind, MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; TableIdentifier
-&gt; FieldName
-&gt; AnnFields ('Postgres pgKind)
-&gt; Maybe NamingCase
-&gt; m (ColumnAlias, SQLExp)
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processAnnFields"><span class="hs-identifier hs-var">processAnnFields</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687793956"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Identifier -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#identifierToTableIdentifier"><span class="hs-identifier hs-var">identifierToTableIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">(Identifier -&gt; TableIdentifier) -&gt; Identifier -&gt; TableIdentifier
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SourcePrefixes -&gt; Identifier
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#_pfThis"><span class="hs-identifier hs-var">_pfThis</span></a></span><span> </span><span class="annot"><span class="annottext">SourcePrefixes
</span><a href="#local-6989586621687794001"><span class="hs-identifier hs-var">sourcePrefixes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793963"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">AnnFields ('Postgres pgKind)
[(FieldName, AnnFieldG ('Postgres pgKind) Void SQLExp)]
</span><a href="#local-6989586621687793983"><span class="hs-identifier hs-var">objAnnFields</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687793960"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-372"></span><span>          </span><span class="annot"><span class="annottext">(ObjectRelationSource, InsOrdHashMap ColumnAlias SQLExp, SQLExp)
-&gt; m (ObjectRelationSource, InsOrdHashMap ColumnAlias SQLExp,
      SQLExp)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-373"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ObjectRelationSource
</span><a href="#local-6989586621687794005"><span class="hs-identifier hs-var">objRelSource</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-374"></span><span>              </span><span class="annot"><span class="annottext">(ColumnAlias -&gt; SQLExp -&gt; InsOrdHashMap ColumnAlias SQLExp)
-&gt; (ColumnAlias, SQLExp) -&gt; InsOrdHashMap ColumnAlias SQLExp
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">ColumnAlias -&gt; SQLExp -&gt; InsOrdHashMap ColumnAlias SQLExp
forall k v. Hashable k =&gt; k -&gt; v -&gt; InsOrdHashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/insert-ordered-containers-0.2.5.1-b5ad8e22c80bc291a2f581fb78a4448e46180aa38110e81c957f693abd1dc222/share/doc/html/src/Data.HashMap.Strict.InsOrd.html#singleton"><span class="hs-identifier hs-var">InsOrdHashMap.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">(ColumnAlias, SQLExp)
</span><a href="#local-6989586621687794007"><span class="hs-identifier hs-var">annFieldsExtr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-375"></span><span>              </span><span class="annot"><span class="annottext">TableIdentifier -&gt; FieldName -&gt; SQLExp
forall b. IsIdentifier b =&gt; TableIdentifier -&gt; b -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#mkQIdenExp"><span class="hs-identifier hs-var">S.mkQIdenExp</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793986"><span class="hs-identifier hs-var">objRelSourcePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793963"><span class="hs-identifier hs-var">fieldName</span></a></span><span>
</span><span id="line-376"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFArrayRelation"><span class="hs-identifier hs-type">AFArrayRelation</span></a></span><span> </span><span id="local-6989586621687794012"><span class="annot"><span class="annottext">ArraySelectG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794012"><span class="hs-identifier hs-var">arrSel</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-378"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687794013"><span class="annot"><span class="annottext">arrRelSourcePrefix :: TableIdentifier
</span><a href="#local-6989586621687794013"><span class="hs-identifier hs-var hs-var">arrRelSourcePrefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TableIdentifier
-&gt; FieldName -&gt; SimilarArrayFields -&gt; FieldName -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkArrayRelationSourcePrefix"><span class="hs-identifier hs-var">mkArrayRelationSourcePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793957"><span class="hs-identifier hs-var">sourcePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793958"><span class="hs-identifier hs-var">fieldAlias</span></a></span><span> </span><span class="annot"><span class="annottext">SimilarArrayFields
forall k v. HashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashMap.Internal.html#empty"><span class="hs-identifier hs-var">HashMap.empty</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793963"><span class="hs-identifier hs-var">fieldName</span></a></span><span>
</span><span id="line-379"></span><span>              </span><span id="local-6989586621687794015"><span class="annot"><span class="annottext">arrRelAlias :: TableAlias
</span><a href="#local-6989586621687794015"><span class="hs-identifier hs-var hs-var">arrRelAlias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; SimilarArrayFields -&gt; FieldName -&gt; TableAlias
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkArrayRelationAlias"><span class="hs-identifier hs-var">mkArrayRelationAlias</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793958"><span class="hs-identifier hs-var">fieldAlias</span></a></span><span> </span><span class="annot"><span class="annottext">SimilarArrayFields
forall k v. HashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashMap.Internal.html#empty"><span class="hs-identifier hs-var">HashMap.empty</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793963"><span class="hs-identifier hs-var">fieldName</span></a></span><span>
</span><span id="line-380"></span><span>          </span><span class="annot"><span class="annottext">UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; TableAlias
-&gt; ArraySelect ('Postgres pgKind)
-&gt; Maybe NamingCase
-&gt; m ()
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m, MonadWriter SelectWriter m,
 MonadState NativeQueryFreshIdStore m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind, MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; TableAlias
-&gt; ArraySelect ('Postgres pgKind)
-&gt; Maybe NamingCase
-&gt; m ()
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processArrayRelation"><span class="hs-identifier hs-var">processArrayRelation</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687793956"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableIdentifier -&gt; SourcePrefixes
</span><a href="#local-6989586621687794002"><span class="hs-identifier hs-var">mkSourcePrefixes</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794013"><span class="hs-identifier hs-var">arrRelSourcePrefix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793963"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">TableAlias
</span><a href="#local-6989586621687794015"><span class="hs-identifier hs-var">arrRelAlias</span></a></span><span> </span><span class="annot"><span class="annottext">ArraySelect ('Postgres pgKind)
ArraySelectG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794012"><span class="hs-identifier hs-var">arrSel</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687793960"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-381"></span><span>          </span><span class="annot"><span class="annottext">SQLExp -&gt; m SQLExp
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(SQLExp -&gt; m SQLExp) -&gt; SQLExp -&gt; m SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TableIdentifier -&gt; FieldName -&gt; SQLExp
forall b. IsIdentifier b =&gt; TableIdentifier -&gt; b -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#mkQIdenExp"><span class="hs-identifier hs-var">S.mkQIdenExp</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794013"><span class="hs-identifier hs-var">arrRelSourcePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793963"><span class="hs-identifier hs-var">fieldName</span></a></span><span>
</span><span id="line-382"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFComputedField"><span class="hs-identifier hs-type">AFComputedField</span></a></span><span> </span><span class="annot"><span class="annottext">XComputedField ('Postgres pgKind)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ComputedFieldName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#CFSScalar"><span class="hs-identifier hs-type">CFSScalar</span></a></span><span> </span><span id="local-6989586621687794019"><span class="annot"><span class="annottext">ComputedFieldScalarSelect ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794019"><span class="hs-identifier hs-var">scalar</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-383"></span><span>          </span><span class="annot"><span class="annottext">ComputedFieldScalarSelect ('Postgres pgKind) SQLExp -&gt; m SQLExp
</span><a href="#local-6989586621687794020"><span class="hs-identifier hs-var">fromScalarComputedField</span></a></span><span> </span><span class="annot"><span class="annottext">ComputedFieldScalarSelect ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794019"><span class="hs-identifier hs-var">scalar</span></a></span><span>
</span><span id="line-384"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFComputedField"><span class="hs-identifier hs-type">AFComputedField</span></a></span><span> </span><span class="annot"><span class="annottext">XComputedField ('Postgres pgKind)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ComputedFieldName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#CFSTable"><span class="hs-identifier hs-type">CFSTable</span></a></span><span> </span><span id="local-6989586621687794022"><span class="annot"><span class="annottext">JsonAggSelect
</span><a href="#local-6989586621687794022"><span class="hs-identifier hs-var">selectTy</span></a></span></span><span> </span><span id="local-6989586621687794023"><span class="annot"><span class="annottext">AnnSimpleSelectG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794023"><span class="hs-identifier hs-var">sel</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (ComputedFieldTableSetSource, Extractor,
   InsOrdHashMap ColumnAlias SQLExp, SQLExp)
-&gt; m SQLExp
forall (m :: * -&gt; *) a.
MonadWriter SelectWriter m =&gt;
m (ComputedFieldTableSetSource, Extractor,
   InsOrdHashMap ColumnAlias SQLExp, a)
-&gt; m a
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.JoinTree.html#withWriteComputedFieldTableSet"><span class="hs-identifier hs-var">withWriteComputedFieldTableSet</span></a></span><span> </span><span class="annot"><span class="annottext">(m (ComputedFieldTableSetSource, Extractor,
    InsOrdHashMap ColumnAlias SQLExp, SQLExp)
 -&gt; m SQLExp)
-&gt; m (ComputedFieldTableSetSource, Extractor,
      InsOrdHashMap ColumnAlias SQLExp, SQLExp)
-&gt; m SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-385"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687794024"><span class="annot"><span class="annottext">computedFieldSourcePrefix :: TableIdentifier
</span><a href="#local-6989586621687794024"><span class="hs-identifier hs-var hs-var">computedFieldSourcePrefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-386"></span><span>                </span><span class="annot"><span class="annottext">TableIdentifier -&gt; FieldName -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkComputedFieldTableIdentifier"><span class="hs-identifier hs-var">mkComputedFieldTableIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793957"><span class="hs-identifier hs-var">sourcePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793963"><span class="hs-identifier hs-var">fieldName</span></a></span><span>
</span><span id="line-387"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621687794025"><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687794025"><span class="hs-identifier hs-var">selectSource</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794026"><span class="annot"><span class="annottext">InsOrdHashMap ColumnAlias SQLExp
</span><a href="#local-6989586621687794026"><span class="hs-identifier hs-var">nodeExtractors</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-388"></span><span>            </span><span class="annot"><span class="annottext">UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; PermissionLimitSubQuery
-&gt; AnnSimpleSelect ('Postgres pgKind)
-&gt; m (SelectSource, InsOrdHashMap ColumnAlias SQLExp)
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m,
 MonadState NativeQueryFreshIdStore m, MonadWriter SelectWriter m,
 Backend ('Postgres pgKind), PostgresAnnotatedFieldJSON pgKind,
 MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; PermissionLimitSubQuery
-&gt; AnnSimpleSelect ('Postgres pgKind)
-&gt; m (SelectSource, InsOrdHashMap ColumnAlias SQLExp)
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processAnnSimpleSelect"><span class="hs-identifier hs-var">processAnnSimpleSelect</span></a></span><span>
</span><span id="line-389"></span><span>              </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687793956"><span class="hs-identifier hs-var">userInfo</span></a></span><span>
</span><span id="line-390"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableIdentifier -&gt; SourcePrefixes
</span><a href="#local-6989586621687794002"><span class="hs-identifier hs-var">mkSourcePrefixes</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794024"><span class="hs-identifier hs-var">computedFieldSourcePrefix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>              </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793963"><span class="hs-identifier hs-var">fieldName</span></a></span><span>
</span><span id="line-392"></span><span>              </span><span class="annot"><span class="annottext">PermissionLimitSubQuery
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#PLSQNotRequired"><span class="hs-identifier hs-var">PLSQNotRequired</span></a></span><span>
</span><span id="line-393"></span><span>              </span><span class="annot"><span class="annottext">AnnSimpleSelect ('Postgres pgKind)
AnnSimpleSelectG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794023"><span class="hs-identifier hs-var">sel</span></a></span><span>
</span><span id="line-394"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687794027"><span class="annot"><span class="annottext">computedFieldTableSetSource :: ComputedFieldTableSetSource
</span><a href="#local-6989586621687794027"><span class="hs-identifier hs-var hs-var">computedFieldTableSetSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; SelectSource -&gt; ComputedFieldTableSetSource
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#ComputedFieldTableSetSource"><span class="hs-identifier hs-var">ComputedFieldTableSetSource</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793963"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687794025"><span class="hs-identifier hs-var">selectSource</span></a></span><span>
</span><span id="line-395"></span><span>              </span><span id="local-6989586621687794029"><span class="annot"><span class="annottext">extractor :: Extractor
</span><a href="#local-6989586621687794029"><span class="hs-identifier hs-var hs-var">extractor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-396"></span><span>                </span><span class="annot"><span class="annottext">JsonAggSelect
-&gt; ColumnAlias
-&gt; PermissionLimitSubQuery
-&gt; Maybe OrderByExp
-&gt; Extractor
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Extractor.html#asJsonAggExtr"><span class="hs-identifier hs-var">asJsonAggExtr</span></a></span><span> </span><span class="annot"><span class="annottext">JsonAggSelect
</span><a href="#local-6989586621687794022"><span class="hs-identifier hs-var">selectTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; ColumnAlias
forall a. IsIdentifier a =&gt; a -&gt; ColumnAlias
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#toColumnAlias"><span class="hs-identifier hs-var">S.toColumnAlias</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793963"><span class="hs-identifier hs-var">fieldName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PermissionLimitSubQuery
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#PLSQNotRequired"><span class="hs-identifier hs-var">PLSQNotRequired</span></a></span><span>
</span><span id="line-397"></span><span>                  </span><span class="annot"><span class="annottext">(Maybe OrderByExp -&gt; Extractor) -&gt; Maybe OrderByExp -&gt; Extractor
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SelectSource -&gt; Maybe OrderByExp
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#orderByForJsonAgg"><span class="hs-identifier hs-var">orderByForJsonAgg</span></a></span><span> </span><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687794025"><span class="hs-identifier hs-var">selectSource</span></a></span><span>
</span><span id="line-398"></span><span>          </span><span class="annot"><span class="annottext">(ComputedFieldTableSetSource, Extractor,
 InsOrdHashMap ColumnAlias SQLExp, SQLExp)
-&gt; m (ComputedFieldTableSetSource, Extractor,
      InsOrdHashMap ColumnAlias SQLExp, SQLExp)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-399"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ComputedFieldTableSetSource
</span><a href="#local-6989586621687794027"><span class="hs-identifier hs-var">computedFieldTableSetSource</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-400"></span><span>              </span><span class="annot"><span class="annottext">Extractor
</span><a href="#local-6989586621687794029"><span class="hs-identifier hs-var">extractor</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-401"></span><span>              </span><span class="annot"><span class="annottext">InsOrdHashMap ColumnAlias SQLExp
</span><a href="#local-6989586621687794026"><span class="hs-identifier hs-var">nodeExtractors</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-402"></span><span>              </span><span class="annot"><span class="annottext">TableIdentifier -&gt; FieldName -&gt; SQLExp
forall b. IsIdentifier b =&gt; TableIdentifier -&gt; b -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#mkQIdenExp"><span class="hs-identifier hs-var">S.mkQIdenExp</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794024"><span class="hs-identifier hs-var">computedFieldSourcePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793963"><span class="hs-identifier hs-var">fieldName</span></a></span><span>
</span><span id="line-403"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span>  </span><span class="annot"><span class="annottext">(ColumnAlias, SQLExp) -&gt; m (ColumnAlias, SQLExp)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">((ColumnAlias, SQLExp) -&gt; m (ColumnAlias, SQLExp))
-&gt; (ColumnAlias, SQLExp) -&gt; m (ColumnAlias, SQLExp)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind).
PostgresAnnotatedFieldJSON pgKind =&gt;
FieldName -&gt; [(FieldName, SQLExp)] -&gt; (ColumnAlias, SQLExp)
</span><a href="Hasura.Backends.Postgres.Translate.Select.AnnotatedFieldJSON.html#annRowToJson"><span class="hs-identifier hs-var">annRowToJson</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621687793205"><span class="hs-identifier hs-type">pgKind</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687793958"><span class="hs-identifier hs-var">fieldAlias</span></a></span><span> </span><span class="annot"><span class="annottext">[(FieldName, SQLExp)]
</span><a href="#local-6989586621687793961"><span class="hs-identifier hs-var">fieldExps</span></a></span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-407"></span><span>    </span><span id="local-6989586621687794002"><span class="annot"><span class="annottext">mkSourcePrefixes :: TableIdentifier -&gt; SourcePrefixes
</span><a href="#local-6989586621687794002"><span class="hs-identifier hs-var hs-var">mkSourcePrefixes</span></a></span></span><span> </span><span id="local-6989586621687794031"><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794031"><span class="hs-identifier hs-var">newPrefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identifier -&gt; Identifier -&gt; SourcePrefixes
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#SourcePrefixes"><span class="hs-identifier hs-var">SourcePrefixes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableIdentifier -&gt; Identifier
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#tableIdentifierToIdentifier"><span class="hs-identifier hs-var">tableIdentifierToIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794031"><span class="hs-identifier hs-var">newPrefix</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableIdentifier -&gt; Identifier
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#tableIdentifierToIdentifier"><span class="hs-identifier hs-var">tableIdentifierToIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793957"><span class="hs-identifier hs-var">sourcePrefix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span>    </span><span id="local-6989586621687794034"><span class="annot"><span class="annottext">baseTableIdentifier :: TableIdentifier
</span><a href="#local-6989586621687794034"><span class="hs-identifier hs-var hs-var">baseTableIdentifier</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TableIdentifier -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkBaseTableIdentifier"><span class="hs-identifier hs-var">mkBaseTableIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793957"><span class="hs-identifier hs-var">sourcePrefix</span></a></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span>    </span><span class="annot"><a href="#local-6989586621687793974"><span class="hs-identifier hs-type">toSQLCol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnColumnField"><span class="hs-identifier hs-type">AnnColumnField</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793205"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621687793204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span id="local-6989586621687793974"><span class="annot"><span class="annottext">toSQLCol :: AnnColumnField ('Postgres pgKind) SQLExp -&gt; m SQLExp
</span><a href="#local-6989586621687793974"><span class="hs-identifier hs-var hs-var">toSQLCol</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnColumnField"><span class="hs-identifier hs-type">AnnColumnField</span></a></span><span> </span><span id="local-6989586621687794036"><span class="annot"><span class="annottext">Column ('Postgres pgKind)
</span><a href="#local-6989586621687794036"><span class="hs-identifier hs-var">col</span></a></span></span><span> </span><span id="local-6989586621687794037"><span class="annot"><span class="annottext">ColumnType ('Postgres pgKind)
</span><a href="#local-6989586621687794037"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span id="local-6989586621687794038"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687794038"><span class="hs-identifier hs-var">asText</span></a></span></span><span> </span><span id="local-6989586621687794039"><span class="annot"><span class="annottext">Maybe (ScalarSelectionArguments ('Postgres pgKind))
</span><a href="#local-6989586621687794039"><span class="hs-identifier hs-var">colOpM</span></a></span></span><span> </span><span id="local-6989586621687794040"><span class="annot"><span class="annottext">AnnRedactionExp ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794040"><span class="hs-identifier hs-var">redactionExp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-413"></span><span>      </span><span id="local-6989586621687794041"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687794041"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m StringifyNumbers
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-414"></span><span>      </span><span id="local-6989586621687794043"><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794043"><span class="hs-identifier hs-var">sqlExpression</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-415"></span><span>        </span><span class="annot"><span class="annottext">Qual
-&gt; AnnRedactionExp ('Postgres pgKind) SQLExp
-&gt; UserInfo
-&gt; SQLExp
-&gt; m SQLExp
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(Backend ('Postgres pgKind), MonadIO m, MonadError QErr m) =&gt;
Qual
-&gt; AnnRedactionExp ('Postgres pgKind) SQLExp
-&gt; UserInfo
-&gt; SQLExp
-&gt; m SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.BoolExp.html#withRedactionExp"><span class="hs-identifier hs-var">withRedactionExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableIdentifier -&gt; Maybe TypeAnn -&gt; Qual
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#QualifiedIdentifier"><span class="hs-identifier hs-var">S.QualifiedIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794034"><span class="hs-identifier hs-var">baseTableIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TypeAnn
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AnnRedactionExp ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794040"><span class="hs-identifier hs-var">redactionExp</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687793956"><span class="hs-identifier hs-var">userInfo</span></a></span><span>
</span><span id="line-416"></span><span>          </span><span class="annot"><span class="annottext">(SQLExp -&gt; m SQLExp) -&gt; SQLExp -&gt; m SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe ColumnOp -&gt; SQLExp -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Extractor.html#withColumnOp"><span class="hs-identifier hs-var">withColumnOp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ScalarSelectionArguments ('Postgres pgKind))
Maybe ColumnOp
</span><a href="#local-6989586621687794039"><span class="hs-identifier hs-var">colOpM</span></a></span><span>
</span><span id="line-417"></span><span>          </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TableIdentifier -&gt; PGCol -&gt; SQLExp
forall b. IsIdentifier b =&gt; TableIdentifier -&gt; b -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#mkQIdenExp"><span class="hs-identifier hs-var">S.mkQIdenExp</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794034"><span class="hs-identifier hs-var">baseTableIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Column ('Postgres pgKind)
PGCol
</span><a href="#local-6989586621687794036"><span class="hs-identifier hs-var">col</span></a></span><span>
</span><span id="line-418"></span><span>      </span><span class="annot"><span class="annottext">SQLExp -&gt; m SQLExp
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(SQLExp -&gt; m SQLExp) -&gt; SQLExp -&gt; m SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
-&gt; ColumnType ('Postgres pgKind)
-&gt; Bool
-&gt; Maybe NamingCase
-&gt; SQLExp
-&gt; SQLExp
forall (pgKind :: PostgresKind).
StringifyNumbers
-&gt; ColumnType ('Postgres pgKind)
-&gt; Bool
-&gt; Maybe NamingCase
-&gt; SQLExp
-&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Column.html#toJSONableExp"><span class="hs-identifier hs-var">toJSONableExp</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687794041"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnType ('Postgres pgKind)
</span><a href="#local-6989586621687794037"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687794038"><span class="hs-identifier hs-var">asText</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687793960"><span class="hs-identifier hs-var">tCase</span></a></span><span> </span><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794043"><span class="hs-identifier hs-var">sqlExpression</span></a></span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span>    </span><span class="annot"><a href="#local-6989586621687794020"><span class="hs-identifier hs-type">fromScalarComputedField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ComputedFieldScalarSelect"><span class="hs-identifier hs-type">ComputedFieldScalarSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793205"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621687793204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span>
</span><span id="line-421"></span><span>    </span><span id="local-6989586621687794020"><span class="annot"><span class="annottext">fromScalarComputedField :: ComputedFieldScalarSelect ('Postgres pgKind) SQLExp -&gt; m SQLExp
</span><a href="#local-6989586621687794020"><span class="hs-identifier hs-var hs-var">fromScalarComputedField</span></a></span></span><span> </span><span id="local-6989586621687794044"><span class="annot"><span class="annottext">computedFieldScalar :: ComputedFieldScalarSelect ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794044"><span class="hs-identifier hs-var">computedFieldScalar</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ComputedFieldScalarSelect"><span class="hs-identifier hs-type">ComputedFieldScalarSelect</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687794046"><span id="local-6989586621687794047"><span id="local-6989586621687794048"><span id="local-6989586621687794049"><span id="local-6989586621687794050"><span class="annot"><span class="annottext">Maybe (ScalarSelectionArguments ('Postgres pgKind))
FunctionName ('Postgres pgKind)
ScalarType ('Postgres pgKind)
FunctionArgsExp ('Postgres pgKind) SQLExp
AnnRedactionExp ('Postgres pgKind) SQLExp
_cfssFunction :: FunctionName ('Postgres pgKind)
_cfssArguments :: FunctionArgsExp ('Postgres pgKind) SQLExp
_cfssType :: ScalarType ('Postgres pgKind)
_cfssScalarArguments :: Maybe (ScalarSelectionArguments ('Postgres pgKind))
_cfssRedactionExpression :: AnnRedactionExp ('Postgres pgKind) SQLExp
$sel:_cfssFunction:ComputedFieldScalarSelect :: forall (b :: BackendType) v.
ComputedFieldScalarSelect b v -&gt; FunctionName b
$sel:_cfssArguments:ComputedFieldScalarSelect :: forall (b :: BackendType) v.
ComputedFieldScalarSelect b v -&gt; FunctionArgsExp b v
$sel:_cfssType:ComputedFieldScalarSelect :: forall (b :: BackendType) v.
ComputedFieldScalarSelect b v -&gt; ScalarType b
$sel:_cfssScalarArguments:ComputedFieldScalarSelect :: forall (b :: BackendType) v.
ComputedFieldScalarSelect b v -&gt; Maybe (ScalarSelectionArguments b)
$sel:_cfssRedactionExpression:ComputedFieldScalarSelect :: forall (b :: BackendType) v.
ComputedFieldScalarSelect b v -&gt; AnnRedactionExp b v
</span><a href="#local-6989586621687794046"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-422"></span><span>      </span><span id="local-6989586621687794056"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687794056"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m StringifyNumbers
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-423"></span><span>      </span><span id="local-6989586621687794057"><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794057"><span class="hs-identifier hs-var">computedFieldExp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TableIdentifier
-&gt; UserInfo
-&gt; ComputedFieldScalarSelect ('Postgres pgKind) SQLExp
-&gt; m SQLExp
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(Backend ('Postgres pgKind), MonadIO m, MonadError QErr m) =&gt;
TableIdentifier
-&gt; UserInfo
-&gt; ComputedFieldScalarSelect ('Postgres pgKind) SQLExp
-&gt; m SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Extractor.html#mkRawComputedFieldExpression"><span class="hs-identifier hs-var">mkRawComputedFieldExpression</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793957"><span class="hs-identifier hs-var">sourcePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687793956"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ComputedFieldScalarSelect ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794044"><span class="hs-identifier hs-var">computedFieldScalar</span></a></span><span>
</span><span id="line-424"></span><span>      </span><span class="annot"><span class="annottext">SQLExp -&gt; m SQLExp
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-425"></span><span>        </span><span class="annot"><span class="annottext">(SQLExp -&gt; m SQLExp) -&gt; SQLExp -&gt; m SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
-&gt; ColumnType ('Postgres Any)
-&gt; Bool
-&gt; Maybe NamingCase
-&gt; SQLExp
-&gt; SQLExp
forall (pgKind :: PostgresKind).
StringifyNumbers
-&gt; ColumnType ('Postgres pgKind)
-&gt; Bool
-&gt; Maybe NamingCase
-&gt; SQLExp
-&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Column.html#toJSONableExp"><span class="hs-identifier hs-var">toJSONableExp</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687794056"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScalarType ('Postgres Any) -&gt; ColumnType ('Postgres Any)
forall (b :: BackendType). ScalarType b -&gt; ColumnType b
</span><a href="Hasura.RQL.Types.Column.html#ColumnScalar"><span class="hs-identifier hs-var">ColumnScalar</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarType ('Postgres pgKind)
ScalarType ('Postgres Any)
</span><a href="#local-6989586621687794048"><span class="hs-identifier hs-var">_cfssType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-426"></span><span>        </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794057"><span class="hs-identifier hs-var">computedFieldExp</span></a></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span>    </span><span class="annot"><a href="#local-6989586621687793971"><span class="hs-identifier hs-type">mkNodeId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#SourceName"><span class="hs-identifier hs-type">SourceName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedTable"><span class="hs-identifier hs-type">QualifiedTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Column.html#PrimaryKeyColumns"><span class="hs-identifier hs-type">PrimaryKeyColumns</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793205"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span>
</span><span id="line-429"></span><span>    </span><span id="local-6989586621687793971"><span class="annot"><span class="annottext">mkNodeId :: SourceName
-&gt; QualifiedTable -&gt; PrimaryKeyColumns ('Postgres pgKind) -&gt; SQLExp
</span><a href="#local-6989586621687793971"><span class="hs-identifier hs-var hs-var">mkNodeId</span></a></span></span><span> </span><span id="local-6989586621687794059"><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621687794059"><span class="hs-identifier hs-var">_sourceName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedObject"><span class="hs-identifier hs-type">QualifiedObject</span></a></span><span> </span><span id="local-6989586621687794061"><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621687794061"><span class="hs-identifier hs-var">tableSchema</span></a></span></span><span> </span><span id="local-6989586621687794062"><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621687794062"><span class="hs-identifier hs-var">tableName</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621687794063"><span class="annot"><span class="annottext">PrimaryKeyColumns ('Postgres pgKind)
</span><a href="#local-6989586621687794063"><span class="hs-identifier hs-var">pkeyColumns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-430"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687794064"><span class="annot"><span class="annottext">columnInfoToSQLExp :: ColumnInfo ('Postgres pgKind) -&gt; SQLExp
</span><a href="#local-6989586621687794064"><span class="hs-identifier hs-var hs-var">columnInfoToSQLExp</span></a></span></span><span> </span><span id="local-6989586621687794065"><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
</span><a href="#local-6989586621687794065"><span class="hs-identifier hs-var">pgColumnInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-431"></span><span>            </span><span class="annot"><span class="annottext">StringifyNumbers
-&gt; ColumnType ('Postgres pgKind)
-&gt; Bool
-&gt; Maybe NamingCase
-&gt; SQLExp
-&gt; SQLExp
forall (pgKind :: PostgresKind).
StringifyNumbers
-&gt; ColumnType ('Postgres pgKind)
-&gt; Bool
-&gt; Maybe NamingCase
-&gt; SQLExp
-&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Column.html#toJSONableExp"><span class="hs-identifier hs-var">toJSONableExp</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="Hasura.RQL.Types.Schema.Options.html#Don%27tStringifyNumbers"><span class="hs-identifier hs-var">Options.Don'tStringifyNumbers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind) -&gt; ColumnType ('Postgres pgKind)
forall (b :: BackendType). ColumnInfo b -&gt; ColumnType b
</span><a href="Hasura.RQL.Types.Column.html#ciType"><span class="hs-identifier hs-var">ciType</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
</span><a href="#local-6989586621687794065"><span class="hs-identifier hs-var">pgColumnInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-432"></span><span>              </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TableIdentifier -&gt; PGCol -&gt; SQLExp
forall b. IsIdentifier b =&gt; TableIdentifier -&gt; b -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#mkQIdenExp"><span class="hs-identifier hs-var">S.mkQIdenExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableIdentifier -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkBaseTableIdentifier"><span class="hs-identifier hs-var">mkBaseTableIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687793957"><span class="hs-identifier hs-var">sourcePrefix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>              </span><span class="annot"><span class="annottext">(PGCol -&gt; SQLExp) -&gt; PGCol -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind) -&gt; Column ('Postgres pgKind)
forall (b :: BackendType). ColumnInfo b -&gt; Column b
</span><a href="Hasura.RQL.Types.Column.html#ciColumn"><span class="hs-identifier hs-var">ciColumn</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
</span><a href="#local-6989586621687794065"><span class="hs-identifier hs-var">pgColumnInfo</span></a></span><span>
</span><span id="line-434"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-comment">-- See Note [Relay Node id].</span><span>
</span><span id="line-435"></span><span>          </span><span class="annot"><span class="annottext">SQLExp -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#encodeBase64"><span class="hs-identifier hs-var">encodeBase64</span></a></span><span>
</span><span id="line-436"></span><span>            </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SQLExp -&gt; TypeAnn -&gt; SQLExp) -&gt; TypeAnn -&gt; SQLExp -&gt; SQLExp
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; TypeAnn -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SETyAnn"><span class="hs-identifier hs-var">S.SETyAnn</span></a></span><span> </span><span class="annot"><span class="annottext">TypeAnn
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#textTypeAnn"><span class="hs-identifier hs-var">S.textTypeAnn</span></a></span><span>
</span><span id="line-437"></span><span>            </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SQLExp] -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#applyJsonBuildArray"><span class="hs-identifier hs-var">S.applyJsonBuildArray</span></a></span><span>
</span><span id="line-438"></span><span>            </span><span class="annot"><span class="annottext">([SQLExp] -&gt; SQLExp) -&gt; [SQLExp] -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#intToSQLExp"><span class="hs-identifier hs-var">S.intToSQLExp</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; SQLExp) -&gt; Int -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NodeIdVersion -&gt; Int
</span><a href="Hasura.GraphQL.Schema.Node.html#nodeIdVersionInt"><span class="hs-identifier hs-var">nodeIdVersionInt</span></a></span><span> </span><span class="annot"><span class="annottext">NodeIdVersion
</span><a href="Hasura.GraphQL.Schema.Node.html#currentNodeIdVersion"><span class="hs-identifier hs-var">currentNodeIdVersion</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-439"></span><span>                </span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SchemaName -&gt; Text
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#getSchemaTxt"><span class="hs-identifier hs-var">getSchemaTxt</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaName
</span><a href="#local-6989586621687794061"><span class="hs-identifier hs-var">tableSchema</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-440"></span><span>                </span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableName -&gt; Text
forall a. ToTxt a =&gt; a -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Text.Extended.html#toTxt"><span class="hs-identifier hs-var">toTxt</span></a></span><span> </span><span class="annot"><span class="annottext">TableName
</span><a href="#local-6989586621687794062"><span class="hs-identifier hs-var">tableName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-442"></span><span>            </span><span class="annot"><span class="annottext">[SQLExp] -&gt; [SQLExp] -&gt; [SQLExp]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(ColumnInfo ('Postgres pgKind) -&gt; SQLExp)
-&gt; [ColumnInfo ('Postgres pgKind)] -&gt; [SQLExp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind) -&gt; SQLExp
</span><a href="#local-6989586621687794064"><span class="hs-identifier hs-var">columnInfoToSQLExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimaryKeyColumns ('Postgres pgKind)
-&gt; [ColumnInfo ('Postgres pgKind)]
forall a. NESeq a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">PrimaryKeyColumns ('Postgres pgKind)
</span><a href="#local-6989586621687794063"><span class="hs-identifier hs-var">pkeyColumns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#mkSimilarArrayFields"><span class="hs-identifier hs-type">mkSimilarArrayFields</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687793239"><span class="annot"><a href="#local-6989586621687793239"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621687793240"><span class="annot"><a href="#local-6989586621687793240"><span class="hs-identifier hs-type">v</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-446"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793239"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621687793240"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-447"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnFieldsG"><span class="hs-identifier hs-type">AnnFieldsG</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793239"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="annot"><a href="#local-6989586621687793240"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-448"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NE.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.OrderBy.html#AnnotatedOrderByItemG"><span class="hs-identifier hs-type">AnnotatedOrderByItemG</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793239"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687793240"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-449"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SimilarArrayFields"><span class="hs-identifier hs-type">SimilarArrayFields</span></a></span><span>
</span><span id="line-450"></span><span id="mkSimilarArrayFields"><span class="annot"><span class="annottext">mkSimilarArrayFields :: forall (pgKind :: PostgresKind) v.
(Backend ('Postgres pgKind), Eq v) =&gt;
AnnFieldsG ('Postgres pgKind) Void v
-&gt; Maybe (NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) v))
-&gt; SimilarArrayFields
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#mkSimilarArrayFields"><span class="hs-identifier hs-var hs-var">mkSimilarArrayFields</span></a></span></span><span> </span><span id="local-6989586621687794133"><span class="annot"><span class="annottext">AnnFieldsG ('Postgres pgKind) Void v
</span><a href="#local-6989586621687794133"><span class="hs-identifier hs-var">annFields</span></a></span></span><span> </span><span id="local-6989586621687794134"><span class="annot"><span class="annottext">Maybe (NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) v))
</span><a href="#local-6989586621687794134"><span class="hs-identifier hs-var">maybeOrderBys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-451"></span><span>  </span><span class="annot"><span class="annottext">[(FieldName, [FieldName])] -&gt; SimilarArrayFields
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashMap.Internal.Strict.html#fromList"><span class="hs-identifier hs-var">HashMap.fromList</span></a></span><span>
</span><span id="line-452"></span><span>    </span><span class="annot"><span class="annottext">([(FieldName, [FieldName])] -&gt; SimilarArrayFields)
-&gt; [(FieldName, [FieldName])] -&gt; SimilarArrayFields
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)
  -&gt; (FieldName, [FieldName]))
 -&gt; [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
 -&gt; [(FieldName, [FieldName])])
-&gt; [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
-&gt; (((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)
    -&gt; (FieldName, [FieldName]))
-&gt; [(FieldName, [FieldName])]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)
 -&gt; (FieldName, [FieldName]))
-&gt; [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
-&gt; [(FieldName, [FieldName])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
</span><a href="#local-6989586621687794136"><span class="hs-identifier hs-var">allTuples</span></a></span><span>
</span><span id="line-453"></span><span>    </span><span class="annot"><span class="annottext">((((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)
  -&gt; (FieldName, [FieldName]))
 -&gt; [(FieldName, [FieldName])])
-&gt; (((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)
    -&gt; (FieldName, [FieldName]))
-&gt; [(FieldName, [FieldName])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621687794137"><span class="annot"><span class="annottext">(RelName, SelectArgsG ('Postgres pgKind) v)
</span><a href="#local-6989586621687794137"><span class="hs-identifier hs-var">relNameAndArgs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794138"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794138"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794138"><span class="hs-identifier hs-var">fieldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(RelName, SelectArgsG ('Postgres pgKind) v) -&gt; [FieldName]
</span><a href="#local-6989586621687794139"><span class="hs-identifier hs-var">getSimilarFields</span></a></span><span> </span><span class="annot"><span class="annottext">(RelName, SelectArgsG ('Postgres pgKind) v)
</span><a href="#local-6989586621687794137"><span class="hs-identifier hs-var">relNameAndArgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-455"></span><span>    </span><span id="local-6989586621687794139"><span class="annot"><span class="annottext">getSimilarFields :: (RelName, SelectArgsG ('Postgres pgKind) v) -&gt; [FieldName]
</span><a href="#local-6989586621687794139"><span class="hs-identifier hs-var hs-var">getSimilarFields</span></a></span></span><span> </span><span id="local-6989586621687794140"><span class="annot"><span class="annottext">(RelName, SelectArgsG ('Postgres pgKind) v)
</span><a href="#local-6989586621687794140"><span class="hs-identifier hs-var">relNameAndArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)
 -&gt; FieldName)
-&gt; [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
-&gt; [FieldName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)
-&gt; FieldName
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">([((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
 -&gt; [FieldName])
-&gt; [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
-&gt; [FieldName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(((RelName, SelectArgsG ('Postgres pgKind) v), FieldName) -&gt; Bool)
-&gt; [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
-&gt; [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RelName, SelectArgsG ('Postgres pgKind) v)
-&gt; (RelName, SelectArgsG ('Postgres pgKind) v) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">(RelName, SelectArgsG ('Postgres pgKind) v)
</span><a href="#local-6989586621687794140"><span class="hs-identifier hs-var">relNameAndArgs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((RelName, SelectArgsG ('Postgres pgKind) v) -&gt; Bool)
-&gt; (((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)
    -&gt; (RelName, SelectArgsG ('Postgres pgKind) v))
-&gt; ((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)
-&gt; (RelName, SelectArgsG ('Postgres pgKind) v)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
</span><a href="#local-6989586621687794136"><span class="hs-identifier hs-var">allTuples</span></a></span><span>
</span><span id="line-456"></span><span>    </span><span id="local-6989586621687794136"><span class="annot"><span class="annottext">allTuples :: [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
</span><a href="#local-6989586621687794136"><span class="hs-identifier hs-var hs-var">allTuples</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
</span><a href="#local-6989586621687794141"><span class="hs-identifier hs-var">arrayRelationTuples</span></a></span><span> </span><span class="annot"><span class="annottext">[((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
-&gt; [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
-&gt; [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
</span><a href="#local-6989586621687794142"><span class="hs-identifier hs-var">aggOrderByRelationTuples</span></a></span><span>
</span><span id="line-457"></span><span>    </span><span id="local-6989586621687794141"><span class="annot"><span class="annottext">arrayRelationTuples :: [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
</span><a href="#local-6989586621687794141"><span class="hs-identifier hs-var hs-var">arrayRelationTuples</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-458"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687794143"><span class="annot"><span class="annottext">arrayFields :: [(FieldName, ArraySelectG ('Postgres pgKind) Void v)]
</span><a href="#local-6989586621687794143"><span class="hs-identifier hs-var hs-var">arrayFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FieldName, AnnFieldG ('Postgres pgKind) Void v)
 -&gt; Maybe (FieldName, ArraySelectG ('Postgres pgKind) Void v))
-&gt; AnnFieldsG ('Postgres pgKind) Void v
-&gt; [(FieldName, ArraySelectG ('Postgres pgKind) Void v)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b.
Filterable f =&gt;
(a -&gt; Maybe b) -&gt; f a -&gt; f b
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/witherable-0.4.2-c348fd1be527fbb040281c624d4766fb2c04c7e7f3be298bbe123b3357fb1136/share/doc/html/src/Witherable.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldName, AnnFieldG ('Postgres pgKind) Void v)
-&gt; Maybe (FieldName, ArraySelectG ('Postgres pgKind) Void v)
forall a r.
(a, AnnFieldG ('Postgres pgKind) r v)
-&gt; Maybe (a, ArraySelectG ('Postgres pgKind) r v)
</span><a href="#local-6989586621687794145"><span class="hs-identifier hs-var">getAnnArr</span></a></span><span> </span><span class="annot"><span class="annottext">AnnFieldsG ('Postgres pgKind) Void v
</span><a href="#local-6989586621687794133"><span class="hs-identifier hs-var">annFields</span></a></span><span>
</span><span id="line-459"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(((FieldName, ArraySelectG ('Postgres pgKind) Void v)
  -&gt; ((RelName, SelectArgsG ('Postgres pgKind) v), FieldName))
 -&gt; [(FieldName, ArraySelectG ('Postgres pgKind) Void v)]
 -&gt; [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)])
-&gt; [(FieldName, ArraySelectG ('Postgres pgKind) Void v)]
-&gt; ((FieldName, ArraySelectG ('Postgres pgKind) Void v)
    -&gt; ((RelName, SelectArgsG ('Postgres pgKind) v), FieldName))
-&gt; [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((FieldName, ArraySelectG ('Postgres pgKind) Void v)
 -&gt; ((RelName, SelectArgsG ('Postgres pgKind) v), FieldName))
-&gt; [(FieldName, ArraySelectG ('Postgres pgKind) Void v)]
-&gt; [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[(FieldName, ArraySelectG ('Postgres pgKind) Void v)]
</span><a href="#local-6989586621687794143"><span class="hs-identifier hs-var">arrayFields</span></a></span><span>
</span><span id="line-460"></span><span>            </span><span class="annot"><span class="annottext">(((FieldName, ArraySelectG ('Postgres pgKind) Void v)
  -&gt; ((RelName, SelectArgsG ('Postgres pgKind) v), FieldName))
 -&gt; [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)])
-&gt; ((FieldName, ArraySelectG ('Postgres pgKind) Void v)
    -&gt; ((RelName, SelectArgsG ('Postgres pgKind) v), FieldName))
-&gt; [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621687794146"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794146"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794147"><span class="annot"><span class="annottext">ArraySelectG ('Postgres pgKind) Void v
</span><a href="#local-6989586621687794147"><span class="hs-identifier hs-var">relSel</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArraySelectG ('Postgres pgKind) Void v
-&gt; (RelName, SelectArgsG ('Postgres pgKind) v)
forall r.
ArraySelectG ('Postgres pgKind) r v
-&gt; (RelName, SelectArgsG ('Postgres pgKind) v)
</span><a href="#local-6989586621687794148"><span class="hs-identifier hs-var">getArrayRelNameAndSelectArgs</span></a></span><span> </span><span class="annot"><span class="annottext">ArraySelectG ('Postgres pgKind) Void v
</span><a href="#local-6989586621687794147"><span class="hs-identifier hs-var">relSel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794146"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span>    </span><span id="local-6989586621687793398"><span id="local-6989586621687793399"><span class="annot"><a href="#local-6989586621687794145"><span class="hs-identifier hs-type">getAnnArr</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-463"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621687793398"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnFieldG"><span class="hs-identifier hs-type">AnnFieldG</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793239"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687793399"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793240"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-464"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621687793398"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ArraySelectG"><span class="hs-identifier hs-type">ArraySelectG</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793239"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687793399"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793240"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-465"></span><span>    </span><span id="local-6989586621687794145"><span class="annot"><span class="annottext">getAnnArr :: forall a r.
(a, AnnFieldG ('Postgres pgKind) r v)
-&gt; Maybe (a, ArraySelectG ('Postgres pgKind) r v)
</span><a href="#local-6989586621687794145"><span class="hs-identifier hs-var hs-var">getAnnArr</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687794149"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621687794149"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794150"><span class="annot"><span class="annottext">AnnFieldG ('Postgres pgKind) r v
</span><a href="#local-6989586621687794150"><span class="hs-identifier hs-var">annFld</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AnnFieldG ('Postgres pgKind) r v
</span><a href="#local-6989586621687794150"><span class="hs-identifier hs-var">annFld</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-466"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFArrayRelation"><span class="hs-identifier hs-type">AFArrayRelation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ASConnection"><span class="hs-identifier hs-type">ASConnection</span></a></span><span> </span><span class="annot"><span class="annottext">ArrayConnectionSelect ('Postgres pgKind) r v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (a, ArraySelectG ('Postgres pgKind) r v)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-467"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFArrayRelation"><span class="hs-identifier hs-type">AFArrayRelation</span></a></span><span> </span><span id="local-6989586621687794152"><span class="annot"><span class="annottext">ArraySelectG ('Postgres pgKind) r v
</span><a href="#local-6989586621687794152"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, ArraySelectG ('Postgres pgKind) r v)
-&gt; Maybe (a, ArraySelectG ('Postgres pgKind) r v)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621687794149"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ArraySelectG ('Postgres pgKind) r v
</span><a href="#local-6989586621687794152"><span class="hs-identifier hs-var">ar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>      </span><span class="annot"><span class="annottext">AnnFieldG ('Postgres pgKind) r v
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (a, ArraySelectG ('Postgres pgKind) r v)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span>    </span><span id="local-6989586621687794142"><span class="annot"><span class="annottext">aggOrderByRelationTuples :: [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
</span><a href="#local-6989586621687794142"><span class="hs-identifier hs-var hs-var">aggOrderByRelationTuples</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-471"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687794153"><span class="annot"><span class="annottext">mkItem :: (a, b) -&gt; ((a, SelectArgsG backend v), b)
</span><a href="#local-6989586621687794153"><span class="hs-identifier hs-var hs-var">mkItem</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687794154"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621687794154"><span class="hs-identifier hs-var">relName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794155"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621687794155"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-472"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621687794154"><span class="hs-identifier hs-var">relName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SelectArgsG backend v
forall (backend :: BackendType) v. SelectArgsG backend v
</span><a href="Hasura.RQL.IR.Select.Args.html#noSelectArgs"><span class="hs-identifier hs-var">noSelectArgs</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-473"></span><span>              </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621687794155"><span class="hs-identifier hs-var">fieldName</span></a></span><span>
</span><span id="line-474"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">((RelName, FieldName)
 -&gt; ((RelName, SelectArgsG ('Postgres pgKind) v), FieldName))
-&gt; [(RelName, FieldName)]
-&gt; [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(RelName, FieldName)
-&gt; ((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)
forall {a} {b} {backend :: BackendType} {v}.
(a, b) -&gt; ((a, SelectArgsG backend v), b)
</span><a href="#local-6989586621687794153"><span class="hs-identifier hs-var">mkItem</span></a></span><span>
</span><span id="line-476"></span><span>            </span><span class="annot"><span class="annottext">([(RelName, FieldName)]
 -&gt; [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)])
-&gt; [(RelName, FieldName)]
-&gt; [((RelName, SelectArgsG ('Postgres pgKind) v), FieldName)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(RelName, FieldName)]
-&gt; (NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) v)
    -&gt; [(RelName, FieldName)])
-&gt; Maybe (NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) v))
-&gt; [(RelName, FieldName)]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span>
</span><span id="line-477"></span><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-478"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AnnotatedOrderByItemG ('Postgres pgKind) v
 -&gt; Maybe (RelName, FieldName))
-&gt; [AnnotatedOrderByItemG ('Postgres pgKind) v]
-&gt; [(RelName, FieldName)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b.
Filterable f =&gt;
(a -&gt; Maybe b) -&gt; f a -&gt; f b
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/witherable-0.4.2-c348fd1be527fbb040281c624d4766fb2c04c7e7f3be298bbe123b3357fb1136/share/doc/html/src/Witherable.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnotatedOrderByElement ('Postgres pgKind) v
-&gt; Maybe (RelName, FieldName)
forall {b :: BackendType} {v}.
AnnotatedOrderByElement b v -&gt; Maybe (RelName, FieldName)
</span><a href="#local-6989586621687794157"><span class="hs-identifier hs-var">fetchAggOrderByRels</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnotatedOrderByElement ('Postgres pgKind) v
 -&gt; Maybe (RelName, FieldName))
-&gt; (AnnotatedOrderByItemG ('Postgres pgKind) v
    -&gt; AnnotatedOrderByElement ('Postgres pgKind) v)
-&gt; AnnotatedOrderByItemG ('Postgres pgKind) v
-&gt; Maybe (RelName, FieldName)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AnnotatedOrderByItemG ('Postgres pgKind) v
-&gt; AnnotatedOrderByElement ('Postgres pgKind) v
forall (b :: BackendType) a. OrderByItemG b a -&gt; a
</span><a href="Hasura.RQL.IR.OrderBy.html#obiColumn"><span class="hs-identifier hs-var">obiColumn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([AnnotatedOrderByItemG ('Postgres pgKind) v]
 -&gt; [(RelName, FieldName)])
-&gt; (NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) v)
    -&gt; [AnnotatedOrderByItemG ('Postgres pgKind) v])
-&gt; NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) v)
-&gt; [(RelName, FieldName)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) v)
-&gt; [AnnotatedOrderByItemG ('Postgres pgKind) v]
forall a. NonEmpty a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>              </span><span class="annot"><span class="annottext">Maybe (NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) v))
</span><a href="#local-6989586621687794134"><span class="hs-identifier hs-var">maybeOrderBys</span></a></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span>    </span><span id="local-6989586621687794157"><span class="annot"><span class="annottext">fetchAggOrderByRels :: AnnotatedOrderByElement b v -&gt; Maybe (RelName, FieldName)
</span><a href="#local-6989586621687794157"><span class="hs-identifier hs-var hs-var">fetchAggOrderByRels</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.OrderBy.html#AOCArrayAggregation"><span class="hs-identifier hs-type">AOCArrayAggregation</span></a></span><span> </span><span id="local-6989586621687794160"><span class="annot"><span class="annottext">RelInfo b
</span><a href="#local-6989586621687794160"><span class="hs-identifier hs-var">ri</span></a></span></span><span> </span><span class="annot"><span class="annottext">AnnBoolExp b v
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">AnnotatedAggregateOrderBy b v
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-482"></span><span>      </span><span class="annot"><span class="annottext">(RelName, FieldName) -&gt; Maybe (RelName, FieldName)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RelInfo b -&gt; RelName
forall (b :: BackendType). RelInfo b -&gt; RelName
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riName"><span class="hs-identifier hs-var">riName</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo b
</span><a href="#local-6989586621687794160"><span class="hs-identifier hs-var">ri</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RelName -&gt; FieldName
forall a. ToTxt a =&gt; a -&gt; FieldName
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkOrderByFieldName"><span class="hs-identifier hs-var">mkOrderByFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">(RelName -&gt; FieldName) -&gt; RelName -&gt; FieldName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RelInfo b -&gt; RelName
forall (b :: BackendType). RelInfo b -&gt; RelName
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riName"><span class="hs-identifier hs-var">riName</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo b
</span><a href="#local-6989586621687794160"><span class="hs-identifier hs-var">ri</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>    </span><span class="annot"><a href="#local-6989586621687794157"><span class="hs-identifier hs-var">fetchAggOrderByRels</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedOrderByElement b v
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (RelName, FieldName)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span>    </span><span id="local-6989586621687793400"><span class="annot"><a href="#local-6989586621687794148"><span class="hs-identifier hs-type">getArrayRelNameAndSelectArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-486"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ArraySelectG"><span class="hs-identifier hs-type">ArraySelectG</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793239"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687793400"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793240"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-487"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Common.html#RelName"><span class="hs-identifier hs-type">RelName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.Args.html#SelectArgsG"><span class="hs-identifier hs-type">SelectArgsG</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793239"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621687793240"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-488"></span><span>    </span><span id="local-6989586621687794148"><span class="annot"><span class="annottext">getArrayRelNameAndSelectArgs :: forall r.
ArraySelectG ('Postgres pgKind) r v
-&gt; (RelName, SelectArgsG ('Postgres pgKind) v)
</span><a href="#local-6989586621687794148"><span class="hs-identifier hs-var hs-var">getArrayRelNameAndSelectArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-489"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ASSimple"><span class="hs-identifier hs-type">ASSimple</span></a></span><span> </span><span id="local-6989586621687794163"><span class="annot"><span class="annottext">ArrayRelationSelectG ('Postgres pgKind) r v
</span><a href="#local-6989586621687794163"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrayRelationSelectG ('Postgres pgKind) r v -&gt; RelName
forall (b :: BackendType) a. AnnRelationSelectG b a -&gt; RelName
</span><a href="Hasura.RQL.IR.Select.RelationSelect.html#%24sel%3A_aarRelationshipName%3AAnnRelationSelectG"><span class="hs-identifier hs-var">_aarRelationshipName</span></a></span><span> </span><span class="annot"><span class="annottext">ArrayRelationSelectG ('Postgres pgKind) r v
</span><a href="#local-6989586621687794163"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AnnSelectG ('Postgres pgKind) (AnnFieldG ('Postgres pgKind) r) v
-&gt; SelectArgsG ('Postgres pgKind) v
forall (b :: BackendType) (f :: * -&gt; *) v.
AnnSelectG b f v -&gt; SelectArgsG b v
</span><a href="Hasura.RQL.IR.Select.AnnSelectG.html#%24sel%3A_asnArgs%3AAnnSelectG"><span class="hs-identifier hs-var">_asnArgs</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnSelectG ('Postgres pgKind) (AnnFieldG ('Postgres pgKind) r) v
 -&gt; SelectArgsG ('Postgres pgKind) v)
-&gt; AnnSelectG ('Postgres pgKind) (AnnFieldG ('Postgres pgKind) r) v
-&gt; SelectArgsG ('Postgres pgKind) v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArrayRelationSelectG ('Postgres pgKind) r v
-&gt; AnnSelectG ('Postgres pgKind) (AnnFieldG ('Postgres pgKind) r) v
forall (b :: BackendType) a. AnnRelationSelectG b a -&gt; a
</span><a href="Hasura.RQL.IR.Select.RelationSelect.html#%24sel%3A_aarAnnSelect%3AAnnRelationSelectG"><span class="hs-identifier hs-var">_aarAnnSelect</span></a></span><span> </span><span class="annot"><span class="annottext">ArrayRelationSelectG ('Postgres pgKind) r v
</span><a href="#local-6989586621687794163"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ASAggregate"><span class="hs-identifier hs-type">ASAggregate</span></a></span><span> </span><span id="local-6989586621687794168"><span class="annot"><span class="annottext">ArrayAggregateSelectG ('Postgres pgKind) r v
</span><a href="#local-6989586621687794168"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrayAggregateSelectG ('Postgres pgKind) r v -&gt; RelName
forall (b :: BackendType) a. AnnRelationSelectG b a -&gt; RelName
</span><a href="Hasura.RQL.IR.Select.RelationSelect.html#%24sel%3A_aarRelationshipName%3AAnnRelationSelectG"><span class="hs-identifier hs-var">_aarRelationshipName</span></a></span><span> </span><span class="annot"><span class="annottext">ArrayAggregateSelectG ('Postgres pgKind) r v
</span><a href="#local-6989586621687794168"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AnnSelectG
  ('Postgres pgKind) (TableAggregateFieldG ('Postgres pgKind) r) v
-&gt; SelectArgsG ('Postgres pgKind) v
forall (b :: BackendType) (f :: * -&gt; *) v.
AnnSelectG b f v -&gt; SelectArgsG b v
</span><a href="Hasura.RQL.IR.Select.AnnSelectG.html#%24sel%3A_asnArgs%3AAnnSelectG"><span class="hs-identifier hs-var">_asnArgs</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnSelectG
   ('Postgres pgKind) (TableAggregateFieldG ('Postgres pgKind) r) v
 -&gt; SelectArgsG ('Postgres pgKind) v)
-&gt; AnnSelectG
     ('Postgres pgKind) (TableAggregateFieldG ('Postgres pgKind) r) v
-&gt; SelectArgsG ('Postgres pgKind) v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArrayAggregateSelectG ('Postgres pgKind) r v
-&gt; AnnSelectG
     ('Postgres pgKind) (TableAggregateFieldG ('Postgres pgKind) r) v
forall (b :: BackendType) a. AnnRelationSelectG b a -&gt; a
</span><a href="Hasura.RQL.IR.Select.RelationSelect.html#%24sel%3A_aarAnnSelect%3AAnnRelationSelectG"><span class="hs-identifier hs-var">_aarAnnSelect</span></a></span><span> </span><span class="annot"><span class="annottext">ArrayAggregateSelectG ('Postgres pgKind) r v
</span><a href="#local-6989586621687794168"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ASConnection"><span class="hs-identifier hs-type">ASConnection</span></a></span><span> </span><span id="local-6989586621687794169"><span class="annot"><span class="annottext">ArrayConnectionSelect ('Postgres pgKind) r v
</span><a href="#local-6989586621687794169"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrayConnectionSelect ('Postgres pgKind) r v -&gt; RelName
forall (b :: BackendType) a. AnnRelationSelectG b a -&gt; RelName
</span><a href="Hasura.RQL.IR.Select.RelationSelect.html#%24sel%3A_aarRelationshipName%3AAnnRelationSelectG"><span class="hs-identifier hs-var">_aarRelationshipName</span></a></span><span> </span><span class="annot"><span class="annottext">ArrayConnectionSelect ('Postgres pgKind) r v
</span><a href="#local-6989586621687794169"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AnnSelectG
  ('Postgres pgKind) (ConnectionField ('Postgres pgKind) r) v
-&gt; SelectArgsG ('Postgres pgKind) v
forall (b :: BackendType) (f :: * -&gt; *) v.
AnnSelectG b f v -&gt; SelectArgsG b v
</span><a href="Hasura.RQL.IR.Select.AnnSelectG.html#%24sel%3A_asnArgs%3AAnnSelectG"><span class="hs-identifier hs-var">_asnArgs</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnSelectG
   ('Postgres pgKind) (ConnectionField ('Postgres pgKind) r) v
 -&gt; SelectArgsG ('Postgres pgKind) v)
-&gt; AnnSelectG
     ('Postgres pgKind) (ConnectionField ('Postgres pgKind) r) v
-&gt; SelectArgsG ('Postgres pgKind) v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConnectionSelect ('Postgres pgKind) r v
-&gt; AnnSelectG
     ('Postgres pgKind) (ConnectionField ('Postgres pgKind) r) v
forall (b :: BackendType) r v.
ConnectionSelect b r v -&gt; AnnSelectG b (ConnectionField b r) v
</span><a href="Hasura.RQL.IR.Select.html#%24sel%3A_csSelect%3AConnectionSelect"><span class="hs-identifier hs-var">_csSelect</span></a></span><span> </span><span class="annot"><span class="annottext">(ConnectionSelect ('Postgres pgKind) r v
 -&gt; AnnSelectG
      ('Postgres pgKind) (ConnectionField ('Postgres pgKind) r) v)
-&gt; ConnectionSelect ('Postgres pgKind) r v
-&gt; AnnSelectG
     ('Postgres pgKind) (ConnectionField ('Postgres pgKind) r) v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ArrayConnectionSelect ('Postgres pgKind) r v
-&gt; ConnectionSelect ('Postgres pgKind) r v
forall (b :: BackendType) a. AnnRelationSelectG b a -&gt; a
</span><a href="Hasura.RQL.IR.Select.RelationSelect.html#%24sel%3A_aarAnnSelect%3AAnnRelationSelectG"><span class="hs-identifier hs-var">_aarAnnSelect</span></a></span><span> </span><span class="annot"><span class="annottext">ArrayConnectionSelect ('Postgres pgKind) r v
</span><a href="#local-6989586621687794169"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processArrayRelation"><span class="hs-identifier hs-type">processArrayRelation</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-494"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687793291"><span class="annot"><a href="#local-6989586621687793291"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621687793290"><span class="annot"><a href="#local-6989586621687793290"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793290"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-496"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadWriter</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SelectWriter"><span class="hs-identifier hs-type">SelectWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793290"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-497"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#NativeQueryFreshIdStore"><span class="hs-identifier hs-type">NativeQueryFreshIdStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793290"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-498"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793291"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-499"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.AnnotatedFieldJSON.html#PostgresAnnotatedFieldJSON"><span class="hs-identifier hs-type">PostgresAnnotatedFieldJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793291"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-500"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687793290"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-501"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793290"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-503"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-504"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SourcePrefixes"><span class="hs-identifier hs-type">SourcePrefixes</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-505"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-506"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#TableAlias"><span class="hs-identifier hs-type">S.TableAlias</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-507"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ArraySelect"><span class="hs-identifier hs-type">ArraySelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793291"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-508"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-509"></span><span>  </span><span class="annot"><a href="#local-6989586621687793290"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span id="processArrayRelation"><span class="annot"><span class="annottext">processArrayRelation :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m, MonadWriter SelectWriter m,
 MonadState NativeQueryFreshIdStore m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind, MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; TableAlias
-&gt; ArraySelect ('Postgres pgKind)
-&gt; Maybe NamingCase
-&gt; m ()
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processArrayRelation"><span class="hs-identifier hs-var hs-var">processArrayRelation</span></a></span></span><span> </span><span id="local-6989586621687794211"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687794211"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621687794212"><span class="annot"><span class="annottext">SourcePrefixes
</span><a href="#local-6989586621687794212"><span class="hs-identifier hs-var">sourcePrefixes</span></a></span></span><span> </span><span id="local-6989586621687794213"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794213"><span class="hs-identifier hs-var">fieldAlias</span></a></span></span><span> </span><span id="local-6989586621687794214"><span class="annot"><span class="annottext">TableAlias
</span><a href="#local-6989586621687794214"><span class="hs-identifier hs-var">relAlias</span></a></span></span><span> </span><span id="local-6989586621687794215"><span class="annot"><span class="annottext">ArraySelect ('Postgres pgKind)
</span><a href="#local-6989586621687794215"><span class="hs-identifier hs-var">arrSel</span></a></span></span><span> </span><span id="local-6989586621687794216"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687794216"><span class="hs-identifier hs-var">_tCase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-511"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ArraySelect ('Postgres pgKind)
</span><a href="#local-6989586621687794215"><span class="hs-identifier hs-var">arrSel</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-512"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ASSimple"><span class="hs-identifier hs-type">ASSimple</span></a></span><span> </span><span id="local-6989586621687794217"><span class="annot"><span class="annottext">ArrayRelationSelectG
  ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind))
</span><a href="#local-6989586621687794217"><span class="hs-identifier hs-var">annArrRel</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (ArrayRelationSource, Extractor,
   InsOrdHashMap ColumnAlias SQLExp, ())
-&gt; m ()
forall (m :: * -&gt; *) a.
MonadWriter SelectWriter m =&gt;
m (ArrayRelationSource, Extractor,
   InsOrdHashMap ColumnAlias SQLExp, a)
-&gt; m a
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.JoinTree.html#withWriteArrayRelation"><span class="hs-identifier hs-var">withWriteArrayRelation</span></a></span><span> </span><span class="annot"><span class="annottext">(m (ArrayRelationSource, Extractor,
    InsOrdHashMap ColumnAlias SQLExp, ())
 -&gt; m ())
-&gt; m (ArrayRelationSource, Extractor,
      InsOrdHashMap ColumnAlias SQLExp, ())
-&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-513"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.RelationSelect.html#AnnRelationSelectG"><span class="hs-identifier hs-type">AnnRelationSelectG</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687794218"><span class="annot"><span class="annottext">HashMap (Column ('Postgres pgKind)) (Column ('Postgres pgKind))
</span><a href="#local-6989586621687794218"><span class="hs-identifier hs-var">colMapping</span></a></span></span><span> </span><span class="annot"><span class="annottext">Nullable
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687794219"><span class="annot"><span class="annottext">AnnSimpleSelectG
  ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind))
</span><a href="#local-6989586621687794219"><span class="hs-identifier hs-var">sel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArrayRelationSelectG
  ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind))
</span><a href="#local-6989586621687794217"><span class="hs-identifier hs-var">annArrRel</span></a></span><span>
</span><span id="line-514"></span><span>          </span><span id="local-6989586621687794220"><span class="annot"><span class="annottext">permLimitSubQuery :: PermissionLimitSubQuery
</span><a href="#local-6989586621687794220"><span class="hs-identifier hs-var hs-var">permLimitSubQuery</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-515"></span><span>            </span><span class="annot"><span class="annottext">PermissionLimitSubQuery
-&gt; (Int -&gt; PermissionLimitSubQuery)
-&gt; Maybe Int
-&gt; PermissionLimitSubQuery
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">PermissionLimitSubQuery
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#PLSQNotRequired"><span class="hs-identifier hs-var">PLSQNotRequired</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; PermissionLimitSubQuery
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#PLSQRequired"><span class="hs-identifier hs-var">PLSQRequired</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; PermissionLimitSubQuery)
-&gt; Maybe Int -&gt; PermissionLimitSubQuery
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TablePermG ('Postgres pgKind) SQLExp -&gt; Maybe Int
forall (b :: BackendType) v. TablePermG b v -&gt; Maybe Int
</span><a href="Hasura.RQL.IR.Select.TablePerm.html#%24sel%3A_tpLimit%3ATablePerm"><span class="hs-identifier hs-var">_tpLimit</span></a></span><span> </span><span class="annot"><span class="annottext">(TablePermG ('Postgres pgKind) SQLExp -&gt; Maybe Int)
-&gt; TablePermG ('Postgres pgKind) SQLExp -&gt; Maybe Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AnnSelectG
  ('Postgres pgKind) (AnnFieldG ('Postgres pgKind) Void) SQLExp
-&gt; TablePermG ('Postgres pgKind) SQLExp
forall (b :: BackendType) (f :: * -&gt; *) v.
AnnSelectG b f v -&gt; TablePermG b v
</span><a href="Hasura.RQL.IR.Select.AnnSelectG.html#%24sel%3A_asnPerm%3AAnnSelectG"><span class="hs-identifier hs-var">_asnPerm</span></a></span><span> </span><span class="annot"><span class="annottext">AnnSimpleSelectG
  ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind))
AnnSelectG
  ('Postgres pgKind) (AnnFieldG ('Postgres pgKind) Void) SQLExp
</span><a href="#local-6989586621687794219"><span class="hs-identifier hs-var">sel</span></a></span><span>
</span><span id="line-516"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621687794222"><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687794222"><span class="hs-identifier hs-var">source</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794223"><span class="annot"><span class="annottext">InsOrdHashMap ColumnAlias SQLExp
</span><a href="#local-6989586621687794223"><span class="hs-identifier hs-var">nodeExtractors</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-517"></span><span>        </span><span class="annot"><span class="annottext">UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; PermissionLimitSubQuery
-&gt; AnnSimpleSelectG
     ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind))
-&gt; m (SelectSource, InsOrdHashMap ColumnAlias SQLExp)
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m,
 MonadState NativeQueryFreshIdStore m, MonadWriter SelectWriter m,
 Backend ('Postgres pgKind), PostgresAnnotatedFieldJSON pgKind,
 MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; PermissionLimitSubQuery
-&gt; AnnSimpleSelect ('Postgres pgKind)
-&gt; m (SelectSource, InsOrdHashMap ColumnAlias SQLExp)
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processAnnSimpleSelect"><span class="hs-identifier hs-var">processAnnSimpleSelect</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687794211"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">SourcePrefixes
</span><a href="#local-6989586621687794212"><span class="hs-identifier hs-var">sourcePrefixes</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794213"><span class="hs-identifier hs-var">fieldAlias</span></a></span><span> </span><span class="annot"><span class="annottext">PermissionLimitSubQuery
</span><a href="#local-6989586621687794220"><span class="hs-identifier hs-var">permLimitSubQuery</span></a></span><span> </span><span class="annot"><span class="annottext">AnnSimpleSelectG
  ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind))
</span><a href="#local-6989586621687794219"><span class="hs-identifier hs-var">sel</span></a></span><span>
</span><span id="line-518"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687794224"><span class="annot"><span class="annottext">topExtr :: Extractor
</span><a href="#local-6989586621687794224"><span class="hs-identifier hs-var hs-var">topExtr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-519"></span><span>            </span><span class="annot"><span class="annottext">JsonAggSelect
-&gt; ColumnAlias
-&gt; PermissionLimitSubQuery
-&gt; Maybe OrderByExp
-&gt; Extractor
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Extractor.html#asJsonAggExtr"><span class="hs-identifier hs-var">asJsonAggExtr</span></a></span><span>
</span><span id="line-520"></span><span>              </span><span class="annot"><span class="annottext">JsonAggSelect
</span><a href="Hasura.RQL.Types.Common.html#JASMultipleRows"><span class="hs-identifier hs-var">JASMultipleRows</span></a></span><span>
</span><span id="line-521"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; ColumnAlias
forall a. IsIdentifier a =&gt; a -&gt; ColumnAlias
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#toColumnAlias"><span class="hs-identifier hs-var">S.toColumnAlias</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794213"><span class="hs-identifier hs-var">fieldAlias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>              </span><span class="annot"><span class="annottext">PermissionLimitSubQuery
</span><a href="#local-6989586621687794220"><span class="hs-identifier hs-var">permLimitSubQuery</span></a></span><span>
</span><span id="line-523"></span><span>              </span><span class="annot"><span class="annottext">(Maybe OrderByExp -&gt; Extractor) -&gt; Maybe OrderByExp -&gt; Extractor
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SelectSource -&gt; Maybe OrderByExp
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#orderByForJsonAgg"><span class="hs-identifier hs-var">orderByForJsonAgg</span></a></span><span> </span><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687794222"><span class="hs-identifier hs-var">source</span></a></span><span>
</span><span id="line-524"></span><span>      </span><span class="annot"><span class="annottext">(ArrayRelationSource, Extractor, InsOrdHashMap ColumnAlias SQLExp,
 ())
-&gt; m (ArrayRelationSource, Extractor,
      InsOrdHashMap ColumnAlias SQLExp, ())
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-525"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">TableAlias
-&gt; HashMap PGCol PGCol -&gt; SelectSource -&gt; ArrayRelationSource
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#ArrayRelationSource"><span class="hs-identifier hs-var">ArrayRelationSource</span></a></span><span> </span><span class="annot"><span class="annottext">TableAlias
</span><a href="#local-6989586621687794214"><span class="hs-identifier hs-var">relAlias</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap (Column ('Postgres pgKind)) (Column ('Postgres pgKind))
HashMap PGCol PGCol
</span><a href="#local-6989586621687794218"><span class="hs-identifier hs-var">colMapping</span></a></span><span> </span><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687794222"><span class="hs-identifier hs-var">source</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-526"></span><span>          </span><span class="annot"><span class="annottext">Extractor
</span><a href="#local-6989586621687794224"><span class="hs-identifier hs-var">topExtr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-527"></span><span>          </span><span class="annot"><span class="annottext">InsOrdHashMap ColumnAlias SQLExp
</span><a href="#local-6989586621687794223"><span class="hs-identifier hs-var">nodeExtractors</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-528"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ASAggregate"><span class="hs-identifier hs-type">ASAggregate</span></a></span><span> </span><span id="local-6989586621687794227"><span class="annot"><span class="annottext">ArrayAggregateSelectG
  ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind))
</span><a href="#local-6989586621687794227"><span class="hs-identifier hs-var">aggSel</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (ArrayRelationSource, Extractor,
   InsOrdHashMap ColumnAlias SQLExp, ())
-&gt; m ()
forall (m :: * -&gt; *) a.
MonadWriter SelectWriter m =&gt;
m (ArrayRelationSource, Extractor,
   InsOrdHashMap ColumnAlias SQLExp, a)
-&gt; m a
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.JoinTree.html#withWriteArrayRelation"><span class="hs-identifier hs-var">withWriteArrayRelation</span></a></span><span> </span><span class="annot"><span class="annottext">(m (ArrayRelationSource, Extractor,
    InsOrdHashMap ColumnAlias SQLExp, ())
 -&gt; m ())
-&gt; m (ArrayRelationSource, Extractor,
      InsOrdHashMap ColumnAlias SQLExp, ())
-&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-531"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.RelationSelect.html#AnnRelationSelectG"><span class="hs-identifier hs-type">AnnRelationSelectG</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687794228"><span class="annot"><span class="annottext">HashMap (Column ('Postgres pgKind)) (Column ('Postgres pgKind))
</span><a href="#local-6989586621687794228"><span class="hs-identifier hs-var">colMapping</span></a></span></span><span> </span><span class="annot"><span class="annottext">Nullable
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687794229"><span class="annot"><span class="annottext">AnnAggregateSelectG
  ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind))
</span><a href="#local-6989586621687794229"><span class="hs-identifier hs-var">sel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArrayAggregateSelectG
  ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind))
</span><a href="#local-6989586621687794227"><span class="hs-identifier hs-var">aggSel</span></a></span><span>
</span><span id="line-532"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621687794230"><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687794230"><span class="hs-identifier hs-var">source</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794231"><span class="annot"><span class="annottext">InsOrdHashMap ColumnAlias SQLExp
</span><a href="#local-6989586621687794231"><span class="hs-identifier hs-var">nodeExtractors</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794232"><span class="annot"><span class="annottext">Extractor
</span><a href="#local-6989586621687794232"><span class="hs-identifier hs-var">topExtr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-533"></span><span>        </span><span class="annot"><span class="annottext">UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; AnnAggregateSelectG
     ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind))
-&gt; m (SelectSource, InsOrdHashMap ColumnAlias SQLExp, Extractor)
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m, MonadWriter SelectWriter m,
 MonadState NativeQueryFreshIdStore m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind, MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; AnnAggregateSelect ('Postgres pgKind)
-&gt; m (SelectSource, InsOrdHashMap ColumnAlias SQLExp, Extractor)
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processAnnAggregateSelect"><span class="hs-identifier hs-var">processAnnAggregateSelect</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687794211"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">SourcePrefixes
</span><a href="#local-6989586621687794212"><span class="hs-identifier hs-var">sourcePrefixes</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794213"><span class="hs-identifier hs-var">fieldAlias</span></a></span><span> </span><span class="annot"><span class="annottext">AnnAggregateSelectG
  ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind))
</span><a href="#local-6989586621687794229"><span class="hs-identifier hs-var">sel</span></a></span><span>
</span><span id="line-534"></span><span>      </span><span class="annot"><span class="annottext">(ArrayRelationSource, Extractor, InsOrdHashMap ColumnAlias SQLExp,
 ())
-&gt; m (ArrayRelationSource, Extractor,
      InsOrdHashMap ColumnAlias SQLExp, ())
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-535"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">TableAlias
-&gt; HashMap PGCol PGCol -&gt; SelectSource -&gt; ArrayRelationSource
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#ArrayRelationSource"><span class="hs-identifier hs-var">ArrayRelationSource</span></a></span><span> </span><span class="annot"><span class="annottext">TableAlias
</span><a href="#local-6989586621687794214"><span class="hs-identifier hs-var">relAlias</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap (Column ('Postgres pgKind)) (Column ('Postgres pgKind))
HashMap PGCol PGCol
</span><a href="#local-6989586621687794228"><span class="hs-identifier hs-var">colMapping</span></a></span><span> </span><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687794230"><span class="hs-identifier hs-var">source</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-536"></span><span>          </span><span class="annot"><span class="annottext">Extractor
</span><a href="#local-6989586621687794232"><span class="hs-identifier hs-var">topExtr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-537"></span><span>          </span><span class="annot"><span class="annottext">InsOrdHashMap ColumnAlias SQLExp
</span><a href="#local-6989586621687794231"><span class="hs-identifier hs-var">nodeExtractors</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-538"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-540"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ASConnection"><span class="hs-identifier hs-type">ASConnection</span></a></span><span> </span><span id="local-6989586621687794233"><span class="annot"><span class="annottext">ArrayConnectionSelect
  ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind))
</span><a href="#local-6989586621687794233"><span class="hs-identifier hs-var">connSel</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m (ArrayConnectionSource, Extractor,
   InsOrdHashMap ColumnAlias SQLExp, ())
-&gt; m ()
forall (m :: * -&gt; *) a.
MonadWriter SelectWriter m =&gt;
m (ArrayConnectionSource, Extractor,
   InsOrdHashMap ColumnAlias SQLExp, a)
-&gt; m a
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.JoinTree.html#withWriteArrayConnection"><span class="hs-identifier hs-var">withWriteArrayConnection</span></a></span><span> </span><span class="annot"><span class="annottext">(m (ArrayConnectionSource, Extractor,
    InsOrdHashMap ColumnAlias SQLExp, ())
 -&gt; m ())
-&gt; m (ArrayConnectionSource, Extractor,
      InsOrdHashMap ColumnAlias SQLExp, ())
-&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-541"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.RelationSelect.html#AnnRelationSelectG"><span class="hs-identifier hs-type">AnnRelationSelectG</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687794234"><span class="annot"><span class="annottext">HashMap (Column ('Postgres pgKind)) (Column ('Postgres pgKind))
</span><a href="#local-6989586621687794234"><span class="hs-identifier hs-var">colMapping</span></a></span></span><span> </span><span class="annot"><span class="annottext">Nullable
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687794235"><span class="annot"><span class="annottext">ConnectionSelect
  ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind))
</span><a href="#local-6989586621687794235"><span class="hs-identifier hs-var">sel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArrayConnectionSelect
  ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind))
</span><a href="#local-6989586621687794233"><span class="hs-identifier hs-var">connSel</span></a></span><span>
</span><span id="line-542"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621687794236"><span class="annot"><span class="annottext">ArrayConnectionSource
</span><a href="#local-6989586621687794236"><span class="hs-identifier hs-var">source</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794237"><span class="annot"><span class="annottext">Extractor
</span><a href="#local-6989586621687794237"><span class="hs-identifier hs-var">topExtractor</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794238"><span class="annot"><span class="annottext">InsOrdHashMap ColumnAlias SQLExp
</span><a href="#local-6989586621687794238"><span class="hs-identifier hs-var">nodeExtractors</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-543"></span><span>        </span><span class="annot"><span class="annottext">UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; TableAlias
-&gt; HashMap PGCol PGCol
-&gt; ConnectionSelect ('Postgres pgKind) Void SQLExp
-&gt; m (ArrayConnectionSource, Extractor,
      InsOrdHashMap ColumnAlias SQLExp)
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m, MonadWriter SelectWriter m,
 MonadState NativeQueryFreshIdStore m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind, MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; TableAlias
-&gt; HashMap PGCol PGCol
-&gt; ConnectionSelect ('Postgres pgKind) Void SQLExp
-&gt; m (ArrayConnectionSource, Extractor,
      InsOrdHashMap ColumnAlias SQLExp)
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processConnectionSelect"><span class="hs-identifier hs-var">processConnectionSelect</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687794211"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">SourcePrefixes
</span><a href="#local-6989586621687794212"><span class="hs-identifier hs-var">sourcePrefixes</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794213"><span class="hs-identifier hs-var">fieldAlias</span></a></span><span> </span><span class="annot"><span class="annottext">TableAlias
</span><a href="#local-6989586621687794214"><span class="hs-identifier hs-var">relAlias</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap (Column ('Postgres pgKind)) (Column ('Postgres pgKind))
HashMap PGCol PGCol
</span><a href="#local-6989586621687794234"><span class="hs-identifier hs-var">colMapping</span></a></span><span> </span><span class="annot"><span class="annottext">ConnectionSelect
  ('Postgres pgKind) Void (SQLExpression ('Postgres pgKind))
ConnectionSelect ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794235"><span class="hs-identifier hs-var">sel</span></a></span><span>
</span><span id="line-544"></span><span>      </span><span class="annot"><span class="annottext">(ArrayConnectionSource, Extractor,
 InsOrdHashMap ColumnAlias SQLExp, ())
-&gt; m (ArrayConnectionSource, Extractor,
      InsOrdHashMap ColumnAlias SQLExp, ())
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-545"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ArrayConnectionSource
</span><a href="#local-6989586621687794236"><span class="hs-identifier hs-var">source</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-546"></span><span>          </span><span class="annot"><span class="annottext">Extractor
</span><a href="#local-6989586621687794237"><span class="hs-identifier hs-var">topExtractor</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-547"></span><span>          </span><span class="annot"><span class="annottext">InsOrdHashMap ColumnAlias SQLExp
</span><a href="#local-6989586621687794238"><span class="hs-identifier hs-var">nodeExtractors</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-548"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#aggregateFieldToExp"><span class="hs-identifier hs-type">aggregateFieldToExp</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-552"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687793199"><span class="annot"><a href="#local-6989586621687793199"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-553"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#TableIdentifier"><span class="hs-identifier hs-type">TableIdentifier</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-554"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AggregateFields"><span class="hs-identifier hs-type">AggregateFields</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793199"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-555"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-556"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span>
</span><span id="line-557"></span><span id="aggregateFieldToExp"><span class="annot"><span class="annottext">aggregateFieldToExp :: forall (pgKind :: PostgresKind).
TableIdentifier
-&gt; AggregateFields ('Postgres pgKind) SQLExp
-&gt; StringifyNumbers
-&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#aggregateFieldToExp"><span class="hs-identifier hs-var hs-var">aggregateFieldToExp</span></a></span></span><span> </span><span id="local-6989586621687794246"><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794246"><span class="hs-identifier hs-var">sourcePrefix</span></a></span></span><span> </span><span id="local-6989586621687794247"><span class="annot"><span class="annottext">AggregateFields ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794247"><span class="hs-identifier hs-var">aggregateFields</span></a></span></span><span> </span><span id="local-6989586621687794248"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687794248"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-558"></span><span>  </span><span class="annot"><span class="annottext">[SQLExp] -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#applyJsonBuildObj"><span class="hs-identifier hs-var">S.applyJsonBuildObj</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((FieldName, AggregateField ('Postgres pgKind) SQLExp) -&gt; [SQLExp])
-&gt; AggregateFields ('Postgres pgKind) SQLExp -&gt; [SQLExp]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">(FieldName, AggregateField ('Postgres pgKind) SQLExp) -&gt; [SQLExp]
</span><a href="#local-6989586621687794249"><span class="hs-identifier hs-var">aggregateFieldToExtractor</span></a></span><span> </span><span class="annot"><span class="annottext">AggregateFields ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794247"><span class="hs-identifier hs-var">aggregateFields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-560"></span><span>    </span><span class="annot"><a href="#local-6989586621687794250"><span class="hs-identifier hs-type">withAlias</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-561"></span><span>    </span><span id="local-6989586621687794250"><span class="annot"><span class="annottext">withAlias :: FieldName -&gt; SQLExp -&gt; [SQLExp]
</span><a href="#local-6989586621687794250"><span class="hs-identifier hs-var hs-var">withAlias</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span id="local-6989586621687794251"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794251"><span class="hs-identifier hs-var">fldName</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621687794252"><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794252"><span class="hs-identifier hs-var">sqlExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794251"><span class="hs-identifier hs-var">fldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794252"><span class="hs-identifier hs-var">sqlExp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-562"></span><span>
</span><span id="line-563"></span><span>    </span><span class="annot"><a href="#local-6989586621687794249"><span class="hs-identifier hs-type">aggregateFieldToExtractor</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-564"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AggregateField"><span class="hs-identifier hs-type">AggregateField</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793199"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-565"></span><span>      </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-566"></span><span>    </span><span id="local-6989586621687794249"><span class="annot"><span class="annottext">aggregateFieldToExtractor :: (FieldName, AggregateField ('Postgres pgKind) SQLExp) -&gt; [SQLExp]
</span><a href="#local-6989586621687794249"><span class="hs-identifier hs-var hs-var">aggregateFieldToExtractor</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687794253"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794253"><span class="hs-identifier hs-var">aggregateFieldName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794254"><span class="annot"><span class="annottext">AggregateField ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794254"><span class="hs-identifier hs-var">field</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; SQLExp -&gt; [SQLExp]
</span><a href="#local-6989586621687794250"><span class="hs-identifier hs-var">withAlias</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794253"><span class="hs-identifier hs-var">aggregateFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">(SQLExp -&gt; [SQLExp]) -&gt; SQLExp -&gt; [SQLExp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AggregateField ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794254"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-567"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFCount"><span class="hs-identifier hs-type">AFCount</span></a></span><span> </span><span id="local-6989586621687794256"><span class="annot"><span class="annottext">CountType ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794256"><span class="hs-identifier hs-var">countAggregate</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CountType QIdentifier -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SECount"><span class="hs-identifier hs-var">S.SECount</span></a></span><span> </span><span class="annot"><span class="annottext">(CountType QIdentifier -&gt; SQLExp)
-&gt; CountType QIdentifier -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PGCol -&gt; QIdentifier
</span><a href="#local-6989586621687794258"><span class="hs-identifier hs-var">columnToQIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">(PGCol -&gt; QIdentifier)
-&gt; ((PGCol, AnnRedactionExp ('Postgres pgKind) SQLExp) -&gt; PGCol)
-&gt; (PGCol, AnnRedactionExp ('Postgres pgKind) SQLExp)
-&gt; QIdentifier
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(PGCol, AnnRedactionExp ('Postgres pgKind) SQLExp) -&gt; PGCol
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((PGCol, AnnRedactionExp ('Postgres pgKind) SQLExp) -&gt; QIdentifier)
-&gt; CountType (PGCol, AnnRedactionExp ('Postgres pgKind) SQLExp)
-&gt; CountType QIdentifier
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">CountAggregate pgKind SQLExp
-&gt; CountType (PGCol, AnnRedactionExp ('Postgres pgKind) SQLExp)
forall (pgKind :: PostgresKind) v.
CountAggregate pgKind v
-&gt; CountType (PGCol, AnnRedactionExp ('Postgres pgKind) v)
</span><a href="Hasura.Backends.Postgres.Types.Aggregates.html#getCountType"><span class="hs-identifier hs-var">getCountType</span></a></span><span> </span><span class="annot"><span class="annottext">CountType ('Postgres pgKind) SQLExp
CountAggregate pgKind SQLExp
</span><a href="#local-6989586621687794256"><span class="hs-identifier hs-var">countAggregate</span></a></span><span>
</span><span id="line-568"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFOp"><span class="hs-identifier hs-type">AFOp</span></a></span><span> </span><span id="local-6989586621687794261"><span class="annot"><span class="annottext">AggregateOp ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794261"><span class="hs-identifier hs-var">aggOp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; AggregateOp ('Postgres pgKind) SQLExp -&gt; SQLExp
</span><a href="#local-6989586621687794262"><span class="hs-identifier hs-var">aggregateOpToObj</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794253"><span class="hs-identifier hs-var">aggregateFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">AggregateOp ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794261"><span class="hs-identifier hs-var">aggOp</span></a></span><span>
</span><span id="line-569"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFExp"><span class="hs-identifier hs-type">AFExp</span></a></span><span> </span><span id="local-6989586621687794264"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794264"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794264"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span>    </span><span class="annot"><a href="#local-6989586621687794262"><span class="hs-identifier hs-type">aggregateOpToObj</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AggregateOp"><span class="hs-identifier hs-type">AggregateOp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793199"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span>
</span><span id="line-572"></span><span>    </span><span id="local-6989586621687794262"><span class="annot"><span class="annottext">aggregateOpToObj :: FieldName -&gt; AggregateOp ('Postgres pgKind) SQLExp -&gt; SQLExp
</span><a href="#local-6989586621687794262"><span class="hs-identifier hs-var hs-var">aggregateOpToObj</span></a></span></span><span> </span><span id="local-6989586621687794265"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794265"><span class="hs-identifier hs-var">aggregateFieldName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AggregateOp"><span class="hs-identifier hs-type">AggregateOp</span></a></span><span> </span><span id="local-6989586621687794267"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794267"><span class="hs-identifier hs-var">opText</span></a></span></span><span> </span><span id="local-6989586621687794268"><span class="annot"><span class="annottext">SelectionFields ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794268"><span class="hs-identifier hs-var">selectionFields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-573"></span><span>      </span><span class="annot"><span class="annottext">[SQLExp] -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#applyJsonBuildObj"><span class="hs-identifier hs-var">S.applyJsonBuildObj</span></a></span><span> </span><span class="annot"><span class="annottext">([SQLExp] -&gt; SQLExp) -&gt; [SQLExp] -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((FieldName, SelectionField ('Postgres pgKind) SQLExp) -&gt; [SQLExp])
-&gt; SelectionFields ('Postgres pgKind) SQLExp -&gt; [SQLExp]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName
-&gt; Text
-&gt; (FieldName, SelectionField ('Postgres pgKind) SQLExp)
-&gt; [SQLExp]
</span><a href="#local-6989586621687794269"><span class="hs-identifier hs-var">selectionFieldToExtractor</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794265"><span class="hs-identifier hs-var">aggregateFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794267"><span class="hs-identifier hs-var">opText</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SelectionFields ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794268"><span class="hs-identifier hs-var">selectionFields</span></a></span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span>    </span><span class="annot"><a href="#local-6989586621687794269"><span class="hs-identifier hs-type">selectionFieldToExtractor</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-576"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-577"></span><span>      </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/text-2.0.1-d0f6d61f5277bae932134563876cbceb4967915f364959864c72abbc2978d8ed/share/doc/html/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-578"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#SelectionField"><span class="hs-identifier hs-type">SelectionField</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793199"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-579"></span><span>      </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-580"></span><span>    </span><span id="local-6989586621687794269"><span class="annot"><span class="annottext">selectionFieldToExtractor :: FieldName
-&gt; Text
-&gt; (FieldName, SelectionField ('Postgres pgKind) SQLExp)
-&gt; [SQLExp]
</span><a href="#local-6989586621687794269"><span class="hs-identifier hs-var hs-var">selectionFieldToExtractor</span></a></span></span><span> </span><span id="local-6989586621687794270"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794270"><span class="hs-identifier hs-var">aggregateFieldName</span></a></span></span><span> </span><span id="local-6989586621687794271"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794271"><span class="hs-identifier hs-var">opText</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687794272"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794272"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794273"><span class="annot"><span class="annottext">SelectionField ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794273"><span class="hs-identifier hs-var">selectionField</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-581"></span><span>      </span><span class="annot"><span class="annottext">FieldName -&gt; SQLExp -&gt; [SQLExp]
</span><a href="#local-6989586621687794250"><span class="hs-identifier hs-var">withAlias</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794272"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">(SQLExp -&gt; [SQLExp]) -&gt; SQLExp -&gt; [SQLExp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SelectionField ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794273"><span class="hs-identifier hs-var">selectionField</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-582"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#SFCol"><span class="hs-identifier hs-type">SFCol</span></a></span><span> </span><span id="local-6989586621687794275"><span class="annot"><span class="annottext">Column ('Postgres pgKind)
</span><a href="#local-6989586621687794275"><span class="hs-identifier hs-var">col</span></a></span></span><span> </span><span id="local-6989586621687794276"><span class="annot"><span class="annottext">ColumnType ('Postgres pgKind)
</span><a href="#local-6989586621687794276"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621687794277"><span class="annot"><span class="annottext">AnnRedactionExp ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794277"><span class="hs-identifier hs-var">_redactionExp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-583"></span><span>          </span><span class="annot"><span class="annottext">StringifyNumbers
-&gt; ColumnType ('Postgres pgKind)
-&gt; Bool
-&gt; Maybe NamingCase
-&gt; SQLExp
-&gt; SQLExp
forall (pgKind :: PostgresKind).
StringifyNumbers
-&gt; ColumnType ('Postgres pgKind)
-&gt; Bool
-&gt; Maybe NamingCase
-&gt; SQLExp
-&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Column.html#toJSONableExp"><span class="hs-identifier hs-var">toJSONableExp</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687794248"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnType ('Postgres pgKind)
</span><a href="#local-6989586621687794276"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-584"></span><span>            </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [SQLExp] -&gt; Maybe OrderByExp -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SEFnApp"><span class="hs-identifier hs-var">S.SEFnApp</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794271"><span class="hs-identifier hs-var">opText</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QIdentifier -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SEQIdentifier"><span class="hs-identifier hs-var">S.SEQIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">(QIdentifier -&gt; SQLExp) -&gt; QIdentifier -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PGCol -&gt; QIdentifier
</span><a href="#local-6989586621687794258"><span class="hs-identifier hs-var">columnToQIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Column ('Postgres pgKind)
PGCol
</span><a href="#local-6989586621687794275"><span class="hs-identifier hs-var">col</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe OrderByExp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-585"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#SFComputedField"><span class="hs-identifier hs-type">SFComputedField</span></a></span><span> </span><span id="local-6989586621687794281"><span class="annot"><span class="annottext">ComputedFieldName
</span><a href="#local-6989586621687794281"><span class="hs-identifier hs-var">_cfName</span></a></span></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ComputedFieldScalarSelect"><span class="hs-identifier hs-type">ComputedFieldScalarSelect</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621687794282"><span id="local-6989586621687794283"><span id="local-6989586621687794284"><span id="local-6989586621687794285"><span id="local-6989586621687794286"><span class="annot"><span class="annottext">Maybe (ScalarSelectionArguments ('Postgres pgKind))
FunctionName ('Postgres pgKind)
ScalarType ('Postgres pgKind)
FunctionArgsExp ('Postgres pgKind) SQLExp
AnnRedactionExp ('Postgres pgKind) SQLExp
$sel:_cfssFunction:ComputedFieldScalarSelect :: forall (b :: BackendType) v.
ComputedFieldScalarSelect b v -&gt; FunctionName b
$sel:_cfssArguments:ComputedFieldScalarSelect :: forall (b :: BackendType) v.
ComputedFieldScalarSelect b v -&gt; FunctionArgsExp b v
$sel:_cfssType:ComputedFieldScalarSelect :: forall (b :: BackendType) v.
ComputedFieldScalarSelect b v -&gt; ScalarType b
$sel:_cfssScalarArguments:ComputedFieldScalarSelect :: forall (b :: BackendType) v.
ComputedFieldScalarSelect b v -&gt; Maybe (ScalarSelectionArguments b)
$sel:_cfssRedactionExpression:ComputedFieldScalarSelect :: forall (b :: BackendType) v.
ComputedFieldScalarSelect b v -&gt; AnnRedactionExp b v
_cfssFunction :: FunctionName ('Postgres pgKind)
_cfssArguments :: FunctionArgsExp ('Postgres pgKind) SQLExp
_cfssType :: ScalarType ('Postgres pgKind)
_cfssScalarArguments :: Maybe (ScalarSelectionArguments ('Postgres pgKind))
_cfssRedactionExpression :: AnnRedactionExp ('Postgres pgKind) SQLExp
</span><a href="Hasura.RQL.IR.Select.html#%24sel%3A_cfssFunction%3AComputedFieldScalarSelect"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-586"></span><span>          </span><span class="annot"><span class="annottext">StringifyNumbers
-&gt; ColumnType ('Postgres Any)
-&gt; Bool
-&gt; Maybe NamingCase
-&gt; SQLExp
-&gt; SQLExp
forall (pgKind :: PostgresKind).
StringifyNumbers
-&gt; ColumnType ('Postgres pgKind)
-&gt; Bool
-&gt; Maybe NamingCase
-&gt; SQLExp
-&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Column.html#toJSONableExp"><span class="hs-identifier hs-var">toJSONableExp</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687794248"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScalarType ('Postgres Any) -&gt; ColumnType ('Postgres Any)
forall (b :: BackendType). ScalarType b -&gt; ColumnType b
</span><a href="Hasura.RQL.Types.Column.html#ColumnScalar"><span class="hs-identifier hs-var">ColumnScalar</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarType ('Postgres pgKind)
ScalarType ('Postgres Any)
</span><a href="#local-6989586621687794284"><span class="hs-identifier hs-var">_cfssType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-587"></span><span>            </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [SQLExp] -&gt; Maybe OrderByExp -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SEFnApp"><span class="hs-identifier hs-var">S.SEFnApp</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794271"><span class="hs-identifier hs-var">opText</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">QIdentifier -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SEQIdentifier"><span class="hs-identifier hs-var">S.SEQIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">(QIdentifier -&gt; SQLExp) -&gt; QIdentifier -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; FieldName -&gt; QIdentifier
</span><a href="#local-6989586621687794287"><span class="hs-identifier hs-var">computedFieldToQIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794270"><span class="hs-identifier hs-var">aggregateFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794272"><span class="hs-identifier hs-var">fieldName</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe OrderByExp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-588"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#SFExp"><span class="hs-identifier hs-type">SFExp</span></a></span><span> </span><span id="local-6989586621687794289"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794289"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-589"></span><span>          </span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794289"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-590"></span><span>
</span><span id="line-591"></span><span>    </span><span class="annot"><a href="#local-6989586621687794258"><span class="hs-identifier hs-type">columnToQIdentifier</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#PGCol"><span class="hs-identifier hs-type">PGCol</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#QIdentifier"><span class="hs-identifier hs-type">S.QIdentifier</span></a></span><span>
</span><span id="line-592"></span><span>    </span><span id="local-6989586621687794258"><span class="annot"><span class="annottext">columnToQIdentifier :: PGCol -&gt; QIdentifier
</span><a href="#local-6989586621687794258"><span class="hs-identifier hs-var hs-var">columnToQIdentifier</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TableIdentifier -&gt; ColumnAlias -&gt; QIdentifier
forall b. IsIdentifier b =&gt; TableIdentifier -&gt; b -&gt; QIdentifier
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#mkQIdentifier"><span class="hs-identifier hs-var">S.mkQIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794246"><span class="hs-identifier hs-var">sourcePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">(ColumnAlias -&gt; QIdentifier)
-&gt; (PGCol -&gt; ColumnAlias) -&gt; PGCol -&gt; QIdentifier
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TableIdentifier -&gt; PGCol -&gt; ColumnAlias
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#contextualizeBaseTableColumn"><span class="hs-identifier hs-var">contextualizeBaseTableColumn</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794246"><span class="hs-identifier hs-var">sourcePrefix</span></a></span><span>
</span><span id="line-593"></span><span>
</span><span id="line-594"></span><span>    </span><span class="annot"><a href="#local-6989586621687794287"><span class="hs-identifier hs-type">computedFieldToQIdentifier</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#QIdentifier"><span class="hs-identifier hs-type">S.QIdentifier</span></a></span><span>
</span><span id="line-595"></span><span>    </span><span id="local-6989586621687794287"><span class="annot"><span class="annottext">computedFieldToQIdentifier :: FieldName -&gt; FieldName -&gt; QIdentifier
</span><a href="#local-6989586621687794287"><span class="hs-identifier hs-var hs-var">computedFieldToQIdentifier</span></a></span></span><span> </span><span id="local-6989586621687794291"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794291"><span class="hs-identifier hs-var">aggregateFieldName</span></a></span></span><span> </span><span id="local-6989586621687794292"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794292"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TableIdentifier -&gt; ColumnAlias -&gt; QIdentifier
forall b. IsIdentifier b =&gt; TableIdentifier -&gt; b -&gt; QIdentifier
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#mkQIdentifier"><span class="hs-identifier hs-var">S.mkQIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794246"><span class="hs-identifier hs-var">sourcePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">(ColumnAlias -&gt; QIdentifier) -&gt; ColumnAlias -&gt; QIdentifier
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TableIdentifier -&gt; FieldName -&gt; FieldName -&gt; ColumnAlias
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#contextualizeAggregateInput"><span class="hs-identifier hs-var">contextualizeAggregateInput</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794246"><span class="hs-identifier hs-var">sourcePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794291"><span class="hs-identifier hs-var">aggregateFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794292"><span class="hs-identifier hs-var">fieldName</span></a></span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processAnnSimpleSelect"><span class="hs-identifier hs-type">processAnnSimpleSelect</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-598"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687793303"><span class="annot"><a href="#local-6989586621687793303"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621687793302"><span class="annot"><a href="#local-6989586621687793302"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-599"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793302"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-600"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#NativeQueryFreshIdStore"><span class="hs-identifier hs-type">NativeQueryFreshIdStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793302"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-601"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadWriter</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SelectWriter"><span class="hs-identifier hs-type">SelectWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793302"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-602"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793303"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-603"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.AnnotatedFieldJSON.html#PostgresAnnotatedFieldJSON"><span class="hs-identifier hs-type">PostgresAnnotatedFieldJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793303"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-604"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687793302"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-605"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793302"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-606"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-607"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-608"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SourcePrefixes"><span class="hs-identifier hs-type">SourcePrefixes</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-609"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-610"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#PermissionLimitSubQuery"><span class="hs-identifier hs-type">PermissionLimitSubQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-611"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnSimpleSelect"><span class="hs-identifier hs-type">AnnSimpleSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793303"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-612"></span><span>  </span><span class="annot"><a href="#local-6989586621687793302"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-613"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SelectSource"><span class="hs-identifier hs-type">SelectSource</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-614"></span><span>      </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/insert-ordered-containers-0.2.5.1-b5ad8e22c80bc291a2f581fb78a4448e46180aa38110e81c957f693abd1dc222/share/doc/html/src/Data.HashMap.Strict.InsOrd.html#InsOrdHashMap"><span class="hs-identifier hs-type">InsOrdHashMap</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#ColumnAlias"><span class="hs-identifier hs-type">S.ColumnAlias</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span>
</span><span id="line-615"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span id="processAnnSimpleSelect"><span class="annot"><span class="annottext">processAnnSimpleSelect :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m,
 MonadState NativeQueryFreshIdStore m, MonadWriter SelectWriter m,
 Backend ('Postgres pgKind), PostgresAnnotatedFieldJSON pgKind,
 MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; PermissionLimitSubQuery
-&gt; AnnSimpleSelect ('Postgres pgKind)
-&gt; m (SelectSource, InsOrdHashMap ColumnAlias SQLExp)
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processAnnSimpleSelect"><span class="hs-identifier hs-var hs-var">processAnnSimpleSelect</span></a></span></span><span> </span><span id="local-6989586621687794325"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687794325"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621687794326"><span class="annot"><span class="annottext">SourcePrefixes
</span><a href="#local-6989586621687794326"><span class="hs-identifier hs-var">sourcePrefixes</span></a></span></span><span> </span><span id="local-6989586621687794327"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794327"><span class="hs-identifier hs-var">fieldAlias</span></a></span></span><span> </span><span id="local-6989586621687794328"><span class="annot"><span class="annottext">PermissionLimitSubQuery
</span><a href="#local-6989586621687794328"><span class="hs-identifier hs-var">permLimitSubQuery</span></a></span></span><span> </span><span id="local-6989586621687794329"><span class="annot"><span class="annottext">AnnSimpleSelect ('Postgres pgKind)
</span><a href="#local-6989586621687794329"><span class="hs-identifier hs-var">annSimpleSel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-617"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621687794330"><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687794330"><span class="hs-identifier hs-var">selectSource</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794331"><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)]
</span><a href="#local-6989586621687794331"><span class="hs-identifier hs-var">orderByAndDistinctExtrs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe SQLExp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-618"></span><span>    </span><span class="annot"><span class="annottext">UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; SimilarArrayFields
-&gt; SelectFrom ('Postgres pgKind)
-&gt; PermissionLimitSubQuery
-&gt; TablePerm ('Postgres pgKind)
-&gt; SelectArgs ('Postgres pgKind)
-&gt; m (SelectSource, [(ColumnAlias, SQLExp)], Maybe SQLExp)
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m,
 MonadState NativeQueryFreshIdStore m, MonadWriter SelectWriter m,
 Backend ('Postgres pgKind), MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; SimilarArrayFields
-&gt; SelectFrom ('Postgres pgKind)
-&gt; PermissionLimitSubQuery
-&gt; TablePerm ('Postgres pgKind)
-&gt; SelectArgs ('Postgres pgKind)
-&gt; m (SelectSource, [(ColumnAlias, SQLExp)], Maybe SQLExp)
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processSelectParams"><span class="hs-identifier hs-var">processSelectParams</span></a></span><span>
</span><span id="line-619"></span><span>      </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687794325"><span class="hs-identifier hs-var">userInfo</span></a></span><span>
</span><span id="line-620"></span><span>      </span><span class="annot"><span class="annottext">SourcePrefixes
</span><a href="#local-6989586621687794326"><span class="hs-identifier hs-var">sourcePrefixes</span></a></span><span>
</span><span id="line-621"></span><span>      </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794327"><span class="hs-identifier hs-var">fieldAlias</span></a></span><span>
</span><span id="line-622"></span><span>      </span><span class="annot"><span class="annottext">SimilarArrayFields
</span><a href="#local-6989586621687794332"><span class="hs-identifier hs-var">similarArrayFields</span></a></span><span>
</span><span id="line-623"></span><span>      </span><span class="annot"><span class="annottext">SelectFrom ('Postgres pgKind)
</span><a href="#local-6989586621687794333"><span class="hs-identifier hs-var">tableFrom</span></a></span><span>
</span><span id="line-624"></span><span>      </span><span class="annot"><span class="annottext">PermissionLimitSubQuery
</span><a href="#local-6989586621687794328"><span class="hs-identifier hs-var">permLimitSubQuery</span></a></span><span>
</span><span id="line-625"></span><span>      </span><span class="annot"><span class="annottext">TablePerm ('Postgres pgKind)
</span><a href="#local-6989586621687794334"><span class="hs-identifier hs-var">tablePermissions</span></a></span><span>
</span><span id="line-626"></span><span>      </span><span class="annot"><span class="annottext">SelectArgs ('Postgres pgKind)
</span><a href="#local-6989586621687794335"><span class="hs-identifier hs-var">tableArgs</span></a></span><span>
</span><span id="line-627"></span><span>  </span><span id="local-6989586621687794336"><span class="annot"><span class="annottext">(ColumnAlias, SQLExp)
</span><a href="#local-6989586621687794336"><span class="hs-identifier hs-var">annFieldsExtr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-628"></span><span>    </span><span class="annot"><span class="annottext">UserInfo
-&gt; TableIdentifier
-&gt; FieldName
-&gt; AnnFields ('Postgres pgKind)
-&gt; Maybe NamingCase
-&gt; m (ColumnAlias, SQLExp)
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m, MonadWriter SelectWriter m,
 MonadState NativeQueryFreshIdStore m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind, MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; TableIdentifier
-&gt; FieldName
-&gt; AnnFields ('Postgres pgKind)
-&gt; Maybe NamingCase
-&gt; m (ColumnAlias, SQLExp)
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processAnnFields"><span class="hs-identifier hs-var">processAnnFields</span></a></span><span>
</span><span id="line-629"></span><span>      </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687794325"><span class="hs-identifier hs-var">userInfo</span></a></span><span>
</span><span id="line-630"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Identifier -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#identifierToTableIdentifier"><span class="hs-identifier hs-var">identifierToTableIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">(Identifier -&gt; TableIdentifier) -&gt; Identifier -&gt; TableIdentifier
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SourcePrefixes -&gt; Identifier
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#_pfThis"><span class="hs-identifier hs-var">_pfThis</span></a></span><span> </span><span class="annot"><span class="annottext">SourcePrefixes
</span><a href="#local-6989586621687794326"><span class="hs-identifier hs-var">sourcePrefixes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span>      </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794327"><span class="hs-identifier hs-var">fieldAlias</span></a></span><span>
</span><span id="line-632"></span><span>      </span><span class="annot"><span class="annottext">AnnFields ('Postgres pgKind)
</span><a href="#local-6989586621687794337"><span class="hs-identifier hs-var">annSelFields</span></a></span><span>
</span><span id="line-633"></span><span>      </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687794338"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-634"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687794339"><span class="annot"><span class="annottext">allExtractors :: InsOrdHashMap ColumnAlias SQLExp
</span><a href="#local-6989586621687794339"><span class="hs-identifier hs-var hs-var">allExtractors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)] -&gt; InsOrdHashMap ColumnAlias SQLExp
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; InsOrdHashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/insert-ordered-containers-0.2.5.1-b5ad8e22c80bc291a2f581fb78a4448e46180aa38110e81c957f693abd1dc222/share/doc/html/src/Data.HashMap.Strict.InsOrd.html#fromList"><span class="hs-identifier hs-var">InsOrdHashMap.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(ColumnAlias, SQLExp)] -&gt; InsOrdHashMap ColumnAlias SQLExp)
-&gt; [(ColumnAlias, SQLExp)] -&gt; InsOrdHashMap ColumnAlias SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ColumnAlias, SQLExp)
</span><a href="#local-6989586621687794336"><span class="hs-identifier hs-var">annFieldsExtr</span></a></span><span> </span><span class="annot"><span class="annottext">(ColumnAlias, SQLExp)
-&gt; [(ColumnAlias, SQLExp)] -&gt; [(ColumnAlias, SQLExp)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)]
</span><a href="#local-6989586621687794331"><span class="hs-identifier hs-var">orderByAndDistinctExtrs</span></a></span><span>
</span><span id="line-635"></span><span>  </span><span class="annot"><span class="annottext">(SelectSource, InsOrdHashMap ColumnAlias SQLExp)
-&gt; m (SelectSource, InsOrdHashMap ColumnAlias SQLExp)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687794330"><span class="hs-identifier hs-var">selectSource</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap ColumnAlias SQLExp
</span><a href="#local-6989586621687794339"><span class="hs-identifier hs-var">allExtractors</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-637"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Select.AnnSelectG.html#AnnSelectG"><span class="hs-identifier hs-type">AnnSelectG</span></a></span><span> </span><span id="local-6989586621687794337"><span class="annot"><span class="annottext">AnnFields ('Postgres pgKind)
</span><a href="#local-6989586621687794337"><span class="hs-identifier hs-var">annSelFields</span></a></span></span><span> </span><span id="local-6989586621687794333"><span class="annot"><span class="annottext">SelectFrom ('Postgres pgKind)
</span><a href="#local-6989586621687794333"><span class="hs-identifier hs-var">tableFrom</span></a></span></span><span> </span><span id="local-6989586621687794334"><span class="annot"><span class="annottext">TablePerm ('Postgres pgKind)
</span><a href="#local-6989586621687794334"><span class="hs-identifier hs-var">tablePermissions</span></a></span></span><span> </span><span id="local-6989586621687794335"><span class="annot"><span class="annottext">SelectArgs ('Postgres pgKind)
</span><a href="#local-6989586621687794335"><span class="hs-identifier hs-var">tableArgs</span></a></span></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687794338"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687794338"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnnSimpleSelect ('Postgres pgKind)
</span><a href="#local-6989586621687794329"><span class="hs-identifier hs-var">annSimpleSel</span></a></span><span>
</span><span id="line-638"></span><span>    </span><span id="local-6989586621687794332"><span class="annot"><span class="annottext">similarArrayFields :: SimilarArrayFields
</span><a href="#local-6989586621687794332"><span class="hs-identifier hs-var hs-var">similarArrayFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-639"></span><span>      </span><span class="annot"><span class="annottext">AnnFieldsG ('Postgres pgKind) Void SQLExp
-&gt; Maybe
     (NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) SQLExp))
-&gt; SimilarArrayFields
forall (pgKind :: PostgresKind) v.
(Backend ('Postgres pgKind), Eq v) =&gt;
AnnFieldsG ('Postgres pgKind) Void v
-&gt; Maybe (NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) v))
-&gt; SimilarArrayFields
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#mkSimilarArrayFields"><span class="hs-identifier hs-var">mkSimilarArrayFields</span></a></span><span> </span><span class="annot"><span class="annottext">AnnFields ('Postgres pgKind)
AnnFieldsG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794337"><span class="hs-identifier hs-var">annSelFields</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) SQLExp))
 -&gt; SimilarArrayFields)
-&gt; Maybe
     (NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) SQLExp))
-&gt; SimilarArrayFields
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SelectArgsG ('Postgres pgKind) SQLExp
-&gt; Maybe
     (NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) SQLExp))
forall (b :: BackendType) v.
SelectArgsG b v -&gt; Maybe (NonEmpty (AnnotatedOrderByItemG b v))
</span><a href="Hasura.RQL.IR.Select.Args.html#%24sel%3A_saOrderBy%3ASelectArgs"><span class="hs-identifier hs-var">_saOrderBy</span></a></span><span> </span><span class="annot"><span class="annottext">SelectArgs ('Postgres pgKind)
SelectArgsG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794335"><span class="hs-identifier hs-var">tableArgs</span></a></span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processConnectionSelect"><span class="hs-identifier hs-type">processConnectionSelect</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-642"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687793447"><span class="annot"><a href="#local-6989586621687793447"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621687793446"><span class="annot"><a href="#local-6989586621687793446"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-643"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793446"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-644"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadWriter</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SelectWriter"><span class="hs-identifier hs-type">SelectWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793446"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-645"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#NativeQueryFreshIdStore"><span class="hs-identifier hs-type">NativeQueryFreshIdStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793446"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-646"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793447"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-647"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.AnnotatedFieldJSON.html#PostgresAnnotatedFieldJSON"><span class="hs-identifier hs-type">PostgresAnnotatedFieldJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793447"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-648"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687793446"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-649"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793446"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-650"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-651"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-652"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SourcePrefixes"><span class="hs-identifier hs-type">SourcePrefixes</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-653"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-654"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#TableAlias"><span class="hs-identifier hs-type">S.TableAlias</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-655"></span><span>  </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashMap.Internal.html#HashMap"><span class="hs-identifier hs-type">HashMap.HashMap</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#PGCol"><span class="hs-identifier hs-type">PGCol</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#PGCol"><span class="hs-identifier hs-type">PGCol</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-656"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ConnectionSelect"><span class="hs-identifier hs-type">ConnectionSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793447"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-657"></span><span>  </span><span class="annot"><a href="#local-6989586621687793446"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-658"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#ArrayConnectionSource"><span class="hs-identifier hs-type">ArrayConnectionSource</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-659"></span><span>      </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#Extractor"><span class="hs-identifier hs-type">S.Extractor</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-660"></span><span>      </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/insert-ordered-containers-0.2.5.1-b5ad8e22c80bc291a2f581fb78a4448e46180aa38110e81c957f693abd1dc222/share/doc/html/src/Data.HashMap.Strict.InsOrd.html#InsOrdHashMap"><span class="hs-identifier hs-type">InsOrdHashMap</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#ColumnAlias"><span class="hs-identifier hs-type">S.ColumnAlias</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span>
</span><span id="line-661"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-662"></span><span id="processConnectionSelect"><span class="annot"><span class="annottext">processConnectionSelect :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m, MonadWriter SelectWriter m,
 MonadState NativeQueryFreshIdStore m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind, MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; TableAlias
-&gt; HashMap PGCol PGCol
-&gt; ConnectionSelect ('Postgres pgKind) Void SQLExp
-&gt; m (ArrayConnectionSource, Extractor,
      InsOrdHashMap ColumnAlias SQLExp)
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processConnectionSelect"><span class="hs-identifier hs-var hs-var">processConnectionSelect</span></a></span></span><span> </span><span id="local-6989586621687794395"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687794395"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621687794396"><span class="annot"><span class="annottext">SourcePrefixes
</span><a href="#local-6989586621687794396"><span class="hs-identifier hs-var">sourcePrefixes</span></a></span></span><span> </span><span id="local-6989586621687794397"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794397"><span class="hs-identifier hs-var">fieldAlias</span></a></span></span><span> </span><span id="local-6989586621687794398"><span class="annot"><span class="annottext">TableAlias
</span><a href="#local-6989586621687794398"><span class="hs-identifier hs-var">relAlias</span></a></span></span><span> </span><span id="local-6989586621687794399"><span class="annot"><span class="annottext">HashMap PGCol PGCol
</span><a href="#local-6989586621687794399"><span class="hs-identifier hs-var">colMapping</span></a></span></span><span> </span><span id="local-6989586621687794400"><span class="annot"><span class="annottext">ConnectionSelect ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794400"><span class="hs-identifier hs-var">connectionSelect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-663"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621687794401"><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687794401"><span class="hs-identifier hs-var">selectSource</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794402"><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)]
</span><a href="#local-6989586621687794402"><span class="hs-identifier hs-var">orderByAndDistinctExtrs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794403"><span class="annot"><span class="annottext">Maybe SQLExp
</span><a href="#local-6989586621687794403"><span class="hs-identifier hs-var">maybeOrderByCursor</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-664"></span><span>    </span><span class="annot"><span class="annottext">UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; SimilarArrayFields
-&gt; SelectFrom ('Postgres pgKind)
-&gt; PermissionLimitSubQuery
-&gt; TablePerm ('Postgres pgKind)
-&gt; SelectArgs ('Postgres pgKind)
-&gt; m (SelectSource, [(ColumnAlias, SQLExp)], Maybe SQLExp)
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m,
 MonadState NativeQueryFreshIdStore m, MonadWriter SelectWriter m,
 Backend ('Postgres pgKind), MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; SourcePrefixes
-&gt; FieldName
-&gt; SimilarArrayFields
-&gt; SelectFrom ('Postgres pgKind)
-&gt; PermissionLimitSubQuery
-&gt; TablePerm ('Postgres pgKind)
-&gt; SelectArgs ('Postgres pgKind)
-&gt; m (SelectSource, [(ColumnAlias, SQLExp)], Maybe SQLExp)
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processSelectParams"><span class="hs-identifier hs-var">processSelectParams</span></a></span><span>
</span><span id="line-665"></span><span>      </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687794395"><span class="hs-identifier hs-var">userInfo</span></a></span><span>
</span><span id="line-666"></span><span>      </span><span class="annot"><span class="annottext">SourcePrefixes
</span><a href="#local-6989586621687794396"><span class="hs-identifier hs-var">sourcePrefixes</span></a></span><span>
</span><span id="line-667"></span><span>      </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794397"><span class="hs-identifier hs-var">fieldAlias</span></a></span><span>
</span><span id="line-668"></span><span>      </span><span class="annot"><span class="annottext">SimilarArrayFields
</span><a href="#local-6989586621687794404"><span class="hs-identifier hs-var">similarArrayFields</span></a></span><span>
</span><span id="line-669"></span><span>      </span><span class="annot"><span class="annottext">SelectFrom ('Postgres pgKind)
SelectFromG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794405"><span class="hs-identifier hs-var">selectFrom</span></a></span><span>
</span><span id="line-670"></span><span>      </span><span class="annot"><span class="annottext">PermissionLimitSubQuery
</span><a href="#local-6989586621687794406"><span class="hs-identifier hs-var">permLimitSubQuery</span></a></span><span>
</span><span id="line-671"></span><span>      </span><span class="annot"><span class="annottext">TablePerm ('Postgres pgKind)
TablePermG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794407"><span class="hs-identifier hs-var">tablePermissions</span></a></span><span>
</span><span id="line-672"></span><span>      </span><span class="annot"><span class="annottext">SelectArgs ('Postgres pgKind)
SelectArgsG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794408"><span class="hs-identifier hs-var">tableArgs</span></a></span><span>
</span><span id="line-673"></span><span>
</span><span id="line-674"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687794410"><span class="annot"><span class="annottext">mkCursorExtractor :: SQLExp -&gt; (ColumnAlias, SQLExp)
</span><a href="#local-6989586621687794410"><span class="hs-identifier hs-var hs-var">mkCursorExtractor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Identifier -&gt; ColumnAlias
forall a. IsIdentifier a =&gt; a -&gt; ColumnAlias
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#toColumnAlias"><span class="hs-identifier hs-var">S.toColumnAlias</span></a></span><span> </span><span class="annot"><span class="annottext">Identifier
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#cursorIdentifier"><span class="hs-identifier hs-var">cursorIdentifier</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SQLExp -&gt; (ColumnAlias, SQLExp))
-&gt; (SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; (ColumnAlias, SQLExp)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SQLExp -&gt; TypeAnn -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SETyAnn"><span class="hs-operator hs-var">`S.SETyAnn`</span></a></span><span> </span><span class="annot"><span class="annottext">TypeAnn
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#textTypeAnn"><span class="hs-identifier hs-var">S.textTypeAnn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-675"></span><span>      </span><span id="local-6989586621687794411"><span class="annot"><span class="annottext">cursorExtractors :: [(ColumnAlias, SQLExp)]
</span><a href="#local-6989586621687794411"><span class="hs-identifier hs-var hs-var">cursorExtractors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe SQLExp
</span><a href="#local-6989586621687794403"><span class="hs-identifier hs-var">maybeOrderByCursor</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-676"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621687794412"><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794412"><span class="hs-identifier hs-var">orderByCursor</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SQLExp -&gt; (ColumnAlias, SQLExp)
</span><a href="#local-6989586621687794410"><span class="hs-identifier hs-var">mkCursorExtractor</span></a></span><span> </span><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794412"><span class="hs-identifier hs-var">orderByCursor</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-677"></span><span>        </span><span class="annot"><span class="annottext">Maybe SQLExp
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-678"></span><span>          </span><span class="hs-comment">-- Extract primary key columns from base select along with cursor expression.</span><span>
</span><span id="line-679"></span><span>          </span><span class="hs-comment">-- Those columns are required to perform connection split via a WHERE clause.</span><span>
</span><span id="line-680"></span><span>          </span><span class="annot"><span class="annottext">SQLExp -&gt; (ColumnAlias, SQLExp)
</span><a href="#local-6989586621687794410"><span class="hs-identifier hs-var">mkCursorExtractor</span></a></span><span> </span><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794413"><span class="hs-identifier hs-var">primaryKeyColumnsObjectExp</span></a></span><span> </span><span class="annot"><span class="annottext">(ColumnAlias, SQLExp)
-&gt; [(ColumnAlias, SQLExp)] -&gt; [(ColumnAlias, SQLExp)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)]
</span><a href="#local-6989586621687794414"><span class="hs-identifier hs-var">primaryKeyColumnExtractors</span></a></span><span>
</span><span id="line-681"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621687794415"><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794415"><span class="hs-identifier hs-var">topExtractorExp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794416"><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)]
</span><a href="#local-6989586621687794416"><span class="hs-identifier hs-var">exps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(StateT [(ColumnAlias, SQLExp)] m SQLExp
 -&gt; [(ColumnAlias, SQLExp)] -&gt; m (SQLExp, [(ColumnAlias, SQLExp)]))
-&gt; [(ColumnAlias, SQLExp)]
-&gt; StateT [(ColumnAlias, SQLExp)] m SQLExp
-&gt; m (SQLExp, [(ColumnAlias, SQLExp)])
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">StateT [(ColumnAlias, SQLExp)] m SQLExp
-&gt; [(ColumnAlias, SQLExp)] -&gt; m (SQLExp, [(ColumnAlias, SQLExp)])
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><span class="hs-identifier hs-var">runStateT</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(StateT [(ColumnAlias, SQLExp)] m SQLExp
 -&gt; m (SQLExp, [(ColumnAlias, SQLExp)]))
-&gt; StateT [(ColumnAlias, SQLExp)] m SQLExp
-&gt; m (SQLExp, [(ColumnAlias, SQLExp)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SelectSource -&gt; StateT [(ColumnAlias, SQLExp)] m SQLExp
forall (n :: * -&gt; *) (n' :: * -&gt; *) (t :: (* -&gt; *) -&gt; * -&gt; *).
(MonadState [(ColumnAlias, SQLExp)] n, n ~ t n', MonadTrans t,
 MonadState NativeQueryFreshIdStore n', MonadWriter SelectWriter n',
 MonadReader StringifyNumbers n', MonadIO n', MonadError QErr n') =&gt;
SelectSource -&gt; n SQLExp
</span><a href="#local-6989586621687794418"><span class="hs-identifier hs-var">processFields</span></a></span><span> </span><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687794401"><span class="hs-identifier hs-var">selectSource</span></a></span><span>
</span><span id="line-682"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687794419"><span class="annot"><span class="annottext">topExtractor :: Extractor
</span><a href="#local-6989586621687794419"><span class="hs-identifier hs-var hs-var">topExtractor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; Maybe ColumnAlias -&gt; Extractor
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#Extractor"><span class="hs-identifier hs-var">S.Extractor</span></a></span><span> </span><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794415"><span class="hs-identifier hs-var">topExtractorExp</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ColumnAlias -&gt; Extractor) -&gt; Maybe ColumnAlias -&gt; Extractor
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ColumnAlias -&gt; Maybe ColumnAlias
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ColumnAlias -&gt; Maybe ColumnAlias)
-&gt; ColumnAlias -&gt; Maybe ColumnAlias
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Identifier -&gt; ColumnAlias
forall a. IsIdentifier a =&gt; a -&gt; ColumnAlias
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#toColumnAlias"><span class="hs-identifier hs-var">S.toColumnAlias</span></a></span><span> </span><span class="annot"><span class="annottext">Identifier
</span><a href="#local-6989586621687794420"><span class="hs-identifier hs-var">fieldIdentifier</span></a></span><span>
</span><span id="line-683"></span><span>      </span><span id="local-6989586621687794421"><span class="annot"><span class="annottext">allExtractors :: InsOrdHashMap ColumnAlias SQLExp
</span><a href="#local-6989586621687794421"><span class="hs-identifier hs-var hs-var">allExtractors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)] -&gt; InsOrdHashMap ColumnAlias SQLExp
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; InsOrdHashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/insert-ordered-containers-0.2.5.1-b5ad8e22c80bc291a2f581fb78a4448e46180aa38110e81c957f693abd1dc222/share/doc/html/src/Data.HashMap.Strict.InsOrd.html#fromList"><span class="hs-identifier hs-var">InsOrdHashMap.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(ColumnAlias, SQLExp)] -&gt; InsOrdHashMap ColumnAlias SQLExp)
-&gt; [(ColumnAlias, SQLExp)] -&gt; InsOrdHashMap ColumnAlias SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)]
</span><a href="#local-6989586621687794411"><span class="hs-identifier hs-var">cursorExtractors</span></a></span><span> </span><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)]
-&gt; [(ColumnAlias, SQLExp)] -&gt; [(ColumnAlias, SQLExp)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)]
</span><a href="#local-6989586621687794416"><span class="hs-identifier hs-var">exps</span></a></span><span> </span><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)]
-&gt; [(ColumnAlias, SQLExp)] -&gt; [(ColumnAlias, SQLExp)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)]
</span><a href="#local-6989586621687794402"><span class="hs-identifier hs-var">orderByAndDistinctExtrs</span></a></span><span>
</span><span id="line-684"></span><span>      </span><span id="local-6989586621687794422"><span class="annot"><span class="annottext">arrayConnectionSource :: ArrayConnectionSource
</span><a href="#local-6989586621687794422"><span class="hs-identifier hs-var hs-var">arrayConnectionSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-685"></span><span>        </span><span class="annot"><span class="annottext">TableAlias
-&gt; HashMap PGCol PGCol
-&gt; Maybe BoolExp
-&gt; Maybe ConnectionSlice
-&gt; SelectSource
-&gt; ArrayConnectionSource
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#ArrayConnectionSource"><span class="hs-identifier hs-var">ArrayConnectionSource</span></a></span><span>
</span><span id="line-686"></span><span>          </span><span class="annot"><span class="annottext">TableAlias
</span><a href="#local-6989586621687794398"><span class="hs-identifier hs-var">relAlias</span></a></span><span>
</span><span id="line-687"></span><span>          </span><span class="annot"><span class="annottext">HashMap PGCol PGCol
</span><a href="#local-6989586621687794399"><span class="hs-identifier hs-var">colMapping</span></a></span><span>
</span><span id="line-688"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty (ConnectionSplit ('Postgres pgKind) SQLExp) -&gt; BoolExp
</span><a href="#local-6989586621687794424"><span class="hs-identifier hs-var">mkSplitBoolExp</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (ConnectionSplit ('Postgres pgKind) SQLExp) -&gt; BoolExp)
-&gt; Maybe (NonEmpty (ConnectionSplit ('Postgres pgKind) SQLExp))
-&gt; Maybe BoolExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (NonEmpty (ConnectionSplit ('Postgres pgKind) SQLExp))
</span><a href="#local-6989586621687794425"><span class="hs-identifier hs-var">maybeSplit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>          </span><span class="annot"><span class="annottext">Maybe ConnectionSlice
</span><a href="#local-6989586621687794426"><span class="hs-identifier hs-var">maybeSlice</span></a></span><span>
</span><span id="line-690"></span><span>          </span><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687794401"><span class="hs-identifier hs-var">selectSource</span></a></span><span>
</span><span id="line-691"></span><span>  </span><span class="annot"><span class="annottext">(ArrayConnectionSource, Extractor,
 InsOrdHashMap ColumnAlias SQLExp)
-&gt; m (ArrayConnectionSource, Extractor,
      InsOrdHashMap ColumnAlias SQLExp)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-692"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ArrayConnectionSource
</span><a href="#local-6989586621687794422"><span class="hs-identifier hs-var">arrayConnectionSource</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-693"></span><span>      </span><span class="annot"><span class="annottext">Extractor
</span><a href="#local-6989586621687794419"><span class="hs-identifier hs-var">topExtractor</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-694"></span><span>      </span><span class="annot"><span class="annottext">InsOrdHashMap ColumnAlias SQLExp
</span><a href="#local-6989586621687794421"><span class="hs-identifier hs-var">allExtractors</span></a></span><span>
</span><span id="line-695"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-696"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-697"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ConnectionSelect"><span class="hs-identifier hs-type">ConnectionSelect</span></a></span><span> </span><span class="annot"><span class="annottext">XRelay ('Postgres pgKind)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687794428"><span class="annot"><span class="annottext">PrimaryKeyColumns ('Postgres pgKind)
</span><a href="#local-6989586621687794428"><span class="hs-identifier hs-var">primaryKeyColumns</span></a></span></span><span> </span><span id="local-6989586621687794425"><span class="annot"><span class="annottext">Maybe (NonEmpty (ConnectionSplit ('Postgres pgKind) SQLExp))
</span><a href="#local-6989586621687794425"><span class="hs-identifier hs-var">maybeSplit</span></a></span></span><span> </span><span id="local-6989586621687794426"><span class="annot"><span class="annottext">Maybe ConnectionSlice
</span><a href="#local-6989586621687794426"><span class="hs-identifier hs-var">maybeSlice</span></a></span></span><span> </span><span id="local-6989586621687794429"><span class="annot"><span class="annottext">AnnSelectG
  ('Postgres pgKind) (ConnectionField ('Postgres pgKind) Void) SQLExp
</span><a href="#local-6989586621687794429"><span class="hs-identifier hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConnectionSelect ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794400"><span class="hs-identifier hs-var">connectionSelect</span></a></span><span>
</span><span id="line-698"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Select.AnnSelectG.html#AnnSelectG"><span class="hs-identifier hs-type">AnnSelectG</span></a></span><span> </span><span id="local-6989586621687794430"><span class="annot"><span class="annottext">Fields (ConnectionField ('Postgres pgKind) Void SQLExp)
</span><a href="#local-6989586621687794430"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621687794405"><span class="annot"><span class="annottext">SelectFromG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794405"><span class="hs-identifier hs-var">selectFrom</span></a></span></span><span> </span><span id="local-6989586621687794407"><span class="annot"><span class="annottext">TablePermG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794407"><span class="hs-identifier hs-var">tablePermissions</span></a></span></span><span> </span><span id="local-6989586621687794408"><span class="annot"><span class="annottext">SelectArgsG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794408"><span class="hs-identifier hs-var">tableArgs</span></a></span></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687794431"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687794431"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnnSelectG
  ('Postgres pgKind) (ConnectionField ('Postgres pgKind) Void) SQLExp
</span><a href="#local-6989586621687794429"><span class="hs-identifier hs-var">select</span></a></span><span>
</span><span id="line-699"></span><span>    </span><span id="local-6989586621687794420"><span class="annot"><span class="annottext">fieldIdentifier :: Identifier
</span><a href="#local-6989586621687794420"><span class="hs-identifier hs-var hs-var">fieldIdentifier</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Identifier
forall a. IsIdentifier a =&gt; a -&gt; Identifier
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#toIdentifier"><span class="hs-identifier hs-var">toIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794397"><span class="hs-identifier hs-var">fieldAlias</span></a></span><span>
</span><span id="line-700"></span><span>    </span><span id="local-6989586621687794432"><span class="annot"><span class="annottext">thisPrefix :: TableIdentifier
</span><a href="#local-6989586621687794432"><span class="hs-identifier hs-var hs-var">thisPrefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identifier -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#identifierToTableIdentifier"><span class="hs-identifier hs-var">identifierToTableIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">(Identifier -&gt; TableIdentifier) -&gt; Identifier -&gt; TableIdentifier
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SourcePrefixes -&gt; Identifier
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#_pfThis"><span class="hs-identifier hs-var">_pfThis</span></a></span><span> </span><span class="annot"><span class="annottext">SourcePrefixes
</span><a href="#local-6989586621687794396"><span class="hs-identifier hs-var">sourcePrefixes</span></a></span><span>
</span><span id="line-701"></span><span>    </span><span id="local-6989586621687794406"><span class="annot"><span class="annottext">permLimitSubQuery :: PermissionLimitSubQuery
</span><a href="#local-6989586621687794406"><span class="hs-identifier hs-var hs-var">permLimitSubQuery</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PermissionLimitSubQuery
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#PLSQNotRequired"><span class="hs-identifier hs-var">PLSQNotRequired</span></a></span><span>
</span><span id="line-702"></span><span>
</span><span id="line-703"></span><span>    </span><span id="local-6989586621687794413"><span class="annot"><span class="annottext">primaryKeyColumnsObjectExp :: SQLExp
</span><a href="#local-6989586621687794413"><span class="hs-identifier hs-var hs-var">primaryKeyColumnsObjectExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-704"></span><span>      </span><span class="annot"><span class="annottext">[SQLExp] -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#applyJsonBuildObj"><span class="hs-identifier hs-var">S.applyJsonBuildObj</span></a></span><span>
</span><span id="line-705"></span><span>        </span><span class="annot"><span class="annottext">([SQLExp] -&gt; SQLExp) -&gt; [SQLExp] -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((ColumnInfo ('Postgres pgKind) -&gt; [SQLExp])
 -&gt; [ColumnInfo ('Postgres pgKind)] -&gt; [SQLExp])
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; (ColumnInfo ('Postgres pgKind) -&gt; [SQLExp])
-&gt; [SQLExp]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(ColumnInfo ('Postgres pgKind) -&gt; [SQLExp])
-&gt; [ColumnInfo ('Postgres pgKind)] -&gt; [SQLExp]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimaryKeyColumns ('Postgres pgKind)
-&gt; [ColumnInfo ('Postgres pgKind)]
forall a. NESeq a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">PrimaryKeyColumns ('Postgres pgKind)
</span><a href="#local-6989586621687794428"><span class="hs-identifier hs-var">primaryKeyColumns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-706"></span><span>        </span><span class="annot"><span class="annottext">((ColumnInfo ('Postgres pgKind) -&gt; [SQLExp]) -&gt; [SQLExp])
-&gt; (ColumnInfo ('Postgres pgKind) -&gt; [SQLExp]) -&gt; [SQLExp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621687794433"><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
</span><a href="#local-6989586621687794433"><span class="hs-identifier hs-var">pgColumnInfo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-707"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; SQLExp) -&gt; Text -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PGCol -&gt; Text
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#getPGColTxt"><span class="hs-identifier hs-var">getPGColTxt</span></a></span><span> </span><span class="annot"><span class="annottext">(PGCol -&gt; Text) -&gt; PGCol -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind) -&gt; Column ('Postgres pgKind)
forall (b :: BackendType). ColumnInfo b -&gt; Column b
</span><a href="Hasura.RQL.Types.Column.html#ciColumn"><span class="hs-identifier hs-var">ciColumn</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
</span><a href="#local-6989586621687794433"><span class="hs-identifier hs-var">pgColumnInfo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-708"></span><span>            </span><span class="annot"><span class="annottext">StringifyNumbers
-&gt; ColumnType ('Postgres pgKind)
-&gt; Bool
-&gt; Maybe NamingCase
-&gt; SQLExp
-&gt; SQLExp
forall (pgKind :: PostgresKind).
StringifyNumbers
-&gt; ColumnType ('Postgres pgKind)
-&gt; Bool
-&gt; Maybe NamingCase
-&gt; SQLExp
-&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Column.html#toJSONableExp"><span class="hs-identifier hs-var">toJSONableExp</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="Hasura.RQL.Types.Schema.Options.html#Don%27tStringifyNumbers"><span class="hs-identifier hs-var">Options.Don'tStringifyNumbers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind) -&gt; ColumnType ('Postgres pgKind)
forall (b :: BackendType). ColumnInfo b -&gt; ColumnType b
</span><a href="Hasura.RQL.Types.Column.html#ciType"><span class="hs-identifier hs-var">ciType</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
</span><a href="#local-6989586621687794433"><span class="hs-identifier hs-var">pgColumnInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687794431"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-709"></span><span>              </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TableIdentifier -&gt; PGCol -&gt; SQLExp
forall b. IsIdentifier b =&gt; TableIdentifier -&gt; b -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#mkQIdenExp"><span class="hs-identifier hs-var">S.mkQIdenExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableIdentifier -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkBaseTableIdentifier"><span class="hs-identifier hs-var">mkBaseTableIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794432"><span class="hs-identifier hs-var">thisPrefix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-710"></span><span>              </span><span class="annot"><span class="annottext">(PGCol -&gt; SQLExp) -&gt; PGCol -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind) -&gt; Column ('Postgres pgKind)
forall (b :: BackendType). ColumnInfo b -&gt; Column b
</span><a href="Hasura.RQL.Types.Column.html#ciColumn"><span class="hs-identifier hs-var">ciColumn</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
</span><a href="#local-6989586621687794433"><span class="hs-identifier hs-var">pgColumnInfo</span></a></span><span>
</span><span id="line-711"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-712"></span><span>
</span><span id="line-713"></span><span>    </span><span id="local-6989586621687794414"><span class="annot"><span class="annottext">primaryKeyColumnExtractors :: [(ColumnAlias, SQLExp)]
</span><a href="#local-6989586621687794414"><span class="hs-identifier hs-var hs-var">primaryKeyColumnExtractors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-714"></span><span>      </span><span class="annot"><span class="annottext">((ColumnInfo ('Postgres pgKind) -&gt; (ColumnAlias, SQLExp))
 -&gt; [ColumnInfo ('Postgres pgKind)] -&gt; [(ColumnAlias, SQLExp)])
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; (ColumnInfo ('Postgres pgKind) -&gt; (ColumnAlias, SQLExp))
-&gt; [(ColumnAlias, SQLExp)]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(ColumnInfo ('Postgres pgKind) -&gt; (ColumnAlias, SQLExp))
-&gt; [ColumnInfo ('Postgres pgKind)] -&gt; [(ColumnAlias, SQLExp)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimaryKeyColumns ('Postgres pgKind)
-&gt; [ColumnInfo ('Postgres pgKind)]
forall a. NESeq a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">PrimaryKeyColumns ('Postgres pgKind)
</span><a href="#local-6989586621687794428"><span class="hs-identifier hs-var">primaryKeyColumns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-715"></span><span>        </span><span class="annot"><span class="annottext">((ColumnInfo ('Postgres pgKind) -&gt; (ColumnAlias, SQLExp))
 -&gt; [(ColumnAlias, SQLExp)])
-&gt; (ColumnInfo ('Postgres pgKind) -&gt; (ColumnAlias, SQLExp))
-&gt; [(ColumnAlias, SQLExp)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621687794435"><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
</span><a href="#local-6989586621687794435"><span class="hs-identifier hs-var">pgColumnInfo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-716"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687794436"><span class="annot"><span class="annottext">pgColumn :: Column ('Postgres pgKind)
</span><a href="#local-6989586621687794436"><span class="hs-identifier hs-var hs-var">pgColumn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind) -&gt; Column ('Postgres pgKind)
forall (b :: BackendType). ColumnInfo b -&gt; Column b
</span><a href="Hasura.RQL.Types.Column.html#ciColumn"><span class="hs-identifier hs-var">ciColumn</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
</span><a href="#local-6989586621687794435"><span class="hs-identifier hs-var">pgColumnInfo</span></a></span><span>
</span><span id="line-717"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">TableIdentifier -&gt; PGCol -&gt; ColumnAlias
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#contextualizeBaseTableColumn"><span class="hs-identifier hs-var">contextualizeBaseTableColumn</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794432"><span class="hs-identifier hs-var">thisPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">Column ('Postgres pgKind)
PGCol
</span><a href="#local-6989586621687794436"><span class="hs-identifier hs-var">pgColumn</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-718"></span><span>                </span><span class="annot"><span class="annottext">TableIdentifier -&gt; PGCol -&gt; SQLExp
forall b. IsIdentifier b =&gt; TableIdentifier -&gt; b -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#mkQIdenExp"><span class="hs-identifier hs-var">S.mkQIdenExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableIdentifier -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkBaseTableIdentifier"><span class="hs-identifier hs-var">mkBaseTableIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794432"><span class="hs-identifier hs-var">thisPrefix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Column ('Postgres pgKind)
PGCol
</span><a href="#local-6989586621687794436"><span class="hs-identifier hs-var">pgColumn</span></a></span><span>
</span><span id="line-719"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-720"></span><span>
</span><span id="line-721"></span><span>    </span><span id="local-6989586621687794424"><span class="annot"><span class="annottext">mkSplitBoolExp :: NonEmpty (ConnectionSplit ('Postgres pgKind) SQLExp) -&gt; BoolExp
</span><a href="#local-6989586621687794424"><span class="hs-identifier hs-var hs-var">mkSplitBoolExp</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687794437"><span class="annot"><span class="annottext">ConnectionSplit ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794437"><span class="hs-identifier hs-var">firstSplit</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">NE.:|</span></span><span> </span><span id="local-6989586621687794438"><span class="annot"><span class="annottext">[ConnectionSplit ('Postgres pgKind) SQLExp]
</span><a href="#local-6989586621687794438"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-722"></span><span>      </span><span class="annot"><span class="annottext">BinOp -&gt; BoolExp -&gt; BoolExp -&gt; BoolExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#BEBin"><span class="hs-identifier hs-var">S.BEBin</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#OrOp"><span class="hs-identifier hs-var">S.OrOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConnectionSplit ('Postgres pgKind) SQLExp -&gt; BoolExp
</span><a href="#local-6989586621687794441"><span class="hs-identifier hs-var">mkSplitCompareExp</span></a></span><span> </span><span class="annot"><span class="annottext">ConnectionSplit ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794437"><span class="hs-identifier hs-var">firstSplit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(BoolExp -&gt; BoolExp) -&gt; BoolExp -&gt; BoolExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConnectionSplit ('Postgres pgKind) SQLExp
-&gt; [ConnectionSplit ('Postgres pgKind) SQLExp] -&gt; BoolExp
</span><a href="#local-6989586621687794442"><span class="hs-identifier hs-var">mkBoolExpFromRest</span></a></span><span> </span><span class="annot"><span class="annottext">ConnectionSplit ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794437"><span class="hs-identifier hs-var">firstSplit</span></a></span><span> </span><span class="annot"><span class="annottext">[ConnectionSplit ('Postgres pgKind) SQLExp]
</span><a href="#local-6989586621687794438"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-723"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-724"></span><span>        </span><span id="local-6989586621687794442"><span class="annot"><span class="annottext">mkBoolExpFromRest :: ConnectionSplit ('Postgres pgKind) SQLExp
-&gt; [ConnectionSplit ('Postgres pgKind) SQLExp] -&gt; BoolExp
</span><a href="#local-6989586621687794442"><span class="hs-identifier hs-var hs-var">mkBoolExpFromRest</span></a></span></span><span> </span><span id="local-6989586621687794443"><span class="annot"><span class="annottext">ConnectionSplit ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794443"><span class="hs-identifier hs-var">previousSplit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-725"></span><span>          </span><span class="annot"><span class="annottext">BinOp -&gt; BoolExp -&gt; BoolExp -&gt; BoolExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#BEBin"><span class="hs-identifier hs-var">S.BEBin</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#AndOp"><span class="hs-identifier hs-var">S.AndOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConnectionSplit ('Postgres pgKind) SQLExp -&gt; BoolExp
</span><a href="#local-6989586621687794445"><span class="hs-identifier hs-var">mkEqualityCompareExp</span></a></span><span> </span><span class="annot"><span class="annottext">ConnectionSplit ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794443"><span class="hs-identifier hs-var">previousSplit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(BoolExp -&gt; BoolExp)
-&gt; ([ConnectionSplit ('Postgres pgKind) SQLExp] -&gt; BoolExp)
-&gt; [ConnectionSplit ('Postgres pgKind) SQLExp]
-&gt; BoolExp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-726"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; BoolExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#BELit"><span class="hs-identifier hs-var">S.BELit</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-727"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621687794447"><span class="annot"><span class="annottext">ConnectionSplit ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794447"><span class="hs-identifier hs-var">thisSplit</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621687794448"><span class="annot"><span class="annottext">[ConnectionSplit ('Postgres pgKind) SQLExp]
</span><a href="#local-6989586621687794448"><span class="hs-identifier hs-var">remainingSplit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NonEmpty (ConnectionSplit ('Postgres pgKind) SQLExp) -&gt; BoolExp
</span><a href="#local-6989586621687794424"><span class="hs-identifier hs-var">mkSplitBoolExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConnectionSplit ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794447"><span class="hs-identifier hs-var">thisSplit</span></a></span><span> </span><span class="annot"><span class="annottext">ConnectionSplit ('Postgres pgKind) SQLExp
-&gt; [ConnectionSplit ('Postgres pgKind) SQLExp]
-&gt; NonEmpty (ConnectionSplit ('Postgres pgKind) SQLExp)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">NE.:|</span></span><span> </span><span class="annot"><span class="annottext">[ConnectionSplit ('Postgres pgKind) SQLExp]
</span><a href="#local-6989586621687794448"><span class="hs-identifier hs-var">remainingSplit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-728"></span><span>
</span><span id="line-729"></span><span>        </span><span id="local-6989586621687794441"><span class="annot"><span class="annottext">mkSplitCompareExp :: ConnectionSplit ('Postgres pgKind) SQLExp -&gt; BoolExp
</span><a href="#local-6989586621687794441"><span class="hs-identifier hs-var hs-var">mkSplitCompareExp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ConnectionSplit"><span class="hs-identifier hs-type">ConnectionSplit</span></a></span><span> </span><span id="local-6989586621687794450"><span class="annot"><span class="annottext">ConnectionSplitKind
</span><a href="#local-6989586621687794450"><span class="hs-identifier hs-var">kind</span></a></span></span><span> </span><span id="local-6989586621687794451"><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794451"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.OrderBy.html#OrderByItemG"><span class="hs-identifier hs-type">OrderByItemG</span></a></span><span> </span><span id="local-6989586621687794452"><span class="annot"><span class="annottext">Maybe (BasicOrderType ('Postgres pgKind))
</span><a href="#local-6989586621687794452"><span class="hs-identifier hs-var">obTyM</span></a></span></span><span> </span><span id="local-6989586621687794453"><span class="annot"><span class="annottext">AnnotatedOrderByElement ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794453"><span class="hs-identifier hs-var">obCol</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (NullsOrderType ('Postgres pgKind))
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-730"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687794454"><span class="annot"><span class="annottext">obAlias :: ColumnAlias
</span><a href="#local-6989586621687794454"><span class="hs-identifier hs-var hs-var">obAlias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TableIdentifier
-&gt; FieldName
-&gt; SimilarArrayFields
-&gt; AnnotatedOrderByElement ('Postgres pgKind) SQLExp
-&gt; ColumnAlias
forall (pgKind :: PostgresKind) v.
TableIdentifier
-&gt; FieldName
-&gt; SimilarArrayFields
-&gt; AnnotatedOrderByElement ('Postgres pgKind) v
-&gt; ColumnAlias
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkAnnOrderByAlias"><span class="hs-identifier hs-var">mkAnnOrderByAlias</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794432"><span class="hs-identifier hs-var">thisPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794397"><span class="hs-identifier hs-var">fieldAlias</span></a></span><span> </span><span class="annot"><span class="annottext">SimilarArrayFields
</span><a href="#local-6989586621687794404"><span class="hs-identifier hs-var">similarArrayFields</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedOrderByElement ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794453"><span class="hs-identifier hs-var">obCol</span></a></span><span>
</span><span id="line-731"></span><span>              </span><span id="local-6989586621687794455"><span class="annot"><span class="annottext">obTy :: OrderType
</span><a href="#local-6989586621687794455"><span class="hs-identifier hs-var hs-var">obTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OrderType -&gt; Maybe OrderType -&gt; OrderType
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">OrderType
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#OTAsc"><span class="hs-identifier hs-var">S.OTAsc</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (BasicOrderType ('Postgres pgKind))
Maybe OrderType
</span><a href="#local-6989586621687794452"><span class="hs-identifier hs-var">obTyM</span></a></span><span>
</span><span id="line-732"></span><span>              </span><span id="local-6989586621687794458"><span class="annot"><span class="annottext">compareOp :: CompareOp
</span><a href="#local-6989586621687794458"><span class="hs-identifier hs-var hs-var">compareOp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConnectionSplitKind
</span><a href="#local-6989586621687794450"><span class="hs-identifier hs-var">kind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrderType
</span><a href="#local-6989586621687794455"><span class="hs-identifier hs-var">obTy</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-733"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConnectionSplitKind
</span><a href="Hasura.RQL.IR.Select.html#CSKAfter"><span class="hs-identifier hs-var">CSKAfter</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrderType
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#OTAsc"><span class="hs-identifier hs-var">S.OTAsc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CompareOp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SGT"><span class="hs-identifier hs-var">S.SGT</span></a></span><span>
</span><span id="line-734"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConnectionSplitKind
</span><a href="Hasura.RQL.IR.Select.html#CSKAfter"><span class="hs-identifier hs-var">CSKAfter</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrderType
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#OTDesc"><span class="hs-identifier hs-var">S.OTDesc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CompareOp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SLT"><span class="hs-identifier hs-var">S.SLT</span></a></span><span>
</span><span id="line-735"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConnectionSplitKind
</span><a href="Hasura.RQL.IR.Select.html#CSKBefore"><span class="hs-identifier hs-var">CSKBefore</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrderType
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#OTAsc"><span class="hs-identifier hs-var">S.OTAsc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CompareOp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SLT"><span class="hs-identifier hs-var">S.SLT</span></a></span><span>
</span><span id="line-736"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConnectionSplitKind
</span><a href="Hasura.RQL.IR.Select.html#CSKBefore"><span class="hs-identifier hs-var">CSKBefore</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OrderType
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#OTDesc"><span class="hs-identifier hs-var">S.OTDesc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CompareOp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SGT"><span class="hs-identifier hs-var">S.SGT</span></a></span><span>
</span><span id="line-737"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">CompareOp -&gt; SQLExp -&gt; SQLExp -&gt; BoolExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#BECompare"><span class="hs-identifier hs-var">S.BECompare</span></a></span><span> </span><span class="annot"><span class="annottext">CompareOp
</span><a href="#local-6989586621687794458"><span class="hs-identifier hs-var">compareOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Identifier -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SEIdentifier"><span class="hs-identifier hs-var">S.SEIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">(Identifier -&gt; SQLExp) -&gt; Identifier -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ColumnAlias -&gt; Identifier
forall a. IsIdentifier a =&gt; a -&gt; Identifier
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#toIdentifier"><span class="hs-identifier hs-var">toIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnAlias
</span><a href="#local-6989586621687794454"><span class="hs-identifier hs-var">obAlias</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794451"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-738"></span><span>
</span><span id="line-739"></span><span>        </span><span id="local-6989586621687794445"><span class="annot"><span class="annottext">mkEqualityCompareExp :: ConnectionSplit ('Postgres pgKind) SQLExp -&gt; BoolExp
</span><a href="#local-6989586621687794445"><span class="hs-identifier hs-var hs-var">mkEqualityCompareExp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ConnectionSplit"><span class="hs-identifier hs-type">ConnectionSplit</span></a></span><span> </span><span class="annot"><span class="annottext">ConnectionSplitKind
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687794466"><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794466"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621687794467"><span class="annot"><span class="annottext">OrderByItemG
  ('Postgres pgKind)
  (AnnotatedOrderByElement ('Postgres pgKind) SQLExp)
</span><a href="#local-6989586621687794467"><span class="hs-identifier hs-var">orderByItem</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-740"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687794468"><span class="annot"><span class="annottext">obAlias :: ColumnAlias
</span><a href="#local-6989586621687794468"><span class="hs-identifier hs-var hs-var">obAlias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-741"></span><span>                </span><span class="annot"><span class="annottext">TableIdentifier
-&gt; FieldName
-&gt; SimilarArrayFields
-&gt; AnnotatedOrderByElement ('Postgres pgKind) SQLExp
-&gt; ColumnAlias
forall (pgKind :: PostgresKind) v.
TableIdentifier
-&gt; FieldName
-&gt; SimilarArrayFields
-&gt; AnnotatedOrderByElement ('Postgres pgKind) v
-&gt; ColumnAlias
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Aliases.html#mkAnnOrderByAlias"><span class="hs-identifier hs-var">mkAnnOrderByAlias</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794432"><span class="hs-identifier hs-var">thisPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794397"><span class="hs-identifier hs-var">fieldAlias</span></a></span><span> </span><span class="annot"><span class="annottext">SimilarArrayFields
</span><a href="#local-6989586621687794404"><span class="hs-identifier hs-var">similarArrayFields</span></a></span><span>
</span><span id="line-742"></span><span>                  </span><span class="annot"><span class="annottext">(AnnotatedOrderByElement ('Postgres pgKind) SQLExp -&gt; ColumnAlias)
-&gt; AnnotatedOrderByElement ('Postgres pgKind) SQLExp -&gt; ColumnAlias
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OrderByItemG
  ('Postgres pgKind)
  (AnnotatedOrderByElement ('Postgres pgKind) SQLExp)
-&gt; AnnotatedOrderByElement ('Postgres pgKind) SQLExp
forall (b :: BackendType) a. OrderByItemG b a -&gt; a
</span><a href="Hasura.RQL.IR.OrderBy.html#obiColumn"><span class="hs-identifier hs-var">obiColumn</span></a></span><span> </span><span class="annot"><span class="annottext">OrderByItemG
  ('Postgres pgKind)
  (AnnotatedOrderByElement ('Postgres pgKind) SQLExp)
</span><a href="#local-6989586621687794467"><span class="hs-identifier hs-var">orderByItem</span></a></span><span>
</span><span id="line-743"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">CompareOp -&gt; SQLExp -&gt; SQLExp -&gt; BoolExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#BECompare"><span class="hs-identifier hs-var">S.BECompare</span></a></span><span> </span><span class="annot"><span class="annottext">CompareOp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SEQ"><span class="hs-identifier hs-var">S.SEQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Identifier -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SEIdentifier"><span class="hs-identifier hs-var">S.SEIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">(Identifier -&gt; SQLExp) -&gt; Identifier -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ColumnAlias -&gt; Identifier
forall a. IsIdentifier a =&gt; a -&gt; Identifier
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#toIdentifier"><span class="hs-identifier hs-var">toIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnAlias
</span><a href="#local-6989586621687794468"><span class="hs-identifier hs-var">obAlias</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794466"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-744"></span><span>
</span><span id="line-745"></span><span>    </span><span id="local-6989586621687794404"><span class="annot"><span class="annottext">similarArrayFields :: SimilarArrayFields
</span><a href="#local-6989586621687794404"><span class="hs-identifier hs-var hs-var">similarArrayFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SimilarArrayFields] -&gt; SimilarArrayFields
forall k v. (Eq k, Hashable k) =&gt; [HashMap k v] -&gt; HashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashMap.Internal.html#unions"><span class="hs-identifier hs-var">HashMap.unions</span></a></span><span>
</span><span id="line-746"></span><span>      </span><span class="annot"><span class="annottext">([SimilarArrayFields] -&gt; SimilarArrayFields)
-&gt; [SimilarArrayFields] -&gt; SimilarArrayFields
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((ConnectionField ('Postgres pgKind) Void SQLExp
  -&gt; SimilarArrayFields)
 -&gt; [ConnectionField ('Postgres pgKind) Void SQLExp]
 -&gt; [SimilarArrayFields])
-&gt; [ConnectionField ('Postgres pgKind) Void SQLExp]
-&gt; (ConnectionField ('Postgres pgKind) Void SQLExp
    -&gt; SimilarArrayFields)
-&gt; [SimilarArrayFields]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(ConnectionField ('Postgres pgKind) Void SQLExp
 -&gt; SimilarArrayFields)
-&gt; [ConnectionField ('Postgres pgKind) Void SQLExp]
-&gt; [SimilarArrayFields]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((FieldName, ConnectionField ('Postgres pgKind) Void SQLExp)
 -&gt; ConnectionField ('Postgres pgKind) Void SQLExp)
-&gt; Fields (ConnectionField ('Postgres pgKind) Void SQLExp)
-&gt; [ConnectionField ('Postgres pgKind) Void SQLExp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(FieldName, ConnectionField ('Postgres pgKind) Void SQLExp)
-&gt; ConnectionField ('Postgres pgKind) Void SQLExp
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">Fields (ConnectionField ('Postgres pgKind) Void SQLExp)
</span><a href="#local-6989586621687794430"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-747"></span><span>      </span><span class="annot"><span class="annottext">((ConnectionField ('Postgres pgKind) Void SQLExp
  -&gt; SimilarArrayFields)
 -&gt; [SimilarArrayFields])
-&gt; (ConnectionField ('Postgres pgKind) Void SQLExp
    -&gt; SimilarArrayFields)
-&gt; [SimilarArrayFields]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-748"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ConnectionTypename"><span class="hs-identifier hs-type">ConnectionTypename</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SimilarArrayFields
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-749"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ConnectionPageInfo"><span class="hs-identifier hs-type">ConnectionPageInfo</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SimilarArrayFields
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-750"></span><span>        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ConnectionEdges"><span class="hs-identifier hs-type">ConnectionEdges</span></a></span><span> </span><span id="local-6989586621687794473"><span class="annot"><span class="annottext">EdgeFields ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794473"><span class="hs-identifier hs-var">edges</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[SimilarArrayFields] -&gt; SimilarArrayFields
forall k v. (Eq k, Hashable k) =&gt; [HashMap k v] -&gt; HashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashMap.Internal.html#unions"><span class="hs-identifier hs-var">HashMap.unions</span></a></span><span>
</span><span id="line-751"></span><span>          </span><span class="annot"><span class="annottext">([SimilarArrayFields] -&gt; SimilarArrayFields)
-&gt; [SimilarArrayFields] -&gt; SimilarArrayFields
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((EdgeField ('Postgres pgKind) Void SQLExp -&gt; SimilarArrayFields)
 -&gt; [EdgeField ('Postgres pgKind) Void SQLExp]
 -&gt; [SimilarArrayFields])
-&gt; [EdgeField ('Postgres pgKind) Void SQLExp]
-&gt; (EdgeField ('Postgres pgKind) Void SQLExp -&gt; SimilarArrayFields)
-&gt; [SimilarArrayFields]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(EdgeField ('Postgres pgKind) Void SQLExp -&gt; SimilarArrayFields)
-&gt; [EdgeField ('Postgres pgKind) Void SQLExp]
-&gt; [SimilarArrayFields]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((FieldName, EdgeField ('Postgres pgKind) Void SQLExp)
 -&gt; EdgeField ('Postgres pgKind) Void SQLExp)
-&gt; EdgeFields ('Postgres pgKind) Void SQLExp
-&gt; [EdgeField ('Postgres pgKind) Void SQLExp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(FieldName, EdgeField ('Postgres pgKind) Void SQLExp)
-&gt; EdgeField ('Postgres pgKind) Void SQLExp
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">EdgeFields ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794473"><span class="hs-identifier hs-var">edges</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-752"></span><span>          </span><span class="annot"><span class="annottext">((EdgeField ('Postgres pgKind) Void SQLExp -&gt; SimilarArrayFields)
 -&gt; [SimilarArrayFields])
-&gt; (EdgeField ('Postgres pgKind) Void SQLExp -&gt; SimilarArrayFields)
-&gt; [SimilarArrayFields]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-753"></span><span>            </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#EdgeTypename"><span class="hs-identifier hs-type">EdgeTypename</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SimilarArrayFields
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-754"></span><span>            </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#EdgeCursor"><span class="hs-identifier hs-type">EdgeCursor</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SimilarArrayFields
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-755"></span><span>            </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#EdgeNode"><span class="hs-identifier hs-type">EdgeNode</span></a></span><span> </span><span id="local-6989586621687794477"><span class="annot"><span class="annottext">AnnFieldsG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794477"><span class="hs-identifier hs-var">annFields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-756"></span><span>              </span><span class="annot"><span class="annottext">AnnFieldsG ('Postgres pgKind) Void SQLExp
-&gt; Maybe
     (NonEmpty
        (OrderByItemG
           ('Postgres pgKind)
           (AnnotatedOrderByElement ('Postgres pgKind) SQLExp)))
-&gt; SimilarArrayFields
forall (pgKind :: PostgresKind) v.
(Backend ('Postgres pgKind), Eq v) =&gt;
AnnFieldsG ('Postgres pgKind) Void v
-&gt; Maybe (NonEmpty (AnnotatedOrderByItemG ('Postgres pgKind) v))
-&gt; SimilarArrayFields
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#mkSimilarArrayFields"><span class="hs-identifier hs-var">mkSimilarArrayFields</span></a></span><span> </span><span class="annot"><span class="annottext">AnnFieldsG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794477"><span class="hs-identifier hs-var">annFields</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe
   (NonEmpty
      (OrderByItemG
         ('Postgres pgKind)
         (AnnotatedOrderByElement ('Postgres pgKind) SQLExp)))
 -&gt; SimilarArrayFields)
-&gt; Maybe
     (NonEmpty
        (OrderByItemG
           ('Postgres pgKind)
           (AnnotatedOrderByElement ('Postgres pgKind) SQLExp)))
-&gt; SimilarArrayFields
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SelectArgsG ('Postgres pgKind) SQLExp
-&gt; Maybe
     (NonEmpty
        (OrderByItemG
           ('Postgres pgKind)
           (AnnotatedOrderByElement ('Postgres pgKind) SQLExp)))
forall (b :: BackendType) v.
SelectArgsG b v -&gt; Maybe (NonEmpty (AnnotatedOrderByItemG b v))
</span><a href="Hasura.RQL.IR.Select.Args.html#%24sel%3A_saOrderBy%3ASelectArgs"><span class="hs-identifier hs-var">_saOrderBy</span></a></span><span> </span><span class="annot"><span class="annottext">SelectArgsG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687794408"><span class="hs-identifier hs-var">tableArgs</span></a></span><span>
</span><span id="line-757"></span><span>
</span><span id="line-758"></span><span>    </span><span id="local-6989586621687794482"><span class="annot"><span class="annottext">mkSimpleJsonAgg :: SQLExp -&gt; Maybe OrderByExp -&gt; SQLExp
</span><a href="#local-6989586621687794482"><span class="hs-identifier hs-var hs-var">mkSimpleJsonAgg</span></a></span></span><span> </span><span id="local-6989586621687794483"><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794483"><span class="hs-identifier hs-var">rowExp</span></a></span></span><span> </span><span id="local-6989586621687794484"><span class="annot"><span class="annottext">Maybe OrderByExp
</span><a href="#local-6989586621687794484"><span class="hs-identifier hs-var">ob</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-759"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687794485"><span class="annot"><span class="annottext">jsonAggExp :: SQLExp
</span><a href="#local-6989586621687794485"><span class="hs-identifier hs-var hs-var">jsonAggExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [SQLExp] -&gt; Maybe OrderByExp -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SEFnApp"><span class="hs-identifier hs-var">S.SEFnApp</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;json_agg&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794483"><span class="hs-identifier hs-var">rowExp</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe OrderByExp
</span><a href="#local-6989586621687794484"><span class="hs-identifier hs-var">ob</span></a></span><span>
</span><span id="line-760"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [SQLExp] -&gt; Maybe OrderByExp -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SEFnApp"><span class="hs-identifier hs-var">S.SEFnApp</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;coalesce&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794485"><span class="hs-identifier hs-var">jsonAggExp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;[]&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe OrderByExp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-761"></span><span>
</span><span id="line-762"></span><span>    </span><span class="annot"><a href="#local-6989586621687794418"><span class="hs-identifier hs-type">processFields</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-763"></span><span>      </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687793472"><span class="annot"><a href="#local-6989586621687793472"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621687793474"><span class="annot"><a href="#local-6989586621687793474"><span class="hs-identifier hs-type">n'</span></a></span></span><span> </span><span id="local-6989586621687793473"><span class="annot"><a href="#local-6989586621687793473"><span class="hs-identifier hs-type">t</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-764"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#ColumnAlias"><span class="hs-identifier hs-type">S.ColumnAlias</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621687793472"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-765"></span><span>        </span><span class="hs-comment">-- Constraints for 'processAnnFields':</span><span>
</span><span id="line-766"></span><span>        </span><span class="annot"><a href="#local-6989586621687793472"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621687793473"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793474"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-767"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">MonadTrans</span></span><span> </span><span class="annot"><a href="#local-6989586621687793473"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-768"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#NativeQueryFreshIdStore"><span class="hs-identifier hs-type">NativeQueryFreshIdStore</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793474"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-769"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">MonadWriter</span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SelectWriter"><span class="hs-identifier hs-type">SelectWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793474"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-770"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793474"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-771"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687793474"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-772"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687793474"><span class="hs-identifier hs-type">n'</span></a></span><span>
</span><span id="line-773"></span><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-774"></span><span>      </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Types.html#SelectSource"><span class="hs-identifier hs-type">SelectSource</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-775"></span><span>      </span><span class="annot"><a href="#local-6989586621687793472"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span>
</span><span id="line-776"></span><span>    </span><span id="local-6989586621687794418"><span class="annot"><span class="annottext">processFields :: forall (n :: * -&gt; *) (n' :: * -&gt; *) (t :: (* -&gt; *) -&gt; * -&gt; *).
(MonadState [(ColumnAlias, SQLExp)] n, n ~ t n', MonadTrans t,
 MonadState NativeQueryFreshIdStore n', MonadWriter SelectWriter n',
 MonadReader StringifyNumbers n', MonadIO n', MonadError QErr n') =&gt;
SelectSource -&gt; n SQLExp
</span><a href="#local-6989586621687794418"><span class="hs-identifier hs-var hs-var">processFields</span></a></span></span><span> </span><span id="local-6989586621687794545"><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687794545"><span class="hs-identifier hs-var">selectSource</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-777"></span><span>      </span><span class="annot"><span class="annottext">([[SQLExp]] -&gt; SQLExp) -&gt; n [[SQLExp]] -&gt; n SQLExp
forall a b. (a -&gt; b) -&gt; n a -&gt; n b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SQLExp] -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#applyJsonBuildObj"><span class="hs-identifier hs-var">S.applyJsonBuildObj</span></a></span><span> </span><span class="annot"><span class="annottext">([SQLExp] -&gt; SQLExp)
-&gt; ([[SQLExp]] -&gt; [SQLExp]) -&gt; [[SQLExp]] -&gt; SQLExp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[SQLExp]] -&gt; [SQLExp]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span class="hs-special">)</span><span>
</span><span id="line-778"></span><span>        </span><span class="annot"><span class="annottext">(n [[SQLExp]] -&gt; n SQLExp) -&gt; n [[SQLExp]] -&gt; n SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Fields (ConnectionField ('Postgres pgKind) Void SQLExp)
-&gt; ((FieldName, ConnectionField ('Postgres pgKind) Void SQLExp)
    -&gt; n [SQLExp])
-&gt; n [[SQLExp]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">Fields (ConnectionField ('Postgres pgKind) Void SQLExp)
</span><a href="#local-6989586621687794430"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-779"></span><span>        </span><span class="annot"><span class="annottext">(((FieldName, ConnectionField ('Postgres pgKind) Void SQLExp)
  -&gt; n [SQLExp])
 -&gt; n [[SQLExp]])
-&gt; ((FieldName, ConnectionField ('Postgres pgKind) Void SQLExp)
    -&gt; n [SQLExp])
-&gt; n [[SQLExp]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span id="local-6989586621687794547"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794547"><span class="hs-identifier hs-var">fieldText</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794548"><span class="annot"><span class="annottext">ConnectionField ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794548"><span class="hs-identifier hs-var">field</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-780"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794547"><span class="hs-identifier hs-var">fieldText</span></a></span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; [SQLExp] -&gt; [SQLExp]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-781"></span><span>            </span><span class="annot"><span class="annottext">([SQLExp] -&gt; [SQLExp])
-&gt; (SQLExp -&gt; [SQLExp]) -&gt; SQLExp -&gt; [SQLExp]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; [SQLExp]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-782"></span><span>            </span><span class="annot"><span class="annottext">(SQLExp -&gt; [SQLExp]) -&gt; n SQLExp -&gt; n [SQLExp]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ConnectionField ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794548"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-783"></span><span>              </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ConnectionTypename"><span class="hs-identifier hs-type">ConnectionTypename</span></a></span><span> </span><span id="local-6989586621687794549"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794549"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; n SQLExp
forall a. a -&gt; n a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(SQLExp -&gt; n SQLExp) -&gt; SQLExp -&gt; n SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeAnn -&gt; SQLExp -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#withForceAggregation"><span class="hs-identifier hs-var">withForceAggregation</span></a></span><span> </span><span class="annot"><span class="annottext">TypeAnn
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#textTypeAnn"><span class="hs-identifier hs-var">S.textTypeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794549"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-784"></span><span>              </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ConnectionPageInfo"><span class="hs-identifier hs-type">ConnectionPageInfo</span></a></span><span> </span><span id="local-6989586621687794550"><span class="annot"><span class="annottext">PageInfoFields
</span><a href="#local-6989586621687794550"><span class="hs-identifier hs-var">pageInfoFields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; n SQLExp
forall a. a -&gt; n a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(SQLExp -&gt; n SQLExp) -&gt; SQLExp -&gt; n SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PageInfoFields -&gt; SQLExp
forall {t :: * -&gt; *}.
Foldable t =&gt;
t (FieldName, PageInfoField) -&gt; SQLExp
</span><a href="#local-6989586621687794551"><span class="hs-identifier hs-var">processPageInfoFields</span></a></span><span> </span><span class="annot"><span class="annottext">PageInfoFields
</span><a href="#local-6989586621687794550"><span class="hs-identifier hs-var">pageInfoFields</span></a></span><span>
</span><span id="line-785"></span><span>              </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ConnectionEdges"><span class="hs-identifier hs-type">ConnectionEdges</span></a></span><span> </span><span id="local-6989586621687794552"><span class="annot"><span class="annottext">EdgeFields ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794552"><span class="hs-identifier hs-var">edges</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-786"></span><span>                </span><span class="annot"><span class="annottext">([[SQLExp]] -&gt; SQLExp) -&gt; n [[SQLExp]] -&gt; n SQLExp
forall a b. (a -&gt; b) -&gt; n a -&gt; n b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SQLExp -&gt; Maybe OrderByExp -&gt; SQLExp)
-&gt; Maybe OrderByExp -&gt; SQLExp -&gt; SQLExp
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; Maybe OrderByExp -&gt; SQLExp
</span><a href="#local-6989586621687794482"><span class="hs-identifier hs-var">mkSimpleJsonAgg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectSource -&gt; Maybe OrderByExp
</span><a href="Hasura.Backends.Postgres.Translate.Types.html#orderByForJsonAgg"><span class="hs-identifier hs-var">orderByForJsonAgg</span></a></span><span> </span><span class="annot"><span class="annottext">SelectSource
</span><a href="#local-6989586621687794545"><span class="hs-identifier hs-var">selectSource</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp)
-&gt; ([[SQLExp]] -&gt; SQLExp) -&gt; [[SQLExp]] -&gt; SQLExp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[SQLExp] -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#applyJsonBuildObj"><span class="hs-identifier hs-var">S.applyJsonBuildObj</span></a></span><span> </span><span class="annot"><span class="annottext">([SQLExp] -&gt; SQLExp)
-&gt; ([[SQLExp]] -&gt; [SQLExp]) -&gt; [[SQLExp]] -&gt; SQLExp
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[[SQLExp]] -&gt; [SQLExp]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span class="hs-special">)</span><span>
</span><span id="line-787"></span><span>                  </span><span class="annot"><span class="annottext">(n [[SQLExp]] -&gt; n SQLExp) -&gt; n [[SQLExp]] -&gt; n SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EdgeFields ('Postgres pgKind) Void SQLExp
-&gt; ((FieldName, EdgeField ('Postgres pgKind) Void SQLExp)
    -&gt; n [SQLExp])
-&gt; n [[SQLExp]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">EdgeFields ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794552"><span class="hs-identifier hs-var">edges</span></a></span><span>
</span><span id="line-788"></span><span>                  </span><span class="annot"><span class="annottext">(((FieldName, EdgeField ('Postgres pgKind) Void SQLExp)
  -&gt; n [SQLExp])
 -&gt; n [[SQLExp]])
-&gt; ((FieldName, EdgeField ('Postgres pgKind) Void SQLExp)
    -&gt; n [SQLExp])
-&gt; n [[SQLExp]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span id="local-6989586621687794553"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794553"><span class="hs-identifier hs-var">edgeText</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794554"><span class="annot"><span class="annottext">EdgeField ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794554"><span class="hs-identifier hs-var">edge</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-789"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794553"><span class="hs-identifier hs-var">edgeText</span></a></span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; [SQLExp] -&gt; [SQLExp]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-790"></span><span>                      </span><span class="annot"><span class="annottext">([SQLExp] -&gt; [SQLExp])
-&gt; (SQLExp -&gt; [SQLExp]) -&gt; SQLExp -&gt; [SQLExp]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; [SQLExp]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-791"></span><span>                      </span><span class="annot"><span class="annottext">(SQLExp -&gt; [SQLExp]) -&gt; n SQLExp -&gt; n [SQLExp]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EdgeField ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794554"><span class="hs-identifier hs-var">edge</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-792"></span><span>                        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#EdgeTypename"><span class="hs-identifier hs-type">EdgeTypename</span></a></span><span> </span><span id="local-6989586621687794555"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794555"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; n SQLExp
forall a. a -&gt; n a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(SQLExp -&gt; n SQLExp) -&gt; SQLExp -&gt; n SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794555"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-793"></span><span>                        </span><span class="annot"><span class="annottext">EdgeField ('Postgres pgKind) Void SQLExp
</span><a href="Hasura.RQL.IR.Select.html#EdgeCursor"><span class="hs-identifier hs-var">EdgeCursor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; n SQLExp
forall a. a -&gt; n a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(SQLExp -&gt; n SQLExp) -&gt; SQLExp -&gt; n SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#encodeBase64"><span class="hs-identifier hs-var">encodeBase64</span></a></span><span> </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Identifier -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SEIdentifier"><span class="hs-identifier hs-var">S.SEIdentifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Identifier -&gt; Identifier
forall a. IsIdentifier a =&gt; a -&gt; Identifier
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#toIdentifier"><span class="hs-identifier hs-var">toIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Identifier
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#cursorIdentifier"><span class="hs-identifier hs-var">cursorIdentifier</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-794"></span><span>                        </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#EdgeNode"><span class="hs-identifier hs-type">EdgeNode</span></a></span><span> </span><span id="local-6989586621687794556"><span class="annot"><span class="annottext">AnnFieldsG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794556"><span class="hs-identifier hs-var">annFields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-795"></span><span>                          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687794557"><span class="annot"><span class="annottext">edgeFieldName :: FieldName
</span><a href="#local-6989586621687794557"><span class="hs-identifier hs-var hs-var">edgeFieldName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-796"></span><span>                                </span><span class="annot"><span class="annottext">Text -&gt; FieldName
</span><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-var">FieldName</span></a></span><span>
</span><span id="line-797"></span><span>                                  </span><span class="annot"><span class="annottext">(Text -&gt; FieldName) -&gt; Text -&gt; FieldName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Text
</span><a href="Hasura.RQL.Types.Common.html#getFieldNameTxt"><span class="hs-identifier hs-var">getFieldNameTxt</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794397"><span class="hs-identifier hs-var">fieldAlias</span></a></span><span>
</span><span id="line-798"></span><span>                                  </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-799"></span><span>                                  </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794547"><span class="hs-identifier hs-var">fieldText</span></a></span><span>
</span><span id="line-800"></span><span>                                  </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-801"></span><span>                                  </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794553"><span class="hs-identifier hs-var">edgeText</span></a></span><span>
</span><span id="line-802"></span><span>                              </span><span id="local-6989586621687794559"><span class="annot"><span class="annottext">edgeFieldIdentifier :: Identifier
</span><a href="#local-6989586621687794559"><span class="hs-identifier hs-var hs-var">edgeFieldIdentifier</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Identifier
forall a. IsIdentifier a =&gt; a -&gt; Identifier
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#toIdentifier"><span class="hs-identifier hs-var">toIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794557"><span class="hs-identifier hs-var">edgeFieldName</span></a></span><span>
</span><span id="line-803"></span><span>                          </span><span id="local-6989586621687794560"><span class="annot"><span class="annottext">(ColumnAlias, SQLExp)
</span><a href="#local-6989586621687794560"><span class="hs-identifier hs-var">annFieldsExtrExp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">n' (ColumnAlias, SQLExp) -&gt; t n' (ColumnAlias, SQLExp)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; t m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(n' (ColumnAlias, SQLExp) -&gt; t n' (ColumnAlias, SQLExp))
-&gt; n' (ColumnAlias, SQLExp) -&gt; t n' (ColumnAlias, SQLExp)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserInfo
-&gt; TableIdentifier
-&gt; FieldName
-&gt; AnnFields ('Postgres pgKind)
-&gt; Maybe NamingCase
-&gt; n' (ColumnAlias, SQLExp)
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadReader StringifyNumbers m, MonadWriter SelectWriter m,
 MonadState NativeQueryFreshIdStore m, Backend ('Postgres pgKind),
 PostgresAnnotatedFieldJSON pgKind, MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; TableIdentifier
-&gt; FieldName
-&gt; AnnFields ('Postgres pgKind)
-&gt; Maybe NamingCase
-&gt; m (ColumnAlias, SQLExp)
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Process.html#processAnnFields"><span class="hs-identifier hs-var">processAnnFields</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687794395"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794432"><span class="hs-identifier hs-var">thisPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621687794557"><span class="hs-identifier hs-var">edgeFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">AnnFields ('Postgres pgKind)
AnnFieldsG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687794556"><span class="hs-identifier hs-var">annFields</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687794431"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-804"></span><span>                          </span><span class="annot"><span class="annottext">([(ColumnAlias, SQLExp)] -&gt; [(ColumnAlias, SQLExp)]) -&gt; n ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(ColumnAlias, SQLExp)]
-&gt; [(ColumnAlias, SQLExp)] -&gt; [(ColumnAlias, SQLExp)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(ColumnAlias, SQLExp)
</span><a href="#local-6989586621687794560"><span class="hs-identifier hs-var">annFieldsExtrExp</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-805"></span><span>                          </span><span class="annot"><span class="annottext">SQLExp -&gt; n SQLExp
forall a. a -&gt; n a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(SQLExp -&gt; n SQLExp) -&gt; SQLExp -&gt; n SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Identifier -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SEIdentifier"><span class="hs-identifier hs-var">S.SEIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Identifier
</span><a href="#local-6989586621687794559"><span class="hs-identifier hs-var">edgeFieldIdentifier</span></a></span><span>
</span><span id="line-806"></span><span>
</span><span id="line-807"></span><span>    </span><span id="local-6989586621687794551"><span class="annot"><span class="annottext">processPageInfoFields :: t (FieldName, PageInfoField) -&gt; SQLExp
</span><a href="#local-6989586621687794551"><span class="hs-identifier hs-var hs-var">processPageInfoFields</span></a></span></span><span> </span><span id="local-6989586621687794566"><span class="annot"><span class="annottext">t (FieldName, PageInfoField)
</span><a href="#local-6989586621687794566"><span class="hs-identifier hs-var">infoFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-808"></span><span>      </span><span class="annot"><span class="annottext">[SQLExp] -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#applyJsonBuildObj"><span class="hs-identifier hs-var">S.applyJsonBuildObj</span></a></span><span>
</span><span id="line-809"></span><span>        </span><span class="annot"><span class="annottext">([SQLExp] -&gt; SQLExp) -&gt; [SQLExp] -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(((FieldName, PageInfoField) -&gt; [SQLExp])
 -&gt; t (FieldName, PageInfoField) -&gt; [SQLExp])
-&gt; t (FieldName, PageInfoField)
-&gt; ((FieldName, PageInfoField) -&gt; [SQLExp])
-&gt; [SQLExp]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((FieldName, PageInfoField) -&gt; [SQLExp])
-&gt; t (FieldName, PageInfoField) -&gt; [SQLExp]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">t (FieldName, PageInfoField)
</span><a href="#local-6989586621687794566"><span class="hs-identifier hs-var">infoFields</span></a></span><span>
</span><span id="line-810"></span><span>        </span><span class="annot"><span class="annottext">(((FieldName, PageInfoField) -&gt; [SQLExp]) -&gt; [SQLExp])
-&gt; ((FieldName, PageInfoField) -&gt; [SQLExp]) -&gt; [SQLExp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span id="local-6989586621687794567"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794567"><span class="hs-identifier hs-var">fieldText</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687794568"><span class="annot"><span class="annottext">PageInfoField
</span><a href="#local-6989586621687794568"><span class="hs-identifier hs-var">field</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794567"><span class="hs-identifier hs-var">fieldText</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([SQLExp] -&gt; [SQLExp]) -&gt; [SQLExp] -&gt; [SQLExp]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; [SQLExp]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PageInfoField
</span><a href="#local-6989586621687794568"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-811"></span><span>          </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#PageInfoTypename"><span class="hs-identifier hs-type">PageInfoTypename</span></a></span><span> </span><span id="local-6989586621687794570"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794570"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeAnn -&gt; SQLExp -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#withForceAggregation"><span class="hs-identifier hs-var">withForceAggregation</span></a></span><span> </span><span class="annot"><span class="annottext">TypeAnn
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#textTypeAnn"><span class="hs-identifier hs-var">S.textTypeAnn</span></a></span><span> </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687794570"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-812"></span><span>          </span><span class="annot"><span class="annottext">PageInfoField
</span><a href="Hasura.RQL.IR.Select.html#PageInfoHasNextPage"><span class="hs-identifier hs-var">PageInfoHasNextPage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-813"></span><span>            </span><span class="annot"><span class="annottext">TypeAnn -&gt; SQLExp -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#withForceAggregation"><span class="hs-identifier hs-var">withForceAggregation</span></a></span><span> </span><span class="annot"><span class="annottext">TypeAnn
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#boolTypeAnn"><span class="hs-identifier hs-var">S.boolTypeAnn</span></a></span><span>
</span><span id="line-814"></span><span>              </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; TableIdentifier -&gt; SQLExp
</span><a href="#local-6989586621687794573"><span class="hs-identifier hs-var">mkSingleFieldSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Identifier -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SEIdentifier"><span class="hs-identifier hs-var">S.SEIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Identifier
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#hasNextPageIdentifier"><span class="hs-identifier hs-var">hasNextPageIdentifier</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#pageInfoSelectAliasIdentifier"><span class="hs-identifier hs-var">pageInfoSelectAliasIdentifier</span></a></span><span>
</span><span id="line-815"></span><span>          </span><span class="annot"><span class="annottext">PageInfoField
</span><a href="Hasura.RQL.IR.Select.html#PageInfoHasPreviousPage"><span class="hs-identifier hs-var">PageInfoHasPreviousPage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-816"></span><span>            </span><span class="annot"><span class="annottext">TypeAnn -&gt; SQLExp -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#withForceAggregation"><span class="hs-identifier hs-var">withForceAggregation</span></a></span><span> </span><span class="annot"><span class="annottext">TypeAnn
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#boolTypeAnn"><span class="hs-identifier hs-var">S.boolTypeAnn</span></a></span><span>
</span><span id="line-817"></span><span>              </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; TableIdentifier -&gt; SQLExp
</span><a href="#local-6989586621687794573"><span class="hs-identifier hs-var">mkSingleFieldSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Identifier -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SEIdentifier"><span class="hs-identifier hs-var">S.SEIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Identifier
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#hasPreviousPageIdentifier"><span class="hs-identifier hs-var">hasPreviousPageIdentifier</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#pageInfoSelectAliasIdentifier"><span class="hs-identifier hs-var">pageInfoSelectAliasIdentifier</span></a></span><span>
</span><span id="line-818"></span><span>          </span><span class="annot"><span class="annottext">PageInfoField
</span><a href="Hasura.RQL.IR.Select.html#PageInfoStartCursor"><span class="hs-identifier hs-var">PageInfoStartCursor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-819"></span><span>            </span><span class="annot"><span class="annottext">TypeAnn -&gt; SQLExp -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#withForceAggregation"><span class="hs-identifier hs-var">withForceAggregation</span></a></span><span> </span><span class="annot"><span class="annottext">TypeAnn
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#textTypeAnn"><span class="hs-identifier hs-var">S.textTypeAnn</span></a></span><span>
</span><span id="line-820"></span><span>              </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#encodeBase64"><span class="hs-identifier hs-var">encodeBase64</span></a></span><span>
</span><span id="line-821"></span><span>              </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; TableIdentifier -&gt; SQLExp
</span><a href="#local-6989586621687794573"><span class="hs-identifier hs-var">mkSingleFieldSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Identifier -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SEIdentifier"><span class="hs-identifier hs-var">S.SEIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Identifier
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#startCursorIdentifier"><span class="hs-identifier hs-var">startCursorIdentifier</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#cursorsSelectAliasIdentifier"><span class="hs-identifier hs-var">cursorsSelectAliasIdentifier</span></a></span><span>
</span><span id="line-822"></span><span>          </span><span class="annot"><span class="annottext">PageInfoField
</span><a href="Hasura.RQL.IR.Select.html#PageInfoEndCursor"><span class="hs-identifier hs-var">PageInfoEndCursor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-823"></span><span>            </span><span class="annot"><span class="annottext">TypeAnn -&gt; SQLExp -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#withForceAggregation"><span class="hs-identifier hs-var">withForceAggregation</span></a></span><span> </span><span class="annot"><span class="annottext">TypeAnn
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#textTypeAnn"><span class="hs-identifier hs-var">S.textTypeAnn</span></a></span><span>
</span><span id="line-824"></span><span>              </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#encodeBase64"><span class="hs-identifier hs-var">encodeBase64</span></a></span><span>
</span><span id="line-825"></span><span>              </span><span class="annot"><span class="annottext">(SQLExp -&gt; SQLExp) -&gt; SQLExp -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SQLExp -&gt; TableIdentifier -&gt; SQLExp
</span><a href="#local-6989586621687794573"><span class="hs-identifier hs-var">mkSingleFieldSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Identifier -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SEIdentifier"><span class="hs-identifier hs-var">S.SEIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Identifier
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#endCursorIdentifier"><span class="hs-identifier hs-var">endCursorIdentifier</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#cursorsSelectAliasIdentifier"><span class="hs-identifier hs-var">cursorsSelectAliasIdentifier</span></a></span><span>
</span><span id="line-826"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-827"></span><span>        </span><span id="local-6989586621687794573"><span class="annot"><span class="annottext">mkSingleFieldSelect :: SQLExp -&gt; TableIdentifier -&gt; SQLExp
</span><a href="#local-6989586621687794573"><span class="hs-identifier hs-var hs-var">mkSingleFieldSelect</span></a></span></span><span> </span><span id="local-6989586621687794577"><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794577"><span class="hs-identifier hs-var">field</span></a></span></span><span> </span><span id="local-6989586621687794578"><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794578"><span class="hs-identifier hs-var">fromIdentifier</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-828"></span><span>          </span><span class="annot"><span class="annottext">Select -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SESelect"><span class="hs-identifier hs-var">S.SESelect</span></a></span><span>
</span><span id="line-829"></span><span>            </span><span class="annot"><span class="annottext">Select
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#mkSelect"><span class="hs-identifier hs-var">S.mkSelect</span></a></span><span>
</span><span id="line-830"></span><span>              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">selExtr :: [Extractor]
</span><a href="#local-6989586621687794581"><span class="hs-identifier hs-var">S.selExtr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SQLExp -&gt; Maybe ColumnAlias -&gt; Extractor
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#Extractor"><span class="hs-identifier hs-var">S.Extractor</span></a></span><span> </span><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687794577"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ColumnAlias
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-831"></span><span>                </span><span class="annot"><span class="annottext">selFrom :: Maybe FromExp
</span><a href="#local-6989586621687794582"><span class="hs-identifier hs-var">S.selFrom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FromExp -&gt; Maybe FromExp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(FromExp -&gt; Maybe FromExp) -&gt; FromExp -&gt; Maybe FromExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[FromItem] -&gt; FromExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#FromExp"><span class="hs-identifier hs-var">S.FromExp</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TableIdentifier -&gt; FromItem
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#FIIdentifier"><span class="hs-identifier hs-var">S.FIIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687794578"><span class="hs-identifier hs-var">fromIdentifier</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-832"></span><span>              </span><span class="hs-special">}</span><span>
</span><span id="line-833"></span></pre></body></html>