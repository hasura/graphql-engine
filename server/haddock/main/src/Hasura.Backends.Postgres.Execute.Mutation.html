<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | Postgres Execute Mutation</span><span>
</span><span id="line-4"></span><span class="hs-comment">--</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Generic combinators for translating and excecuting IR mutation statements.</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Used by the specific mutation modules, e.g. 'Hasura.Backends.Postgres.Execute.Insert'.</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- See 'Hasura.Backends.Postgres.Instances.Execute'.</span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hasura.Backends.Postgres.Execute.Mutation</span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier">MutateResp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execDeleteQuery"><span class="hs-identifier">execDeleteQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execInsertQuery"><span class="hs-identifier">execInsertQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execUpdateQuery"><span class="hs-identifier">execUpdateQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#executeMutationOutputQuery"><span class="hs-identifier">executeMutationOutputQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndFetchCols"><span class="hs-identifier">mutateAndFetchCols</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#ValidateInputPayloadVersion"><span class="hs-identifier">ValidateInputPayloadVersion</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#validateInputPayloadVersion"><span class="hs-identifier">validateInputPayloadVersion</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#ValidateInputErrorResponse"><span class="hs-identifier">ValidateInputErrorResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#HttpHandlerLog"><span class="hs-identifier">HttpHandlerLog</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#ValidateInsertInputLog"><span class="hs-identifier">ValidateInsertInputLog</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#InsertValidationPayloadMap"><span class="hs-identifier">InsertValidationPayloadMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#validateUpdateMutation"><span class="hs-identifier">validateUpdateMutation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#validateDeleteMutation"><span class="hs-identifier">validateDeleteMutation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#validateMutation"><span class="hs-identifier">validateMutation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">where</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">try</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/lens-5.2.2-c288f4ab3533e91c5d241152121e172474cc553aa524e32488a24b727cc130b5/share/doc/html/src/Control.Lens.html"><span class="hs-identifier">Control.Lens</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Lens</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.html"><span class="hs-identifier">Data.Aeson</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.html"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">J</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Key.html"><span class="hs-identifier">Data.Aeson.Key</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">J</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.TH.html"><span class="hs-identifier">Data.Aeson.TH</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">J</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Environment.html"><span class="hs-identifier">Data.Environment</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Env</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashMap.Strict.html"><span class="hs-identifier">Data.HashMap.Strict</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HashMap</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/insert-ordered-containers-0.2.5.1-b5ad8e22c80bc291a2f581fb78a4448e46180aa38110e81c957f693abd1dc222/share/doc/html/src/Data.HashMap.Strict.InsOrd.html"><span class="hs-identifier">Data.HashMap.Strict.InsOrd</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">InsOrdHashMap</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DS</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.html"><span class="hs-identifier">Database.PG.Query</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PG</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.html"><span class="hs-identifier">Hasura.Backends.Postgres.Connection</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html"><span class="hs-identifier">Hasura.Backends.Postgres.SQL.DML</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html"><span class="hs-identifier">Hasura.Backends.Postgres.SQL.Types</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#TableName"><span class="hs-identifier">TableName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Value.html"><span class="hs-identifier">Hasura.Backends.Postgres.SQL.Value</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Delete.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Delete</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Insert.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Insert</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Mutation.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Mutation</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Returning.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Returning</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Select</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Select.Internal.Helpers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#customSQLToTopLevelCTEs"><span class="hs-identifier">customSQLToTopLevelCTEs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#toQuery"><span class="hs-identifier">toQuery</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Update.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Update</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Types.Update.html"><span class="hs-identifier">Hasura.Backends.Postgres.Types.Update</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Postgres</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html"><span class="hs-identifier">Hasura.Base.Error</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html"><span class="hs-identifier">Hasura.EncJSON</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/schema-parsers-1.0.0/opt/doc/html/schema-parsers/src/Hasura.GraphQL.Parser.Internal.Convert.html"><span class="hs-identifier">Hasura.GraphQL.Parser.Internal.Convert</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/schema-parsers-1.0.0/opt/doc/html/schema-parsers/src/Hasura.GraphQL.Parser.Variable.html"><span class="hs-identifier">Hasura.GraphQL.Parser.Variable</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.HTTP.html"><span class="hs-identifier">Hasura.HTTP</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Logging.html"><span class="hs-identifier">Hasura.Logging</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.QueryTags.html"><span class="hs-identifier">Hasura.QueryTags</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DDL.Headers.html"><span class="hs-identifier">Hasura.RQL.DDL.Headers</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.html"><span class="hs-identifier">Hasura.RQL.IR</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IR</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.BoolExp.html"><span class="hs-identifier">Hasura.RQL.IR.BoolExp</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Delete.html"><span class="hs-identifier">Hasura.RQL.IR.Delete</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Insert.html"><span class="hs-identifier">Hasura.RQL.IR.Insert</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Returning.html"><span class="hs-identifier">Hasura.RQL.IR.Returning</span></a></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html"><span class="hs-identifier">Hasura.RQL.IR.Select</span></a></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Update.html"><span class="hs-identifier">Hasura.RQL.IR.Update</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html"><span class="hs-identifier">Hasura.RQL.Types.Backend</span></a></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html"><span class="hs-identifier">Hasura.RQL.Types.BackendType</span></a></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Column.html"><span class="hs-identifier">Hasura.RQL.Types.Column</span></a></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html"><span class="hs-identifier">Hasura.RQL.Types.Common</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Headers.html"><span class="hs-identifier">Hasura.RQL.Types.Headers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Headers.html#HeaderConf"><span class="hs-identifier">HeaderConf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html"><span class="hs-identifier">Hasura.RQL.Types.NamingCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html#NamingCase"><span class="hs-identifier">NamingCase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Permission.html"><span class="hs-identifier">Hasura.RQL.Types.Permission</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html"><span class="hs-identifier">Hasura.RQL.Types.Schema.Options</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Options</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Utils.html"><span class="hs-identifier">Hasura.Server.Utils</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Session.html"><span class="hs-identifier">Hasura.Session</span></a></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Tracing.html"><span class="hs-identifier">Hasura.Tracing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Tracing.Propagator.B3.html#b3TraceContextPropagator"><span class="hs-identifier">b3TraceContextPropagator</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Tracing.html"><span class="hs-identifier">Hasura.Tracing</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tracing</span></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html"><span class="hs-identifier">Language.GraphQL.Draft.Syntax</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Network.HTTP.Client.Transformable.html"><span class="hs-identifier">Network.HTTP.Client.Transformable</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HTTP</span></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/wreq-0.5.3.3-288702744e167bbd35c96c1c806bd4ce18aeffab9557ceb3329b6915df71a6c6/share/doc/html/src/Network.Wreq.html"><span class="hs-identifier">Network.Wreq</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Wreq</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">data</span><span> </span><span id="MutateResp"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier hs-var">MutateResp</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687788675"><span class="annot"><a href="#local-6989586621687788675"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#BackendType"><span class="hs-identifier hs-type">BackendType</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621687788676"><span class="annot"><a href="#local-6989586621687788676"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MutateResp"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier hs-var">MutateResp</span></a></span></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_mrAffectedRows"><span class="annot"><span class="annottext">forall (b :: BackendType) a. MutateResp b a -&gt; Int
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_mrAffectedRows"><span class="hs-identifier hs-var hs-var">_mrAffectedRows</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>    </span><span id="_mrReturningColumns"><span class="annot"><span class="annottext">forall (b :: BackendType) a. MutateResp b a -&gt; [ColumnValues b a]
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_mrReturningColumns"><span class="hs-identifier hs-var hs-var">_mrReturningColumns</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnValues"><span class="hs-identifier hs-type">ColumnValues</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788675"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788676"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621687789321"><span id="local-6989586621687789323"><span class="annot"><span class="annottext">(forall x. MutateResp b a -&gt; Rep (MutateResp b a) x)
-&gt; (forall x. Rep (MutateResp b a) x -&gt; MutateResp b a)
-&gt; Generic (MutateResp b a)
forall x. Rep (MutateResp b a) x -&gt; MutateResp b a
forall x. MutateResp b a -&gt; Rep (MutateResp b a) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (b :: BackendType) a x.
Rep (MutateResp b a) x -&gt; MutateResp b a
forall (b :: BackendType) a x.
MutateResp b a -&gt; Rep (MutateResp b a) x
$cfrom :: forall (b :: BackendType) a x.
MutateResp b a -&gt; Rep (MutateResp b a) x
from :: forall x. MutateResp b a -&gt; Rep (MutateResp b a) x
$cto :: forall (b :: BackendType) a x.
Rep (MutateResp b a) x -&gt; MutateResp b a
to :: forall x. Rep (MutateResp b a) x -&gt; MutateResp b a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span id="local-6989586621687788706"><span id="local-6989586621687788707"><span id="local-6989586621687789329"><span id="local-6989586621687789338"><span id="local-6989586621687789342"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788706"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621687788707"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier hs-type">MutateResp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788706"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788707"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span id="local-6989586621687788714"><span id="local-6989586621687788715"><span id="local-6989586621687789352"><span id="local-6989586621687789359"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788714"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621687788715"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier hs-type">MutateResp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788714"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788715"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621687788723"><span id="local-6989586621687788724"><span id="local-6989586621687789370"><span id="local-6989586621687789374"><span id="local-6989586621687789377"><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788723"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#ToJSON"><span class="hs-identifier hs-type">ToJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788724"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#ToJSON"><span class="hs-identifier hs-type">ToJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier hs-type">MutateResp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788723"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788724"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621687789482"><span class="annot"><span class="annottext">toJSON :: MutateResp b a -&gt; Value
</span><a href="#local-6989586621687789482"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; MutateResp b a -&gt; Value
forall a.
(Generic a, GToJSON' Value Zero (Rep a)) =&gt;
Options -&gt; a -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#genericToJSON"><span class="hs-identifier hs-var">genericToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html#hasuraJSON"><span class="hs-identifier hs-var">hasuraJSON</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621687788856"><span id="local-6989586621687788857"><span id="local-6989586621687789490"><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788856"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.FromJSON.html#FromJSON"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788857"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.FromJSON.html#FromJSON"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier hs-type">MutateResp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788856"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788857"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>  </span><span id="local-6989586621687789572"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (MutateResp b a)
</span><a href="#local-6989586621687789572"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Value -&gt; Parser (MutateResp b a)
forall a.
(Generic a, GFromJSON Zero (Rep a)) =&gt;
Options -&gt; Value -&gt; Parser a
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.FromJSON.html#genericParseJSON"><span class="hs-identifier hs-var">genericParseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Options
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html#hasuraJSON"><span class="hs-identifier hs-var">hasuraJSON</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-keyword">data</span><span> </span><span id="Mutation"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#Mutation"><span class="hs-identifier hs-var">Mutation</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687788924"><span class="annot"><a href="#local-6989586621687788924"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#BackendType"><span class="hs-identifier hs-type">BackendType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Mutation"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#Mutation"><span class="hs-identifier hs-var">Mutation</span></a></span></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_mTable"><span class="annot"><span class="annottext">forall (b :: BackendType). Mutation b -&gt; QualifiedTable
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_mTable"><span class="hs-identifier hs-var hs-var">_mTable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedTable"><span class="hs-identifier hs-type">QualifiedTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>    </span><span id="_mQuery"><span class="annot"><span class="annottext">forall (b :: BackendType). Mutation b -&gt; (MutationCTE, Seq PrepArg)
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_mQuery"><span class="hs-identifier hs-var hs-var">_mQuery</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Returning.html#MutationCTE"><span class="hs-identifier hs-type">MutationCTE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DS.Seq</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Connection.html#PrepArg"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>    </span><span id="_mOutput"><span class="annot"><span class="annottext">forall (b :: BackendType). Mutation b -&gt; MutationOutput b
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_mOutput"><span class="hs-identifier hs-var hs-var">_mOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Returning.html#MutationOutput"><span class="hs-identifier hs-type">MutationOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788924"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>    </span><span id="_mCols"><span class="annot"><span class="annottext">forall (b :: BackendType). Mutation b -&gt; [ColumnInfo b]
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_mCols"><span class="hs-identifier hs-var hs-var">_mCols</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788924"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>    </span><span id="_mStrfyNum"><span class="annot"><span class="annottext">forall (b :: BackendType). Mutation b -&gt; StringifyNumbers
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_mStrfyNum"><span class="hs-identifier hs-var hs-var">_mStrfyNum</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>    </span><span id="_mNamingConvention"><span class="annot"><span class="annottext">forall (b :: BackendType). Mutation b -&gt; Maybe NamingCase
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_mNamingConvention"><span class="hs-identifier hs-var hs-var">_mNamingConvention</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span id="local-6989586621687788942"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mkMutation"><span class="hs-identifier hs-type">mkMutation</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedTable"><span class="hs-identifier hs-type">QualifiedTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Returning.html#MutationCTE"><span class="hs-identifier hs-type">MutationCTE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DS.Seq</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Connection.html#PrepArg"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Returning.html#MutationOutput"><span class="hs-identifier hs-type">MutationOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788942"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788942"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-118"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#Mutation"><span class="hs-identifier hs-type">Mutation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788942"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-120"></span><span id="mkMutation"><span class="annot"><span class="annottext">mkMutation :: forall (pgKind :: PostgresKind).
UserInfo
-&gt; QualifiedTable
-&gt; (MutationCTE, Seq PrepArg)
-&gt; MutationOutput ('Postgres pgKind)
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; Mutation ('Postgres pgKind)
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mkMutation"><span class="hs-identifier hs-var hs-var">mkMutation</span></a></span></span><span> </span><span id="local-6989586621687789583"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789583"><span class="hs-identifier hs-var">_userInfo</span></a></span></span><span> </span><span id="local-6989586621687789584"><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621687789584"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span id="local-6989586621687789585"><span class="annot"><span class="annottext">(MutationCTE, Seq PrepArg)
</span><a href="#local-6989586621687789585"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span id="local-6989586621687789586"><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
</span><a href="#local-6989586621687789586"><span class="hs-identifier hs-var">output</span></a></span></span><span> </span><span id="local-6989586621687789587"><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687789587"><span class="hs-identifier hs-var">allCols</span></a></span></span><span> </span><span id="local-6989586621687789588"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687789588"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span id="local-6989586621687789589"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687789589"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><span class="annottext">QualifiedTable
-&gt; (MutationCTE, Seq PrepArg)
-&gt; MutationOutput ('Postgres pgKind)
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; Mutation ('Postgres pgKind)
forall (b :: BackendType).
QualifiedTable
-&gt; (MutationCTE, Seq PrepArg)
-&gt; MutationOutput b
-&gt; [ColumnInfo b]
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; Mutation b
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#Mutation"><span class="hs-identifier hs-var">Mutation</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621687789584"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">(MutationCTE, Seq PrepArg)
</span><a href="#local-6989586621687789585"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
</span><a href="#local-6989586621687789586"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687789587"><span class="hs-identifier hs-var">allCols</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687789588"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687789589"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span id="local-6989586621687788945"><span id="local-6989586621687788947"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#runMutation"><span class="hs-identifier hs-type">runMutation</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788945"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788947"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html#PostgresTranslateSelect"><span class="hs-identifier hs-type">PostgresTranslateSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788947"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788945"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687788945"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-130"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#Mutation"><span class="hs-identifier hs-type">Mutation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788947"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><a href="#local-6989586621687788945"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span></span></span><span>
</span><span id="line-133"></span><span id="runMutation"><span class="annot"><span class="annottext">runMutation :: forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m,
 MonadIO m) =&gt;
UserInfo -&gt; Mutation ('Postgres pgKind) -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#runMutation"><span class="hs-identifier hs-var hs-var">runMutation</span></a></span></span><span> </span><span id="local-6989586621687789606"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789606"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621687789607"><span class="annot"><span class="annottext">Mutation ('Postgres pgKind)
</span><a href="#local-6989586621687789607"><span class="hs-identifier hs-var">mut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><span class="annottext">m EncJSON -&gt; m EncJSON -&gt; Bool -&gt; m EncJSON
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserInfo -&gt; Mutation ('Postgres pgKind) -&gt; m EncJSON
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m,
 MonadIO m) =&gt;
UserInfo -&gt; Mutation ('Postgres pgKind) -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndReturn"><span class="hs-identifier hs-var">mutateAndReturn</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789606"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Mutation ('Postgres pgKind)
</span><a href="#local-6989586621687789607"><span class="hs-identifier hs-var">mut</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserInfo -&gt; Mutation ('Postgres pgKind) -&gt; m EncJSON
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m,
 MonadIO m) =&gt;
UserInfo -&gt; Mutation ('Postgres pgKind) -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndSel"><span class="hs-identifier hs-var">mutateAndSel</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789606"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Mutation ('Postgres pgKind)
</span><a href="#local-6989586621687789607"><span class="hs-identifier hs-var">mut</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><span class="annottext">(Bool -&gt; m EncJSON) -&gt; Bool -&gt; m EncJSON
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MutationOutputG ('Postgres pgKind) Void SQLExp -&gt; Bool
forall (backend :: BackendType) r a.
MutationOutputG backend r a -&gt; Bool
</span><a href="Hasura.RQL.IR.Returning.html#hasNestedFld"><span class="hs-identifier hs-var">hasNestedFld</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><span class="annottext">(MutationOutputG ('Postgres pgKind) Void SQLExp -&gt; Bool)
-&gt; MutationOutputG ('Postgres pgKind) Void SQLExp -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Mutation ('Postgres pgKind) -&gt; MutationOutput ('Postgres pgKind)
forall (b :: BackendType). Mutation b -&gt; MutationOutput b
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_mOutput"><span class="hs-identifier hs-var">_mOutput</span></a></span><span> </span><span class="annot"><span class="annottext">Mutation ('Postgres pgKind)
</span><a href="#local-6989586621687789607"><span class="hs-identifier hs-var">mut</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span id="local-6989586621687789612"><span id="local-6989586621687789613"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndReturn"><span class="hs-identifier hs-type">mutateAndReturn</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789612"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789613"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html#PostgresTranslateSelect"><span class="hs-identifier hs-type">PostgresTranslateSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789613"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789612"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687789612"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-146"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#Mutation"><span class="hs-identifier hs-type">Mutation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789613"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><a href="#local-6989586621687789612"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span></span></span><span>
</span><span id="line-148"></span><span id="mutateAndReturn"><span class="annot"><span class="annottext">mutateAndReturn :: forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m,
 MonadIO m) =&gt;
UserInfo -&gt; Mutation ('Postgres pgKind) -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndReturn"><span class="hs-identifier hs-var hs-var">mutateAndReturn</span></a></span></span><span> </span><span id="local-6989586621687789626"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789626"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#Mutation"><span class="hs-identifier hs-type">Mutation</span></a></span><span> </span><span id="local-6989586621687789627"><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621687789627"><span class="hs-identifier hs-var">qt</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687789628"><span class="annot"><span class="annottext">MutationCTE
</span><a href="#local-6989586621687789628"><span class="hs-identifier hs-var">cte</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687789629"><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687789629"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621687789630"><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
</span><a href="#local-6989586621687789630"><span class="hs-identifier hs-var">mutationOutput</span></a></span></span><span> </span><span id="local-6989586621687789631"><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687789631"><span class="hs-identifier hs-var">allCols</span></a></span></span><span> </span><span id="local-6989586621687789632"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687789632"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span id="local-6989586621687789633"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687789633"><span class="hs-identifier hs-var">tCase</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>  </span><span class="annot"><span class="annottext">UserInfo
-&gt; QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; Maybe Int
-&gt; MutationCTE
-&gt; MutationOutput ('Postgres pgKind)
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; [PrepArg]
-&gt; m EncJSON
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m,
 MonadIO m) =&gt;
UserInfo
-&gt; QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; Maybe Int
-&gt; MutationCTE
-&gt; MutationOutput ('Postgres pgKind)
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; [PrepArg]
-&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#executeMutationOutputQuery"><span class="hs-identifier hs-var">executeMutationOutputQuery</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789626"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621687789627"><span class="hs-identifier hs-var">qt</span></a></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687789631"><span class="hs-identifier hs-var">allCols</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">MutationCTE
</span><a href="#local-6989586621687789628"><span class="hs-identifier hs-var">cte</span></a></span><span> </span><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
</span><a href="#local-6989586621687789630"><span class="hs-identifier hs-var">mutationOutput</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687789632"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687789633"><span class="hs-identifier hs-var">tCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq PrepArg -&gt; [PrepArg]
forall a. Seq a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687789629"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execUpdateQuery"><span class="hs-identifier hs-type">execUpdateQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687788973"><span class="annot"><a href="#local-6989586621687788973"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621687788972"><span class="annot"><a href="#local-6989586621687788972"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788972"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788973"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html#PostgresTranslateSelect"><span class="hs-identifier hs-type">PostgresTranslateSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788973"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788972"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687788972"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-160"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-161"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Update.html#AnnotatedUpdate"><span class="hs-identifier hs-type">AnnotatedUpdate</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788973"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DS.Seq</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Connection.html#PrepArg"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><a href="#local-6989586621687788972"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span>
</span><span id="line-164"></span><span id="execUpdateQuery"><span class="annot"><span class="annottext">execUpdateQuery :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m,
 MonadIO m) =&gt;
StringifyNumbers
-&gt; Maybe NamingCase
-&gt; UserInfo
-&gt; (AnnotatedUpdate ('Postgres pgKind), Seq PrepArg)
-&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execUpdateQuery"><span class="hs-identifier hs-var hs-var">execUpdateQuery</span></a></span></span><span> </span><span id="local-6989586621687789661"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687789661"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span id="local-6989586621687789662"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687789662"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span id="local-6989586621687789663"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789663"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687789664"><span class="annot"><span class="annottext">AnnotatedUpdate ('Postgres pgKind)
</span><a href="#local-6989586621687789664"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687789665"><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687789665"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-165"></span><span>  </span><span id="local-6989586621687789666"><span class="annot"><span class="annottext">UpdateCTE
</span><a href="#local-6989586621687789666"><span class="hs-identifier hs-var">updateCTE</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserInfo -&gt; AnnotatedUpdate ('Postgres pgKind) -&gt; m UpdateCTE
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(Backend ('Postgres pgKind), MonadIO m, MonadError QErr m) =&gt;
UserInfo -&gt; AnnotatedUpdate ('Postgres pgKind) -&gt; m UpdateCTE
</span><a href="Hasura.Backends.Postgres.Translate.Update.html#mkUpdateCTE"><span class="hs-identifier hs-var">mkUpdateCTE</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789663"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedUpdate ('Postgres pgKind)
</span><a href="#local-6989586621687789664"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UpdateCTE
</span><a href="#local-6989586621687789666"><span class="hs-identifier hs-var">updateCTE</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Update.html#Update"><span class="hs-identifier hs-type">Update</span></a></span><span> </span><span id="local-6989586621687789669"><span class="annot"><span class="annottext">TopLevelCTE
</span><a href="#local-6989586621687789669"><span class="hs-identifier hs-var">singleUpdate</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TopLevelCTE -&gt; m EncJSON
</span><a href="#local-6989586621687789670"><span class="hs-identifier hs-var">runCTE</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelCTE
</span><a href="#local-6989586621687789669"><span class="hs-identifier hs-var">singleUpdate</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Update.html#MultiUpdate"><span class="hs-identifier hs-type">MultiUpdate</span></a></span><span> </span><span id="local-6989586621687789672"><span class="annot"><span class="annottext">[TopLevelCTE]
</span><a href="#local-6989586621687789672"><span class="hs-identifier hs-var">ctes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[EncJSON] -&gt; EncJSON
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html#encJFromList"><span class="hs-identifier hs-var">encJFromList</span></a></span><span> </span><span class="annot"><span class="annottext">([EncJSON] -&gt; EncJSON) -&gt; m [EncJSON] -&gt; m EncJSON
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(TopLevelCTE -&gt; m EncJSON) -&gt; [TopLevelCTE] -&gt; m [EncJSON]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">TopLevelCTE -&gt; m EncJSON
</span><a href="#local-6989586621687789670"><span class="hs-identifier hs-var">runCTE</span></a></span><span> </span><span class="annot"><span class="annottext">[TopLevelCTE]
</span><a href="#local-6989586621687789672"><span class="hs-identifier hs-var">ctes</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><a href="#local-6989586621687789670"><span class="hs-identifier hs-type">runCTE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#TopLevelCTE"><span class="hs-identifier hs-type">S.TopLevelCTE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621687788972"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621687789670"><span class="annot"><span class="annottext">runCTE :: TopLevelCTE -&gt; m EncJSON
</span><a href="#local-6989586621687789670"><span class="hs-identifier hs-var hs-var">runCTE</span></a></span></span><span> </span><span id="local-6989586621687789676"><span class="annot"><span class="annottext">TopLevelCTE
</span><a href="#local-6989586621687789676"><span class="hs-identifier hs-var">cte</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-172"></span><span>      </span><span class="annot"><span class="annottext">UserInfo -&gt; Mutation ('Postgres pgKind) -&gt; m EncJSON
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m,
 MonadIO m) =&gt;
UserInfo -&gt; Mutation ('Postgres pgKind) -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#runMutation"><span class="hs-identifier hs-var">runMutation</span></a></span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789663"><span class="hs-identifier hs-var">userInfo</span></a></span><span>
</span><span id="line-174"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserInfo
-&gt; QualifiedTable
-&gt; (MutationCTE, Seq PrepArg)
-&gt; MutationOutput ('Postgres pgKind)
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; Mutation ('Postgres pgKind)
forall (pgKind :: PostgresKind).
UserInfo
-&gt; QualifiedTable
-&gt; (MutationCTE, Seq PrepArg)
-&gt; MutationOutput ('Postgres pgKind)
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; Mutation ('Postgres pgKind)
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mkMutation"><span class="hs-identifier hs-var">mkMutation</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789663"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnotatedUpdateG ('Postgres pgKind) Void SQLExp
-&gt; TableName ('Postgres pgKind)
forall (b :: BackendType) r v.
AnnotatedUpdateG b r v -&gt; TableName b
</span><a href="Hasura.RQL.IR.Update.html#_auTable"><span class="hs-identifier hs-var">_auTable</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedUpdate ('Postgres pgKind)
AnnotatedUpdateG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687789664"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TopLevelCTE -&gt; MutationCTE
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#MCCheckConstraint"><span class="hs-identifier hs-var">MCCheckConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelCTE
</span><a href="#local-6989586621687789676"><span class="hs-identifier hs-var">cte</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687789665"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnotatedUpdateG ('Postgres pgKind) Void SQLExp
-&gt; MutationOutputG ('Postgres pgKind) Void SQLExp
forall (b :: BackendType) r v.
AnnotatedUpdateG b r v -&gt; MutationOutputG b r v
</span><a href="Hasura.RQL.IR.Update.html#_auOutput"><span class="hs-identifier hs-var">_auOutput</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedUpdate ('Postgres pgKind)
AnnotatedUpdateG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687789664"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnotatedUpdateG ('Postgres pgKind) Void SQLExp
-&gt; [ColumnInfo ('Postgres pgKind)]
forall (b :: BackendType) r v.
AnnotatedUpdateG b r v -&gt; [ColumnInfo b]
</span><a href="Hasura.RQL.IR.Update.html#_auAllCols"><span class="hs-identifier hs-var">_auAllCols</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedUpdate ('Postgres pgKind)
AnnotatedUpdateG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687789664"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687789661"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687789662"><span class="hs-identifier hs-var">tCase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execDeleteQuery"><span class="hs-identifier hs-type">execDeleteQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687789007"><span class="annot"><a href="#local-6989586621687789007"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621687789006"><span class="annot"><a href="#local-6989586621687789006"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789006"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687789006"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789007"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html#PostgresTranslateSelect"><span class="hs-identifier hs-type">PostgresTranslateSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789007"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789006"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Delete.html#AnnDel"><span class="hs-identifier hs-type">AnnDel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789007"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DS.Seq</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Connection.html#PrepArg"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><a href="#local-6989586621687789006"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span>
</span><span id="line-189"></span><span id="execDeleteQuery"><span class="annot"><span class="annottext">execDeleteQuery :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, MonadIO m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m) =&gt;
StringifyNumbers
-&gt; Maybe NamingCase
-&gt; UserInfo
-&gt; (AnnDel ('Postgres pgKind), Seq PrepArg)
-&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execDeleteQuery"><span class="hs-identifier hs-var hs-var">execDeleteQuery</span></a></span></span><span> </span><span id="local-6989586621687789698"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687789698"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span id="local-6989586621687789699"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687789699"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span id="local-6989586621687789700"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789700"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687789701"><span class="annot"><span class="annottext">AnnDel ('Postgres pgKind)
</span><a href="#local-6989586621687789701"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687789702"><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687789702"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-190"></span><span>  </span><span id="local-6989586621687789703"><span class="annot"><span class="annottext">SQLDelete
</span><a href="#local-6989586621687789703"><span class="hs-identifier hs-var">delete</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserInfo -&gt; AnnDel ('Postgres pgKind) -&gt; m SQLDelete
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(Backend ('Postgres pgKind), MonadIO m, MonadError QErr m) =&gt;
UserInfo -&gt; AnnDel ('Postgres pgKind) -&gt; m SQLDelete
</span><a href="Hasura.Backends.Postgres.Translate.Delete.html#mkDelete"><span class="hs-identifier hs-var">mkDelete</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789700"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">AnnDel ('Postgres pgKind)
</span><a href="#local-6989586621687789701"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span class="annot"><span class="annottext">UserInfo -&gt; Mutation ('Postgres pgKind) -&gt; m EncJSON
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m,
 MonadIO m) =&gt;
UserInfo -&gt; Mutation ('Postgres pgKind) -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#runMutation"><span class="hs-identifier hs-var">runMutation</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789700"><span class="hs-identifier hs-var">userInfo</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserInfo
-&gt; QualifiedTable
-&gt; (MutationCTE, Seq PrepArg)
-&gt; MutationOutput ('Postgres pgKind)
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; Mutation ('Postgres pgKind)
forall (pgKind :: PostgresKind).
UserInfo
-&gt; QualifiedTable
-&gt; (MutationCTE, Seq PrepArg)
-&gt; MutationOutput ('Postgres pgKind)
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; Mutation ('Postgres pgKind)
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mkMutation"><span class="hs-identifier hs-var">mkMutation</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789700"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnDelG ('Postgres pgKind) Void SQLExp
-&gt; TableName ('Postgres pgKind)
forall (b :: BackendType) r v. AnnDelG b r v -&gt; TableName b
</span><a href="Hasura.RQL.IR.Delete.html#_adTable"><span class="hs-identifier hs-var">_adTable</span></a></span><span> </span><span class="annot"><span class="annottext">AnnDel ('Postgres pgKind)
AnnDelG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687789701"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SQLDelete -&gt; MutationCTE
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#MCDelete"><span class="hs-identifier hs-var">MCDelete</span></a></span><span> </span><span class="annot"><span class="annottext">SQLDelete
</span><a href="#local-6989586621687789703"><span class="hs-identifier hs-var">delete</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687789702"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnDelG ('Postgres pgKind) Void SQLExp
-&gt; MutationOutputG ('Postgres pgKind) Void SQLExp
forall (b :: BackendType) r v.
AnnDelG b r v -&gt; MutationOutputG b r v
</span><a href="Hasura.RQL.IR.Delete.html#_adOutput"><span class="hs-identifier hs-var">_adOutput</span></a></span><span> </span><span class="annot"><span class="annottext">AnnDel ('Postgres pgKind)
AnnDelG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687789701"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnDelG ('Postgres pgKind) Void SQLExp
-&gt; [ColumnInfo ('Postgres pgKind)]
forall (b :: BackendType) r v. AnnDelG b r v -&gt; [ColumnInfo b]
</span><a href="Hasura.RQL.IR.Delete.html#_adAllCols"><span class="hs-identifier hs-var">_adAllCols</span></a></span><span> </span><span class="annot"><span class="annottext">AnnDel ('Postgres pgKind)
AnnDelG ('Postgres pgKind) Void SQLExp
</span><a href="#local-6989586621687789701"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687789698"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687789699"><span class="hs-identifier hs-var">tCase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span id="local-6989586621687789025"><span id="local-6989586621687789026"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execInsertQuery"><span class="hs-identifier hs-type">execInsertQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789025"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789026"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html#PostgresTranslateSelect"><span class="hs-identifier hs-type">PostgresTranslateSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789026"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789025"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687789025"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#InsertQueryP1"><span class="hs-identifier hs-type">InsertQueryP1</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789026"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DS.Seq</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Connection.html#PrepArg"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><a href="#local-6989586621687789025"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span></span></span><span>
</span><span id="line-207"></span><span id="execInsertQuery"><span class="annot"><span class="annottext">execInsertQuery :: forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m,
 MonadIO m) =&gt;
StringifyNumbers
-&gt; Maybe NamingCase
-&gt; UserInfo
-&gt; (InsertQueryP1 ('Postgres pgKind), Seq PrepArg)
-&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#execInsertQuery"><span class="hs-identifier hs-var hs-var">execInsertQuery</span></a></span></span><span> </span><span id="local-6989586621687789725"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687789725"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span id="local-6989586621687789726"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687789726"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span id="local-6989586621687789727"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789727"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687789728"><span class="annot"><span class="annottext">InsertQueryP1 ('Postgres pgKind)
</span><a href="#local-6989586621687789728"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687789729"><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687789729"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-208"></span><span>  </span><span id="local-6989586621687789730"><span class="annot"><span class="annottext">TopLevelCTE
</span><a href="#local-6989586621687789730"><span class="hs-identifier hs-var">insertCTE</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserInfo -&gt; InsertQueryP1 ('Postgres pgKind) -&gt; m TopLevelCTE
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(Backend ('Postgres pgKind), MonadIO m, MonadError QErr m) =&gt;
UserInfo -&gt; InsertQueryP1 ('Postgres pgKind) -&gt; m TopLevelCTE
</span><a href="Hasura.Backends.Postgres.Translate.Insert.html#mkInsertCTE"><span class="hs-identifier hs-var">mkInsertCTE</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789727"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">InsertQueryP1 ('Postgres pgKind)
</span><a href="#local-6989586621687789728"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-209"></span><span>  </span><span class="annot"><span class="annottext">UserInfo -&gt; Mutation ('Postgres pgKind) -&gt; m EncJSON
forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m,
 MonadIO m) =&gt;
UserInfo -&gt; Mutation ('Postgres pgKind) -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#runMutation"><span class="hs-identifier hs-var">runMutation</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789727"><span class="hs-identifier hs-var">userInfo</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UserInfo
-&gt; QualifiedTable
-&gt; (MutationCTE, Seq PrepArg)
-&gt; MutationOutput ('Postgres pgKind)
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; Mutation ('Postgres pgKind)
forall (pgKind :: PostgresKind).
UserInfo
-&gt; QualifiedTable
-&gt; (MutationCTE, Seq PrepArg)
-&gt; MutationOutput ('Postgres pgKind)
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; Mutation ('Postgres pgKind)
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mkMutation"><span class="hs-identifier hs-var">mkMutation</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789727"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InsertQueryP1 ('Postgres pgKind) -&gt; TableName ('Postgres pgKind)
forall (b :: BackendType). InsertQueryP1 b -&gt; TableName b
</span><a href="Hasura.RQL.IR.Insert.html#iqp1Table"><span class="hs-identifier hs-var">iqp1Table</span></a></span><span> </span><span class="annot"><span class="annottext">InsertQueryP1 ('Postgres pgKind)
</span><a href="#local-6989586621687789728"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TopLevelCTE -&gt; MutationCTE
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#MCCheckConstraint"><span class="hs-identifier hs-var">MCCheckConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">TopLevelCTE
</span><a href="#local-6989586621687789730"><span class="hs-identifier hs-var">insertCTE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687789729"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InsertQueryP1 ('Postgres pgKind)
-&gt; MutationOutput ('Postgres pgKind)
forall (b :: BackendType). InsertQueryP1 b -&gt; MutationOutput b
</span><a href="Hasura.RQL.IR.Insert.html#iqp1Output"><span class="hs-identifier hs-var">iqp1Output</span></a></span><span> </span><span class="annot"><span class="annottext">InsertQueryP1 ('Postgres pgKind)
</span><a href="#local-6989586621687789728"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InsertQueryP1 ('Postgres pgKind) -&gt; [ColumnInfo ('Postgres pgKind)]
forall (b :: BackendType). InsertQueryP1 b -&gt; [ColumnInfo b]
</span><a href="Hasura.RQL.IR.Insert.html#iqp1AllCols"><span class="hs-identifier hs-var">iqp1AllCols</span></a></span><span> </span><span class="annot"><span class="annottext">InsertQueryP1 ('Postgres pgKind)
</span><a href="#local-6989586621687789728"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687789725"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687789726"><span class="hs-identifier hs-var">tCase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">{- Note: [Prepared statements in Mutations]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The SQL statements we generate for mutations seem to include the actual values
in the statements in some cases which pretty much makes them unfit for reuse
(Handling relationships in the returning clause is the source of this
complexity). Further, `PGConn` has an internal cache which maps a statement to
a 'prepared statement id' on Postgres. As we prepare more and more single-use
SQL statements we end up leaking memory both on graphql-engine and Postgres
till the connection is closed. So a simpler but very crude fix is to not use
prepared statements for mutations. The performance of insert mutations
shouldn't be affected but updates and delete mutations with complex boolean
conditions **might** see some degradation.
-}</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndSel"><span class="hs-identifier hs-type">mutateAndSel</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687788957"><span class="annot"><a href="#local-6989586621687788957"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621687788956"><span class="annot"><a href="#local-6989586621687788956"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788956"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-230"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788957"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html#PostgresTranslateSelect"><span class="hs-identifier hs-type">PostgresTranslateSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788957"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788956"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687788956"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#Mutation"><span class="hs-identifier hs-type">Mutation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788957"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><a href="#local-6989586621687788956"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span>
</span><span id="line-238"></span><span id="mutateAndSel"><span class="annot"><span class="annottext">mutateAndSel :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m,
 MonadIO m) =&gt;
UserInfo -&gt; Mutation ('Postgres pgKind) -&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndSel"><span class="hs-identifier hs-var hs-var">mutateAndSel</span></a></span></span><span> </span><span id="local-6989586621687789753"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789753"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#Mutation"><span class="hs-identifier hs-type">Mutation</span></a></span><span> </span><span id="local-6989586621687789754"><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621687789754"><span class="hs-identifier hs-var">qt</span></a></span></span><span> </span><span id="local-6989586621687789755"><span class="annot"><span class="annottext">(MutationCTE, Seq PrepArg)
</span><a href="#local-6989586621687789755"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621687789756"><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
</span><a href="#local-6989586621687789756"><span class="hs-identifier hs-var">mutationOutput</span></a></span></span><span> </span><span id="local-6989586621687789757"><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687789757"><span class="hs-identifier hs-var">allCols</span></a></span></span><span> </span><span id="local-6989586621687789758"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687789758"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span id="local-6989586621687789759"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687789759"><span class="hs-identifier hs-var">tCase</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-comment">-- Perform mutation and fetch unique columns</span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier hs-type">MutateResp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621687789760"><span class="annot"><span class="annottext">[ColumnValues ('Postgres pgKind) TxtEncodedVal]
</span><a href="#local-6989586621687789760"><span class="hs-identifier hs-var">columnVals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxE QErr (MutateResp ('Postgres pgKind) TxtEncodedVal)
-&gt; m (MutateResp ('Postgres pgKind) TxtEncodedVal)
forall a. TxE QErr a -&gt; m a
forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">(TxE QErr (MutateResp ('Postgres pgKind) TxtEncodedVal)
 -&gt; m (MutateResp ('Postgres pgKind) TxtEncodedVal))
-&gt; TxE QErr (MutateResp ('Postgres pgKind) TxtEncodedVal)
-&gt; m (MutateResp ('Postgres pgKind) TxtEncodedVal)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UserInfo
-&gt; QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; (MutationCTE, Seq PrepArg)
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; TxE QErr (MutateResp ('Postgres pgKind) TxtEncodedVal)
forall (pgKind :: PostgresKind).
(Backend ('Postgres pgKind), PostgresTranslateSelect pgKind) =&gt;
UserInfo
-&gt; QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; (MutationCTE, Seq PrepArg)
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; TxE QErr (MutateResp ('Postgres pgKind) TxtEncodedVal)
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndFetchCols"><span class="hs-identifier hs-var">mutateAndFetchCols</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789753"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621687789754"><span class="hs-identifier hs-var">qt</span></a></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687789757"><span class="hs-identifier hs-var">allCols</span></a></span><span> </span><span class="annot"><span class="annottext">(MutationCTE, Seq PrepArg)
</span><a href="#local-6989586621687789755"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687789758"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687789759"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621687789762"><span class="annot"><span class="annottext">Select
</span><a href="#local-6989586621687789762"><span class="hs-identifier hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; [ColumnValues ('Postgres pgKind) TxtEncodedVal]
-&gt; m Select
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
MonadError QErr m =&gt;
QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; [ColumnValues ('Postgres pgKind) TxtEncodedVal]
-&gt; m Select
</span><a href="Hasura.Backends.Postgres.Translate.Mutation.html#mkSelectExpFromColumnValues"><span class="hs-identifier hs-var">mkSelectExpFromColumnValues</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621687789754"><span class="hs-identifier hs-var">qt</span></a></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687789757"><span class="hs-identifier hs-var">allCols</span></a></span><span> </span><span class="annot"><span class="annottext">[ColumnValues ('Postgres pgKind) TxtEncodedVal]
</span><a href="#local-6989586621687789760"><span class="hs-identifier hs-var">columnVals</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-comment">-- Perform select query and fetch returning fields</span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><span class="annottext">UserInfo
-&gt; QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; Maybe Int
-&gt; MutationCTE
-&gt; MutationOutput ('Postgres pgKind)
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; [PrepArg]
-&gt; m EncJSON
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m,
 MonadIO m) =&gt;
UserInfo
-&gt; QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; Maybe Int
-&gt; MutationCTE
-&gt; MutationOutput ('Postgres pgKind)
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; [PrepArg]
-&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#executeMutationOutputQuery"><span class="hs-identifier hs-var">executeMutationOutputQuery</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789753"><span class="hs-identifier hs-var">userInfo</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621687789754"><span class="hs-identifier hs-var">qt</span></a></span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687789757"><span class="hs-identifier hs-var">allCols</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Select -&gt; MutationCTE
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#MCSelectValues"><span class="hs-identifier hs-var">MCSelectValues</span></a></span><span> </span><span class="annot"><span class="annottext">Select
</span><a href="#local-6989586621687789762"><span class="hs-identifier hs-var">select</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
</span><a href="#local-6989586621687789756"><span class="hs-identifier hs-var">mutationOutput</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687789758"><span class="hs-identifier hs-var">strfyNum</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687789759"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span id="local-6989586621687789044"><span id="local-6989586621687789045"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#withCheckPermission"><span class="hs-identifier hs-type">withCheckPermission</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789044"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621687789044"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621687789045"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621687789044"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789045"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-255"></span><span id="withCheckPermission"><span class="annot"><span class="annottext">withCheckPermission :: forall (m :: * -&gt; *) a. MonadError QErr m =&gt; m (a, Bool) -&gt; m a
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#withCheckPermission"><span class="hs-identifier hs-var hs-var">withCheckPermission</span></a></span></span><span> </span><span id="local-6989586621687789777"><span class="annot"><span class="annottext">m (a, Bool)
</span><a href="#local-6989586621687789777"><span class="hs-identifier hs-var">sqlTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621687789778"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621687789778"><span class="hs-identifier hs-var">rawResponse</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687789779"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687789779"><span class="hs-identifier hs-var">checkConstraint</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (a, Bool)
</span><a href="#local-6989586621687789777"><span class="hs-identifier hs-var">sqlTx</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687789779"><span class="hs-identifier hs-var">checkConstraint</span></a></span><span>
</span><span id="line-258"></span><span>    </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#PermissionError"><span class="hs-identifier hs-var">PermissionError</span></a></span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;check constraint of an insert/update permission has failed&quot;</span></span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><span class="annottext">a -&gt; m a
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621687789778"><span class="hs-identifier hs-var">rawResponse</span></a></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#executeMutationOutputQuery"><span class="hs-identifier hs-type">executeMutationOutputQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687788969"><span class="annot"><a href="#local-6989586621687788969"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621687788968"><span class="annot"><a href="#local-6989586621687788968"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788968"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788969"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-266"></span><span>    </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html#PostgresTranslateSelect"><span class="hs-identifier hs-type">PostgresTranslateSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788969"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-267"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="annot"><a href="Hasura.QueryTags.html#QueryTagsComment"><span class="hs-identifier hs-type">QueryTagsComment</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788968"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687788968"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedTable"><span class="hs-identifier hs-type">QualifiedTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788969"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-273"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-274"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Returning.html#MutationCTE"><span class="hs-identifier hs-type">MutationCTE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-275"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Returning.html#MutationOutput"><span class="hs-identifier hs-type">MutationOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687788969"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-276"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Prepared params</span></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Connection.html#PrepArg"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-280"></span><span>  </span><span class="annot"><a href="#local-6989586621687788968"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-json-encoding-1.0.0/opt/doc/html/hasura-json-encoding/src/Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span>
</span><span id="line-281"></span><span id="executeMutationOutputQuery"><span class="annot"><span class="annottext">executeMutationOutputQuery :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadTx m, Backend ('Postgres pgKind),
 PostgresTranslateSelect pgKind, MonadReader QueryTagsComment m,
 MonadIO m) =&gt;
UserInfo
-&gt; QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; Maybe Int
-&gt; MutationCTE
-&gt; MutationOutput ('Postgres pgKind)
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; [PrepArg]
-&gt; m EncJSON
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#executeMutationOutputQuery"><span class="hs-identifier hs-var hs-var">executeMutationOutputQuery</span></a></span></span><span> </span><span id="local-6989586621687789808"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789808"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621687789809"><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621687789809"><span class="hs-identifier hs-var">qt</span></a></span></span><span> </span><span id="local-6989586621687789810"><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687789810"><span class="hs-identifier hs-var">allCols</span></a></span></span><span> </span><span id="local-6989586621687789811"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687789811"><span class="hs-identifier hs-var">preCalAffRows</span></a></span></span><span> </span><span id="local-6989586621687789812"><span class="annot"><span class="annottext">MutationCTE
</span><a href="#local-6989586621687789812"><span class="hs-identifier hs-var">cte</span></a></span></span><span> </span><span id="local-6989586621687789813"><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
</span><a href="#local-6989586621687789813"><span class="hs-identifier hs-var">mutOutput</span></a></span></span><span> </span><span id="local-6989586621687789814"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687789814"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span id="local-6989586621687789815"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687789815"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span id="local-6989586621687789816"><span class="annot"><span class="annottext">[PrepArg]
</span><a href="#local-6989586621687789816"><span class="hs-identifier hs-var">prepArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-282"></span><span>  </span><span id="local-6989586621687789817"><span class="annot"><span class="annottext">QueryTagsComment
</span><a href="#local-6989586621687789817"><span class="hs-identifier hs-var">queryTags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m QueryTagsComment
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687789068"><span class="annot"><a href="#local-6989586621687789819"><span class="hs-identifier hs-type">queryTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Class.html#FromRes"><span class="hs-identifier hs-type">PG.FromRes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789068"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621687788968"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789068"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-284"></span><span>      </span><span id="local-6989586621687789819"><span class="annot"><span class="annottext">queryTx :: forall a. FromRes a =&gt; m a
</span><a href="#local-6989586621687789819"><span class="hs-identifier hs-var hs-var">queryTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-285"></span><span>        </span><span id="local-6989586621687789832"><span class="annot"><span class="annottext">SelectWith
</span><a href="#local-6989586621687789832"><span class="hs-identifier hs-var">selectWith</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UserInfo
-&gt; QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; Maybe Int
-&gt; MutationCTE
-&gt; MutationOutput ('Postgres pgKind)
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; m SelectWith
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(Backend ('Postgres pgKind), PostgresTranslateSelect pgKind,
 MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; Maybe Int
-&gt; MutationCTE
-&gt; MutationOutput ('Postgres pgKind)
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; m SelectWith
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#mkMutationOutputExp"><span class="hs-identifier hs-var">mkMutationOutputExp</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789808"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621687789809"><span class="hs-identifier hs-var">qt</span></a></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687789810"><span class="hs-identifier hs-var">allCols</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621687789811"><span class="hs-identifier hs-var">preCalAffRows</span></a></span><span> </span><span class="annot"><span class="annottext">MutationCTE
</span><a href="#local-6989586621687789812"><span class="hs-identifier hs-var">cte</span></a></span><span> </span><span class="annot"><span class="annottext">MutationOutput ('Postgres pgKind)
</span><a href="#local-6989586621687789813"><span class="hs-identifier hs-var">mutOutput</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687789814"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687789815"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-286"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687789834"><span class="annot"><span class="annottext">query :: Query
</span><a href="#local-6989586621687789834"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectWith -&gt; Query
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#toQuery"><span class="hs-identifier hs-var">toQuery</span></a></span><span> </span><span class="annot"><span class="annottext">SelectWith
</span><a href="#local-6989586621687789832"><span class="hs-identifier hs-var">selectWith</span></a></span><span>
</span><span id="line-287"></span><span>            </span><span id="local-6989586621687789835"><span class="annot"><span class="annottext">queryWithQueryTags :: Query
</span><a href="#local-6989586621687789835"><span class="hs-identifier hs-var hs-var">queryWithQueryTags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621687789834"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">getQueryText :: Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Transaction.html#getQueryText"><span class="hs-identifier hs-var">PG.getQueryText</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Transaction.html#getQueryText"><span class="hs-identifier hs-var">PG.getQueryText</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621687789834"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QueryTagsComment -&gt; Text
</span><a href="Hasura.QueryTags.html#_unQueryTagsComment"><span class="hs-identifier hs-var">_unQueryTagsComment</span></a></span><span> </span><span class="annot"><span class="annottext">QueryTagsComment
</span><a href="#local-6989586621687789817"><span class="hs-identifier hs-var">queryTags</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-288"></span><span>        </span><span class="hs-comment">-- See Note [Prepared statements in Mutations]</span><span>
</span><span id="line-289"></span><span>        </span><span class="annot"><span class="annottext">TxE QErr a -&gt; m a
forall a. TxE QErr a -&gt; m a
forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PGTxErr -&gt; QErr) -&gt; Query -&gt; [PrepArg] -&gt; Bool -&gt; TxE QErr a
forall (m :: * -&gt; *) a e.
(MonadIO m, FromRes a) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; [PrepArg] -&gt; Bool -&gt; TxET e m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Transaction.html#rawQE"><span class="hs-identifier hs-var">PG.rawQE</span></a></span><span> </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#dmlTxErrorHandler"><span class="hs-identifier hs-var">dmlTxErrorHandler</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621687789835"><span class="hs-identifier hs-var">queryWithQueryTags</span></a></span><span> </span><span class="annot"><span class="annottext">[PrepArg]
</span><a href="#local-6989586621687789816"><span class="hs-identifier hs-var">prepArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">MutationCTE -&gt; Bool
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#checkPermissionRequired"><span class="hs-identifier hs-var">checkPermissionRequired</span></a></span><span> </span><span class="annot"><span class="annottext">MutationCTE
</span><a href="#local-6989586621687789812"><span class="hs-identifier hs-var">cte</span></a></span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">m (EncJSON, Bool) -&gt; m EncJSON
forall (m :: * -&gt; *) a. MonadError QErr m =&gt; m (a, Bool) -&gt; m a
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#withCheckPermission"><span class="hs-identifier hs-var">withCheckPermission</span></a></span><span> </span><span class="annot"><span class="annottext">(m (EncJSON, Bool) -&gt; m EncJSON) -&gt; m (EncJSON, Bool) -&gt; m EncJSON
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SingleRow (EncJSON, Bool) -&gt; (EncJSON, Bool)
forall a. SingleRow a -&gt; a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Class.html#getRow"><span class="hs-identifier hs-var">PG.getRow</span></a></span><span> </span><span class="annot"><span class="annottext">(SingleRow (EncJSON, Bool) -&gt; (EncJSON, Bool))
-&gt; m (SingleRow (EncJSON, Bool)) -&gt; m (EncJSON, Bool)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m (SingleRow (EncJSON, Bool))
forall a. FromRes a =&gt; m a
</span><a href="#local-6989586621687789819"><span class="hs-identifier hs-var">queryTx</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Identity EncJSON -&gt; EncJSON
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity EncJSON -&gt; EncJSON)
-&gt; (SingleRow (Identity EncJSON) -&gt; Identity EncJSON)
-&gt; SingleRow (Identity EncJSON)
-&gt; EncJSON
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SingleRow (Identity EncJSON) -&gt; Identity EncJSON
forall a. SingleRow a -&gt; a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Class.html#getRow"><span class="hs-identifier hs-var">PG.getRow</span></a></span><span> </span><span class="annot"><span class="annottext">(SingleRow (Identity EncJSON) -&gt; EncJSON)
-&gt; m (SingleRow (Identity EncJSON)) -&gt; m EncJSON
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">m (SingleRow (Identity EncJSON))
forall a. FromRes a =&gt; m a
</span><a href="#local-6989586621687789819"><span class="hs-identifier hs-var">queryTx</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndFetchCols"><span class="hs-identifier hs-type">mutateAndFetchCols</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687789040"><span class="annot"><a href="#local-6989586621687789040"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789040"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html#PostgresTranslateSelect"><span class="hs-identifier hs-type">PostgresTranslateSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789040"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-298"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-299"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#QualifiedTable"><span class="hs-identifier hs-type">QualifiedTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789040"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Returning.html#MutationCTE"><span class="hs-identifier hs-type">MutationCTE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DS.Seq</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Connection.html#PrepArg"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Schema.Options.html#StringifyNumbers"><span class="hs-identifier hs-type">Options.StringifyNumbers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-303"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.NamingCase.html#NamingCase"><span class="hs-identifier hs-type">NamingCase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-304"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Transaction.html#TxE"><span class="hs-identifier hs-type">PG.TxE</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#MutateResp"><span class="hs-identifier hs-type">MutateResp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789040"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.SQL.Value.html#TxtEncodedVal"><span class="hs-identifier hs-type">TxtEncodedVal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span id="mutateAndFetchCols"><span class="annot"><span class="annottext">mutateAndFetchCols :: forall (pgKind :: PostgresKind).
(Backend ('Postgres pgKind), PostgresTranslateSelect pgKind) =&gt;
UserInfo
-&gt; QualifiedTable
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; (MutationCTE, Seq PrepArg)
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; TxE QErr (MutateResp ('Postgres pgKind) TxtEncodedVal)
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#mutateAndFetchCols"><span class="hs-identifier hs-var hs-var">mutateAndFetchCols</span></a></span></span><span> </span><span id="local-6989586621687789898"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789898"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621687789899"><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621687789899"><span class="hs-identifier hs-var">qt</span></a></span></span><span> </span><span id="local-6989586621687789900"><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687789900"><span class="hs-identifier hs-var">cols</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621687789901"><span class="annot"><span class="annottext">MutationCTE
</span><a href="#local-6989586621687789901"><span class="hs-identifier hs-var">cte</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687789902"><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687789902"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621687789903"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687789903"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span id="local-6989586621687789904"><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687789904"><span class="hs-identifier hs-var">tCase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621687789905"><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687789905"><span class="hs-identifier hs-var">colSel</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687789906"><span class="annot"><span class="annottext">CustomSQLCTEs
</span><a href="#local-6989586621687789906"><span class="hs-identifier hs-var">customSQLCTEs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><span class="annottext">WriterT CustomSQLCTEs (TxET QErr IO) SQLExp
-&gt; TxET QErr IO (SQLExp, CustomSQLCTEs)
forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
</span><span class="hs-identifier hs-var">runWriterT</span></span><span>
</span><span id="line-308"></span><span>      </span><span class="annot"><span class="annottext">(WriterT CustomSQLCTEs (TxET QErr IO) SQLExp
 -&gt; TxET QErr IO (SQLExp, CustomSQLCTEs))
-&gt; WriterT CustomSQLCTEs (TxET QErr IO) SQLExp
-&gt; TxET QErr IO (SQLExp, CustomSQLCTEs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Select -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SESelect"><span class="hs-identifier hs-var">S.SESelect</span></a></span><span>
</span><span id="line-309"></span><span>      </span><span class="annot"><span class="annottext">(Select -&gt; SQLExp)
-&gt; WriterT CustomSQLCTEs (TxET QErr IO) Select
-&gt; WriterT CustomSQLCTEs (TxET QErr IO) SQLExp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">UserInfo
-&gt; JsonAggSelect
-&gt; AnnSimpleSelect ('Postgres pgKind)
-&gt; WriterT CustomSQLCTEs (TxET QErr IO) Select
forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(Backend ('Postgres pgKind), PostgresAnnotatedFieldJSON pgKind,
 PostgresGenerateSQLSelect pgKind, MonadWriter CustomSQLCTEs m,
 MonadIO m, MonadError QErr m) =&gt;
UserInfo
-&gt; JsonAggSelect -&gt; AnnSimpleSelect ('Postgres pgKind) -&gt; m Select
</span><a href="Hasura.Backends.Postgres.Translate.Select.Simple.html#mkSQLSelect"><span class="hs-identifier hs-var">mkSQLSelect</span></a></span><span>
</span><span id="line-310"></span><span>        </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687789898"><span class="hs-identifier hs-var">userInfo</span></a></span><span>
</span><span id="line-311"></span><span>        </span><span class="annot"><span class="annottext">JsonAggSelect
</span><a href="Hasura.RQL.Types.Common.html#JASMultipleRows"><span class="hs-identifier hs-var">JASMultipleRows</span></a></span><span>
</span><span id="line-312"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Fields (AnnFieldG ('Postgres pgKind) Void SQLExp)
-&gt; SelectFromG ('Postgres pgKind) SQLExp
-&gt; TablePermG ('Postgres pgKind) SQLExp
-&gt; SelectArgsG ('Postgres pgKind) SQLExp
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; AnnSelectG
     ('Postgres pgKind) (AnnFieldG ('Postgres pgKind) Void) SQLExp
forall (b :: BackendType) (f :: * -&gt; *) v.
Fields (f v)
-&gt; SelectFromG b v
-&gt; TablePermG b v
-&gt; SelectArgsG b v
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; AnnSelectG b f v
</span><a href="Hasura.RQL.IR.Select.AnnSelectG.html#AnnSelectG"><span class="hs-identifier hs-var">AnnSelectG</span></a></span><span> </span><span class="annot"><span class="annottext">Fields (AnnFieldG ('Postgres pgKind) Void SQLExp)
</span><a href="#local-6989586621687789912"><span class="hs-identifier hs-var">selFlds</span></a></span><span> </span><span class="annot"><span class="annottext">SelectFromG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687789913"><span class="hs-identifier hs-var">tabFrom</span></a></span><span> </span><span class="annot"><span class="annottext">TablePermG ('Postgres pgKind) SQLExp
forall {b :: BackendType} {v}. TablePermG b v
</span><a href="#local-6989586621687789914"><span class="hs-identifier hs-var">tabPerm</span></a></span><span> </span><span class="annot"><span class="annottext">SelectArgsG ('Postgres pgKind) SQLExp
forall (backend :: BackendType) v. SelectArgsG backend v
</span><a href="Hasura.RQL.IR.Select.Args.html#noSelectArgs"><span class="hs-identifier hs-var">noSelectArgs</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621687789903"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe NamingCase
</span><a href="#local-6989586621687789904"><span class="hs-identifier hs-var">tCase</span></a></span><span>
</span><span id="line-313"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687789916"><span class="annot"><span class="annottext">selectWith :: SelectWith
</span><a href="#local-6989586621687789916"><span class="hs-identifier hs-var hs-var">selectWith</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-315"></span><span>        </span><span class="annot"><span class="annottext">[(TableAlias, TopLevelCTE)] -&gt; Select -&gt; SelectWith
forall statement.
[(TableAlias, statement)] -&gt; Select -&gt; SelectWithG statement
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SelectWith"><span class="hs-identifier hs-var">S.SelectWith</span></a></span><span>
</span><span id="line-316"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableAlias
</span><a href="#local-6989586621687789918"><span class="hs-identifier hs-var">rawAlias</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MutationCTE -&gt; TopLevelCTE
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#getMutationCTE"><span class="hs-identifier hs-var">getMutationCTE</span></a></span><span> </span><span class="annot"><span class="annottext">MutationCTE
</span><a href="#local-6989586621687789901"><span class="hs-identifier hs-var">cte</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-317"></span><span>              </span><span class="annot"><span class="annottext">[(TableAlias, TopLevelCTE)]
-&gt; [(TableAlias, TopLevelCTE)] -&gt; [(TableAlias, TopLevelCTE)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">CustomSQLCTEs -&gt; [(TableAlias, TopLevelCTE)]
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#customSQLToTopLevelCTEs"><span class="hs-identifier hs-var">customSQLToTopLevelCTEs</span></a></span><span> </span><span class="annot"><span class="annottext">CustomSQLCTEs
</span><a href="#local-6989586621687789906"><span class="hs-identifier hs-var">customSQLCTEs</span></a></span><span>
</span><span id="line-318"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>          </span><span class="annot"><span class="annottext">(Select -&gt; SelectWith) -&gt; Select -&gt; SelectWith
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Select
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#mkSelect"><span class="hs-identifier hs-var">S.mkSelect</span></a></span><span>
</span><span id="line-320"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">selExtr :: [Extractor]
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#selExtr"><span class="hs-identifier hs-var">S.selExtr</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-321"></span><span>                </span><span class="annot"><span class="annottext">SQLExp -&gt; Maybe ColumnAlias -&gt; Extractor
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#Extractor"><span class="hs-identifier hs-var">S.Extractor</span></a></span><span>
</span><span id="line-322"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[SQLExp] -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#applyJsonBuildObj"><span class="hs-identifier hs-var">S.applyJsonBuildObj</span></a></span><span>
</span><span id="line-323"></span><span>                      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;affected_rows&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-324"></span><span>                        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Select -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SESelect"><span class="hs-identifier hs-var">S.SESelect</span></a></span><span>
</span><span id="line-325"></span><span>                            </span><span class="annot"><span class="annottext">(Select -&gt; SQLExp) -&gt; Select -&gt; SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Select
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#mkSelect"><span class="hs-identifier hs-var">S.mkSelect</span></a></span><span>
</span><span id="line-326"></span><span>                              </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">selExtr :: [Extractor]
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#selExtr"><span class="hs-identifier hs-var">S.selExtr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SQLExp -&gt; Maybe ColumnAlias -&gt; Extractor
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#Extractor"><span class="hs-identifier hs-var">S.Extractor</span></a></span><span> </span><span class="annot"><span class="annottext">SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#countStar"><span class="hs-identifier hs-var">S.countStar</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ColumnAlias
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-327"></span><span>                                </span><span class="annot"><span class="annottext">selFrom :: Maybe FromExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#selFrom"><span class="hs-identifier hs-var">S.selFrom</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FromExp -&gt; Maybe FromExp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(FromExp -&gt; Maybe FromExp) -&gt; FromExp -&gt; Maybe FromExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[FromItem] -&gt; FromExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#FromExp"><span class="hs-identifier hs-var">S.FromExp</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TableIdentifier -&gt; FromItem
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#FIIdentifier"><span class="hs-identifier hs-var">S.FIIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687789929"><span class="hs-identifier hs-var">rawIdentifier</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-328"></span><span>                              </span><span class="hs-special">}</span><span>
</span><span id="line-329"></span><span>                        </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-330"></span><span>                        </span><span class="annot"><span class="annottext">Text -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#SELit"><span class="hs-identifier hs-var">S.SELit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;returning_columns&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-331"></span><span>                        </span><span class="annot"><span class="annottext">SQLExp
</span><a href="#local-6989586621687789905"><span class="hs-identifier hs-var">colSel</span></a></span><span>
</span><span id="line-332"></span><span>                      </span><span class="hs-special">]</span><span>
</span><span id="line-333"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>                  </span><span class="annot"><span class="annottext">Maybe ColumnAlias
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-335"></span><span>                  </span><span class="annot"><span class="annottext">Extractor -&gt; [Extractor] -&gt; [Extractor]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Extractor] -&gt; [Extractor] -&gt; Bool -&gt; [Extractor]
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SQLExp -&gt; Maybe ColumnAlias -&gt; Extractor
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#Extractor"><span class="hs-identifier hs-var">S.Extractor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableIdentifier -&gt; SQLExp
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#mkCheckErrorExp"><span class="hs-identifier hs-var">mkCheckErrorExp</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687789929"><span class="hs-identifier hs-var">rawIdentifier</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ColumnAlias
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MutationCTE -&gt; Bool
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#checkPermissionRequired"><span class="hs-identifier hs-var">checkPermissionRequired</span></a></span><span> </span><span class="annot"><span class="annottext">MutationCTE
</span><a href="#local-6989586621687789901"><span class="hs-identifier hs-var">cte</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687789931"><span class="annot"><span class="annottext">sqlText :: Query
</span><a href="#local-6989586621687789931"><span class="hs-identifier hs-var hs-var">sqlText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectWith -&gt; Query
</span><a href="Hasura.Backends.Postgres.Translate.Select.Internal.Helpers.html#toQuery"><span class="hs-identifier hs-var">toQuery</span></a></span><span> </span><span class="annot"><span class="annottext">SelectWith
</span><a href="#local-6989586621687789916"><span class="hs-identifier hs-var">selectWith</span></a></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687789142"><span class="annot"><a href="#local-6989586621687789932"><span class="hs-identifier hs-type">mutationTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Class.html#FromRes"><span class="hs-identifier hs-type">PG.FromRes</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789142"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Transaction.html#TxE"><span class="hs-identifier hs-type">PG.TxE</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789142"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-339"></span><span>      </span><span id="local-6989586621687789932"><span class="annot"><span class="annottext">mutationTx :: forall a. FromRes a =&gt; TxE QErr a
</span><a href="#local-6989586621687789932"><span class="hs-identifier hs-var hs-var">mutationTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-340"></span><span>        </span><span class="hs-comment">-- See Note [Prepared statements in Mutations]</span><span>
</span><span id="line-341"></span><span>        </span><span class="annot"><span class="annottext">(PGTxErr -&gt; QErr) -&gt; Query -&gt; [PrepArg] -&gt; Bool -&gt; TxET QErr IO a
forall (m :: * -&gt; *) a e.
(MonadIO m, FromRes a) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; [PrepArg] -&gt; Bool -&gt; TxET e m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Transaction.html#rawQE"><span class="hs-identifier hs-var">PG.rawQE</span></a></span><span> </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#dmlTxErrorHandler"><span class="hs-identifier hs-var">dmlTxErrorHandler</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621687789931"><span class="hs-identifier hs-var">sqlText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq PrepArg -&gt; [PrepArg]
forall a. Seq a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621687789902"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">MutationCTE -&gt; Bool
</span><a href="Hasura.Backends.Postgres.Translate.Returning.html#checkPermissionRequired"><span class="hs-identifier hs-var">checkPermissionRequired</span></a></span><span> </span><span class="annot"><span class="annottext">MutationCTE
</span><a href="#local-6989586621687789901"><span class="hs-identifier hs-var">cte</span></a></span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TxET QErr IO (MutateResp ('Postgres pgKind) TxtEncodedVal, Bool)
-&gt; TxE QErr (MutateResp ('Postgres pgKind) TxtEncodedVal)
forall (m :: * -&gt; *) a. MonadError QErr m =&gt; m (a, Bool) -&gt; m a
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#withCheckPermission"><span class="hs-identifier hs-var">withCheckPermission</span></a></span><span> </span><span class="annot"><span class="annottext">(TxET QErr IO (MutateResp ('Postgres pgKind) TxtEncodedVal, Bool)
 -&gt; TxE QErr (MutateResp ('Postgres pgKind) TxtEncodedVal))
-&gt; TxET QErr IO (MutateResp ('Postgres pgKind) TxtEncodedVal, Bool)
-&gt; TxE QErr (MutateResp ('Postgres pgKind) TxtEncodedVal)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal)
 -&gt; MutateResp ('Postgres pgKind) TxtEncodedVal)
-&gt; (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal), Bool)
-&gt; (MutateResp ('Postgres pgKind) TxtEncodedVal, Bool)
forall b c d. (b -&gt; c) -&gt; (b, d) -&gt; (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal)
-&gt; MutateResp ('Postgres pgKind) TxtEncodedVal
forall a. ViaJSON a -&gt; a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Class.html#getViaJSON"><span class="hs-identifier hs-var">PG.getViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">((ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal), Bool)
 -&gt; (MutateResp ('Postgres pgKind) TxtEncodedVal, Bool))
-&gt; (SingleRow
      (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal), Bool)
    -&gt; (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal), Bool))
-&gt; SingleRow
     (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal), Bool)
-&gt; (MutateResp ('Postgres pgKind) TxtEncodedVal, Bool)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SingleRow
  (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal), Bool)
-&gt; (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal), Bool)
forall a. SingleRow a -&gt; a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Class.html#getRow"><span class="hs-identifier hs-var">PG.getRow</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SingleRow
   (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal), Bool)
 -&gt; (MutateResp ('Postgres pgKind) TxtEncodedVal, Bool))
-&gt; TxET
     QErr
     IO
     (SingleRow
        (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal), Bool))
-&gt; TxET QErr IO (MutateResp ('Postgres pgKind) TxtEncodedVal, Bool)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TxET
  QErr
  IO
  (SingleRow
     (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal), Bool))
forall a. FromRes a =&gt; TxE QErr a
</span><a href="#local-6989586621687789932"><span class="hs-identifier hs-var">mutationTx</span></a></span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal)
-&gt; MutateResp ('Postgres pgKind) TxtEncodedVal
forall a. ViaJSON a -&gt; a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Class.html#getViaJSON"><span class="hs-identifier hs-var">PG.getViaJSON</span></a></span><span> </span><span class="annot"><span class="annottext">(ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal)
 -&gt; MutateResp ('Postgres pgKind) TxtEncodedVal)
-&gt; (SingleRow
      (Identity (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal)))
    -&gt; ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal))
-&gt; SingleRow
     (Identity (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal)))
-&gt; MutateResp ('Postgres pgKind) TxtEncodedVal
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Identity (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal))
-&gt; ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal)
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var">runIdentity</span></span><span> </span><span class="annot"><span class="annottext">(Identity (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal))
 -&gt; ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal))
-&gt; (SingleRow
      (Identity (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal)))
    -&gt; Identity
         (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal)))
-&gt; SingleRow
     (Identity (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal)))
-&gt; ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SingleRow
  (Identity (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal)))
-&gt; Identity (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal))
forall a. SingleRow a -&gt; a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/pg-client-0.1.0/opt/doc/html/pg-client/src/Database.PG.Query.Class.html#getRow"><span class="hs-identifier hs-var">PG.getRow</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(SingleRow
   (Identity (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal)))
 -&gt; MutateResp ('Postgres pgKind) TxtEncodedVal)
-&gt; TxET
     QErr
     IO
     (SingleRow
        (Identity (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal))))
-&gt; TxE QErr (MutateResp ('Postgres pgKind) TxtEncodedVal)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TxET
  QErr
  IO
  (SingleRow
     (Identity (ViaJSON (MutateResp ('Postgres pgKind) TxtEncodedVal))))
forall a. FromRes a =&gt; TxE QErr a
</span><a href="#local-6989586621687789932"><span class="hs-identifier hs-var">mutationTx</span></a></span><span>
</span><span id="line-346"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-347"></span><span>    </span><span id="local-6989586621687789918"><span class="annot"><span class="annottext">rawAlias :: TableAlias
</span><a href="#local-6989586621687789918"><span class="hs-identifier hs-var hs-var">rawAlias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; TableAlias
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#mkTableAlias"><span class="hs-identifier hs-var">S.mkTableAlias</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; TableAlias) -&gt; Text -&gt; TableAlias
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;mutres__&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">QualifiedTable -&gt; Text
forall a. ToTxt a =&gt; QualifiedObject a -&gt; Text
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#qualifiedObjectToText"><span class="hs-identifier hs-var">qualifiedObjectToText</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621687789899"><span class="hs-identifier hs-var">qt</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span id="local-6989586621687789929"><span class="annot"><span class="annottext">rawIdentifier :: TableIdentifier
</span><a href="#local-6989586621687789929"><span class="hs-identifier hs-var hs-var">rawIdentifier</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TableAlias -&gt; TableIdentifier
</span><a href="Hasura.Backends.Postgres.SQL.DML.html#tableAliasToIdentifier"><span class="hs-identifier hs-var">S.tableAliasToIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableAlias
</span><a href="#local-6989586621687789918"><span class="hs-identifier hs-var">rawAlias</span></a></span><span>
</span><span id="line-349"></span><span>    </span><span id="local-6989586621687789913"><span class="annot"><span class="annottext">tabFrom :: SelectFromG ('Postgres pgKind) SQLExp
</span><a href="#local-6989586621687789913"><span class="hs-identifier hs-var hs-var">tabFrom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FIIdentifier -&gt; SelectFromG ('Postgres pgKind) SQLExp
forall (b :: BackendType) v. FIIdentifier -&gt; SelectFromG b v
</span><a href="Hasura.RQL.IR.Select.From.html#FromIdentifier"><span class="hs-identifier hs-var">FromIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">(FIIdentifier -&gt; SelectFromG ('Postgres pgKind) SQLExp)
-&gt; FIIdentifier -&gt; SelectFromG ('Postgres pgKind) SQLExp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FIIdentifier
</span><a href="Hasura.RQL.IR.Select.From.html#FIIdentifier"><span class="hs-identifier hs-var">FIIdentifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableIdentifier -&gt; Text
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#unTableIdentifier"><span class="hs-identifier hs-var">unTableIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">TableIdentifier
</span><a href="#local-6989586621687789929"><span class="hs-identifier hs-var">rawIdentifier</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>    </span><span id="local-6989586621687789914"><span class="annot"><span class="annottext">tabPerm :: TablePermG b v
</span><a href="#local-6989586621687789914"><span class="hs-identifier hs-var hs-var">tabPerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnnBoolExp b v -&gt; Maybe Int -&gt; TablePermG b v
forall (b :: BackendType) v.
AnnBoolExp b v -&gt; Maybe Int -&gt; TablePermG b v
</span><a href="Hasura.RQL.IR.Select.TablePerm.html#TablePerm"><span class="hs-identifier hs-var">TablePerm</span></a></span><span> </span><span class="annot"><span class="annottext">AnnBoolExp b v
forall (backend :: BackendType) scalar. AnnBoolExp backend scalar
</span><a href="Hasura.RQL.IR.BoolExp.html#annBoolExpTrue"><span class="hs-identifier hs-var">annBoolExpTrue</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-351"></span><span>    </span><span id="local-6989586621687789912"><span class="annot"><span class="annottext">selFlds :: Fields (AnnFieldG ('Postgres pgKind) Void SQLExp)
</span><a href="#local-6989586621687789912"><span class="hs-identifier hs-var hs-var">selFlds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((ColumnInfo ('Postgres pgKind)
  -&gt; (FieldName, AnnFieldG ('Postgres pgKind) Void SQLExp))
 -&gt; [ColumnInfo ('Postgres pgKind)]
 -&gt; Fields (AnnFieldG ('Postgres pgKind) Void SQLExp))
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; (ColumnInfo ('Postgres pgKind)
    -&gt; (FieldName, AnnFieldG ('Postgres pgKind) Void SQLExp))
-&gt; Fields (AnnFieldG ('Postgres pgKind) Void SQLExp)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(ColumnInfo ('Postgres pgKind)
 -&gt; (FieldName, AnnFieldG ('Postgres pgKind) Void SQLExp))
-&gt; [ColumnInfo ('Postgres pgKind)]
-&gt; Fields (AnnFieldG ('Postgres pgKind) Void SQLExp)
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[ColumnInfo ('Postgres pgKind)]
</span><a href="#local-6989586621687789900"><span class="hs-identifier hs-var">cols</span></a></span><span>
</span><span id="line-352"></span><span>      </span><span class="annot"><span class="annottext">((ColumnInfo ('Postgres pgKind)
  -&gt; (FieldName, AnnFieldG ('Postgres pgKind) Void SQLExp))
 -&gt; Fields (AnnFieldG ('Postgres pgKind) Void SQLExp))
-&gt; (ColumnInfo ('Postgres pgKind)
    -&gt; (FieldName, AnnFieldG ('Postgres pgKind) Void SQLExp))
-&gt; Fields (AnnFieldG ('Postgres pgKind) Void SQLExp)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621687789947"><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
</span><a href="#local-6989586621687789947"><span class="hs-identifier hs-var">ci</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType). Backend b =&gt; Column b -&gt; FieldName
</span><a href="Hasura.RQL.Types.Column.html#fromCol"><span class="hs-identifier hs-var">fromCol</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789040"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Column ('Postgres pgKind) -&gt; FieldName)
-&gt; Column ('Postgres pgKind) -&gt; FieldName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind) -&gt; Column ('Postgres pgKind)
forall (b :: BackendType). ColumnInfo b -&gt; Column b
</span><a href="Hasura.RQL.Types.Column.html#ciColumn"><span class="hs-identifier hs-var">ciColumn</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
</span><a href="#local-6989586621687789947"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
-&gt; AnnFieldG ('Postgres pgKind) Void SQLExp
forall (backend :: BackendType) r v.
ColumnInfo backend -&gt; AnnFieldG backend r v
</span><a href="Hasura.RQL.IR.Select.html#mkAnnColumnFieldAsText"><span class="hs-identifier hs-var">mkAnnColumnFieldAsText</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres pgKind)
</span><a href="#local-6989586621687789947"><span class="hs-identifier hs-var">ci</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="hs-comment">-------------- Validating insert input using external HTTP webhook -----------------------</span><span>
</span><span id="line-355"></span><span class="hs-keyword">type</span><span> </span><span id="ValidateInputPayloadVersion"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#ValidateInputPayloadVersion"><span class="hs-identifier hs-var">ValidateInputPayloadVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#validateInputPayloadVersion"><span class="hs-identifier hs-type">validateInputPayloadVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#ValidateInputPayloadVersion"><span class="hs-identifier hs-type">ValidateInputPayloadVersion</span></a></span><span>
</span><span id="line-358"></span><span id="validateInputPayloadVersion"><span class="annot"><span class="annottext">validateInputPayloadVersion :: Int
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#validateInputPayloadVersion"><span class="hs-identifier hs-var hs-var">validateInputPayloadVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-keyword">newtype</span><span> </span><span id="ValidateInputErrorResponse"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#ValidateInputErrorResponse"><span class="hs-identifier hs-var">ValidateInputErrorResponse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ValidateInputErrorResponse"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#ValidateInputErrorResponse"><span class="hs-identifier hs-var">ValidateInputErrorResponse</span></a></span></span><span> </span><span class="hs-special">{</span><span id="_vierMessage"><span class="annot"><span class="annottext">ValidateInputErrorResponse -&gt; Text
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_vierMessage"><span class="hs-identifier hs-var hs-var">_vierMessage</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/text-2.0.1-d0f6d61f5277bae932134563876cbceb4967915f364959864c72abbc2978d8ed/share/doc/html/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621687789954"><span id="local-6989586621687789959"><span id="local-6989586621687789963"><span class="annot"><span class="annottext">Int -&gt; ValidateInputErrorResponse -&gt; ShowS
[ValidateInputErrorResponse] -&gt; ShowS
ValidateInputErrorResponse -&gt; String
(Int -&gt; ValidateInputErrorResponse -&gt; ShowS)
-&gt; (ValidateInputErrorResponse -&gt; String)
-&gt; ([ValidateInputErrorResponse] -&gt; ShowS)
-&gt; Show ValidateInputErrorResponse
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; ValidateInputErrorResponse -&gt; ShowS
showsPrec :: Int -&gt; ValidateInputErrorResponse -&gt; ShowS
$cshow :: ValidateInputErrorResponse -&gt; String
show :: ValidateInputErrorResponse -&gt; String
$cshowList :: [ValidateInputErrorResponse] -&gt; ShowS
showList :: [ValidateInputErrorResponse] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687789966"><span id="local-6989586621687789971"><span class="annot"><span class="annottext">ValidateInputErrorResponse -&gt; ValidateInputErrorResponse -&gt; Bool
(ValidateInputErrorResponse -&gt; ValidateInputErrorResponse -&gt; Bool)
-&gt; (ValidateInputErrorResponse
    -&gt; ValidateInputErrorResponse -&gt; Bool)
-&gt; Eq ValidateInputErrorResponse
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ValidateInputErrorResponse -&gt; ValidateInputErrorResponse -&gt; Bool
== :: ValidateInputErrorResponse -&gt; ValidateInputErrorResponse -&gt; Bool
$c/= :: ValidateInputErrorResponse -&gt; ValidateInputErrorResponse -&gt; Bool
/= :: ValidateInputErrorResponse -&gt; ValidateInputErrorResponse -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-special">$</span><span id="local-6989586621687789976"><span id="local-6989586621687789984"><span id="local-6989586621687789988"><span id="local-6989586621687789995"><span id="local-6989586621687790001"><span id="local-6989586621687790005"><span class="hs-special">(</span><span class="hs-identifier">J.deriveJSON</span><span> </span><span class="hs-identifier">hasuraJSON</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">ValidateInputErrorResponse</span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="hs-keyword">data</span><span> </span><span id="HttpHandlerLog"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#HttpHandlerLog"><span class="hs-identifier hs-var">HttpHandlerLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HttpHandlerLog"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#HttpHandlerLog"><span class="hs-identifier hs-var">HttpHandlerLog</span></a></span></span><span>
</span><span id="line-366"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_hhlUrl"><span class="annot"><span class="annottext">HttpHandlerLog -&gt; Text
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_hhlUrl"><span class="hs-identifier hs-var hs-var">_hhlUrl</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/text-2.0.1-d0f6d61f5277bae932134563876cbceb4967915f364959864c72abbc2978d8ed/share/doc/html/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-367"></span><span>    </span><span id="_hhlRequest"><span class="annot"><span class="annottext">HttpHandlerLog -&gt; Value
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_hhlRequest"><span class="hs-identifier hs-var hs-var">_hhlRequest</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">J.Value</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-368"></span><span>    </span><span id="_hhlRequestHeaders"><span class="annot"><span class="annottext">HttpHandlerLog -&gt; [HeaderConf]
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_hhlRequestHeaders"><span class="hs-identifier hs-var hs-var">_hhlRequestHeaders</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Headers.html#HeaderConf"><span class="hs-identifier hs-type">HeaderConf</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-369"></span><span>    </span><span id="_hhlResponse"><span class="annot"><span class="annottext">HttpHandlerLog -&gt; Value
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_hhlResponse"><span class="hs-identifier hs-var hs-var">_hhlResponse</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">J.Value</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-370"></span><span>    </span><span id="_hhlResponseStatus"><span class="annot"><span class="annottext">HttpHandlerLog -&gt; Int
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#_hhlResponseStatus"><span class="hs-identifier hs-var hs-var">_hhlResponseStatus</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621687790032"><span id="local-6989586621687790042"><span id="local-6989586621687790046"><span class="annot"><span class="annottext">Int -&gt; HttpHandlerLog -&gt; ShowS
[HttpHandlerLog] -&gt; ShowS
HttpHandlerLog -&gt; String
(Int -&gt; HttpHandlerLog -&gt; ShowS)
-&gt; (HttpHandlerLog -&gt; String)
-&gt; ([HttpHandlerLog] -&gt; ShowS)
-&gt; Show HttpHandlerLog
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; HttpHandlerLog -&gt; ShowS
showsPrec :: Int -&gt; HttpHandlerLog -&gt; ShowS
$cshow :: HttpHandlerLog -&gt; String
show :: HttpHandlerLog -&gt; String
$cshowList :: [HttpHandlerLog] -&gt; ShowS
showList :: [HttpHandlerLog] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="hs-special">$</span><span id="local-6989586621687790050"><span id="local-6989586621687790071"><span id="local-6989586621687790086"><span id="local-6989586621687790090"><span class="hs-special">(</span><span class="hs-identifier">J.deriveToJSON</span><span> </span><span class="hs-identifier">hasuraJSON</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">HttpHandlerLog</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-keyword">data</span><span> </span><span id="ValidateInsertInputLog"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#ValidateInsertInputLog"><span class="hs-identifier hs-var">ValidateInsertInputLog</span></a></span></span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="VIILHttpHandler"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#VIILHttpHandler"><span class="hs-identifier hs-var">VIILHttpHandler</span></a></span></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#HttpHandlerLog"><span class="hs-identifier hs-type">HttpHandlerLog</span></a></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621687790113"><span id="local-6989586621687790117"><span id="local-6989586621687790120"><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#ToJSON"><span class="hs-identifier hs-type">J.ToJSON</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#ValidateInsertInputLog"><span class="hs-identifier hs-type">ValidateInsertInputLog</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-380"></span><span>  </span><span id="local-6989586621687790135"><span class="annot"><span class="annottext">toJSON :: ValidateInsertInputLog -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#VIILHttpHandler"><span class="hs-identifier hs-type">VIILHttpHandler</span></a></span><span> </span><span id="local-6989586621687790136"><span class="annot"><span class="annottext">HttpHandlerLog
</span><a href="#local-6989586621687790136"><span class="hs-identifier hs-var">httpHandlerLog</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-381"></span><span>    </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">J.object</span></a></span><span> </span><span class="annot"><span class="annottext">([Pair] -&gt; Value) -&gt; [Pair] -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;type&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; String -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">J..=</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;http&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;details&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">J..=</span></a></span><span> </span><span class="annot"><span class="annottext">HttpHandlerLog -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var">J.toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">HttpHandlerLog
</span><a href="#local-6989586621687790136"><span class="hs-identifier hs-var">httpHandlerLog</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.Logging.html#ToEngineLog"><span class="hs-identifier hs-type">L.ToEngineLog</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#ValidateInsertInputLog"><span class="hs-identifier hs-type">ValidateInsertInputLog</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">L.Hasura</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-384"></span><span>  </span><span id="local-6989586621687790146"><span class="annot"><span class="annottext">toEngineLog :: ValidateInsertInputLog -&gt; (LogLevel, EngineLogType Hasura, Value)
</span><a href="#local-6989586621687790146"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEngineLog</span></a></span></span><span> </span><span id="local-6989586621687790148"><span class="annot"><span class="annottext">ValidateInsertInputLog
</span><a href="#local-6989586621687790148"><span class="hs-identifier hs-var">ahl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LogLevel
</span><a href="Hasura.Logging.html#LevelInfo"><span class="hs-identifier hs-var">L.LevelInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EngineLogType Hasura
</span><a href="Hasura.Logging.html#ELTValidateInputLog"><span class="hs-identifier hs-var">L.ELTValidateInputLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ValidateInsertInputLog -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var">J.toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">ValidateInsertInputLog
</span><a href="#local-6989586621687790148"><span class="hs-identifier hs-var">ahl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">-- | Map of table name and the value that is being inserted for that table</span><span>
</span><span id="line-387"></span><span class="hs-comment">-- This map is helpful for collecting all the insert mutation arguments for the</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- nested tables and then sending them all at onve to the input validation webhook.</span><span>
</span><span id="line-389"></span><span class="hs-keyword">type</span><span> </span><span id="InsertValidationPayloadMap"><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#InsertValidationPayloadMap"><span class="hs-identifier hs-var">InsertValidationPayloadMap</span></a></span></span><span> </span><span id="local-6989586621687790151"><span class="annot"><a href="#local-6989586621687790151"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/insert-ordered-containers-0.2.5.1-b5ad8e22c80bc291a2f581fb78a4448e46180aa38110e81c957f693abd1dc222/share/doc/html/src/Data.HashMap.Strict.InsOrd.html#InsOrdHashMap"><span class="hs-identifier hs-type">InsOrdHashMap.InsOrdHashMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#TableName"><span class="hs-identifier hs-type">TableName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687790151"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.IR.Insert.html#AnnotatedInsertRow"><span class="hs-identifier hs-type">IR.AnnotatedInsertRow</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687790151"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687790151"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Permission.html#ValidateInput"><span class="hs-identifier hs-type">ValidateInput</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#ResolvedWebhook"><span class="hs-identifier hs-type">ResolvedWebhook</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#validateUpdateMutation"><span class="hs-identifier hs-type">validateUpdateMutation</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687789209"><span class="annot"><a href="#local-6989586621687789209"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span> </span><span id="local-6989586621687789201"><span class="annot"><a href="#local-6989586621687789201"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789201"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687789201"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Tracing.Class.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789201"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-394"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Environment.html#Environment"><span class="hs-identifier hs-type">Env.Environment</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-395"></span><span>  </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-client-0.7.13.1-88628f48a025e46598ca658ea231eb27d6340417f49e950fbf8c438edb3ebbdc/share/doc/html/src/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">HTTP.Manager</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-396"></span><span>  </span><span class="annot"><a href="Hasura.Logging.html#Logger"><span class="hs-identifier hs-type">L.Logger</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">L.Hasura</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-397"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-398"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#ResolvedWebhook"><span class="hs-identifier hs-type">ResolvedWebhook</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Headers.html#HeaderConf"><span class="hs-identifier hs-type">HeaderConf</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-400"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#Timeout"><span class="hs-identifier hs-type">Timeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-401"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-402"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-types-0.12.3-50f0bdaf50e249a664c6f7a424df2a1a996a248b4dcc1ea8a009a9576cae9524/share/doc/html/src/Network.HTTP.Types.Header.html#Header"><span class="hs-identifier hs-type">HTTP.Header</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-403"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Update.html#AnnotatedUpdateG"><span class="hs-identifier hs-type">IR.AnnotatedUpdateG</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789209"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789209"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-404"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashMap.Internal.html#HashMap"><span class="hs-identifier hs-type">HashMap</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html#Name"><span class="hs-identifier hs-type">G.Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html#Value"><span class="hs-identifier hs-type">G.Value</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/schema-parsers-1.0.0/opt/doc/html/schema-parsers/src/Hasura.GraphQL.Parser.Variable.html#Variable"><span class="hs-identifier hs-type">G.Variable</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-405"></span><span>  </span><span class="annot"><a href="#local-6989586621687789201"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span id="validateUpdateMutation"><span class="annot"><span class="annottext">validateUpdateMutation :: forall (pgKind :: PostgresKind) (m :: * -&gt; *).
(MonadError QErr m, MonadIO m, MonadTrace m) =&gt;
Environment
-&gt; Manager
-&gt; Logger Hasura
-&gt; UserInfo
-&gt; ResolvedWebhook
-&gt; [HeaderConf]
-&gt; Timeout
-&gt; Bool
-&gt; [Header]
-&gt; AnnotatedUpdateG
     ('Postgres pgKind) Void (UnpreparedValue ('Postgres pgKind))
-&gt; Maybe (HashMap Name (Value Variable))
-&gt; m ()
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#validateUpdateMutation"><span class="hs-identifier hs-var hs-var">validateUpdateMutation</span></a></span></span><span> </span><span id="local-6989586621687790181"><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621687790181"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621687790182"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621687790182"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621687790183"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621687790183"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621687790184"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687790184"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621687790185"><span class="annot"><span class="annottext">ResolvedWebhook
</span><a href="#local-6989586621687790185"><span class="hs-identifier hs-var">resolvedWebHook</span></a></span></span><span> </span><span id="local-6989586621687790186"><span class="annot"><span class="annottext">[HeaderConf]
</span><a href="#local-6989586621687790186"><span class="hs-identifier hs-var">confHeaders</span></a></span></span><span> </span><span id="local-6989586621687790187"><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621687790187"><span class="hs-identifier hs-var">timeout</span></a></span></span><span> </span><span id="local-6989586621687790188"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687790188"><span class="hs-identifier hs-var">forwardClientHeaders</span></a></span></span><span> </span><span id="local-6989586621687790189"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621687790189"><span class="hs-identifier hs-var">reqHeaders</span></a></span></span><span> </span><span id="local-6989586621687790190"><span class="annot"><span class="annottext">AnnotatedUpdateG
  ('Postgres pgKind) Void (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687790190"><span class="hs-identifier hs-var">updateOperation</span></a></span></span><span> </span><span id="local-6989586621687790191"><span class="annot"><span class="annottext">Maybe (HashMap Name (Value Variable))
</span><a href="#local-6989586621687790191"><span class="hs-identifier hs-var">maybeSelSetArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-407"></span><span>  </span><span id="local-6989586621687790192"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621687790192"><span class="hs-identifier hs-var">inputData</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-408"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (HashMap Name (Value Variable))
</span><a href="#local-6989586621687790191"><span class="hs-identifier hs-var">maybeSelSetArgs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-409"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621687790193"><span class="annot"><span class="annottext">HashMap Name (Value Variable)
</span><a href="#local-6989586621687790193"><span class="hs-identifier hs-var">arguments</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-410"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnotatedUpdateG
  ('Postgres pgKind) Void (UnpreparedValue ('Postgres pgKind))
-&gt; UpdateVariant
     ('Postgres pgKind) (UnpreparedValue ('Postgres pgKind))
forall (b :: BackendType) r v.
AnnotatedUpdateG b r v -&gt; UpdateVariant b v
</span><a href="Hasura.RQL.IR.Update.html#_auUpdateVariant"><span class="hs-identifier hs-var">IR._auUpdateVariant</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedUpdateG
  ('Postgres pgKind) Void (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687790190"><span class="hs-identifier hs-var">updateOperation</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-411"></span><span>          </span><span class="hs-comment">-- Mutation arguments for single update (eg: update_customer) are</span><span>
</span><span id="line-412"></span><span>          </span><span class="hs-comment">-- present as seperate root fields of the selection set.</span><span>
</span><span id="line-413"></span><span>          </span><span class="hs-comment">-- eg:</span><span>
</span><span id="line-414"></span><span>          </span><span class="annot"><a href="Hasura.Backends.Postgres.Types.Update.html#SingleBatch"><span class="hs-identifier hs-type">Postgres.SingleBatch</span></a></span><span> </span><span class="annot"><span class="annottext">UpdateBatch
  ('Postgres pgKind)
  UpdateOpExpression
  (UnpreparedValue ('Postgres pgKind))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-415"></span><span>            </span><span class="hs-comment">-- this constructs something like: {&quot;_set&quot;:{&quot;name&quot;: {&quot;_eq&quot;: &quot;abc&quot;}}, &quot;where&quot;:{&quot;id&quot;:{&quot;_eq&quot;:10}}}</span><span>
</span><span id="line-416"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687790196"><span class="annot"><span class="annottext">singleBatchinputVal :: Value
</span><a href="#local-6989586621687790196"><span class="hs-identifier hs-var hs-var">singleBatchinputVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-417"></span><span>                  </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">J.object</span></a></span><span>
</span><span id="line-418"></span><span>                    </span><span class="annot"><span class="annottext">([Pair] -&gt; Value) -&gt; [Pair] -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Name, Value Variable) -&gt; Pair)
-&gt; [(Name, Value Variable)] -&gt; [Pair]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-419"></span><span>                      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621687790197"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687790197"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687790198"><span class="annot"><span class="annottext">Value Variable
</span><a href="#local-6989586621687790198"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Key
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Key.html#fromText"><span class="hs-identifier hs-var">J.fromText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html#unName"><span class="hs-identifier hs-var">G.unName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687790197"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">J..=</span></a></span><span> </span><span class="annot"><span class="annottext">Value Variable -&gt; Value
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/schema-parsers-1.0.0/opt/doc/html/schema-parsers/src/Hasura.GraphQL.Parser.Internal.Convert.html#graphQLToJSON"><span class="hs-identifier hs-var">graphQLToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Value Variable
</span><a href="#local-6989586621687790198"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap Name (Value Variable) -&gt; [(Name, Value Variable)]
forall k v. HashMap k v -&gt; [(k, v)]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashMap.Internal.html#toList"><span class="hs-identifier hs-var">HashMap.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(HashMap Name (Value Variable) -&gt; [(Name, Value Variable)])
-&gt; HashMap Name (Value Variable) -&gt; [(Name, Value Variable)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashMap Name (Value Variable)
</span><a href="#local-6989586621687790193"><span class="hs-identifier hs-var">arguments</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>            </span><span class="annot"><span class="annottext">Value -&gt; m Value
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">J.object</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;input&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; [Value] -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">J..=</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621687790196"><span class="hs-identifier hs-var">singleBatchinputVal</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>          </span><span class="hs-comment">-- Mutation arguments for multiple updates (eg:</span><span>
</span><span id="line-423"></span><span>          </span><span class="hs-comment">-- update_customer_many) are present in the &quot;updates&quot; field of the</span><span>
</span><span id="line-424"></span><span>          </span><span class="hs-comment">-- selection set.</span><span>
</span><span id="line-425"></span><span>          </span><span class="hs-comment">-- Look for &quot;updates&quot; field and get the mutation arguments from it.</span><span>
</span><span id="line-426"></span><span>          </span><span class="hs-comment">-- eg: {&quot;updates&quot;: [{&quot;_set&quot;:{&quot;id&quot;:{&quot;_eq&quot;:10}}, &quot;where&quot;:{&quot;name&quot;:{&quot;_eq&quot;:&quot;abc&quot;}}}]}</span><span>
</span><span id="line-427"></span><span>          </span><span class="annot"><a href="Hasura.Backends.Postgres.Types.Update.html#MultipleBatches"><span class="hs-identifier hs-type">Postgres.MultipleBatches</span></a></span><span> </span><span class="annot"><span class="annottext">[UpdateBatch
   ('Postgres pgKind)
   UpdateOpExpression
   (UnpreparedValue ('Postgres pgKind))]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-428"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; HashMap Name (Value Variable) -&gt; Maybe (Value Variable)
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashMap.Internal.html#lookup"><span class="hs-identifier hs-var">HashMap.lookup</span></a></span><span> </span><span class="hs-special">$$</span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html#litName"><span class="hs-identifier hs-type">G.litName</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;updates&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashMap Name (Value Variable)
</span><a href="#local-6989586621687790193"><span class="hs-identifier hs-var">arguments</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-429"></span><span>              </span><span class="annot"><span class="annottext">Maybe (Value Variable)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value -&gt; m Value
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; m Value) -&gt; Value -&gt; m Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.Internal.html#Null"><span class="hs-identifier hs-var">J.Null</span></a></span><span>
</span><span id="line-430"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621687790209"><span class="annot"><span class="annottext">Value Variable
</span><a href="#local-6989586621687790209"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; m Value
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; m Value) -&gt; Value -&gt; m Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">J.object</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;input&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">J..=</span></a></span><span> </span><span class="annot"><span class="annottext">Value Variable -&gt; Value
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/schema-parsers-1.0.0/opt/doc/html/schema-parsers/src/Hasura.GraphQL.Parser.Internal.Convert.html#graphQLToJSON"><span class="hs-identifier hs-var">graphQLToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Value Variable
</span><a href="#local-6989586621687790209"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>      </span><span class="annot"><span class="annottext">Maybe (HashMap Name (Value Variable))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value -&gt; m Value
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.Internal.html#Null"><span class="hs-identifier hs-var">J.Null</span></a></span><span>
</span><span id="line-432"></span><span>  </span><span class="annot"><span class="annottext">Environment
-&gt; Manager
-&gt; Logger Hasura
-&gt; UserInfo
-&gt; ResolvedWebhook
-&gt; [HeaderConf]
-&gt; Timeout
-&gt; Bool
-&gt; [Header]
-&gt; Value
-&gt; m ()
forall (m :: * -&gt; *).
(MonadError QErr m, MonadIO m, MonadTrace m) =&gt;
Environment
-&gt; Manager
-&gt; Logger Hasura
-&gt; UserInfo
-&gt; ResolvedWebhook
-&gt; [HeaderConf]
-&gt; Timeout
-&gt; Bool
-&gt; [Header]
-&gt; Value
-&gt; m ()
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#validateMutation"><span class="hs-identifier hs-var">validateMutation</span></a></span><span> </span><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621687790181"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621687790182"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621687790183"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687790184"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedWebhook
</span><a href="#local-6989586621687790185"><span class="hs-identifier hs-var">resolvedWebHook</span></a></span><span> </span><span class="annot"><span class="annottext">[HeaderConf]
</span><a href="#local-6989586621687790186"><span class="hs-identifier hs-var">confHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621687790187"><span class="hs-identifier hs-var">timeout</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687790188"><span class="hs-identifier hs-var">forwardClientHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621687790189"><span class="hs-identifier hs-var">reqHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621687790192"><span class="hs-identifier hs-var">inputData</span></a></span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#validateDeleteMutation"><span class="hs-identifier hs-type">validateDeleteMutation</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687789229"><span class="annot"><a href="#local-6989586621687789229"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621687789230"><span class="annot"><a href="#local-6989586621687789230"><span class="hs-identifier hs-type">pgKind</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789229"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687789229"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Tracing.Class.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789229"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-437"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Environment.html#Environment"><span class="hs-identifier hs-type">Env.Environment</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-438"></span><span>  </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-client-0.7.13.1-88628f48a025e46598ca658ea231eb27d6340417f49e950fbf8c438edb3ebbdc/share/doc/html/src/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">HTTP.Manager</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-439"></span><span>  </span><span class="annot"><a href="Hasura.Logging.html#Logger"><span class="hs-identifier hs-type">L.Logger</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">L.Hasura</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-440"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-441"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#ResolvedWebhook"><span class="hs-identifier hs-type">ResolvedWebhook</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Headers.html#HeaderConf"><span class="hs-identifier hs-type">HeaderConf</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-443"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#Timeout"><span class="hs-identifier hs-type">Timeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-444"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-types-0.12.3-50f0bdaf50e249a664c6f7a424df2a1a996a248b4dcc1ea8a009a9576cae9524/share/doc/html/src/Network.HTTP.Types.Header.html#Header"><span class="hs-identifier hs-type">HTTP.Header</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-446"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Delete.html#AnnDelG"><span class="hs-identifier hs-type">IR.AnnDelG</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789230"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Value.html#UnpreparedValue"><span class="hs-identifier hs-type">IR.UnpreparedValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.RQL.Types.BackendType.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789230"><span class="hs-identifier hs-type">pgKind</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-447"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashMap.Internal.html#HashMap"><span class="hs-identifier hs-type">HashMap</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html#Name"><span class="hs-identifier hs-type">G.Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.html#Value"><span class="hs-identifier hs-type">G.Value</span></a></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/schema-parsers-1.0.0/opt/doc/html/schema-parsers/src/Hasura.GraphQL.Parser.Variable.html#Variable"><span class="hs-identifier hs-type">G.Variable</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-448"></span><span>  </span><span class="annot"><a href="#local-6989586621687789229"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span id="validateDeleteMutation"><span class="annot"><span class="annottext">validateDeleteMutation :: forall (m :: * -&gt; *) (pgKind :: PostgresKind).
(MonadError QErr m, MonadIO m, MonadTrace m) =&gt;
Environment
-&gt; Manager
-&gt; Logger Hasura
-&gt; UserInfo
-&gt; ResolvedWebhook
-&gt; [HeaderConf]
-&gt; Timeout
-&gt; Bool
-&gt; [Header]
-&gt; AnnDelG
     ('Postgres pgKind) Void (UnpreparedValue ('Postgres pgKind))
-&gt; Maybe (HashMap Name (Value Variable))
-&gt; m ()
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#validateDeleteMutation"><span class="hs-identifier hs-var hs-var">validateDeleteMutation</span></a></span></span><span> </span><span id="local-6989586621687790234"><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621687790234"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621687790235"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621687790235"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621687790236"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621687790236"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621687790237"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687790237"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span id="local-6989586621687790238"><span class="annot"><span class="annottext">ResolvedWebhook
</span><a href="#local-6989586621687790238"><span class="hs-identifier hs-var">resolvedWebHook</span></a></span></span><span> </span><span id="local-6989586621687790239"><span class="annot"><span class="annottext">[HeaderConf]
</span><a href="#local-6989586621687790239"><span class="hs-identifier hs-var">confHeaders</span></a></span></span><span> </span><span id="local-6989586621687790240"><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621687790240"><span class="hs-identifier hs-var">timeout</span></a></span></span><span> </span><span id="local-6989586621687790241"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687790241"><span class="hs-identifier hs-var">forwardClientHeaders</span></a></span></span><span> </span><span id="local-6989586621687790242"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621687790242"><span class="hs-identifier hs-var">reqHeaders</span></a></span></span><span> </span><span id="local-6989586621687790243"><span class="annot"><span class="annottext">AnnDelG
  ('Postgres pgKind) Void (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687790243"><span class="hs-identifier hs-var">deleteOperation</span></a></span></span><span> </span><span id="local-6989586621687790244"><span class="annot"><span class="annottext">Maybe (HashMap Name (Value Variable))
</span><a href="#local-6989586621687790244"><span class="hs-identifier hs-var">maybeSelSetArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-450"></span><span>  </span><span id="local-6989586621687790245"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621687790245"><span class="hs-identifier hs-var">inputData</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-451"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (HashMap Name (Value Variable))
</span><a href="#local-6989586621687790244"><span class="hs-identifier hs-var">maybeSelSetArgs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-452"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621687790246"><span class="annot"><span class="annottext">HashMap Name (Value Variable)
</span><a href="#local-6989586621687790246"><span class="hs-identifier hs-var">arguments</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-453"></span><span>        </span><span class="hs-comment">-- this constructs something like: {&quot;where&quot;:{&quot;id&quot;:{&quot;_eq&quot;:10}}}</span><span>
</span><span id="line-454"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687790247"><span class="annot"><span class="annottext">deleteInputVal :: Value
</span><a href="#local-6989586621687790247"><span class="hs-identifier hs-var hs-var">deleteInputVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-455"></span><span>              </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">J.object</span></a></span><span>
</span><span id="line-456"></span><span>                </span><span class="annot"><span class="annottext">([Pair] -&gt; Value) -&gt; [Pair] -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Name, Value Variable) -&gt; Pair)
-&gt; [(Name, Value Variable)] -&gt; [Pair]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-457"></span><span>                  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621687790248"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687790248"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621687790249"><span class="annot"><span class="annottext">Value Variable
</span><a href="#local-6989586621687790249"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Key
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Key.html#fromText"><span class="hs-identifier hs-var">J.fromText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/graphql-parser-0.2.0.0/opt/doc/html/graphql-parser/src/Language.GraphQL.Draft.Syntax.Name.html#unName"><span class="hs-identifier hs-var">G.unName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621687790248"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">J..=</span></a></span><span> </span><span class="annot"><span class="annottext">Value Variable -&gt; Value
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/schema-parsers-1.0.0/opt/doc/html/schema-parsers/src/Hasura.GraphQL.Parser.Internal.Convert.html#graphQLToJSON"><span class="hs-identifier hs-var">graphQLToJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Value Variable
</span><a href="#local-6989586621687790249"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap Name (Value Variable) -&gt; [(Name, Value Variable)]
forall k v. HashMap k v -&gt; [(k, v)]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashMap.Internal.html#toList"><span class="hs-identifier hs-var">HashMap.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(HashMap Name (Value Variable) -&gt; [(Name, Value Variable)])
-&gt; HashMap Name (Value Variable) -&gt; [(Name, Value Variable)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashMap Name (Value Variable)
</span><a href="#local-6989586621687790246"><span class="hs-identifier hs-var">arguments</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnDelG
  ('Postgres pgKind) Void (UnpreparedValue ('Postgres pgKind))
-&gt; Bool
forall (b :: BackendType) r v. AnnDelG b r v -&gt; Bool
</span><a href="Hasura.RQL.IR.Delete.html#_adIsDeleteByPk"><span class="hs-identifier hs-var">_adIsDeleteByPk</span></a></span><span> </span><span class="annot"><span class="annottext">AnnDelG
  ('Postgres pgKind) Void (UnpreparedValue ('Postgres pgKind))
</span><a href="#local-6989586621687790243"><span class="hs-identifier hs-var">deleteOperation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-comment">-- If the delete operation is delete_&lt;table&gt;_by_pk, then we need to</span><span>
</span><span id="line-461"></span><span>          </span><span class="hs-comment">-- include the pk_columns field manually in the input payload. This</span><span>
</span><span id="line-462"></span><span>          </span><span class="hs-comment">-- is needed, because unlike the update mutation, the pk_columns for</span><span>
</span><span id="line-463"></span><span>          </span><span class="hs-comment">-- `delete_&lt;table&gt;_by_pk` is not present in the mutation arguments.</span><span>
</span><span id="line-464"></span><span>          </span><span class="hs-comment">-- for eg: the `delete_&lt;table&gt;_by_pk` looks like:</span><span>
</span><span id="line-465"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-466"></span><span>          </span><span class="hs-comment">-- mutation DeleteCustomerByPk {</span><span>
</span><span id="line-467"></span><span>          </span><span class="hs-comment">--   delete_customer_by_pk(id: 1) {</span><span>
</span><span id="line-468"></span><span>          </span><span class="hs-comment">--     id</span><span>
</span><span id="line-469"></span><span>          </span><span class="hs-comment">--    }</span><span>
</span><span id="line-470"></span><span>          </span><span class="hs-comment">-- }</span><span>
</span><span id="line-471"></span><span>          </span><span class="hs-keyword">do</span><span>
</span><span id="line-472"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687790251"><span class="annot"><span class="annottext">deleteInputValByPk :: Value
</span><a href="#local-6989586621687790251"><span class="hs-identifier hs-var hs-var">deleteInputValByPk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">J.object</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;pk_columns&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">J..=</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621687790247"><span class="hs-identifier hs-var">deleteInputVal</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-473"></span><span>            </span><span class="annot"><span class="annottext">Value -&gt; m Value
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">J.object</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;input&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; [Value] -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">J..=</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621687790251"><span class="hs-identifier hs-var">deleteInputValByPk</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Value -&gt; m Value
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">J.object</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;input&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; [Value] -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">J..=</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621687790247"><span class="hs-identifier hs-var">deleteInputVal</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>      </span><span class="annot"><span class="annottext">Maybe (HashMap Name (Value Variable))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value -&gt; m Value
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.Internal.html#Null"><span class="hs-identifier hs-var">J.Null</span></a></span><span>
</span><span id="line-476"></span><span>  </span><span class="annot"><span class="annottext">Environment
-&gt; Manager
-&gt; Logger Hasura
-&gt; UserInfo
-&gt; ResolvedWebhook
-&gt; [HeaderConf]
-&gt; Timeout
-&gt; Bool
-&gt; [Header]
-&gt; Value
-&gt; m ()
forall (m :: * -&gt; *).
(MonadError QErr m, MonadIO m, MonadTrace m) =&gt;
Environment
-&gt; Manager
-&gt; Logger Hasura
-&gt; UserInfo
-&gt; ResolvedWebhook
-&gt; [HeaderConf]
-&gt; Timeout
-&gt; Bool
-&gt; [Header]
-&gt; Value
-&gt; m ()
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#validateMutation"><span class="hs-identifier hs-var">validateMutation</span></a></span><span> </span><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621687790234"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621687790235"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621687790236"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687790237"><span class="hs-identifier hs-var">userInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ResolvedWebhook
</span><a href="#local-6989586621687790238"><span class="hs-identifier hs-var">resolvedWebHook</span></a></span><span> </span><span class="annot"><span class="annottext">[HeaderConf]
</span><a href="#local-6989586621687790239"><span class="hs-identifier hs-var">confHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621687790240"><span class="hs-identifier hs-var">timeout</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687790241"><span class="hs-identifier hs-var">forwardClientHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621687790242"><span class="hs-identifier hs-var">reqHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621687790245"><span class="hs-identifier hs-var">inputData</span></a></span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#validateMutation"><span class="hs-identifier hs-type">validateMutation</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-479"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621687789228"><span class="annot"><a href="#local-6989586621687789228"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789228"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-481"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621687789228"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-482"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.Class.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621687789228"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-483"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-484"></span><span>  </span><span class="annot"><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Data.Environment.html#Environment"><span class="hs-identifier hs-type">Env.Environment</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-485"></span><span>  </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-client-0.7.13.1-88628f48a025e46598ca658ea231eb27d6340417f49e950fbf8c438edb3ebbdc/share/doc/html/src/Network.HTTP.Client.Types.html#Manager"><span class="hs-identifier hs-type">HTTP.Manager</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-486"></span><span>  </span><span class="annot"><a href="Hasura.Logging.html#Logger"><span class="hs-identifier hs-type">L.Logger</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">L.Hasura</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-487"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-488"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#ResolvedWebhook"><span class="hs-identifier hs-type">ResolvedWebhook</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-489"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Headers.html#HeaderConf"><span class="hs-identifier hs-type">HeaderConf</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-490"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#Timeout"><span class="hs-identifier hs-type">Timeout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-491"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-492"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-types-0.12.3-50f0bdaf50e249a664c6f7a424df2a1a996a248b4dcc1ea8a009a9576cae9524/share/doc/html/src/Network.HTTP.Types.Header.html#Header"><span class="hs-identifier hs-type">HTTP.Header</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-493"></span><span>  </span><span class="annot"><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.Internal.html#Value"><span class="hs-identifier hs-type">J.Value</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-494"></span><span>  </span><span class="annot"><a href="#local-6989586621687789228"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span id="validateMutation"><span class="annot"><span class="annottext">validateMutation :: forall (m :: * -&gt; *).
(MonadError QErr m, MonadIO m, MonadTrace m) =&gt;
Environment
-&gt; Manager
-&gt; Logger Hasura
-&gt; UserInfo
-&gt; ResolvedWebhook
-&gt; [HeaderConf]
-&gt; Timeout
-&gt; Bool
-&gt; [Header]
-&gt; Value
-&gt; m ()
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#validateMutation"><span class="hs-identifier hs-var hs-var">validateMutation</span></a></span></span><span> </span><span id="local-6989586621687790343"><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621687790343"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621687790344"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621687790344"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621687790345"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621687790345"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621687790346"><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687790346"><span class="hs-identifier hs-var">userInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Common.html#ResolvedWebhook"><span class="hs-identifier hs-type">ResolvedWebhook</span></a></span><span> </span><span id="local-6989586621687790348"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687790348"><span class="hs-identifier hs-var">urlText</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621687790349"><span class="annot"><span class="annottext">[HeaderConf]
</span><a href="#local-6989586621687790349"><span class="hs-identifier hs-var">confHeaders</span></a></span></span><span> </span><span id="local-6989586621687790350"><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621687790350"><span class="hs-identifier hs-var">timeout</span></a></span></span><span> </span><span id="local-6989586621687790351"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687790351"><span class="hs-identifier hs-var">forwardClientHeaders</span></a></span></span><span> </span><span id="local-6989586621687790352"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621687790352"><span class="hs-identifier hs-var">reqHeaders</span></a></span></span><span> </span><span id="local-6989586621687790353"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621687790353"><span class="hs-identifier hs-var">inputData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-496"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687790354"><span class="annot"><span class="annottext">requestBody :: Value
</span><a href="#local-6989586621687790354"><span class="hs-identifier hs-var hs-var">requestBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-497"></span><span>        </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.Internal.html#object"><span class="hs-identifier hs-var">J.object</span></a></span><span>
</span><span id="line-498"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;version&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Int -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">J..=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#validateInputPayloadVersion"><span class="hs-identifier hs-var">validateInputPayloadVersion</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-499"></span><span>            </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;session_variables&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; SessionVariables -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">J..=</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo -&gt; SessionVariables
</span><a href="Hasura.RQL.Types.Session.html#_uiSession"><span class="hs-identifier hs-var">_uiSession</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687790346"><span class="hs-identifier hs-var">userInfo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-500"></span><span>            </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;role&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; RoleName -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">J..=</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo -&gt; RoleName
</span><a href="Hasura.RQL.Types.Session.html#_uiRole"><span class="hs-identifier hs-var">_uiRole</span></a></span><span> </span><span class="annot"><span class="annottext">UserInfo
</span><a href="#local-6989586621687790346"><span class="hs-identifier hs-var">userInfo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-501"></span><span>            </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;data&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#.%3D"><span class="hs-operator hs-var">J..=</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621687790353"><span class="hs-identifier hs-var">inputData</span></a></span><span>
</span><span id="line-502"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-503"></span><span>  </span><span id="local-6989586621687790357"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621687790357"><span class="hs-identifier hs-var">resolvedConfHeaders</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Environment -&gt; [HeaderConf] -&gt; m [Header]
forall (m :: * -&gt; *).
MonadError QErr m =&gt;
Environment -&gt; [HeaderConf] -&gt; m [Header]
</span><a href="Hasura.RQL.DDL.Headers.html#makeHeadersFromConf"><span class="hs-identifier hs-var">makeHeadersFromConf</span></a></span><span> </span><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621687790343"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">[HeaderConf]
</span><a href="#local-6989586621687790349"><span class="hs-identifier hs-var">confHeaders</span></a></span><span>
</span><span id="line-504"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687790359"><span class="annot"><span class="annottext">clientHeaders :: [Header]
</span><a href="#local-6989586621687790359"><span class="hs-identifier hs-var hs-var">clientHeaders</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621687790351"><span class="hs-identifier hs-var">forwardClientHeaders</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Header] -&gt; [Header]
</span><a href="Hasura.Server.Utils.html#mkClientHeadersForward"><span class="hs-identifier hs-var">mkClientHeadersForward</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621687790352"><span class="hs-identifier hs-var">reqHeaders</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Header]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-505"></span><span>      </span><span class="hs-comment">-- Using HashMap to avoid duplicate headers between configuration headers</span><span>
</span><span id="line-506"></span><span>      </span><span class="hs-comment">-- and client headers where configuration headers are preferred</span><span>
</span><span id="line-507"></span><span>      </span><span id="local-6989586621687790361"><span class="annot"><span class="annottext">hdrs :: [Header]
</span><a href="#local-6989586621687790361"><span class="hs-identifier hs-var hs-var">hdrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap HeaderName ByteString -&gt; [Header]
forall k v. HashMap k v -&gt; [(k, v)]
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashMap.Internal.html#toList"><span class="hs-identifier hs-var">HashMap.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(HashMap HeaderName ByteString -&gt; [Header])
-&gt; ([Header] -&gt; HashMap HeaderName ByteString)
-&gt; [Header]
-&gt; [Header]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Header] -&gt; HashMap HeaderName ByteString
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/unordered-containers-0.2.19.1-fc2e0f1d37ef28cdf90ef4bc038ad0de1aaee4c64eb6ed4574eefbec08a983d1/share/doc/html/src/Data.HashMap.Internal.Strict.html#fromList"><span class="hs-identifier hs-var">HashMap.fromList</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621687790357"><span class="hs-identifier hs-var">resolvedConfHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">[Header] -&gt; [Header] -&gt; [Header]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="Hasura.HTTP.html#defaultHeaders"><span class="hs-identifier hs-var">defaultHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">[Header] -&gt; [Header] -&gt; [Header]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621687790359"><span class="hs-identifier hs-var">clientHeaders</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>  </span><span id="local-6989586621687790364"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621687790364"><span class="hs-identifier hs-var">initRequest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Request -&gt; m Request
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Request -&gt; m Request) -&gt; IO Request -&gt; m Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; IO Request
forall (m :: * -&gt; *). MonadThrow m =&gt; Text -&gt; m Request
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Network.HTTP.Client.Transformable.html#mkRequestThrow"><span class="hs-identifier hs-var">HTTP.mkRequestThrow</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687790348"><span class="hs-identifier hs-var">urlText</span></a></span><span>
</span><span id="line-509"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687790367"><span class="annot"><span class="annottext">request :: Request
</span><a href="#local-6989586621687790367"><span class="hs-identifier hs-var hs-var">request</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-510"></span><span>        </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621687790364"><span class="hs-identifier hs-var">initRequest</span></a></span><span>
</span><span id="line-511"></span><span>          </span><span class="annot"><span class="annottext">Request -&gt; (Request -&gt; Request) -&gt; Request
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">ASetter Request Request ByteString ByteString
-&gt; ByteString -&gt; Request -&gt; Request
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/lens-5.2.2-c288f4ab3533e91c5d241152121e172474cc553aa524e32488a24b727cc130b5/share/doc/html/src/Control.Lens.Setter.html#set"><span class="hs-identifier hs-var">Lens.set</span></a></span><span> </span><span class="annot"><span class="annottext">ASetter Request Request ByteString ByteString
Lens' Request ByteString
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Network.HTTP.Client.Transformable.html#method"><span class="hs-identifier hs-var">HTTP.method</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;POST&quot;</span></span><span>
</span><span id="line-512"></span><span>          </span><span class="annot"><span class="annottext">Request -&gt; (Request -&gt; Request) -&gt; Request
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">ASetter Request Request [Header] [Header]
-&gt; [Header] -&gt; Request -&gt; Request
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/lens-5.2.2-c288f4ab3533e91c5d241152121e172474cc553aa524e32488a24b727cc130b5/share/doc/html/src/Control.Lens.Setter.html#set"><span class="hs-identifier hs-var">Lens.set</span></a></span><span> </span><span class="annot"><span class="annottext">ASetter Request Request [Header] [Header]
Lens' Request [Header]
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Network.HTTP.Client.Transformable.html#headers"><span class="hs-identifier hs-var">HTTP.headers</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621687790361"><span class="hs-identifier hs-var">hdrs</span></a></span><span>
</span><span id="line-513"></span><span>          </span><span class="annot"><span class="annottext">Request -&gt; (Request -&gt; Request) -&gt; Request
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">ASetter Request Request RequestBody RequestBody
-&gt; RequestBody -&gt; Request -&gt; Request
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/lens-5.2.2-c288f4ab3533e91c5d241152121e172474cc553aa524e32488a24b727cc130b5/share/doc/html/src/Control.Lens.Setter.html#set"><span class="hs-identifier hs-var">Lens.set</span></a></span><span> </span><span class="annot"><span class="annottext">ASetter Request Request RequestBody RequestBody
Lens' Request RequestBody
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Network.HTTP.Client.Transformable.html#body"><span class="hs-identifier hs-var">HTTP.body</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; RequestBody
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-client-0.7.13.1-88628f48a025e46598ca658ea231eb27d6340417f49e950fbf8c438edb3ebbdc/share/doc/html/src/Network.HTTP.Client.Types.html#RequestBodyLBS"><span class="hs-identifier hs-var">HTTP.RequestBodyLBS</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; RequestBody) -&gt; ByteString -&gt; RequestBody
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.html#encode"><span class="hs-identifier hs-var">J.encode</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621687790354"><span class="hs-identifier hs-var">requestBody</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>          </span><span class="annot"><span class="annottext">Request -&gt; (Request -&gt; Request) -&gt; Request
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">ASetter Request Request ResponseTimeout ResponseTimeout
-&gt; ResponseTimeout -&gt; Request -&gt; Request
forall s t a b. ASetter s t a b -&gt; b -&gt; s -&gt; t
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/lens-5.2.2-c288f4ab3533e91c5d241152121e172474cc553aa524e32488a24b727cc130b5/share/doc/html/src/Control.Lens.Setter.html#set"><span class="hs-identifier hs-var">Lens.set</span></a></span><span> </span><span class="annot"><span class="annottext">ASetter Request Request ResponseTimeout ResponseTimeout
Lens' Request ResponseTimeout
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-extras-1.0.0/opt/doc/html/hasura-extras/src/Network.HTTP.Client.Transformable.html#timeout"><span class="hs-identifier hs-var">HTTP.timeout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ResponseTimeout
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-client-0.7.13.1-88628f48a025e46598ca658ea231eb27d6340417f49e950fbf8c438edb3ebbdc/share/doc/html/src/Network.HTTP.Client.html#responseTimeoutMicro"><span class="hs-identifier hs-var">HTTP.responseTimeoutMicro</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Timeout -&gt; Int
</span><a href="Hasura.RQL.Types.Common.html#unTimeout"><span class="hs-identifier hs-var">unTimeout</span></a></span><span> </span><span class="annot"><span class="annottext">Timeout
</span><a href="#local-6989586621687790350"><span class="hs-identifier hs-var">timeout</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000000</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- (default: 10 seconds)</span><span>
</span><span id="line-515"></span><span>  </span><span id="local-6989586621687790379"><span class="annot"><span class="annottext">Either HttpException (Response ByteString)
</span><a href="#local-6989586621687790379"><span class="hs-identifier hs-var">httpResponse</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-516"></span><span>    </span><span class="annot"><span class="annottext">HttpPropagator
-&gt; Request
-&gt; (Request -&gt; m (Either HttpException (Response ByteString)))
-&gt; m (Either HttpException (Response ByteString))
forall (m :: * -&gt; *) a.
(MonadIO m, MonadTrace m) =&gt;
HttpPropagator -&gt; Request -&gt; (Request -&gt; m a) -&gt; m a
</span><a href="Hasura.Tracing.Utils.html#traceHTTPRequest"><span class="hs-identifier hs-var">Tracing.traceHTTPRequest</span></a></span><span> </span><span class="annot"><span class="annottext">HttpPropagator
</span><a href="Hasura.Tracing.Propagator.B3.html#b3TraceContextPropagator"><span class="hs-identifier hs-var">b3TraceContextPropagator</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621687790367"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="annot"><span class="annottext">((Request -&gt; m (Either HttpException (Response ByteString)))
 -&gt; m (Either HttpException (Response ByteString)))
-&gt; (Request -&gt; m (Either HttpException (Response ByteString)))
-&gt; m (Either HttpException (Response ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621687790381"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621687790381"><span class="hs-identifier hs-var">request'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-517"></span><span>      </span><span class="annot"><span class="annottext">IO (Either HttpException (Response ByteString))
-&gt; m (Either HttpException (Response ByteString))
forall a. IO a -&gt; m a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either HttpException (Response ByteString))
 -&gt; m (Either HttpException (Response ByteString)))
-&gt; (IO (Response ByteString)
    -&gt; IO (Either HttpException (Response ByteString)))
-&gt; IO (Response ByteString)
-&gt; m (Either HttpException (Response ByteString))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IO (Response ByteString)
-&gt; IO (Either HttpException (Response ByteString))
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">try</span></span><span> </span><span class="annot"><span class="annottext">(IO (Response ByteString)
 -&gt; m (Either HttpException (Response ByteString)))
-&gt; IO (Response ByteString)
-&gt; m (Either HttpException (Response ByteString))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Manager -&gt; IO (Response ByteString)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-client-0.7.13.1-88628f48a025e46598ca658ea231eb27d6340417f49e950fbf8c438edb3ebbdc/share/doc/html/src/Network.HTTP.Client.Core.html#httpLbs"><span class="hs-identifier hs-var">HTTP.httpLbs</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621687790381"><span class="hs-identifier hs-var">request'</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621687790344"><span class="hs-identifier hs-var">manager</span></a></span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either HttpException (Response ByteString)
</span><a href="#local-6989586621687790379"><span class="hs-identifier hs-var">httpResponse</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-520"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621687790383"><span class="annot"><span class="annottext">HttpException
</span><a href="#local-6989586621687790383"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-521"></span><span>      </span><span class="annot"><span class="annottext">Text -&gt; Value -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; Value -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#throw500WithDetail"><span class="hs-identifier hs-var">throw500WithDetail</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;http exception when validating input data&quot;</span></span><span>
</span><span id="line-522"></span><span>        </span><span class="annot"><span class="annottext">(Value -&gt; m ()) -&gt; Value -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HttpException -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var">J.toJSON</span></a></span><span>
</span><span id="line-523"></span><span>        </span><span class="annot"><span class="annottext">(HttpException -&gt; Value) -&gt; HttpException -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HttpException -&gt; HttpException
</span><a href="Hasura.HTTP.html#HttpException"><span class="hs-identifier hs-var">HttpException</span></a></span><span> </span><span class="annot"><span class="annottext">HttpException
</span><a href="#local-6989586621687790383"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-524"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621687790386"><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621687790386"><span class="hs-identifier hs-var">response</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-525"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687790387"><span class="annot"><span class="annottext">responseStatus :: Status
</span><a href="#local-6989586621687790387"><span class="hs-identifier hs-var hs-var">responseStatus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621687790386"><span class="hs-identifier hs-var">response</span></a></span><span> </span><span class="annot"><span class="annottext">Response ByteString
-&gt; Getting Status (Response ByteString) Status -&gt; Status
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/lens-5.2.2-c288f4ab3533e91c5d241152121e172474cc553aa524e32488a24b727cc130b5/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">Lens.^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Status (Response ByteString) Status
forall body (f :: * -&gt; *).
Functor f =&gt;
(Status -&gt; f Status) -&gt; Response body -&gt; f (Response body)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/wreq-0.5.3.3-288702744e167bbd35c96c1c806bd4ce18aeffab9557ceb3329b6915df71a6c6/share/doc/html/src/Network.Wreq.Lens.html#responseStatus"><span class="hs-identifier hs-var">Wreq.responseStatus</span></a></span><span>
</span><span id="line-526"></span><span>          </span><span id="local-6989586621687790390"><span class="annot"><span class="annottext">responseBody :: ByteString
</span><a href="#local-6989586621687790390"><span class="hs-identifier hs-var hs-var">responseBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Response ByteString
</span><a href="#local-6989586621687790386"><span class="hs-identifier hs-var">response</span></a></span><span> </span><span class="annot"><span class="annottext">Response ByteString
-&gt; Getting ByteString (Response ByteString) ByteString
-&gt; ByteString
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/lens-5.2.2-c288f4ab3533e91c5d241152121e172474cc553aa524e32488a24b727cc130b5/share/doc/html/src/Control.Lens.Getter.html#%5E."><span class="hs-operator hs-var">Lens.^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting ByteString (Response ByteString) ByteString
forall body0 body1 (f :: * -&gt; *).
Functor f =&gt;
(body0 -&gt; f body1) -&gt; Response body0 -&gt; f (Response body1)
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/wreq-0.5.3.3-288702744e167bbd35c96c1c806bd4ce18aeffab9557ceb3329b6915df71a6c6/share/doc/html/src/Network.Wreq.Lens.html#responseBody"><span class="hs-identifier hs-var">Wreq.responseBody</span></a></span><span>
</span><span id="line-527"></span><span>          </span><span id="local-6989586621687790392"><span class="annot"><span class="annottext">responseBodyForLogging :: Value
</span><a href="#local-6989586621687790392"><span class="hs-identifier hs-var hs-var">responseBodyForLogging</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Maybe Value -&gt; Value
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.Internal.html#String"><span class="hs-identifier hs-var">J.String</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Value) -&gt; Text -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html#lbsToTxt"><span class="hs-identifier hs-var">lbsToTxt</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621687790390"><span class="hs-identifier hs-var">responseBody</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Value -&gt; Value) -&gt; Maybe Value -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe Value
forall a. FromJSON a =&gt; ByteString -&gt; Maybe a
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.html#decode%27"><span class="hs-identifier hs-var">J.decode'</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621687790390"><span class="hs-identifier hs-var">responseBody</span></a></span><span>
</span><span id="line-528"></span><span>      </span><span class="hs-comment">-- Log the details of the HTTP webhook call</span><span>
</span><span id="line-529"></span><span>      </span><span class="annot"><span class="annottext">Logger Hasura
-&gt; forall a (m :: * -&gt; *).
   (ToEngineLog a Hasura, MonadTraceContext m, MonadIO m) =&gt;
   a -&gt; m ()
forall impl.
Logger impl
-&gt; forall a (m :: * -&gt; *).
   (ToEngineLog a impl, MonadTraceContext m, MonadIO m) =&gt;
   a -&gt; m ()
</span><a href="Hasura.Logging.html#unLoggerTracing"><span class="hs-identifier hs-var">L.unLoggerTracing</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621687790345"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">(ValidateInsertInputLog -&gt; m ()) -&gt; ValidateInsertInputLog -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HttpHandlerLog -&gt; ValidateInsertInputLog
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#VIILHttpHandler"><span class="hs-identifier hs-var">VIILHttpHandler</span></a></span><span> </span><span class="annot"><span class="annottext">(HttpHandlerLog -&gt; ValidateInsertInputLog)
-&gt; HttpHandlerLog -&gt; ValidateInsertInputLog
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value -&gt; [HeaderConf] -&gt; Value -&gt; Int -&gt; HttpHandlerLog
</span><a href="Hasura.Backends.Postgres.Execute.Mutation.html#HttpHandlerLog"><span class="hs-identifier hs-var">HttpHandlerLog</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687790348"><span class="hs-identifier hs-var">urlText</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621687790354"><span class="hs-identifier hs-var">requestBody</span></a></span><span> </span><span class="annot"><span class="annottext">[HeaderConf]
</span><a href="#local-6989586621687790349"><span class="hs-identifier hs-var">confHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621687790392"><span class="hs-identifier hs-var">responseBodyForLogging</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status -&gt; Int
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-types-0.12.3-50f0bdaf50e249a664c6f7a424df2a1a996a248b4dcc1ea8a009a9576cae9524/share/doc/html/src/Network.HTTP.Types.Status.html#statusCode"><span class="hs-identifier hs-var">HTTP.statusCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621687790387"><span class="hs-identifier hs-var">responseStatus</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>      </span><span class="hs-keyword">if</span><span>
</span><span id="line-531"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Status -&gt; Bool
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-types-0.12.3-50f0bdaf50e249a664c6f7a424df2a1a996a248b4dcc1ea8a009a9576cae9524/share/doc/html/src/Network.HTTP.Types.Status.html#statusIsSuccessful"><span class="hs-identifier hs-var">HTTP.statusIsSuccessful</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621687790387"><span class="hs-identifier hs-var">responseStatus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621687790387"><span class="hs-identifier hs-var">responseStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; Status -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-types-0.12.3-50f0bdaf50e249a664c6f7a424df2a1a996a248b4dcc1ea8a009a9576cae9524/share/doc/html/src/Network.HTTP.Types.Status.html#status400"><span class="hs-identifier hs-var">HTTP.status400</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-533"></span><span>            </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Mutation.html#ValidateInputErrorResponse"><span class="hs-identifier hs-type">ValidateInputErrorResponse</span></a></span><span> </span><span id="local-6989586621687790401"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687790401"><span class="hs-identifier hs-var">errorMessage</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-534"></span><span>              </span><span class="annot"><span class="annottext">ByteString -&gt; Either String ValidateInputErrorResponse
forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.html#eitherDecode"><span class="hs-identifier hs-var">J.eitherDecode</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621687790390"><span class="hs-identifier hs-var">responseBody</span></a></span><span> </span><span class="annot"><span class="annottext">Either String ValidateInputErrorResponse
-&gt; (String -&gt; m ValidateInputErrorResponse)
-&gt; m ValidateInputErrorResponse
forall (m :: * -&gt; *) e a.
Applicative m =&gt;
Either e a -&gt; (e -&gt; m a) -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src/Hasura.Prelude.html#onLeft"><span class="hs-operator hs-var">`onLeft`</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621687790404"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621687790404"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-535"></span><span>                </span><span class="annot"><span class="annottext">Text -&gt; Value -&gt; m ValidateInputErrorResponse
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; Value -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#throw500WithDetail"><span class="hs-identifier hs-var">throw500WithDetail</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;received invalid response from input validation webhook&quot;</span></span><span>
</span><span id="line-536"></span><span>                  </span><span class="annot"><span class="annottext">(Value -&gt; m ValidateInputErrorResponse)
-&gt; Value -&gt; m ValidateInputErrorResponse
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var">J.toJSON</span></a></span><span>
</span><span id="line-537"></span><span>                  </span><span class="annot"><span class="annottext">(String -&gt; Value) -&gt; String -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;invalid response: &quot;</span></span><span>
</span><span id="line-538"></span><span>                  </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621687790404"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-539"></span><span>            </span><span class="annot"><span class="annottext">Code -&gt; Text -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#ValidationFailed"><span class="hs-identifier hs-var">ValidationFailed</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621687790401"><span class="hs-identifier hs-var">errorMessage</span></a></span><span>
</span><span id="line-540"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-541"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621687790406"><span class="annot"><span class="annottext">err :: Value
</span><a href="#local-6989586621687790406"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-542"></span><span>                  </span><span class="annot"><span class="annottext">String -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/aeson-2.1.2.1-e70cfd91223b3d0131c9afbae5e81df0c65350557c5511cf0c25a451c1483207/share/doc/html/src/Data.Aeson.Types.ToJSON.html#toJSON"><span class="hs-identifier hs-var">J.toJSON</span></a></span><span>
</span><span id="line-543"></span><span>                    </span><span class="annot"><span class="annottext">(String -&gt; Value) -&gt; String -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expecting 200 or 400 status code, but found &quot;</span></span><span>
</span><span id="line-544"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status -&gt; Int
</span><a href="file:///root/.local/state/cabal/store/ghc-9.4.5/http-types-0.12.3-50f0bdaf50e249a664c6f7a424df2a1a996a248b4dcc1ea8a009a9576cae9524/share/doc/html/src/Network.HTTP.Types.Status.html#statusCode"><span class="hs-identifier hs-var">HTTP.statusCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621687790387"><span class="hs-identifier hs-var">responseStatus</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>            </span><span class="annot"><span class="annottext">Text -&gt; Value -&gt; m ()
forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; Value -&gt; m a
</span><a href="file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.4.5/hasura-base-1.0.0/opt/doc/html/hasura-base/src/Hasura.Base.Error.html#throw500WithDetail"><span class="hs-identifier hs-var">throw500WithDetail</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;internal error when validating input data&quot;</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621687790406"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-546"></span></pre></body></html>