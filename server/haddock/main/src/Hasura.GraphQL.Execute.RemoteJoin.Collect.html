<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hasura.GraphQL.Execute.RemoteJoin.Collect</span><span>
</span><span id="line-2"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsQueryDB"><span class="hs-identifier">getRemoteJoinsQueryDB</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsMutationDB"><span class="hs-identifier">getRemoteJoinsMutationDB</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-4"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsActionQuery"><span class="hs-identifier">getRemoteJoinsActionQuery</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsActionMutation"><span class="hs-identifier">getRemoteJoinsActionMutation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsGraphQLField"><span class="hs-identifier">getRemoteJoinsGraphQLField</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span class="hs-keyword">where</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Traversal'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">preview</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">traverseOf</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_2</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Writer</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict.InsOrd</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">OMap</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.HashMap.Strict.NonEmpty.html"><span class="hs-identifier">Data.HashMap.Strict.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.HashMap.Strict.NonEmpty.html#NEHashMap"><span class="hs-identifier">NEHashMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.HashMap.Strict.NonEmpty.html"><span class="hs-identifier">Data.HashMap.Strict.NonEmpty</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NEMap</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html"><span class="hs-identifier">Hasura.GraphQL.Execute.RemoteJoin.Types</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html"><span class="hs-identifier">Hasura.GraphQL.Parser.Column</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier">UnpreparedValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Constants.html"><span class="hs-identifier">Hasura.GraphQL.Parser.Constants</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Prelude.html"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.html"><span class="hs-identifier">Hasura.RQL.IR</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.html"><span class="hs-identifier">Hasura.RQL.Types</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.SQL.AnyBackend.html"><span class="hs-identifier">Hasura.SQL.AnyBackend</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">AB</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.GraphQL.Draft.Syntax</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-comment">{- Note [Remote Joins Architecture]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    Unparsed Incoming GraphQL   +------------------------------+
    --------------------------&gt; | Parsing of the GraphQL query |-----+
                                +------------------------------+     |
                                                                     | DB Query and remote joins (if any)
                                                                     |
                                                                     V
    +----------------------------------+  SQL query response  +----------------------------+
    |  Traverse the DB response to     | &lt;------------------- |  Execution of the DB query |
    |  get the values of the arguments |                      +----------------------------+
    |   of the remote field            |
    +----------------------------------+
                 |
                 | Remote field arguments
                 V
    +--------------------------+  Remote schema response   +----------------------------------------+
    | Query the remote schema  | ------------------------&gt; | Replace the remote join fields in      |
    | with the remote field    |                           | the SQL query response (JSON) with     |
    | arguments to the remote  |                           | the response obtained from the remote  |
    | field configured in the  |                           | schema at appropriate places.          |
    | remote join.             |                           +----------------------------------------+
    +--------------------------+
-}</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- AST entry points</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | Collects remote joins from the a 'QueryDB' if any, and transforms the</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- selection to add new join fields where those occured.</span><span>
</span><span id="line-57"></span><span class="hs-comment">--</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- Returns the transformed selection set, in which remote fields have been</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- inserted, and for which the @r@ type is now 'Void'.</span><span>
</span><span id="line-60"></span><span id="local-6989586621688527916"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsQueryDB"><span class="hs-identifier hs-type">getRemoteJoinsQueryDB</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688527916"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#QueryDB"><span class="hs-identifier hs-type">QueryDB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688527916"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688527916"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#QueryDB"><span class="hs-identifier hs-type">QueryDB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688527916"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688527916"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#RemoteJoins"><span class="hs-identifier hs-type">RemoteJoins</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-64"></span><span id="getRemoteJoinsQueryDB"><span class="annot"><span class="annottext">getRemoteJoinsQueryDB :: QueryDB
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; (QueryDB b Void (UnpreparedValue b), Maybe RemoteJoins)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsQueryDB"><span class="hs-identifier hs-var hs-var">getRemoteJoinsQueryDB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><span class="annottext">Collector (QueryDB b Void (UnpreparedValue b))
-&gt; (QueryDB b Void (UnpreparedValue b), Maybe RemoteJoins)
forall a. Collector a -&gt; (a, Maybe RemoteJoins)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#runCollector"><span class="hs-identifier hs-var hs-var">runCollector</span></a></span><span> </span><span class="annot"><span class="annottext">(Collector (QueryDB b Void (UnpreparedValue b))
 -&gt; (QueryDB b Void (UnpreparedValue b), Maybe RemoteJoins))
-&gt; (QueryDB
      b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
    -&gt; Collector (QueryDB b Void (UnpreparedValue b)))
-&gt; QueryDB
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; (QueryDB b Void (UnpreparedValue b), Maybe RemoteJoins)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#QDBMultipleRows"><span class="hs-identifier hs-type">QDBMultipleRows</span></a></span><span> </span><span id="local-6989586621688527912"><span class="annot"><span class="annottext">AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527912"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-67"></span><span>      </span><span class="annot"><span class="annottext">AnnSimpleSelectG b Void (UnpreparedValue b)
-&gt; QueryDB b Void (UnpreparedValue b)
forall (b :: BackendType) r v.
AnnSimpleSelectG b r v -&gt; QueryDB b r v
</span><a href="Hasura.RQL.IR.Select.html#QDBMultipleRows"><span class="hs-identifier hs-var">QDBMultipleRows</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnSimpleSelectG b Void (UnpreparedValue b)
 -&gt; QueryDB b Void (UnpreparedValue b))
-&gt; Collector (AnnSimpleSelectG b Void (UnpreparedValue b))
-&gt; Collector (QueryDB b Void (UnpreparedValue b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnSimpleSelectG b Void (UnpreparedValue b))
forall (b :: BackendType).
Backend b =&gt;
AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnSimpleSelectG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformSelect"><span class="hs-identifier hs-var">transformSelect</span></a></span><span> </span><span class="annot"><span class="annottext">AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527912"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#QDBSingleRow"><span class="hs-identifier hs-type">QDBSingleRow</span></a></span><span> </span><span id="local-6989586621688527908"><span class="annot"><span class="annottext">AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527908"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-69"></span><span>      </span><span class="annot"><span class="annottext">AnnSimpleSelectG b Void (UnpreparedValue b)
-&gt; QueryDB b Void (UnpreparedValue b)
forall (b :: BackendType) r v.
AnnSimpleSelectG b r v -&gt; QueryDB b r v
</span><a href="Hasura.RQL.IR.Select.html#QDBSingleRow"><span class="hs-identifier hs-var">QDBSingleRow</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnSimpleSelectG b Void (UnpreparedValue b)
 -&gt; QueryDB b Void (UnpreparedValue b))
-&gt; Collector (AnnSimpleSelectG b Void (UnpreparedValue b))
-&gt; Collector (QueryDB b Void (UnpreparedValue b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnSimpleSelectG b Void (UnpreparedValue b))
forall (b :: BackendType).
Backend b =&gt;
AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnSimpleSelectG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformSelect"><span class="hs-identifier hs-var">transformSelect</span></a></span><span> </span><span class="annot"><span class="annottext">AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527908"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#QDBAggregation"><span class="hs-identifier hs-type">QDBAggregation</span></a></span><span> </span><span id="local-6989586621688527906"><span class="annot"><span class="annottext">AnnAggregateSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527906"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-71"></span><span>      </span><span class="annot"><span class="annottext">AnnAggregateSelectG b Void (UnpreparedValue b)
-&gt; QueryDB b Void (UnpreparedValue b)
forall (b :: BackendType) r v.
AnnAggregateSelectG b r v -&gt; QueryDB b r v
</span><a href="Hasura.RQL.IR.Select.html#QDBAggregation"><span class="hs-identifier hs-var">QDBAggregation</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnAggregateSelectG b Void (UnpreparedValue b)
 -&gt; QueryDB b Void (UnpreparedValue b))
-&gt; Collector (AnnAggregateSelectG b Void (UnpreparedValue b))
-&gt; Collector (QueryDB b Void (UnpreparedValue b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">AnnAggregateSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnAggregateSelectG b Void (UnpreparedValue b))
forall (b :: BackendType).
Backend b =&gt;
AnnAggregateSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnAggregateSelectG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformAggregateSelect"><span class="hs-identifier hs-var">transformAggregateSelect</span></a></span><span> </span><span class="annot"><span class="annottext">AnnAggregateSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527906"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#QDBConnection"><span class="hs-identifier hs-type">QDBConnection</span></a></span><span> </span><span id="local-6989586621688527903"><span class="annot"><span class="annottext">ConnectionSelect
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527903"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-73"></span><span>      </span><span class="annot"><span class="annottext">ConnectionSelect b Void (UnpreparedValue b)
-&gt; QueryDB b Void (UnpreparedValue b)
forall (b :: BackendType) r v.
ConnectionSelect b r v -&gt; QueryDB b r v
</span><a href="Hasura.RQL.IR.Select.html#QDBConnection"><span class="hs-identifier hs-var">QDBConnection</span></a></span><span> </span><span class="annot"><span class="annottext">(ConnectionSelect b Void (UnpreparedValue b)
 -&gt; QueryDB b Void (UnpreparedValue b))
-&gt; Collector (ConnectionSelect b Void (UnpreparedValue b))
-&gt; Collector (QueryDB b Void (UnpreparedValue b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ConnectionSelect
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (ConnectionSelect b Void (UnpreparedValue b))
forall (b :: BackendType).
Backend b =&gt;
ConnectionSelect
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (ConnectionSelect b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformConnectionSelect"><span class="hs-identifier hs-var">transformConnectionSelect</span></a></span><span> </span><span class="annot"><span class="annottext">ConnectionSelect
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527903"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#QDBStreamMultipleRows"><span class="hs-identifier hs-type">QDBStreamMultipleRows</span></a></span><span> </span><span id="local-6989586621688527900"><span class="annot"><span class="annottext">AnnSimpleStreamSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527900"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-75"></span><span>      </span><span class="annot"><span class="annottext">AnnSimpleStreamSelectG b Void (UnpreparedValue b)
-&gt; QueryDB b Void (UnpreparedValue b)
forall (b :: BackendType) r v.
AnnSimpleStreamSelectG b r v -&gt; QueryDB b r v
</span><a href="Hasura.RQL.IR.Select.html#QDBStreamMultipleRows"><span class="hs-identifier hs-var">QDBStreamMultipleRows</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnSimpleStreamSelectG b Void (UnpreparedValue b)
 -&gt; QueryDB b Void (UnpreparedValue b))
-&gt; Collector (AnnSimpleStreamSelectG b Void (UnpreparedValue b))
-&gt; Collector (QueryDB b Void (UnpreparedValue b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">AnnSimpleStreamSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnSimpleStreamSelectG b Void (UnpreparedValue b))
forall (b :: BackendType).
Backend b =&gt;
AnnSimpleStreamSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnSimpleStreamSelectG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformStreamSelect"><span class="hs-identifier hs-var">transformStreamSelect</span></a></span><span> </span><span class="annot"><span class="annottext">AnnSimpleStreamSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527900"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- | Collects remote joins from the a 'MutationDB' if any, and transforms the</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- selection to add new join fields where those occured.</span><span>
</span><span id="line-79"></span><span class="hs-comment">--</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- Returns the transformed selection set, in which remote fields have been</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- inserted, and for which the @r@ type is now 'Void'.</span><span>
</span><span id="line-82"></span><span id="local-6989586621688527898"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsMutationDB"><span class="hs-identifier hs-type">getRemoteJoinsMutationDB</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-83"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688527898"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-84"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Root.html#MutationDB"><span class="hs-identifier hs-type">MutationDB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688527898"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688527898"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#MutationDB"><span class="hs-identifier hs-type">MutationDB</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688527898"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688527898"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#RemoteJoins"><span class="hs-identifier hs-type">RemoteJoins</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-86"></span><span id="getRemoteJoinsMutationDB"><span class="annot"><span class="annottext">getRemoteJoinsMutationDB :: MutationDB
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; (MutationDB b Void (UnpreparedValue b), Maybe RemoteJoins)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsMutationDB"><span class="hs-identifier hs-var hs-var">getRemoteJoinsMutationDB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><span class="annottext">Collector (MutationDB b Void (UnpreparedValue b))
-&gt; (MutationDB b Void (UnpreparedValue b), Maybe RemoteJoins)
forall a. Collector a -&gt; (a, Maybe RemoteJoins)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#runCollector"><span class="hs-identifier hs-var hs-var">runCollector</span></a></span><span> </span><span class="annot"><span class="annottext">(Collector (MutationDB b Void (UnpreparedValue b))
 -&gt; (MutationDB b Void (UnpreparedValue b), Maybe RemoteJoins))
-&gt; (MutationDB
      b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
    -&gt; Collector (MutationDB b Void (UnpreparedValue b)))
-&gt; MutationDB
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; (MutationDB b Void (UnpreparedValue b), Maybe RemoteJoins)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Root.html#MDBInsert"><span class="hs-identifier hs-type">MDBInsert</span></a></span><span> </span><span id="local-6989586621688527896"><span class="annot"><span class="annottext">AnnotatedInsert
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527896"><span class="hs-identifier hs-var">insert</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-89"></span><span>      </span><span class="annot"><span class="annottext">AnnotatedInsert b Void (UnpreparedValue b)
-&gt; MutationDB b Void (UnpreparedValue b)
forall (b :: BackendType) r v.
AnnotatedInsert b r v -&gt; MutationDB b r v
</span><a href="Hasura.RQL.IR.Root.html#MDBInsert"><span class="hs-identifier hs-var">MDBInsert</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnotatedInsert b Void (UnpreparedValue b)
 -&gt; MutationDB b Void (UnpreparedValue b))
-&gt; Collector (AnnotatedInsert b Void (UnpreparedValue b))
-&gt; Collector (MutationDB b Void (UnpreparedValue b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AnnotatedInsert
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnotatedInsert b Void (UnpreparedValue b))
  (MutationOutputG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (MutationOutputG b Void (UnpreparedValue b))
-&gt; LensLike
     Collector
     (AnnotatedInsert
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (AnnotatedInsert b Void (UnpreparedValue b))
     (MutationOutputG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (MutationOutputG b Void (UnpreparedValue b))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AnnotatedInsert
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnotatedInsert b Void (UnpreparedValue b))
  (MutationOutputG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (MutationOutputG b Void (UnpreparedValue b))
forall (b :: BackendType) r1 v r2.
Lens
  (AnnotatedInsert b r1 v)
  (AnnotatedInsert b r2 v)
  (MutationOutputG b r1 v)
  (MutationOutputG b r2 v)
</span><a href="Hasura.RQL.IR.Insert.html#aiOutput"><span class="hs-identifier hs-var">aiOutput</span></a></span><span> </span><span class="annot"><span class="annottext">MutationOutputG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (MutationOutputG b Void (UnpreparedValue b))
forall (b :: BackendType).
Backend b =&gt;
MutationOutputG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (MutationOutputG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformMutationOutput"><span class="hs-identifier hs-var">transformMutationOutput</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedInsert
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527896"><span class="hs-identifier hs-var">insert</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Root.html#MDBUpdate"><span class="hs-identifier hs-type">MDBUpdate</span></a></span><span> </span><span id="local-6989586621688527892"><span class="annot"><span class="annottext">AnnotatedUpdateG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527892"><span class="hs-identifier hs-var">update</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-91"></span><span>      </span><span class="annot"><span class="annottext">AnnotatedUpdateG b Void (UnpreparedValue b)
-&gt; MutationDB b Void (UnpreparedValue b)
forall (b :: BackendType) r v.
AnnotatedUpdateG b r v -&gt; MutationDB b r v
</span><a href="Hasura.RQL.IR.Root.html#MDBUpdate"><span class="hs-identifier hs-var">MDBUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnotatedUpdateG b Void (UnpreparedValue b)
 -&gt; MutationDB b Void (UnpreparedValue b))
-&gt; Collector (AnnotatedUpdateG b Void (UnpreparedValue b))
-&gt; Collector (MutationDB b Void (UnpreparedValue b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AnnotatedUpdateG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnotatedUpdateG b Void (UnpreparedValue b))
  (MutationOutputG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (MutationOutputG b Void (UnpreparedValue b))
-&gt; LensLike
     Collector
     (AnnotatedUpdateG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (AnnotatedUpdateG b Void (UnpreparedValue b))
     (MutationOutputG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (MutationOutputG b Void (UnpreparedValue b))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AnnotatedUpdateG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnotatedUpdateG b Void (UnpreparedValue b))
  (MutationOutputG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (MutationOutputG b Void (UnpreparedValue b))
forall (b :: BackendType) r1 v r2.
Lens
  (AnnotatedUpdateG b r1 v)
  (AnnotatedUpdateG b r2 v)
  (MutationOutputG b r1 v)
  (MutationOutputG b r2 v)
</span><a href="Hasura.RQL.IR.Update.html#auOutput"><span class="hs-identifier hs-var">auOutput</span></a></span><span> </span><span class="annot"><span class="annottext">MutationOutputG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (MutationOutputG b Void (UnpreparedValue b))
forall (b :: BackendType).
Backend b =&gt;
MutationOutputG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (MutationOutputG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformMutationOutput"><span class="hs-identifier hs-var">transformMutationOutput</span></a></span><span> </span><span class="annot"><span class="annottext">AnnotatedUpdateG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527892"><span class="hs-identifier hs-var">update</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Root.html#MDBDelete"><span class="hs-identifier hs-type">MDBDelete</span></a></span><span> </span><span id="local-6989586621688527889"><span class="annot"><span class="annottext">AnnDelG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527889"><span class="hs-identifier hs-var">delete</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-93"></span><span>      </span><span class="annot"><span class="annottext">AnnDelG b Void (UnpreparedValue b)
-&gt; MutationDB b Void (UnpreparedValue b)
forall (b :: BackendType) r v. AnnDelG b r v -&gt; MutationDB b r v
</span><a href="Hasura.RQL.IR.Root.html#MDBDelete"><span class="hs-identifier hs-var">MDBDelete</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnDelG b Void (UnpreparedValue b)
 -&gt; MutationDB b Void (UnpreparedValue b))
-&gt; Collector (AnnDelG b Void (UnpreparedValue b))
-&gt; Collector (MutationDB b Void (UnpreparedValue b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AnnDelG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnDelG b Void (UnpreparedValue b))
  (MutationOutputG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (MutationOutputG b Void (UnpreparedValue b))
-&gt; LensLike
     Collector
     (AnnDelG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (AnnDelG b Void (UnpreparedValue b))
     (MutationOutputG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (MutationOutputG b Void (UnpreparedValue b))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AnnDelG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnDelG b Void (UnpreparedValue b))
  (MutationOutputG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (MutationOutputG b Void (UnpreparedValue b))
forall (b :: BackendType) r1 v r2.
Lens
  (AnnDelG b r1 v)
  (AnnDelG b r2 v)
  (MutationOutputG b r1 v)
  (MutationOutputG b r2 v)
</span><a href="Hasura.RQL.IR.Delete.html#adOutput"><span class="hs-identifier hs-var">adOutput</span></a></span><span> </span><span class="annot"><span class="annottext">MutationOutputG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (MutationOutputG b Void (UnpreparedValue b))
forall (b :: BackendType).
Backend b =&gt;
MutationOutputG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (MutationOutputG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformMutationOutput"><span class="hs-identifier hs-var">transformMutationOutput</span></a></span><span> </span><span class="annot"><span class="annottext">AnnDelG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527889"><span class="hs-identifier hs-var">delete</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Root.html#MDBFunction"><span class="hs-identifier hs-type">MDBFunction</span></a></span><span> </span><span id="local-6989586621688527886"><span class="annot"><span class="annottext">JsonAggSelect
</span><a href="#local-6989586621688527886"><span class="hs-identifier hs-var">aggSelect</span></a></span></span><span> </span><span id="local-6989586621688527885"><span class="annot"><span class="annottext">AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527885"><span class="hs-identifier hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-95"></span><span>      </span><span class="annot"><span class="annottext">JsonAggSelect
-&gt; AnnSimpleSelectG b Void (UnpreparedValue b)
-&gt; MutationDB b Void (UnpreparedValue b)
forall (b :: BackendType) r v.
JsonAggSelect -&gt; AnnSimpleSelectG b r v -&gt; MutationDB b r v
</span><a href="Hasura.RQL.IR.Root.html#MDBFunction"><span class="hs-identifier hs-var">MDBFunction</span></a></span><span> </span><span class="annot"><span class="annottext">JsonAggSelect
</span><a href="#local-6989586621688527886"><span class="hs-identifier hs-var">aggSelect</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnSimpleSelectG b Void (UnpreparedValue b)
 -&gt; MutationDB b Void (UnpreparedValue b))
-&gt; Collector (AnnSimpleSelectG b Void (UnpreparedValue b))
-&gt; Collector (MutationDB b Void (UnpreparedValue b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnSimpleSelectG b Void (UnpreparedValue b))
forall (b :: BackendType).
Backend b =&gt;
AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnSimpleSelectG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformSelect"><span class="hs-identifier hs-var">transformSelect</span></a></span><span> </span><span class="annot"><span class="annottext">AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527885"><span class="hs-identifier hs-var">select</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsActionQuery"><span class="hs-identifier hs-type">getRemoteJoinsActionQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Root.html#ActionQuery"><span class="hs-identifier hs-type">ActionQuery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#ActionQuery"><span class="hs-identifier hs-type">ActionQuery</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#RemoteJoins"><span class="hs-identifier hs-type">RemoteJoins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span id="getRemoteJoinsActionQuery"><span class="annot"><span class="annottext">getRemoteJoinsActionQuery :: ActionQuery (RemoteRelationshipField UnpreparedValue)
-&gt; (ActionQuery Void, Maybe RemoteJoins)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsActionQuery"><span class="hs-identifier hs-var hs-var">getRemoteJoinsActionQuery</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><span class="annottext">Collector (ActionQuery Void)
-&gt; (ActionQuery Void, Maybe RemoteJoins)
forall a. Collector a -&gt; (a, Maybe RemoteJoins)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#runCollector"><span class="hs-identifier hs-var hs-var">runCollector</span></a></span><span> </span><span class="annot"><span class="annottext">(Collector (ActionQuery Void)
 -&gt; (ActionQuery Void, Maybe RemoteJoins))
-&gt; (ActionQuery (RemoteRelationshipField UnpreparedValue)
    -&gt; Collector (ActionQuery Void))
-&gt; ActionQuery (RemoteRelationshipField UnpreparedValue)
-&gt; (ActionQuery Void, Maybe RemoteJoins)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Root.html#AQQuery"><span class="hs-identifier hs-type">AQQuery</span></a></span><span> </span><span id="local-6989586621688527883"><span class="annot"><span class="annottext">AnnActionExecution (RemoteRelationshipField UnpreparedValue)
</span><a href="#local-6989586621688527883"><span class="hs-identifier hs-var">sync</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-103"></span><span>      </span><span class="annot"><span class="annottext">AnnActionExecution Void -&gt; ActionQuery Void
forall r. AnnActionExecution r -&gt; ActionQuery r
</span><a href="Hasura.RQL.IR.Root.html#AQQuery"><span class="hs-identifier hs-var">AQQuery</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnActionExecution Void -&gt; ActionQuery Void)
-&gt; Collector (AnnActionExecution Void)
-&gt; Collector (ActionQuery Void)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">AnnActionExecution (RemoteRelationshipField UnpreparedValue)
-&gt; Collector (AnnActionExecution Void)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformSyncAction"><span class="hs-identifier hs-var">transformSyncAction</span></a></span><span> </span><span class="annot"><span class="annottext">AnnActionExecution (RemoteRelationshipField UnpreparedValue)
</span><a href="#local-6989586621688527883"><span class="hs-identifier hs-var">sync</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Root.html#AQAsync"><span class="hs-identifier hs-type">AQAsync</span></a></span><span> </span><span id="local-6989586621688527880"><span class="annot"><span class="annottext">AnnActionAsyncQuery
  ('Postgres 'Vanilla) (RemoteRelationshipField UnpreparedValue)
</span><a href="#local-6989586621688527880"><span class="hs-identifier hs-var">async</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-105"></span><span>      </span><span class="annot"><span class="annottext">AnnActionAsyncQuery ('Postgres 'Vanilla) Void -&gt; ActionQuery Void
forall r.
AnnActionAsyncQuery ('Postgres 'Vanilla) r -&gt; ActionQuery r
</span><a href="Hasura.RQL.IR.Root.html#AQAsync"><span class="hs-identifier hs-var">AQAsync</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnActionAsyncQuery ('Postgres 'Vanilla) Void -&gt; ActionQuery Void)
-&gt; Collector (AnnActionAsyncQuery ('Postgres 'Vanilla) Void)
-&gt; Collector (ActionQuery Void)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AnnActionAsyncQuery
     ('Postgres 'Vanilla) (RemoteRelationshipField UnpreparedValue))
  (AnnActionAsyncQuery ('Postgres 'Vanilla) Void)
  (AsyncActionQueryFieldsG (RemoteRelationshipField UnpreparedValue))
  (AsyncActionQueryFieldsG Void)
-&gt; LensLike
     Collector
     (AnnActionAsyncQuery
        ('Postgres 'Vanilla) (RemoteRelationshipField UnpreparedValue))
     (AnnActionAsyncQuery ('Postgres 'Vanilla) Void)
     (AsyncActionQueryFieldsG (RemoteRelationshipField UnpreparedValue))
     (AsyncActionQueryFieldsG Void)
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AnnActionAsyncQuery
     ('Postgres 'Vanilla) (RemoteRelationshipField UnpreparedValue))
  (AnnActionAsyncQuery ('Postgres 'Vanilla) Void)
  (AsyncActionQueryFieldsG (RemoteRelationshipField UnpreparedValue))
  (AsyncActionQueryFieldsG Void)
forall (b :: BackendType) r1 r2.
Lens
  (AnnActionAsyncQuery b r1)
  (AnnActionAsyncQuery b r2)
  (AsyncActionQueryFieldsG r1)
  (AsyncActionQueryFieldsG r2)
</span><a href="Hasura.RQL.Types.Action.html#aaaqFields"><span class="hs-identifier hs-var">aaaqFields</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AsyncActionQueryFieldG (RemoteRelationshipField UnpreparedValue)
 -&gt; Collector (AsyncActionQueryFieldG Void))
-&gt; AsyncActionQueryFieldsG
     (RemoteRelationshipField UnpreparedValue)
-&gt; Collector (AsyncActionQueryFieldsG Void)
forall a b. (a -&gt; Collector b) -&gt; Fields a -&gt; Collector (Fields b)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#traverseFields"><span class="hs-identifier hs-var">traverseFields</span></a></span><span> </span><span class="annot"><span class="annottext">AsyncActionQueryFieldG (RemoteRelationshipField UnpreparedValue)
-&gt; Collector (AsyncActionQueryFieldG Void)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformAsyncFields"><span class="hs-identifier hs-var">transformAsyncFields</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AnnActionAsyncQuery
  ('Postgres 'Vanilla) (RemoteRelationshipField UnpreparedValue)
</span><a href="#local-6989586621688527880"><span class="hs-identifier hs-var">async</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsActionMutation"><span class="hs-identifier hs-type">getRemoteJoinsActionMutation</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Root.html#ActionMutation"><span class="hs-identifier hs-type">ActionMutation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#ActionMutation"><span class="hs-identifier hs-type">ActionMutation</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#RemoteJoins"><span class="hs-identifier hs-type">RemoteJoins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span id="getRemoteJoinsActionMutation"><span class="annot"><span class="annottext">getRemoteJoinsActionMutation :: ActionMutation (RemoteRelationshipField UnpreparedValue)
-&gt; (ActionMutation Void, Maybe RemoteJoins)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsActionMutation"><span class="hs-identifier hs-var hs-var">getRemoteJoinsActionMutation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="annottext">Collector (ActionMutation Void)
-&gt; (ActionMutation Void, Maybe RemoteJoins)
forall a. Collector a -&gt; (a, Maybe RemoteJoins)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#runCollector"><span class="hs-identifier hs-var hs-var">runCollector</span></a></span><span> </span><span class="annot"><span class="annottext">(Collector (ActionMutation Void)
 -&gt; (ActionMutation Void, Maybe RemoteJoins))
-&gt; (ActionMutation (RemoteRelationshipField UnpreparedValue)
    -&gt; Collector (ActionMutation Void))
-&gt; ActionMutation (RemoteRelationshipField UnpreparedValue)
-&gt; (ActionMutation Void, Maybe RemoteJoins)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Root.html#AMAsync"><span class="hs-identifier hs-type">AMAsync</span></a></span><span> </span><span id="local-6989586621688527875"><span class="annot"><span class="annottext">AnnActionMutationAsync
</span><a href="#local-6989586621688527875"><span class="hs-identifier hs-var">async</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ActionMutation Void -&gt; Collector (ActionMutation Void)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ActionMutation Void -&gt; Collector (ActionMutation Void))
-&gt; ActionMutation Void -&gt; Collector (ActionMutation Void)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AnnActionMutationAsync -&gt; ActionMutation Void
forall r. AnnActionMutationAsync -&gt; ActionMutation r
</span><a href="Hasura.RQL.IR.Root.html#AMAsync"><span class="hs-identifier hs-var">AMAsync</span></a></span><span> </span><span class="annot"><span class="annottext">AnnActionMutationAsync
</span><a href="#local-6989586621688527875"><span class="hs-identifier hs-var">async</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Root.html#AMSync"><span class="hs-identifier hs-type">AMSync</span></a></span><span> </span><span id="local-6989586621688527873"><span class="annot"><span class="annottext">AnnActionExecution (RemoteRelationshipField UnpreparedValue)
</span><a href="#local-6989586621688527873"><span class="hs-identifier hs-var">sync</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AnnActionExecution Void -&gt; ActionMutation Void
forall r. AnnActionExecution r -&gt; ActionMutation r
</span><a href="Hasura.RQL.IR.Root.html#AMSync"><span class="hs-identifier hs-var">AMSync</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnActionExecution Void -&gt; ActionMutation Void)
-&gt; Collector (AnnActionExecution Void)
-&gt; Collector (ActionMutation Void)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">AnnActionExecution (RemoteRelationshipField UnpreparedValue)
-&gt; Collector (AnnActionExecution Void)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformSyncAction"><span class="hs-identifier hs-var">transformSyncAction</span></a></span><span> </span><span class="annot"><span class="annottext">AnnActionExecution (RemoteRelationshipField UnpreparedValue)
</span><a href="#local-6989586621688527873"><span class="hs-identifier hs-var">sync</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span id="local-6989586621688527943"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsSourceRelation"><span class="hs-identifier hs-type">getRemoteJoinsSourceRelation</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688527943"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#SourceRelationshipSelection"><span class="hs-identifier hs-type">SourceRelationshipSelection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688527943"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#SourceRelationshipSelection"><span class="hs-identifier hs-type">SourceRelationshipSelection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688527943"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#RemoteJoins"><span class="hs-identifier hs-type">RemoteJoins</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-119"></span><span id="getRemoteJoinsSourceRelation"><span class="annot"><span class="annottext">getRemoteJoinsSourceRelation :: SourceRelationshipSelection
  b (RemoteRelationshipField UnpreparedValue) UnpreparedValue
-&gt; (SourceRelationshipSelection b Void UnpreparedValue,
    Maybe RemoteJoins)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsSourceRelation"><span class="hs-identifier hs-var hs-var">getRemoteJoinsSourceRelation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><span class="annottext">Collector (SourceRelationshipSelection b Void UnpreparedValue)
-&gt; (SourceRelationshipSelection b Void UnpreparedValue,
    Maybe RemoteJoins)
forall a. Collector a -&gt; (a, Maybe RemoteJoins)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#runCollector"><span class="hs-identifier hs-var hs-var">runCollector</span></a></span><span> </span><span class="annot"><span class="annottext">(Collector (SourceRelationshipSelection b Void UnpreparedValue)
 -&gt; (SourceRelationshipSelection b Void UnpreparedValue,
     Maybe RemoteJoins))
-&gt; (SourceRelationshipSelection
      b (RemoteRelationshipField UnpreparedValue) UnpreparedValue
    -&gt; Collector (SourceRelationshipSelection b Void UnpreparedValue))
-&gt; SourceRelationshipSelection
     b (RemoteRelationshipField UnpreparedValue) UnpreparedValue
-&gt; (SourceRelationshipSelection b Void UnpreparedValue,
    Maybe RemoteJoins)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#SourceRelationshipObject"><span class="hs-identifier hs-type">SourceRelationshipObject</span></a></span><span> </span><span id="local-6989586621688527870"><span class="annot"><span class="annottext">AnnObjectSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527870"><span class="hs-identifier hs-var">objectSelect</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-122"></span><span>      </span><span class="annot"><span class="annottext">AnnObjectSelectG b Void (UnpreparedValue b)
-&gt; SourceRelationshipSelection b Void UnpreparedValue
forall (b :: BackendType) r (vf :: BackendType -&gt; *).
AnnObjectSelectG b r (vf b) -&gt; SourceRelationshipSelection b r vf
</span><a href="Hasura.RQL.IR.Select.html#SourceRelationshipObject"><span class="hs-identifier hs-var">SourceRelationshipObject</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnObjectSelectG b Void (UnpreparedValue b)
 -&gt; SourceRelationshipSelection b Void UnpreparedValue)
-&gt; Collector (AnnObjectSelectG b Void (UnpreparedValue b))
-&gt; Collector (SourceRelationshipSelection b Void UnpreparedValue)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">AnnObjectSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnObjectSelectG b Void (UnpreparedValue b))
forall (b :: BackendType).
Backend b =&gt;
AnnObjectSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnObjectSelectG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformObjectSelect"><span class="hs-identifier hs-var">transformObjectSelect</span></a></span><span> </span><span class="annot"><span class="annottext">AnnObjectSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527870"><span class="hs-identifier hs-var">objectSelect</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#SourceRelationshipArray"><span class="hs-identifier hs-type">SourceRelationshipArray</span></a></span><span> </span><span id="local-6989586621688527867"><span class="annot"><span class="annottext">AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527867"><span class="hs-identifier hs-var">simpleSelect</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-124"></span><span>      </span><span class="annot"><span class="annottext">AnnSimpleSelectG b Void (UnpreparedValue b)
-&gt; SourceRelationshipSelection b Void UnpreparedValue
forall (b :: BackendType) r (vf :: BackendType -&gt; *).
AnnSimpleSelectG b r (vf b) -&gt; SourceRelationshipSelection b r vf
</span><a href="Hasura.RQL.IR.Select.html#SourceRelationshipArray"><span class="hs-identifier hs-var">SourceRelationshipArray</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnSimpleSelectG b Void (UnpreparedValue b)
 -&gt; SourceRelationshipSelection b Void UnpreparedValue)
-&gt; Collector (AnnSimpleSelectG b Void (UnpreparedValue b))
-&gt; Collector (SourceRelationshipSelection b Void UnpreparedValue)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnSimpleSelectG b Void (UnpreparedValue b))
forall (b :: BackendType).
Backend b =&gt;
AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnSimpleSelectG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformSelect"><span class="hs-identifier hs-var">transformSelect</span></a></span><span> </span><span class="annot"><span class="annottext">AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527867"><span class="hs-identifier hs-var">simpleSelect</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#SourceRelationshipArrayAggregate"><span class="hs-identifier hs-type">SourceRelationshipArrayAggregate</span></a></span><span> </span><span id="local-6989586621688527865"><span class="annot"><span class="annottext">AnnAggregateSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527865"><span class="hs-identifier hs-var">aggregateSelect</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-126"></span><span>      </span><span class="annot"><span class="annottext">AnnAggregateSelectG b Void (UnpreparedValue b)
-&gt; SourceRelationshipSelection b Void UnpreparedValue
forall (b :: BackendType) r (vf :: BackendType -&gt; *).
AnnAggregateSelectG b r (vf b)
-&gt; SourceRelationshipSelection b r vf
</span><a href="Hasura.RQL.IR.Select.html#SourceRelationshipArrayAggregate"><span class="hs-identifier hs-var">SourceRelationshipArrayAggregate</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnAggregateSelectG b Void (UnpreparedValue b)
 -&gt; SourceRelationshipSelection b Void UnpreparedValue)
-&gt; Collector (AnnAggregateSelectG b Void (UnpreparedValue b))
-&gt; Collector (SourceRelationshipSelection b Void UnpreparedValue)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">AnnAggregateSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnAggregateSelectG b Void (UnpreparedValue b))
forall (b :: BackendType).
Backend b =&gt;
AnnAggregateSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnAggregateSelectG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformAggregateSelect"><span class="hs-identifier hs-var">transformAggregateSelect</span></a></span><span> </span><span class="annot"><span class="annottext">AnnAggregateSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527865"><span class="hs-identifier hs-var">aggregateSelect</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span id="local-6989586621688527864"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsGraphQLField"><span class="hs-identifier hs-type">getRemoteJoinsGraphQLField</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-129"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#GraphQLField"><span class="hs-identifier hs-type">GraphQLField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621688527864"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#GraphQLField"><span class="hs-identifier hs-type">GraphQLField</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="annot"><a href="#local-6989586621688527864"><span class="hs-identifier hs-type">var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#RemoteJoins"><span class="hs-identifier hs-type">RemoteJoins</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-131"></span><span id="getRemoteJoinsGraphQLField"><span class="annot"><span class="annottext">getRemoteJoinsGraphQLField :: GraphQLField (RemoteRelationshipField UnpreparedValue) var
-&gt; (GraphQLField Void var, Maybe RemoteJoins)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsGraphQLField"><span class="hs-identifier hs-var hs-var">getRemoteJoinsGraphQLField</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><span class="annottext">Collector (GraphQLField Void var)
-&gt; (GraphQLField Void var, Maybe RemoteJoins)
forall a. Collector a -&gt; (a, Maybe RemoteJoins)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#runCollector"><span class="hs-identifier hs-var hs-var">runCollector</span></a></span><span> </span><span class="annot"><span class="annottext">(Collector (GraphQLField Void var)
 -&gt; (GraphQLField Void var, Maybe RemoteJoins))
-&gt; (GraphQLField (RemoteRelationshipField UnpreparedValue) var
    -&gt; Collector (GraphQLField Void var))
-&gt; GraphQLField (RemoteRelationshipField UnpreparedValue) var
-&gt; (GraphQLField Void var, Maybe RemoteJoins)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GraphQLField (RemoteRelationshipField UnpreparedValue) var
-&gt; Collector (GraphQLField Void var)
forall var.
GraphQLField (RemoteRelationshipField UnpreparedValue) var
-&gt; Collector (GraphQLField Void var)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformGraphQLField"><span class="hs-identifier hs-var">transformGraphQLField</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span id="local-6989586621688527958"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsGraphQLSelectionSet"><span class="hs-identifier hs-type">getRemoteJoinsGraphQLSelectionSet</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-135"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#SelectionSet"><span class="hs-identifier hs-type">SelectionSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621688527958"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#SelectionSet"><span class="hs-identifier hs-type">SelectionSet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="annot"><a href="#local-6989586621688527958"><span class="hs-identifier hs-type">var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#RemoteJoins"><span class="hs-identifier hs-type">RemoteJoins</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-137"></span><span id="getRemoteJoinsGraphQLSelectionSet"><span class="annot"><span class="annottext">getRemoteJoinsGraphQLSelectionSet :: SelectionSet (RemoteRelationshipField UnpreparedValue) var
-&gt; (SelectionSet Void var, Maybe RemoteJoins)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsGraphQLSelectionSet"><span class="hs-identifier hs-var hs-var">getRemoteJoinsGraphQLSelectionSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-138"></span><span>  </span><span class="annot"><span class="annottext">Collector (SelectionSet Void var)
-&gt; (SelectionSet Void var, Maybe RemoteJoins)
forall a. Collector a -&gt; (a, Maybe RemoteJoins)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#runCollector"><span class="hs-identifier hs-var hs-var">runCollector</span></a></span><span> </span><span class="annot"><span class="annottext">(Collector (SelectionSet Void var)
 -&gt; (SelectionSet Void var, Maybe RemoteJoins))
-&gt; (SelectionSet (RemoteRelationshipField UnpreparedValue) var
    -&gt; Collector (SelectionSet Void var))
-&gt; SelectionSet (RemoteRelationshipField UnpreparedValue) var
-&gt; (SelectionSet Void var, Maybe RemoteJoins)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SelectionSet (RemoteRelationshipField UnpreparedValue) var
-&gt; Collector (SelectionSet Void var)
forall var.
SelectionSet (RemoteRelationshipField UnpreparedValue) var
-&gt; Collector (SelectionSet Void var)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformGraphQLSelectionSet"><span class="hs-identifier hs-var">transformGraphQLSelectionSet</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">-- | A writer monad used to collect together all remote joins</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- appearing in some data structure.</span><span>
</span><span id="line-144"></span><span class="hs-comment">--</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- In the functions below, the 'withField' function is used to track the</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- context of the path from the root of the current selection set.</span><span>
</span><span id="line-147"></span><span class="hs-comment">--</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- It is important that we work bottom-up, and do not 'collect' duplicate</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- field names at any level, because the 'Semigroup' instance for 'RemoteJoins'</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- does not allow for these duplicates.</span><span>
</span><span id="line-151"></span><span class="hs-keyword">newtype</span><span> </span><span id="Collector"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-var">Collector</span></a></span></span><span> </span><span id="local-6989586621688528354"><span class="annot"><a href="#local-6989586621688528354"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Collector"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-var">Collector</span></a></span></span><span> </span><span class="hs-special">{</span><span id="runCollector"><span class="annot"><span class="annottext">Collector a -&gt; (a, Maybe RemoteJoins)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#runCollector"><span class="hs-identifier hs-var hs-var">runCollector</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621688528354"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#RemoteJoins"><span class="hs-identifier hs-type">RemoteJoins</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-keyword">deriving</span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621688527856"><span id="local-6989586621688527858"><span class="annot"><span class="annottext">a -&gt; Collector b -&gt; Collector a
(a -&gt; b) -&gt; Collector a -&gt; Collector b
(forall a b. (a -&gt; b) -&gt; Collector a -&gt; Collector b)
-&gt; (forall a b. a -&gt; Collector b -&gt; Collector a)
-&gt; Functor Collector
forall a b. a -&gt; Collector b -&gt; Collector a
forall a b. (a -&gt; b) -&gt; Collector a -&gt; Collector b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; Collector b -&gt; Collector a
$c&lt;$ :: forall a b. a -&gt; Collector b -&gt; Collector a
fmap :: (a -&gt; b) -&gt; Collector a -&gt; Collector b
$cfmap :: forall a b. (a -&gt; b) -&gt; Collector a -&gt; Collector b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688527844"><span id="local-6989586621688527846"><span id="local-6989586621688527848"><span id="local-6989586621688527850"><span id="local-6989586621688527852"><span class="annot"><span class="annottext">Functor Collector
a -&gt; Collector a
Functor Collector
-&gt; (forall a. a -&gt; Collector a)
-&gt; (forall a b. Collector (a -&gt; b) -&gt; Collector a -&gt; Collector b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; Collector a -&gt; Collector b -&gt; Collector c)
-&gt; (forall a b. Collector a -&gt; Collector b -&gt; Collector b)
-&gt; (forall a b. Collector a -&gt; Collector b -&gt; Collector a)
-&gt; Applicative Collector
Collector a -&gt; Collector b -&gt; Collector b
Collector a -&gt; Collector b -&gt; Collector a
Collector (a -&gt; b) -&gt; Collector a -&gt; Collector b
(a -&gt; b -&gt; c) -&gt; Collector a -&gt; Collector b -&gt; Collector c
forall a. a -&gt; Collector a
forall a b. Collector a -&gt; Collector b -&gt; Collector a
forall a b. Collector a -&gt; Collector b -&gt; Collector b
forall a b. Collector (a -&gt; b) -&gt; Collector a -&gt; Collector b
forall a b c.
(a -&gt; b -&gt; c) -&gt; Collector a -&gt; Collector b -&gt; Collector c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: Collector a -&gt; Collector b -&gt; Collector a
$c&lt;* :: forall a b. Collector a -&gt; Collector b -&gt; Collector a
*&gt; :: Collector a -&gt; Collector b -&gt; Collector b
$c*&gt; :: forall a b. Collector a -&gt; Collector b -&gt; Collector b
liftA2 :: (a -&gt; b -&gt; c) -&gt; Collector a -&gt; Collector b -&gt; Collector c
$cliftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; Collector a -&gt; Collector b -&gt; Collector c
&lt;*&gt; :: Collector (a -&gt; b) -&gt; Collector a -&gt; Collector b
$c&lt;*&gt; :: forall a b. Collector (a -&gt; b) -&gt; Collector a -&gt; Collector b
pure :: a -&gt; Collector a
$cpure :: forall a. a -&gt; Collector a
$cp1Applicative :: Functor Collector
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688527836"><span id="local-6989586621688527838"><span id="local-6989586621688527840"><span class="annot"><span class="annottext">Applicative Collector
a -&gt; Collector a
Applicative Collector
-&gt; (forall a b. Collector a -&gt; (a -&gt; Collector b) -&gt; Collector b)
-&gt; (forall a b. Collector a -&gt; Collector b -&gt; Collector b)
-&gt; (forall a. a -&gt; Collector a)
-&gt; Monad Collector
Collector a -&gt; (a -&gt; Collector b) -&gt; Collector b
Collector a -&gt; Collector b -&gt; Collector b
forall a. a -&gt; Collector a
forall a b. Collector a -&gt; Collector b -&gt; Collector b
forall a b. Collector a -&gt; (a -&gt; Collector b) -&gt; Collector b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: a -&gt; Collector a
$creturn :: forall a. a -&gt; Collector a
&gt;&gt; :: Collector a -&gt; Collector b -&gt; Collector b
$c&gt;&gt; :: forall a b. Collector a -&gt; Collector b -&gt; Collector b
&gt;&gt;= :: Collector a -&gt; (a -&gt; Collector b) -&gt; Collector b
$c&gt;&gt;= :: forall a b. Collector a -&gt; (a -&gt; Collector b) -&gt; Collector b
$cp1Monad :: Applicative Collector
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688527825"><span id="local-6989586621688527827"><span id="local-6989586621688527829"><span id="local-6989586621688527831"><span class="annot"><span class="hs-identifier hs-type">MonadWriter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#RemoteJoins"><span class="hs-identifier hs-type">RemoteJoins</span></a></span><span class="hs-special">)</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-keyword">via</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Writer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#RemoteJoins"><span class="hs-identifier hs-type">RemoteJoins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- | Collect some remote joins appearing at the given field names in the current</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- context.</span><span>
</span><span id="line-158"></span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#collect"><span class="hs-identifier hs-type">collect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.HashMap.Strict.NonEmpty.html#NEHashMap"><span class="hs-identifier hs-type">NEHashMap</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#QualifiedFieldName"><span class="hs-identifier hs-type">QualifiedFieldName</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#RemoteJoin"><span class="hs-identifier hs-type">RemoteJoin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-type">Collector</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span id="collect"><span class="annot"><span class="annottext">collect :: NEHashMap QualifiedFieldName RemoteJoin -&gt; Collector ()
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#collect"><span class="hs-identifier hs-var hs-var">collect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe RemoteJoins -&gt; Collector ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="annot"><span class="annottext">(Maybe RemoteJoins -&gt; Collector ())
-&gt; (NEHashMap QualifiedFieldName RemoteJoin -&gt; Maybe RemoteJoins)
-&gt; NEHashMap QualifiedFieldName RemoteJoin
-&gt; Collector ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RemoteJoins -&gt; Maybe RemoteJoins
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(RemoteJoins -&gt; Maybe RemoteJoins)
-&gt; (NEHashMap QualifiedFieldName RemoteJoin -&gt; RemoteJoins)
-&gt; NEHashMap QualifiedFieldName RemoteJoin
-&gt; Maybe RemoteJoins
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NEHashMap QualifiedFieldName (JoinNode RemoteJoin) -&gt; RemoteJoins
forall a. NEHashMap QualifiedFieldName (JoinNode a) -&gt; JoinTree a
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#JoinTree"><span class="hs-identifier hs-var">JoinTree</span></a></span><span> </span><span class="annot"><span class="annottext">(NEHashMap QualifiedFieldName (JoinNode RemoteJoin) -&gt; RemoteJoins)
-&gt; (NEHashMap QualifiedFieldName RemoteJoin
    -&gt; NEHashMap QualifiedFieldName (JoinNode RemoteJoin))
-&gt; NEHashMap QualifiedFieldName RemoteJoin
-&gt; RemoteJoins
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(RemoteJoin -&gt; JoinNode RemoteJoin)
-&gt; NEHashMap QualifiedFieldName RemoteJoin
-&gt; NEHashMap QualifiedFieldName (JoinNode RemoteJoin)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">RemoteJoin -&gt; JoinNode RemoteJoin
forall a. a -&gt; JoinNode a
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#Leaf"><span class="hs-identifier hs-var">Leaf</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-comment">-- | Keep track of the given field name in the current path from the root of the</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- selection set.</span><span>
</span><span id="line-163"></span><span id="local-6989586621688528197"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#withField"><span class="hs-identifier hs-type">withField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-type">Collector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528197"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-type">Collector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528197"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-164"></span><span id="withField"><span class="annot"><span class="annottext">withField :: Maybe Text -&gt; Text -&gt; Collector a -&gt; Collector a
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#withField"><span class="hs-identifier hs-var hs-var">withField</span></a></span></span><span> </span><span id="local-6989586621688527817"><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621688527817"><span class="hs-identifier hs-var">typeName</span></a></span></span><span> </span><span id="local-6989586621688527816"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621688527816"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe RemoteJoins -&gt; Maybe RemoteJoins)
-&gt; Collector a -&gt; Collector a
forall w (m :: * -&gt; *) a. MonadWriter w m =&gt; (w -&gt; w) -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">censor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RemoteJoins -&gt; RemoteJoins)
-&gt; Maybe RemoteJoins -&gt; Maybe RemoteJoins
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">RemoteJoins -&gt; RemoteJoins
</span><a href="#local-6989586621688527814"><span class="hs-identifier hs-var">wrap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621688527814"><span class="annot"><span class="annottext">wrap :: RemoteJoins -&gt; RemoteJoins
</span><a href="#local-6989586621688527814"><span class="hs-identifier hs-var hs-var">wrap</span></a></span></span><span> </span><span id="local-6989586621688527813"><span class="annot"><span class="annottext">RemoteJoins
</span><a href="#local-6989586621688527813"><span class="hs-identifier hs-var">rjs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NEHashMap QualifiedFieldName (JoinNode RemoteJoin) -&gt; RemoteJoins
forall a. NEHashMap QualifiedFieldName (JoinNode a) -&gt; JoinTree a
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#JoinTree"><span class="hs-identifier hs-var">JoinTree</span></a></span><span> </span><span class="annot"><span class="annottext">(NEHashMap QualifiedFieldName (JoinNode RemoteJoin) -&gt; RemoteJoins)
-&gt; NEHashMap QualifiedFieldName (JoinNode RemoteJoin)
-&gt; RemoteJoins
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QualifiedFieldName
-&gt; JoinNode RemoteJoin
-&gt; NEHashMap QualifiedFieldName (JoinNode RemoteJoin)
forall k v. Hashable k =&gt; k -&gt; v -&gt; NEHashMap k v
</span><a href="Data.HashMap.Strict.NonEmpty.html#singleton"><span class="hs-identifier hs-var">NEMap.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; Text -&gt; QualifiedFieldName
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#QualifiedFieldName"><span class="hs-identifier hs-var">QualifiedFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
</span><a href="#local-6989586621688527817"><span class="hs-identifier hs-var">typeName</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621688527816"><span class="hs-identifier hs-var">fieldName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RemoteJoins -&gt; JoinNode RemoteJoin
forall a. JoinTree a -&gt; JoinNode a
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#Tree"><span class="hs-identifier hs-var">Tree</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteJoins
</span><a href="#local-6989586621688527813"><span class="hs-identifier hs-var">rjs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- | Traverse a list of fields, while applying 'withField' to keep track of the</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- path within the AST. This function assumes that no type name is required for</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- the 'QualifiedFieldName' and uses 'Nothing'.</span><span>
</span><span id="line-171"></span><span id="local-6989586621688528292"><span id="local-6989586621688528293"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#traverseFields"><span class="hs-identifier hs-type">traverseFields</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621688528293"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-type">Collector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528292"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-173"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#Fields"><span class="hs-identifier hs-type">Fields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528293"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-174"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-type">Collector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Common.html#Fields"><span class="hs-identifier hs-type">Fields</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528292"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-175"></span><span id="traverseFields"><span class="annot"><span class="annottext">traverseFields :: (a -&gt; Collector b) -&gt; Fields a -&gt; Collector (Fields b)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#traverseFields"><span class="hs-identifier hs-var hs-var">traverseFields</span></a></span></span><span> </span><span id="local-6989586621688527809"><span class="annot"><span class="annottext">a -&gt; Collector b
</span><a href="#local-6989586621688527809"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-176"></span><span>  </span><span class="annot"><span class="annottext">((FieldName, a) -&gt; Collector (FieldName, b))
-&gt; Fields a -&gt; Collector (Fields b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621688527807"><span class="annot"><span class="annottext">field :: (FieldName, a)
</span><a href="#local-6989586621688527807"><span class="hs-identifier hs-var">field</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621688527806"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527806"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">Maybe Text
-&gt; Text -&gt; Collector (FieldName, b) -&gt; Collector (FieldName, b)
forall a. Maybe Text -&gt; Text -&gt; Collector a -&gt; Collector a
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#withField"><span class="hs-identifier hs-var">withField</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; Text
</span><a href="Hasura.RQL.Types.Common.html#getFieldNameTxt"><span class="hs-identifier hs-var hs-var">getFieldNameTxt</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527806"><span class="hs-identifier hs-var">fieldName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Collector (FieldName, b) -&gt; Collector (FieldName, b))
-&gt; Collector (FieldName, b) -&gt; Collector (FieldName, b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Collector b) -&gt; (FieldName, a) -&gt; Collector (FieldName, b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Collector b
</span><a href="#local-6989586621688527809"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldName, a)
</span><a href="#local-6989586621688527807"><span class="hs-identifier hs-var">field</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- Internal AST traversals</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformAsyncFields"><span class="hs-identifier hs-type">transformAsyncFields</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-183"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Action.html#AsyncActionQueryFieldG"><span class="hs-identifier hs-type">AsyncActionQueryFieldG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-type">Collector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Action.html#AsyncActionQueryFieldG"><span class="hs-identifier hs-type">AsyncActionQueryFieldG</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span id="transformAsyncFields"><span class="annot"><span class="annottext">transformAsyncFields :: AsyncActionQueryFieldG (RemoteRelationshipField UnpreparedValue)
-&gt; Collector (AsyncActionQueryFieldG Void)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformAsyncFields"><span class="hs-identifier hs-var hs-var">transformAsyncFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AsyncActionQueryFieldG (RemoteRelationshipField UnpreparedValue))
  (AsyncActionQueryFieldG Void)
  (ActionFieldsG (RemoteRelationshipField UnpreparedValue))
  ActionFields
-&gt; LensLike
     Collector
     (AsyncActionQueryFieldG (RemoteRelationshipField UnpreparedValue))
     (AsyncActionQueryFieldG Void)
     (ActionFieldsG (RemoteRelationshipField UnpreparedValue))
     ActionFields
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AsyncActionQueryFieldG (RemoteRelationshipField UnpreparedValue))
  (AsyncActionQueryFieldG Void)
  (ActionFieldsG (RemoteRelationshipField UnpreparedValue))
  ActionFields
forall r1 r2.
Prism
  (AsyncActionQueryFieldG r1)
  (AsyncActionQueryFieldG r2)
  (ActionFieldsG r1)
  (ActionFieldsG r2)
</span><a href="Hasura.RQL.Types.Action.html#_AsyncOutput"><span class="hs-identifier hs-var">_AsyncOutput</span></a></span><span> </span><span class="annot"><span class="annottext">ActionFieldsG (RemoteRelationshipField UnpreparedValue)
-&gt; Collector ActionFields
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformActionFields"><span class="hs-identifier hs-var">transformActionFields</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span id="local-6989586621688528316"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformMutationOutput"><span class="hs-identifier hs-type">transformMutationOutput</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528316"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Returning.html#MutationOutputG"><span class="hs-identifier hs-type">MutationOutputG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528316"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528316"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-type">Collector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Returning.html#MutationOutputG"><span class="hs-identifier hs-type">MutationOutputG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528316"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528316"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-191"></span><span id="transformMutationOutput"><span class="annot"><span class="annottext">transformMutationOutput :: MutationOutputG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (MutationOutputG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformMutationOutput"><span class="hs-identifier hs-var hs-var">transformMutationOutput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-192"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Returning.html#MOutMultirowFields"><span class="hs-identifier hs-type">MOutMultirowFields</span></a></span><span> </span><span id="local-6989586621688527801"><span class="annot"><span class="annottext">MutFldsG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527801"><span class="hs-identifier hs-var">mutationFields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><span class="annottext">MutFldsG b Void (UnpreparedValue b)
-&gt; MutationOutputG b Void (UnpreparedValue b)
forall (b :: BackendType) r v.
MutFldsG b r v -&gt; MutationOutputG b r v
</span><a href="Hasura.RQL.IR.Returning.html#MOutMultirowFields"><span class="hs-identifier hs-var">MOutMultirowFields</span></a></span><span> </span><span class="annot"><span class="annottext">(MutFldsG b Void (UnpreparedValue b)
 -&gt; MutationOutputG b Void (UnpreparedValue b))
-&gt; Collector (MutFldsG b Void (UnpreparedValue b))
-&gt; Collector (MutationOutputG b Void (UnpreparedValue b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">MutFldsG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (MutFldsG b Void (UnpreparedValue b))
</span><a href="#local-6989586621688527800"><span class="hs-identifier hs-var">transformMutationFields</span></a></span><span> </span><span class="annot"><span class="annottext">MutFldsG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527801"><span class="hs-identifier hs-var">mutationFields</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Returning.html#MOutSinglerowObject"><span class="hs-identifier hs-type">MOutSinglerowObject</span></a></span><span> </span><span id="local-6989586621688527798"><span class="annot"><span class="annottext">AnnFieldsG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527798"><span class="hs-identifier hs-var">annFields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><span class="annottext">AnnFieldsG b Void (UnpreparedValue b)
-&gt; MutationOutputG b Void (UnpreparedValue b)
forall (b :: BackendType) r v.
AnnFieldsG b r v -&gt; MutationOutputG b r v
</span><a href="Hasura.RQL.IR.Returning.html#MOutSinglerowObject"><span class="hs-identifier hs-var">MOutSinglerowObject</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnFieldsG b Void (UnpreparedValue b)
 -&gt; MutationOutputG b Void (UnpreparedValue b))
-&gt; Collector (AnnFieldsG b Void (UnpreparedValue b))
-&gt; Collector (MutationOutputG b Void (UnpreparedValue b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">AnnFieldsG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnFieldsG b Void (UnpreparedValue b))
forall (src :: BackendType).
Backend src =&gt;
AnnFieldsG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; Collector (AnnFieldsG src Void (UnpreparedValue src))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformAnnFields"><span class="hs-identifier hs-var">transformAnnFields</span></a></span><span> </span><span class="annot"><span class="annottext">AnnFieldsG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527798"><span class="hs-identifier hs-var">annFields</span></a></span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-197"></span><span>    </span><span id="local-6989586621688527800"><span class="annot"><span class="annottext">transformMutationFields :: MutFldsG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (MutFldsG b Void (UnpreparedValue b))
</span><a href="#local-6989586621688527800"><span class="hs-identifier hs-var hs-var">transformMutationFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(MutFldG
   b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
 -&gt; Collector (MutFldG b Void (UnpreparedValue b)))
-&gt; MutFldsG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (MutFldsG b Void (UnpreparedValue b))
forall a b. (a -&gt; Collector b) -&gt; Fields a -&gt; Collector (Fields b)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#traverseFields"><span class="hs-identifier hs-var">traverseFields</span></a></span><span> </span><span class="annot"><span class="annottext">((MutFldG
    b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
  -&gt; Collector (MutFldG b Void (UnpreparedValue b)))
 -&gt; MutFldsG
      b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
 -&gt; Collector (MutFldsG b Void (UnpreparedValue b)))
-&gt; (MutFldG
      b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
    -&gt; Collector (MutFldG b Void (UnpreparedValue b)))
-&gt; MutFldsG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (MutFldsG b Void (UnpreparedValue b))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (MutFldG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (MutFldG b Void (UnpreparedValue b))
  (AnnFieldsG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnFieldsG b Void (UnpreparedValue b))
-&gt; LensLike
     Collector
     (MutFldG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (MutFldG b Void (UnpreparedValue b))
     (AnnFieldsG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (AnnFieldsG b Void (UnpreparedValue b))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (MutFldG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (MutFldG b Void (UnpreparedValue b))
  (AnnFieldsG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnFieldsG b Void (UnpreparedValue b))
forall (b1 :: BackendType) r1 v1 (b2 :: BackendType) r2 v2.
Prism
  (MutFldG b1 r1 v1)
  (MutFldG b2 r2 v2)
  (AnnFieldsG b1 r1 v1)
  (AnnFieldsG b2 r2 v2)
</span><a href="Hasura.RQL.IR.Returning.html#_MRet"><span class="hs-identifier hs-var">_MRet</span></a></span><span> </span><span class="annot"><span class="annottext">AnnFieldsG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnFieldsG b Void (UnpreparedValue b))
forall (src :: BackendType).
Backend src =&gt;
AnnFieldsG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; Collector (AnnFieldsG src Void (UnpreparedValue src))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformAnnFields"><span class="hs-identifier hs-var">transformAnnFields</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformSyncAction"><span class="hs-identifier hs-type">transformSyncAction</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-200"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Action.html#AnnActionExecution"><span class="hs-identifier hs-type">AnnActionExecution</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-type">Collector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Action.html#AnnActionExecution"><span class="hs-identifier hs-type">AnnActionExecution</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span id="transformSyncAction"><span class="annot"><span class="annottext">transformSyncAction :: AnnActionExecution (RemoteRelationshipField UnpreparedValue)
-&gt; Collector (AnnActionExecution Void)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformSyncAction"><span class="hs-identifier hs-var hs-var">transformSyncAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AnnActionExecution (RemoteRelationshipField UnpreparedValue))
  (AnnActionExecution Void)
  (ActionFieldsG (RemoteRelationshipField UnpreparedValue))
  ActionFields
-&gt; LensLike
     Collector
     (AnnActionExecution (RemoteRelationshipField UnpreparedValue))
     (AnnActionExecution Void)
     (ActionFieldsG (RemoteRelationshipField UnpreparedValue))
     ActionFields
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AnnActionExecution (RemoteRelationshipField UnpreparedValue))
  (AnnActionExecution Void)
  (ActionFieldsG (RemoteRelationshipField UnpreparedValue))
  ActionFields
forall r1 r2.
Lens
  (AnnActionExecution r1)
  (AnnActionExecution r2)
  (ActionFieldsG r1)
  (ActionFieldsG r2)
</span><a href="Hasura.RQL.Types.Action.html#aaeFields"><span class="hs-identifier hs-var">aaeFields</span></a></span><span> </span><span class="annot"><span class="annottext">ActionFieldsG (RemoteRelationshipField UnpreparedValue)
-&gt; Collector ActionFields
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformActionFields"><span class="hs-identifier hs-var">transformActionFields</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span id="local-6989586621688528342"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformSelect"><span class="hs-identifier hs-type">transformSelect</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528342"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnSimpleSelectG"><span class="hs-identifier hs-type">AnnSimpleSelectG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528342"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528342"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-type">Collector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnSimpleSelectG"><span class="hs-identifier hs-type">AnnSimpleSelectG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528342"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528342"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-208"></span><span id="transformSelect"><span class="annot"><span class="annottext">transformSelect :: AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnSimpleSelectG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformSelect"><span class="hs-identifier hs-var hs-var">transformSelect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AnnSimpleSelectG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnSimpleSelectG b Void (UnpreparedValue b))
  (Fields
     (AnnFieldG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)))
  (Fields (AnnFieldG b Void (UnpreparedValue b)))
-&gt; LensLike
     Collector
     (AnnSimpleSelectG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (AnnSimpleSelectG b Void (UnpreparedValue b))
     (Fields
        (AnnFieldG
           b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)))
     (Fields (AnnFieldG b Void (UnpreparedValue b)))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AnnSimpleSelectG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnSimpleSelectG b Void (UnpreparedValue b))
  (Fields
     (AnnFieldG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)))
  (Fields (AnnFieldG b Void (UnpreparedValue b)))
forall (b :: BackendType) (f1 :: * -&gt; *) v (f2 :: * -&gt; *).
Lens
  (AnnSelectG b f1 v)
  (AnnSelectG b f2 v)
  (Fields (f1 v))
  (Fields (f2 v))
</span><a href="Hasura.RQL.IR.Select.html#asnFields"><span class="hs-identifier hs-var">asnFields</span></a></span><span> </span><span class="annot"><span class="annottext">Fields
  (AnnFieldG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
-&gt; Collector (Fields (AnnFieldG b Void (UnpreparedValue b)))
forall (src :: BackendType).
Backend src =&gt;
AnnFieldsG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; Collector (AnnFieldsG src Void (UnpreparedValue src))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformAnnFields"><span class="hs-identifier hs-var">transformAnnFields</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span id="local-6989586621688528335"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformStreamSelect"><span class="hs-identifier hs-type">transformStreamSelect</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528335"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnSimpleStreamSelectG"><span class="hs-identifier hs-type">AnnSimpleStreamSelectG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528335"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528335"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-213"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-type">Collector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnSimpleStreamSelectG"><span class="hs-identifier hs-type">AnnSimpleStreamSelectG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528335"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528335"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-214"></span><span id="transformStreamSelect"><span class="annot"><span class="annottext">transformStreamSelect :: AnnSimpleStreamSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnSimpleStreamSelectG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformStreamSelect"><span class="hs-identifier hs-var hs-var">transformStreamSelect</span></a></span></span><span> </span><span id="local-6989586621688527793"><span class="annot"><span class="annottext">select :: AnnSimpleStreamSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527793"><span class="hs-identifier hs-var">select</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnSelectStreamG"><span class="hs-identifier hs-type">AnnSelectStreamG</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">_assnFields :: forall (b :: BackendType) (f :: * -&gt; *) v.
AnnSelectStreamG b f v -&gt; Fields (f v)
</span><a href="Hasura.RQL.IR.Select.html#_assnFields"><span class="hs-identifier hs-var">_assnFields</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621688527790"><span class="annot"><span class="annottext">Fields
  (AnnFieldG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
</span><a href="#local-6989586621688527790"><span class="hs-identifier hs-var">fields</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-comment">-- Transform selects in array, object and computed fields</span><span>
</span><span id="line-216"></span><span>  </span><span id="local-6989586621688527789"><span class="annot"><span class="annottext">AnnFieldsG b Void (UnpreparedValue b)
</span><a href="#local-6989586621688527789"><span class="hs-identifier hs-var">transformedFields</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Fields
  (AnnFieldG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
-&gt; Collector (AnnFieldsG b Void (UnpreparedValue b))
forall (src :: BackendType).
Backend src =&gt;
AnnFieldsG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; Collector (AnnFieldsG src Void (UnpreparedValue src))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformAnnFields"><span class="hs-identifier hs-var">transformAnnFields</span></a></span><span> </span><span class="annot"><span class="annottext">Fields
  (AnnFieldG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
</span><a href="#local-6989586621688527790"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><span class="annottext">AnnSimpleStreamSelectG b Void (UnpreparedValue b)
-&gt; Collector (AnnSimpleStreamSelectG b Void (UnpreparedValue b))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">AnnSimpleStreamSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
</span><a href="#local-6989586621688527793"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">_assnFields :: AnnFieldsG b Void (UnpreparedValue b)
</span><a href="Hasura.RQL.IR.Select.html#_assnFields"><span class="hs-identifier hs-var">_assnFields</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AnnFieldsG b Void (UnpreparedValue b)
</span><a href="#local-6989586621688527789"><span class="hs-identifier hs-var">transformedFields</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span id="local-6989586621688528339"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformAggregateSelect"><span class="hs-identifier hs-type">transformAggregateSelect</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-220"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528339"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnAggregateSelectG"><span class="hs-identifier hs-type">AnnAggregateSelectG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528339"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528339"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-222"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-type">Collector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnAggregateSelectG"><span class="hs-identifier hs-type">AnnAggregateSelectG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528339"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528339"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-223"></span><span id="transformAggregateSelect"><span class="annot"><span class="annottext">transformAggregateSelect :: AnnAggregateSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnAggregateSelectG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformAggregateSelect"><span class="hs-identifier hs-var hs-var">transformAggregateSelect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AnnAggregateSelectG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnAggregateSelectG b Void (UnpreparedValue b))
  (Fields
     (TableAggregateFieldG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)))
  (Fields (TableAggregateFieldG b Void (UnpreparedValue b)))
-&gt; LensLike
     Collector
     (AnnAggregateSelectG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (AnnAggregateSelectG b Void (UnpreparedValue b))
     (Fields
        (TableAggregateFieldG
           b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)))
     (Fields (TableAggregateFieldG b Void (UnpreparedValue b)))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AnnAggregateSelectG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnAggregateSelectG b Void (UnpreparedValue b))
  (Fields
     (TableAggregateFieldG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)))
  (Fields (TableAggregateFieldG b Void (UnpreparedValue b)))
forall (b :: BackendType) (f1 :: * -&gt; *) v (f2 :: * -&gt; *).
Lens
  (AnnSelectG b f1 v)
  (AnnSelectG b f2 v)
  (Fields (f1 v))
  (Fields (f2 v))
</span><a href="Hasura.RQL.IR.Select.html#asnFields"><span class="hs-identifier hs-var">asnFields</span></a></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AnnAggregateSelectG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnAggregateSelectG b Void (UnpreparedValue b))
  (Fields
     (TableAggregateFieldG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)))
  (Fields (TableAggregateFieldG b Void (UnpreparedValue b)))
-&gt; LensLike
     Collector
     (AnnAggregateSelectG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (AnnAggregateSelectG b Void (UnpreparedValue b))
     (Fields
        (TableAggregateFieldG
           b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)))
     (Fields (TableAggregateFieldG b Void (UnpreparedValue b)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><span class="annottext">(TableAggregateFieldG
   b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
 -&gt; Collector (TableAggregateFieldG b Void (UnpreparedValue b)))
-&gt; Fields
     (TableAggregateFieldG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
-&gt; Collector
     (Fields (TableAggregateFieldG b Void (UnpreparedValue b)))
forall a b. (a -&gt; Collector b) -&gt; Fields a -&gt; Collector (Fields b)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#traverseFields"><span class="hs-identifier hs-var">traverseFields</span></a></span><span> </span><span class="annot"><span class="annottext">((TableAggregateFieldG
    b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
  -&gt; Collector (TableAggregateFieldG b Void (UnpreparedValue b)))
 -&gt; Fields
      (TableAggregateFieldG
         b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
 -&gt; Collector
      (Fields (TableAggregateFieldG b Void (UnpreparedValue b))))
-&gt; (TableAggregateFieldG
      b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
    -&gt; Collector (TableAggregateFieldG b Void (UnpreparedValue b)))
-&gt; Fields
     (TableAggregateFieldG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
-&gt; Collector
     (Fields (TableAggregateFieldG b Void (UnpreparedValue b)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (TableAggregateFieldG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (TableAggregateFieldG b Void (UnpreparedValue b))
  [(FieldName,
    AnnFieldG
      b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))]
  (AnnFieldsG b Void (UnpreparedValue b))
-&gt; LensLike
     Collector
     (TableAggregateFieldG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (TableAggregateFieldG b Void (UnpreparedValue b))
     [(FieldName,
       AnnFieldG
         b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))]
     (AnnFieldsG b Void (UnpreparedValue b))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((XNodesAgg b,
  [(FieldName,
    AnnFieldG
      b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))])
 -&gt; Collector (XNodesAgg b, AnnFieldsG b Void (UnpreparedValue b)))
-&gt; TableAggregateFieldG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (TableAggregateFieldG b Void (UnpreparedValue b))
forall (b :: BackendType) r1 v1 r2 v2.
Prism
  (TableAggregateFieldG b r1 v1)
  (TableAggregateFieldG b r2 v2)
  (XNodesAgg b, AnnFieldsG b r1 v1)
  (XNodesAgg b, AnnFieldsG b r2 v2)
</span><a href="Hasura.RQL.IR.Select.html#_TAFNodes"><span class="hs-identifier hs-var">_TAFNodes</span></a></span><span> </span><span class="annot"><span class="annottext">(((XNodesAgg b,
   [(FieldName,
     AnnFieldG
       b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))])
  -&gt; Collector (XNodesAgg b, AnnFieldsG b Void (UnpreparedValue b)))
 -&gt; TableAggregateFieldG
      b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
 -&gt; Collector (TableAggregateFieldG b Void (UnpreparedValue b)))
-&gt; (([(FieldName,
       AnnFieldG
         b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))]
     -&gt; Collector (AnnFieldsG b Void (UnpreparedValue b)))
    -&gt; (XNodesAgg b,
        [(FieldName,
          AnnFieldG
            b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))])
    -&gt; Collector (XNodesAgg b, AnnFieldsG b Void (UnpreparedValue b)))
-&gt; LensLike
     Collector
     (TableAggregateFieldG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (TableAggregateFieldG b Void (UnpreparedValue b))
     [(FieldName,
       AnnFieldG
         b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))]
     (AnnFieldsG b Void (UnpreparedValue b))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([(FieldName,
   AnnFieldG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))]
 -&gt; Collector (AnnFieldsG b Void (UnpreparedValue b)))
-&gt; (XNodesAgg b,
    [(FieldName,
      AnnFieldG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))])
-&gt; Collector (XNodesAgg b, AnnFieldsG b Void (UnpreparedValue b))
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(FieldName,
  AnnFieldG
    b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))]
-&gt; Collector (AnnFieldsG b Void (UnpreparedValue b))
forall (src :: BackendType).
Backend src =&gt;
AnnFieldsG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; Collector (AnnFieldsG src Void (UnpreparedValue src))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformAnnFields"><span class="hs-identifier hs-var">transformAnnFields</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-comment">-- Relay doesn't support remote relationships: we can drill down directly to the</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- inner non-relay selection sets.</span><span>
</span><span id="line-229"></span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformConnectionSelect"><span class="hs-identifier hs-type">transformConnectionSelect</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621688528337"><span class="annot"><a href="#local-6989586621688528337"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528337"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ConnectionSelect"><span class="hs-identifier hs-type">ConnectionSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528337"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528337"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-type">Collector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ConnectionSelect"><span class="hs-identifier hs-type">ConnectionSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528337"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528337"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span id="transformConnectionSelect"><span class="annot"><span class="annottext">transformConnectionSelect :: ConnectionSelect
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (ConnectionSelect b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformConnectionSelect"><span class="hs-identifier hs-var hs-var">transformConnectionSelect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><span class="annottext">LensLike
  Collector
  (ConnectionSelect
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (ConnectionSelect b Void (UnpreparedValue b))
  (Fields
     (ConnectionField
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)))
  (Fields (ConnectionField b Void (UnpreparedValue b)))
-&gt; LensLike
     Collector
     (ConnectionSelect
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (ConnectionSelect b Void (UnpreparedValue b))
     (Fields
        (ConnectionField
           b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)))
     (Fields (ConnectionField b Void (UnpreparedValue b)))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AnnSelectG
   b
   (ConnectionField b (RemoteRelationshipField UnpreparedValue))
   (UnpreparedValue b)
 -&gt; Collector
      (AnnSelectG b (ConnectionField b Void) (UnpreparedValue b)))
-&gt; ConnectionSelect
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (ConnectionSelect b Void (UnpreparedValue b))
forall (b :: BackendType) r1 v r2.
Lens
  (ConnectionSelect b r1 v)
  (ConnectionSelect b r2 v)
  (AnnSelectG b (ConnectionField b r1) v)
  (AnnSelectG b (ConnectionField b r2) v)
</span><a href="Hasura.RQL.IR.Select.html#csSelect"><span class="hs-identifier hs-var">csSelect</span></a></span><span> </span><span class="annot"><span class="annottext">((AnnSelectG
    b
    (ConnectionField b (RemoteRelationshipField UnpreparedValue))
    (UnpreparedValue b)
  -&gt; Collector
       (AnnSelectG b (ConnectionField b Void) (UnpreparedValue b)))
 -&gt; ConnectionSelect
      b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
 -&gt; Collector (ConnectionSelect b Void (UnpreparedValue b)))
-&gt; ((Fields
       (ConnectionField
          b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     -&gt; Collector (Fields (ConnectionField b Void (UnpreparedValue b))))
    -&gt; AnnSelectG
         b
         (ConnectionField b (RemoteRelationshipField UnpreparedValue))
         (UnpreparedValue b)
    -&gt; Collector
         (AnnSelectG b (ConnectionField b Void) (UnpreparedValue b)))
-&gt; LensLike
     Collector
     (ConnectionSelect
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (ConnectionSelect b Void (UnpreparedValue b))
     (Fields
        (ConnectionField
           b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)))
     (Fields (ConnectionField b Void (UnpreparedValue b)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Fields
   (ConnectionField
      b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
 -&gt; Collector (Fields (ConnectionField b Void (UnpreparedValue b))))
-&gt; AnnSelectG
     b
     (ConnectionField b (RemoteRelationshipField UnpreparedValue))
     (UnpreparedValue b)
-&gt; Collector
     (AnnSelectG b (ConnectionField b Void) (UnpreparedValue b))
forall (b :: BackendType) (f1 :: * -&gt; *) v (f2 :: * -&gt; *).
Lens
  (AnnSelectG b f1 v)
  (AnnSelectG b f2 v)
  (Fields (f1 v))
  (Fields (f2 v))
</span><a href="Hasura.RQL.IR.Select.html#asnFields"><span class="hs-identifier hs-var">asnFields</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (ConnectionSelect
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (ConnectionSelect b Void (UnpreparedValue b))
  (Fields
     (ConnectionField
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)))
  (Fields (ConnectionField b Void (UnpreparedValue b)))
-&gt; LensLike
     Collector
     (ConnectionSelect
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (ConnectionSelect b Void (UnpreparedValue b))
     (Fields
        (ConnectionField
           b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)))
     (Fields (ConnectionField b Void (UnpreparedValue b)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><span class="annottext">(ConnectionField
   b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
 -&gt; Collector (ConnectionField b Void (UnpreparedValue b)))
-&gt; Fields
     (ConnectionField
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
-&gt; Collector (Fields (ConnectionField b Void (UnpreparedValue b)))
forall a b. (a -&gt; Collector b) -&gt; Fields a -&gt; Collector (Fields b)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#traverseFields"><span class="hs-identifier hs-var">traverseFields</span></a></span><span> </span><span class="annot"><span class="annottext">((ConnectionField
    b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
  -&gt; Collector (ConnectionField b Void (UnpreparedValue b)))
 -&gt; Fields
      (ConnectionField
         b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
 -&gt; Collector (Fields (ConnectionField b Void (UnpreparedValue b))))
-&gt; (ConnectionField
      b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
    -&gt; Collector (ConnectionField b Void (UnpreparedValue b)))
-&gt; Fields
     (ConnectionField
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
-&gt; Collector (Fields (ConnectionField b Void (UnpreparedValue b)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-237"></span><span>      </span><span class="annot"><span class="annottext">LensLike
  Collector
  (ConnectionField
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (ConnectionField b Void (UnpreparedValue b))
  (Fields
     (EdgeField
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)))
  (Fields (EdgeField b Void (UnpreparedValue b)))
-&gt; LensLike
     Collector
     (ConnectionField
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (ConnectionField b Void (UnpreparedValue b))
     (Fields
        (EdgeField
           b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)))
     (Fields (EdgeField b Void (UnpreparedValue b)))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (ConnectionField
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (ConnectionField b Void (UnpreparedValue b))
  (Fields
     (EdgeField
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)))
  (Fields (EdgeField b Void (UnpreparedValue b)))
forall (b1 :: BackendType) r1 v1 (b2 :: BackendType) r2 v2.
Prism
  (ConnectionField b1 r1 v1)
  (ConnectionField b2 r2 v2)
  (EdgeFields b1 r1 v1)
  (EdgeFields b2 r2 v2)
</span><a href="Hasura.RQL.IR.Select.html#_ConnectionEdges"><span class="hs-identifier hs-var">_ConnectionEdges</span></a></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (ConnectionField
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (ConnectionField b Void (UnpreparedValue b))
  (Fields
     (EdgeField
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)))
  (Fields (EdgeField b Void (UnpreparedValue b)))
-&gt; LensLike
     Collector
     (ConnectionField
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (ConnectionField b Void (UnpreparedValue b))
     (Fields
        (EdgeField
           b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)))
     (Fields (EdgeField b Void (UnpreparedValue b)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-238"></span><span>        </span><span class="annot"><span class="annottext">(EdgeField
   b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
 -&gt; Collector (EdgeField b Void (UnpreparedValue b)))
-&gt; Fields
     (EdgeField
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
-&gt; Collector (Fields (EdgeField b Void (UnpreparedValue b)))
forall a b. (a -&gt; Collector b) -&gt; Fields a -&gt; Collector (Fields b)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#traverseFields"><span class="hs-identifier hs-var">traverseFields</span></a></span><span> </span><span class="annot"><span class="annottext">((EdgeField
    b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
  -&gt; Collector (EdgeField b Void (UnpreparedValue b)))
 -&gt; Fields
      (EdgeField
         b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
 -&gt; Collector (Fields (EdgeField b Void (UnpreparedValue b))))
-&gt; (EdgeField
      b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
    -&gt; Collector (EdgeField b Void (UnpreparedValue b)))
-&gt; Fields
     (EdgeField
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
-&gt; Collector (Fields (EdgeField b Void (UnpreparedValue b)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (EdgeField
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (EdgeField b Void (UnpreparedValue b))
  (AnnFieldsG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnFieldsG b Void (UnpreparedValue b))
-&gt; LensLike
     Collector
     (EdgeField
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (EdgeField b Void (UnpreparedValue b))
     (AnnFieldsG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (AnnFieldsG b Void (UnpreparedValue b))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (EdgeField
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (EdgeField b Void (UnpreparedValue b))
  (AnnFieldsG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnFieldsG b Void (UnpreparedValue b))
forall (b1 :: BackendType) r1 v1 (b2 :: BackendType) r2 v2.
Prism
  (EdgeField b1 r1 v1)
  (EdgeField b2 r2 v2)
  (AnnFieldsG b1 r1 v1)
  (AnnFieldsG b2 r2 v2)
</span><a href="Hasura.RQL.IR.Select.html#_EdgeNode"><span class="hs-identifier hs-var">_EdgeNode</span></a></span><span> </span><span class="annot"><span class="annottext">AnnFieldsG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnFieldsG b Void (UnpreparedValue b))
forall (src :: BackendType).
Backend src =&gt;
AnnFieldsG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; Collector (AnnFieldsG src Void (UnpreparedValue src))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformAnnFields"><span class="hs-identifier hs-var">transformAnnFields</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span id="local-6989586621688528276"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformObjectSelect"><span class="hs-identifier hs-type">transformObjectSelect</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528276"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnObjectSelectG"><span class="hs-identifier hs-type">AnnObjectSelectG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528276"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528276"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-type">Collector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnObjectSelectG"><span class="hs-identifier hs-type">AnnObjectSelectG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528276"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528276"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-244"></span><span id="transformObjectSelect"><span class="annot"><span class="annottext">transformObjectSelect :: AnnObjectSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnObjectSelectG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformObjectSelect"><span class="hs-identifier hs-var hs-var">transformObjectSelect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AnnObjectSelectG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnObjectSelectG b Void (UnpreparedValue b))
  (AnnFieldsG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnFieldsG b Void (UnpreparedValue b))
-&gt; LensLike
     Collector
     (AnnObjectSelectG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (AnnObjectSelectG b Void (UnpreparedValue b))
     (AnnFieldsG
        b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
     (AnnFieldsG b Void (UnpreparedValue b))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (AnnObjectSelectG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnObjectSelectG b Void (UnpreparedValue b))
  (AnnFieldsG
     b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b))
  (AnnFieldsG b Void (UnpreparedValue b))
forall (b :: BackendType) r1 v r2.
Lens
  (AnnObjectSelectG b r1 v)
  (AnnObjectSelectG b r2 v)
  (AnnFieldsG b r1 v)
  (AnnFieldsG b r2 v)
</span><a href="Hasura.RQL.IR.Select.html#aosFields"><span class="hs-identifier hs-var">aosFields</span></a></span><span> </span><span class="annot"><span class="annottext">AnnFieldsG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnFieldsG b Void (UnpreparedValue b))
forall (src :: BackendType).
Backend src =&gt;
AnnFieldsG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; Collector (AnnFieldsG src Void (UnpreparedValue src))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformAnnFields"><span class="hs-identifier hs-var">transformAnnFields</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span id="local-6989586621688528273"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformGraphQLField"><span class="hs-identifier hs-type">transformGraphQLField</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-247"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#GraphQLField"><span class="hs-identifier hs-type">GraphQLField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621688528273"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-type">Collector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#GraphQLField"><span class="hs-identifier hs-type">GraphQLField</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="annot"><a href="#local-6989586621688528273"><span class="hs-identifier hs-type">var</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-249"></span><span id="transformGraphQLField"><span class="annot"><span class="annottext">transformGraphQLField :: GraphQLField (RemoteRelationshipField UnpreparedValue) var
-&gt; Collector (GraphQLField Void var)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformGraphQLField"><span class="hs-identifier hs-var hs-var">transformGraphQLField</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (GraphQLField (RemoteRelationshipField UnpreparedValue) var)
  (GraphQLField Void var)
  (SelectionSet (RemoteRelationshipField UnpreparedValue) var)
  (SelectionSet Void var)
-&gt; LensLike
     Collector
     (GraphQLField (RemoteRelationshipField UnpreparedValue) var)
     (GraphQLField Void var)
     (SelectionSet (RemoteRelationshipField UnpreparedValue) var)
     (SelectionSet Void var)
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (GraphQLField (RemoteRelationshipField UnpreparedValue) var)
  (GraphQLField Void var)
  (SelectionSet (RemoteRelationshipField UnpreparedValue) var)
  (SelectionSet Void var)
forall r var r2.
Lens
  (GraphQLField r var)
  (GraphQLField r2 var)
  (SelectionSet r var)
  (SelectionSet r2 var)
</span><a href="Hasura.RQL.IR.RemoteSchema.html#fSelectionSet"><span class="hs-identifier hs-var">fSelectionSet</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionSet (RemoteRelationshipField UnpreparedValue) var
-&gt; Collector (SelectionSet Void var)
forall var.
SelectionSet (RemoteRelationshipField UnpreparedValue) var
-&gt; Collector (SelectionSet Void var)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformGraphQLSelectionSet"><span class="hs-identifier hs-var">transformGraphQLSelectionSet</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span id="local-6989586621688528270"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformGraphQLSelectionSet"><span class="hs-identifier hs-type">transformGraphQLSelectionSet</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-252"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#SelectionSet"><span class="hs-identifier hs-type">SelectionSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621688528270"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-253"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-type">Collector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#SelectionSet"><span class="hs-identifier hs-type">SelectionSet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="annot"><a href="#local-6989586621688528270"><span class="hs-identifier hs-type">var</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-254"></span><span id="transformGraphQLSelectionSet"><span class="annot"><span class="annottext">transformGraphQLSelectionSet :: SelectionSet (RemoteRelationshipField UnpreparedValue) var
-&gt; Collector (SelectionSet Void var)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformGraphQLSelectionSet"><span class="hs-identifier hs-var hs-var">transformGraphQLSelectionSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-255"></span><span>  </span><span class="annot"><span class="annottext">SelectionSet (RemoteRelationshipField UnpreparedValue) var
</span><a href="Hasura.RQL.IR.RemoteSchema.html#SelectionSetNone"><span class="hs-identifier hs-var">SelectionSetNone</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SelectionSet Void var -&gt; Collector (SelectionSet Void var)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">SelectionSet Void var
forall r var. SelectionSet r var
</span><a href="Hasura.RQL.IR.RemoteSchema.html#SelectionSetNone"><span class="hs-identifier hs-var">SelectionSetNone</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#SelectionSetObject"><span class="hs-identifier hs-type">SelectionSetObject</span></a></span><span> </span><span id="local-6989586621688527780"><span class="annot"><span class="annottext">ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527780"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ObjectSelectionSet Void var -&gt; SelectionSet Void var
forall r var. ObjectSelectionSet r var -&gt; SelectionSet r var
</span><a href="Hasura.RQL.IR.RemoteSchema.html#SelectionSetObject"><span class="hs-identifier hs-var">SelectionSetObject</span></a></span><span> </span><span class="annot"><span class="annottext">(ObjectSelectionSet Void var -&gt; SelectionSet Void var)
-&gt; Collector (ObjectSelectionSet Void var)
-&gt; Collector (SelectionSet Void var)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var
-&gt; Collector (ObjectSelectionSet Void var)
forall var.
Maybe Name
-&gt; ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var
-&gt; Collector (ObjectSelectionSet Void var)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformObjectSelectionSet"><span class="hs-identifier hs-var">transformObjectSelectionSet</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Name
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527780"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#SelectionSetUnion"><span class="hs-identifier hs-type">SelectionSetUnion</span></a></span><span> </span><span id="local-6989586621688527777"><span class="annot"><span class="annottext">DeduplicatedSelectionSet
  (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527777"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DeduplicatedSelectionSet Void var -&gt; SelectionSet Void var
forall r var. DeduplicatedSelectionSet r var -&gt; SelectionSet r var
</span><a href="Hasura.RQL.IR.RemoteSchema.html#SelectionSetUnion"><span class="hs-identifier hs-var">SelectionSetUnion</span></a></span><span> </span><span class="annot"><span class="annottext">(DeduplicatedSelectionSet Void var -&gt; SelectionSet Void var)
-&gt; Collector (DeduplicatedSelectionSet Void var)
-&gt; Collector (SelectionSet Void var)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DeduplicatedSelectionSet
  (RemoteRelationshipField UnpreparedValue) var
-&gt; Collector (DeduplicatedSelectionSet Void var)
forall var2.
DeduplicatedSelectionSet
  (RemoteRelationshipField UnpreparedValue) var2
-&gt; Collector (DeduplicatedSelectionSet Void var2)
</span><a href="#local-6989586621688527776"><span class="hs-identifier hs-var">transformDeduplicatedTypeSelectionSet</span></a></span><span> </span><span class="annot"><span class="annottext">DeduplicatedSelectionSet
  (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527777"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#SelectionSetInterface"><span class="hs-identifier hs-type">SelectionSetInterface</span></a></span><span> </span><span id="local-6989586621688527774"><span class="annot"><span class="annottext">DeduplicatedSelectionSet
  (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527774"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DeduplicatedSelectionSet Void var -&gt; SelectionSet Void var
forall r var. DeduplicatedSelectionSet r var -&gt; SelectionSet r var
</span><a href="Hasura.RQL.IR.RemoteSchema.html#SelectionSetInterface"><span class="hs-identifier hs-var">SelectionSetInterface</span></a></span><span> </span><span class="annot"><span class="annottext">(DeduplicatedSelectionSet Void var -&gt; SelectionSet Void var)
-&gt; Collector (DeduplicatedSelectionSet Void var)
-&gt; Collector (SelectionSet Void var)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">DeduplicatedSelectionSet
  (RemoteRelationshipField UnpreparedValue) var
-&gt; Collector (DeduplicatedSelectionSet Void var)
forall var2.
DeduplicatedSelectionSet
  (RemoteRelationshipField UnpreparedValue) var2
-&gt; Collector (DeduplicatedSelectionSet Void var2)
</span><a href="#local-6989586621688527776"><span class="hs-identifier hs-var">transformDeduplicatedTypeSelectionSet</span></a></span><span> </span><span class="annot"><span class="annottext">DeduplicatedSelectionSet
  (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527774"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621688527776"><span class="annot"><span class="annottext">transformDeduplicatedTypeSelectionSet :: DeduplicatedSelectionSet
  (RemoteRelationshipField UnpreparedValue) var2
-&gt; Collector (DeduplicatedSelectionSet Void var2)
</span><a href="#local-6989586621688527776"><span class="hs-identifier hs-var hs-var">transformDeduplicatedTypeSelectionSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-261"></span><span>      </span><span class="annot"><span class="annottext">LensLike
  Collector
  (DeduplicatedSelectionSet
     (RemoteRelationshipField UnpreparedValue) var2)
  (DeduplicatedSelectionSet Void var2)
  (HashMap
     Name
     (ObjectSelectionSet
        (RemoteRelationshipField UnpreparedValue) var2))
  (HashMap Name (ObjectSelectionSet Void var2))
-&gt; LensLike
     Collector
     (DeduplicatedSelectionSet
        (RemoteRelationshipField UnpreparedValue) var2)
     (DeduplicatedSelectionSet Void var2)
     (HashMap
        Name
        (ObjectSelectionSet
           (RemoteRelationshipField UnpreparedValue) var2))
     (HashMap Name (ObjectSelectionSet Void var2))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (DeduplicatedSelectionSet
     (RemoteRelationshipField UnpreparedValue) var2)
  (DeduplicatedSelectionSet Void var2)
  (HashMap
     Name
     (ObjectSelectionSet
        (RemoteRelationshipField UnpreparedValue) var2))
  (HashMap Name (ObjectSelectionSet Void var2))
forall r1 var1 r2 var2.
Lens
  (DeduplicatedSelectionSet r1 var1)
  (DeduplicatedSelectionSet r2 var2)
  (HashMap Name (ObjectSelectionSet r1 var1))
  (HashMap Name (ObjectSelectionSet r2 var2))
</span><a href="Hasura.RQL.IR.RemoteSchema.html#dssMemberSelectionSets"><span class="hs-identifier hs-var">dssMemberSelectionSets</span></a></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (DeduplicatedSelectionSet
     (RemoteRelationshipField UnpreparedValue) var2)
  (DeduplicatedSelectionSet Void var2)
  (HashMap
     Name
     (ObjectSelectionSet
        (RemoteRelationshipField UnpreparedValue) var2))
  (HashMap Name (ObjectSelectionSet Void var2))
-&gt; LensLike
     Collector
     (DeduplicatedSelectionSet
        (RemoteRelationshipField UnpreparedValue) var2)
     (DeduplicatedSelectionSet Void var2)
     (HashMap
        Name
        (ObjectSelectionSet
           (RemoteRelationshipField UnpreparedValue) var2))
     (HashMap Name (ObjectSelectionSet Void var2))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Name
 -&gt; ObjectSelectionSet
      (RemoteRelationshipField UnpreparedValue) var2
 -&gt; Collector (ObjectSelectionSet Void var2))
-&gt; HashMap
     Name
     (ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var2)
-&gt; Collector (HashMap Name (ObjectSelectionSet Void var2))
forall (f :: * -&gt; *) k v1 v2.
Applicative f =&gt;
(k -&gt; v1 -&gt; f v2) -&gt; HashMap k v1 -&gt; f (HashMap k v2)
</span><span class="hs-identifier hs-var">Map.traverseWithKey</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621688527771"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527771"><span class="hs-identifier hs-var">typeName</span></a></span></span><span> </span><span id="local-6989586621688527770"><span class="annot"><span class="annottext">ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var2
</span><a href="#local-6989586621688527770"><span class="hs-identifier hs-var">objectSelectionSet</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-262"></span><span>        </span><span class="annot"><span class="annottext">Maybe Name
-&gt; ObjectSelectionSet
     (RemoteRelationshipField UnpreparedValue) var2
-&gt; Collector (ObjectSelectionSet Void var2)
forall var.
Maybe Name
-&gt; ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var
-&gt; Collector (ObjectSelectionSet Void var)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformObjectSelectionSet"><span class="hs-identifier hs-var">transformObjectSelectionSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527771"><span class="hs-identifier hs-var">typeName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var2
</span><a href="#local-6989586621688527770"><span class="hs-identifier hs-var">objectSelectionSet</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- Actual transformations</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">-- | Transforms a source selection set.</span><span>
</span><span id="line-268"></span><span class="hs-comment">--</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- This function takes an 'AnnFieldsG', which corresponds to a selection of</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- fields on a source, and extracts remote joins: for every field we encounter</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- that maps to a remote destination (either another source or a remote schema),</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- we replace it with a phantom field and 'collect' the corresponding</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- 'RemoteJoin'.</span><span>
</span><span id="line-274"></span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformAnnFields"><span class="hs-identifier hs-type">transformAnnFields</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621688528185"><span class="annot"><a href="#local-6989586621688528185"><span class="hs-identifier hs-type">src</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-276"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528185"><span class="hs-identifier hs-type">src</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnFieldsG"><span class="hs-identifier hs-type">AnnFieldsG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528185"><span class="hs-identifier hs-type">src</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528185"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-type">Collector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnFieldsG"><span class="hs-identifier hs-type">AnnFieldsG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528185"><span class="hs-identifier hs-type">src</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528185"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span id="transformAnnFields"><span class="annot"><span class="annottext">transformAnnFields :: AnnFieldsG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; Collector (AnnFieldsG src Void (UnpreparedValue src))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformAnnFields"><span class="hs-identifier hs-var hs-var">transformAnnFields</span></a></span></span><span> </span><span id="local-6989586621688527769"><span class="annot"><span class="annottext">AnnFieldsG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
</span><a href="#local-6989586621688527769"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-comment">-- Produces a list of transformed fields that may or may not have an</span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-comment">-- associated remote join.</span><span>
</span><span id="line-282"></span><span>  </span><span id="local-6989586621688527768"><span class="annot"><span class="annottext">Fields (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
</span><a href="#local-6989586621688527768"><span class="hs-identifier hs-var">annotatedFields</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><span class="annottext">AnnFieldsG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
</span><a href="#local-6989586621688527769"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">AnnFieldsG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; (AnnFieldsG
      src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
    -&gt; Collector
         (Fields
            (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)))
-&gt; Collector
     (Fields
        (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin))
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(AnnFieldG
   src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
 -&gt; Collector
      (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin))
-&gt; AnnFieldsG
     src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; Collector
     (Fields
        (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin))
forall a b. (a -&gt; Collector b) -&gt; Fields a -&gt; Collector (Fields b)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#traverseFields"><span class="hs-identifier hs-var">traverseFields</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-284"></span><span>      </span><span class="hs-comment">-- AnnFields which do not need to be transformed.</span><span>
</span><span id="line-285"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFNodeId"><span class="hs-identifier hs-type">AFNodeId</span></a></span><span> </span><span id="local-6989586621688527765"><span class="annot"><span class="annottext">XRelay src
</span><a href="#local-6989586621688527765"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621688527764"><span class="annot"><span class="annottext">TableName src
</span><a href="#local-6989586621688527764"><span class="hs-identifier hs-var">qt</span></a></span></span><span> </span><span id="local-6989586621688527763"><span class="annot"><span class="annottext">PrimaryKeyColumns src
</span><a href="#local-6989586621688527763"><span class="hs-identifier hs-var">pkeys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-286"></span><span>        </span><span class="annot"><span class="annottext">(AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
-&gt; Collector
     (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XRelay src
-&gt; TableName src
-&gt; PrimaryKeyColumns src
-&gt; AnnFieldG src Void (UnpreparedValue src)
forall (b :: BackendType) r v.
XRelay b -&gt; TableName b -&gt; PrimaryKeyColumns b -&gt; AnnFieldG b r v
</span><a href="Hasura.RQL.IR.Select.html#AFNodeId"><span class="hs-identifier hs-var">AFNodeId</span></a></span><span> </span><span class="annot"><span class="annottext">XRelay src
</span><a href="#local-6989586621688527765"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">TableName src
</span><a href="#local-6989586621688527764"><span class="hs-identifier hs-var">qt</span></a></span><span> </span><span class="annot"><span class="annottext">PrimaryKeyColumns src
</span><a href="#local-6989586621688527763"><span class="hs-identifier hs-var">pkeys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe RemoteJoin
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFColumn"><span class="hs-identifier hs-type">AFColumn</span></a></span><span> </span><span id="local-6989586621688527761"><span class="annot"><span class="annottext">AnnColumnField src (UnpreparedValue src)
</span><a href="#local-6989586621688527761"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-288"></span><span>        </span><span class="annot"><span class="annottext">(AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
-&gt; Collector
     (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnColumnField src (UnpreparedValue src)
-&gt; AnnFieldG src Void (UnpreparedValue src)
forall (b :: BackendType) r v.
AnnColumnField b v -&gt; AnnFieldG b r v
</span><a href="Hasura.RQL.IR.Select.html#AFColumn"><span class="hs-identifier hs-var">AFColumn</span></a></span><span> </span><span class="annot"><span class="annottext">AnnColumnField src (UnpreparedValue src)
</span><a href="#local-6989586621688527761"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe RemoteJoin
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFExpression"><span class="hs-identifier hs-type">AFExpression</span></a></span><span> </span><span id="local-6989586621688527759"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621688527759"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-290"></span><span>        </span><span class="annot"><span class="annottext">(AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
-&gt; Collector
     (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; AnnFieldG src Void (UnpreparedValue src)
forall (b :: BackendType) r v. Text -&gt; AnnFieldG b r v
</span><a href="Hasura.RQL.IR.Select.html#AFExpression"><span class="hs-identifier hs-var">AFExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621688527759"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe RemoteJoin
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>      </span><span class="hs-comment">-- AnnFields with no associated remote joins and whose transformations are</span><span>
</span><span id="line-292"></span><span>      </span><span class="hs-comment">-- relatively straightforward.</span><span>
</span><span id="line-293"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFObjectRelation"><span class="hs-identifier hs-type">AFObjectRelation</span></a></span><span> </span><span id="local-6989586621688527757"><span class="annot"><span class="annottext">ObjectRelationSelectG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
</span><a href="#local-6989586621688527757"><span class="hs-identifier hs-var">annRel</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-294"></span><span>        </span><span id="local-6989586621688527756"><span class="annot"><span class="annottext">AnnRelationSelectG
  src (AnnObjectSelectG src Void (UnpreparedValue src))
</span><a href="#local-6989586621688527756"><span class="hs-identifier hs-var">transformed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (ObjectRelationSelectG
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (AnnRelationSelectG
     src (AnnObjectSelectG src Void (UnpreparedValue src)))
  (AnnObjectSelectG
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (AnnObjectSelectG src Void (UnpreparedValue src))
-&gt; LensLike
     Collector
     (ObjectRelationSelectG
        src
        (RemoteRelationshipField UnpreparedValue)
        (UnpreparedValue src))
     (AnnRelationSelectG
        src (AnnObjectSelectG src Void (UnpreparedValue src)))
     (AnnObjectSelectG
        src
        (RemoteRelationshipField UnpreparedValue)
        (UnpreparedValue src))
     (AnnObjectSelectG src Void (UnpreparedValue src))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (ObjectRelationSelectG
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (AnnRelationSelectG
     src (AnnObjectSelectG src Void (UnpreparedValue src)))
  (AnnObjectSelectG
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (AnnObjectSelectG src Void (UnpreparedValue src))
forall (b :: BackendType) a1 a2.
Lens (AnnRelationSelectG b a1) (AnnRelationSelectG b a2) a1 a2
</span><a href="Hasura.RQL.IR.Select.html#aarAnnSelect"><span class="hs-identifier hs-var">aarAnnSelect</span></a></span><span> </span><span class="annot"><span class="annottext">AnnObjectSelectG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; Collector (AnnObjectSelectG src Void (UnpreparedValue src))
forall (b :: BackendType).
Backend b =&gt;
AnnObjectSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnObjectSelectG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformObjectSelect"><span class="hs-identifier hs-var">transformObjectSelect</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectRelationSelectG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
</span><a href="#local-6989586621688527757"><span class="hs-identifier hs-var">annRel</span></a></span><span>
</span><span id="line-295"></span><span>        </span><span class="annot"><span class="annottext">(AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
-&gt; Collector
     (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnRelationSelectG
  src (AnnObjectSelectG src Void (UnpreparedValue src))
-&gt; AnnFieldG src Void (UnpreparedValue src)
forall (b :: BackendType) r v.
ObjectRelationSelectG b r v -&gt; AnnFieldG b r v
</span><a href="Hasura.RQL.IR.Select.html#AFObjectRelation"><span class="hs-identifier hs-var">AFObjectRelation</span></a></span><span> </span><span class="annot"><span class="annottext">AnnRelationSelectG
  src (AnnObjectSelectG src Void (UnpreparedValue src))
</span><a href="#local-6989586621688527756"><span class="hs-identifier hs-var">transformed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe RemoteJoin
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFArrayRelation"><span class="hs-identifier hs-type">AFArrayRelation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ASSimple"><span class="hs-identifier hs-type">ASSimple</span></a></span><span> </span><span id="local-6989586621688527752"><span class="annot"><span class="annottext">ArrayRelationSelectG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
</span><a href="#local-6989586621688527752"><span class="hs-identifier hs-var">annRel</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-297"></span><span>        </span><span id="local-6989586621688527751"><span class="annot"><span class="annottext">AnnRelationSelectG
  src (AnnSimpleSelectG src Void (UnpreparedValue src))
</span><a href="#local-6989586621688527751"><span class="hs-identifier hs-var">transformed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (ArrayRelationSelectG
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (AnnRelationSelectG
     src (AnnSimpleSelectG src Void (UnpreparedValue src)))
  (AnnSimpleSelectG
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (AnnSimpleSelectG src Void (UnpreparedValue src))
-&gt; LensLike
     Collector
     (ArrayRelationSelectG
        src
        (RemoteRelationshipField UnpreparedValue)
        (UnpreparedValue src))
     (AnnRelationSelectG
        src (AnnSimpleSelectG src Void (UnpreparedValue src)))
     (AnnSimpleSelectG
        src
        (RemoteRelationshipField UnpreparedValue)
        (UnpreparedValue src))
     (AnnSimpleSelectG src Void (UnpreparedValue src))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (ArrayRelationSelectG
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (AnnRelationSelectG
     src (AnnSimpleSelectG src Void (UnpreparedValue src)))
  (AnnSimpleSelectG
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (AnnSimpleSelectG src Void (UnpreparedValue src))
forall (b :: BackendType) a1 a2.
Lens (AnnRelationSelectG b a1) (AnnRelationSelectG b a2) a1 a2
</span><a href="Hasura.RQL.IR.Select.html#aarAnnSelect"><span class="hs-identifier hs-var">aarAnnSelect</span></a></span><span> </span><span class="annot"><span class="annottext">AnnSimpleSelectG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; Collector (AnnSimpleSelectG src Void (UnpreparedValue src))
forall (b :: BackendType).
Backend b =&gt;
AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnSimpleSelectG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformSelect"><span class="hs-identifier hs-var">transformSelect</span></a></span><span> </span><span class="annot"><span class="annottext">ArrayRelationSelectG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
</span><a href="#local-6989586621688527752"><span class="hs-identifier hs-var">annRel</span></a></span><span>
</span><span id="line-298"></span><span>        </span><span class="annot"><span class="annottext">(AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
-&gt; Collector
     (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArraySelectG src Void (UnpreparedValue src)
-&gt; AnnFieldG src Void (UnpreparedValue src)
forall (b :: BackendType) r v.
ArraySelectG b r v -&gt; AnnFieldG b r v
</span><a href="Hasura.RQL.IR.Select.html#AFArrayRelation"><span class="hs-identifier hs-var">AFArrayRelation</span></a></span><span> </span><span class="annot"><span class="annottext">(ArraySelectG src Void (UnpreparedValue src)
 -&gt; AnnFieldG src Void (UnpreparedValue src))
-&gt; (AnnRelationSelectG
      src (AnnSimpleSelectG src Void (UnpreparedValue src))
    -&gt; ArraySelectG src Void (UnpreparedValue src))
-&gt; AnnRelationSelectG
     src (AnnSimpleSelectG src Void (UnpreparedValue src))
-&gt; AnnFieldG src Void (UnpreparedValue src)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AnnRelationSelectG
  src (AnnSimpleSelectG src Void (UnpreparedValue src))
-&gt; ArraySelectG src Void (UnpreparedValue src)
forall (b :: BackendType) r v.
ArrayRelationSelectG b r v -&gt; ArraySelectG b r v
</span><a href="Hasura.RQL.IR.Select.html#ASSimple"><span class="hs-identifier hs-var">ASSimple</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnRelationSelectG
   src (AnnSimpleSelectG src Void (UnpreparedValue src))
 -&gt; AnnFieldG src Void (UnpreparedValue src))
-&gt; AnnRelationSelectG
     src (AnnSimpleSelectG src Void (UnpreparedValue src))
-&gt; AnnFieldG src Void (UnpreparedValue src)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AnnRelationSelectG
  src (AnnSimpleSelectG src Void (UnpreparedValue src))
</span><a href="#local-6989586621688527751"><span class="hs-identifier hs-var">transformed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe RemoteJoin
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFArrayRelation"><span class="hs-identifier hs-type">AFArrayRelation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ASAggregate"><span class="hs-identifier hs-type">ASAggregate</span></a></span><span> </span><span id="local-6989586621688527749"><span class="annot"><span class="annottext">ArrayAggregateSelectG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
</span><a href="#local-6989586621688527749"><span class="hs-identifier hs-var">aggRel</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-300"></span><span>        </span><span id="local-6989586621688527748"><span class="annot"><span class="annottext">AnnRelationSelectG
  src (AnnAggregateSelectG src Void (UnpreparedValue src))
</span><a href="#local-6989586621688527748"><span class="hs-identifier hs-var">transformed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (ArrayAggregateSelectG
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (AnnRelationSelectG
     src (AnnAggregateSelectG src Void (UnpreparedValue src)))
  (AnnAggregateSelectG
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (AnnAggregateSelectG src Void (UnpreparedValue src))
-&gt; LensLike
     Collector
     (ArrayAggregateSelectG
        src
        (RemoteRelationshipField UnpreparedValue)
        (UnpreparedValue src))
     (AnnRelationSelectG
        src (AnnAggregateSelectG src Void (UnpreparedValue src)))
     (AnnAggregateSelectG
        src
        (RemoteRelationshipField UnpreparedValue)
        (UnpreparedValue src))
     (AnnAggregateSelectG src Void (UnpreparedValue src))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (ArrayAggregateSelectG
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (AnnRelationSelectG
     src (AnnAggregateSelectG src Void (UnpreparedValue src)))
  (AnnAggregateSelectG
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (AnnAggregateSelectG src Void (UnpreparedValue src))
forall (b :: BackendType) a1 a2.
Lens (AnnRelationSelectG b a1) (AnnRelationSelectG b a2) a1 a2
</span><a href="Hasura.RQL.IR.Select.html#aarAnnSelect"><span class="hs-identifier hs-var">aarAnnSelect</span></a></span><span> </span><span class="annot"><span class="annottext">AnnAggregateSelectG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; Collector (AnnAggregateSelectG src Void (UnpreparedValue src))
forall (b :: BackendType).
Backend b =&gt;
AnnAggregateSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnAggregateSelectG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformAggregateSelect"><span class="hs-identifier hs-var">transformAggregateSelect</span></a></span><span> </span><span class="annot"><span class="annottext">ArrayAggregateSelectG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
</span><a href="#local-6989586621688527749"><span class="hs-identifier hs-var">aggRel</span></a></span><span>
</span><span id="line-301"></span><span>        </span><span class="annot"><span class="annottext">(AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
-&gt; Collector
     (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArraySelectG src Void (UnpreparedValue src)
-&gt; AnnFieldG src Void (UnpreparedValue src)
forall (b :: BackendType) r v.
ArraySelectG b r v -&gt; AnnFieldG b r v
</span><a href="Hasura.RQL.IR.Select.html#AFArrayRelation"><span class="hs-identifier hs-var">AFArrayRelation</span></a></span><span> </span><span class="annot"><span class="annottext">(ArraySelectG src Void (UnpreparedValue src)
 -&gt; AnnFieldG src Void (UnpreparedValue src))
-&gt; (AnnRelationSelectG
      src (AnnAggregateSelectG src Void (UnpreparedValue src))
    -&gt; ArraySelectG src Void (UnpreparedValue src))
-&gt; AnnRelationSelectG
     src (AnnAggregateSelectG src Void (UnpreparedValue src))
-&gt; AnnFieldG src Void (UnpreparedValue src)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AnnRelationSelectG
  src (AnnAggregateSelectG src Void (UnpreparedValue src))
-&gt; ArraySelectG src Void (UnpreparedValue src)
forall (b :: BackendType) r v.
ArrayAggregateSelectG b r v -&gt; ArraySelectG b r v
</span><a href="Hasura.RQL.IR.Select.html#ASAggregate"><span class="hs-identifier hs-var">ASAggregate</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnRelationSelectG
   src (AnnAggregateSelectG src Void (UnpreparedValue src))
 -&gt; AnnFieldG src Void (UnpreparedValue src))
-&gt; AnnRelationSelectG
     src (AnnAggregateSelectG src Void (UnpreparedValue src))
-&gt; AnnFieldG src Void (UnpreparedValue src)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AnnRelationSelectG
  src (AnnAggregateSelectG src Void (UnpreparedValue src))
</span><a href="#local-6989586621688527748"><span class="hs-identifier hs-var">transformed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe RemoteJoin
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFArrayRelation"><span class="hs-identifier hs-type">AFArrayRelation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ASConnection"><span class="hs-identifier hs-type">ASConnection</span></a></span><span> </span><span id="local-6989586621688527746"><span class="annot"><span class="annottext">ArrayConnectionSelect
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
</span><a href="#local-6989586621688527746"><span class="hs-identifier hs-var">annRel</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-303"></span><span>        </span><span id="local-6989586621688527745"><span class="annot"><span class="annottext">AnnRelationSelectG
  src (ConnectionSelect src Void (UnpreparedValue src))
</span><a href="#local-6989586621688527745"><span class="hs-identifier hs-var">transformed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (ArrayConnectionSelect
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (AnnRelationSelectG
     src (ConnectionSelect src Void (UnpreparedValue src)))
  (ConnectionSelect
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (ConnectionSelect src Void (UnpreparedValue src))
-&gt; LensLike
     Collector
     (ArrayConnectionSelect
        src
        (RemoteRelationshipField UnpreparedValue)
        (UnpreparedValue src))
     (AnnRelationSelectG
        src (ConnectionSelect src Void (UnpreparedValue src)))
     (ConnectionSelect
        src
        (RemoteRelationshipField UnpreparedValue)
        (UnpreparedValue src))
     (ConnectionSelect src Void (UnpreparedValue src))
forall (f :: * -&gt; *) s t a b.
LensLike f s t a b -&gt; LensLike f s t a b
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">LensLike
  Collector
  (ArrayConnectionSelect
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (AnnRelationSelectG
     src (ConnectionSelect src Void (UnpreparedValue src)))
  (ConnectionSelect
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (ConnectionSelect src Void (UnpreparedValue src))
forall (b :: BackendType) a1 a2.
Lens (AnnRelationSelectG b a1) (AnnRelationSelectG b a2) a1 a2
</span><a href="Hasura.RQL.IR.Select.html#aarAnnSelect"><span class="hs-identifier hs-var">aarAnnSelect</span></a></span><span> </span><span class="annot"><span class="annottext">ConnectionSelect
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; Collector (ConnectionSelect src Void (UnpreparedValue src))
forall (b :: BackendType).
Backend b =&gt;
ConnectionSelect
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (ConnectionSelect b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformConnectionSelect"><span class="hs-identifier hs-var">transformConnectionSelect</span></a></span><span> </span><span class="annot"><span class="annottext">ArrayConnectionSelect
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
</span><a href="#local-6989586621688527746"><span class="hs-identifier hs-var">annRel</span></a></span><span>
</span><span id="line-304"></span><span>        </span><span class="annot"><span class="annottext">(AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
-&gt; Collector
     (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArraySelectG src Void (UnpreparedValue src)
-&gt; AnnFieldG src Void (UnpreparedValue src)
forall (b :: BackendType) r v.
ArraySelectG b r v -&gt; AnnFieldG b r v
</span><a href="Hasura.RQL.IR.Select.html#AFArrayRelation"><span class="hs-identifier hs-var">AFArrayRelation</span></a></span><span> </span><span class="annot"><span class="annottext">(ArraySelectG src Void (UnpreparedValue src)
 -&gt; AnnFieldG src Void (UnpreparedValue src))
-&gt; (AnnRelationSelectG
      src (ConnectionSelect src Void (UnpreparedValue src))
    -&gt; ArraySelectG src Void (UnpreparedValue src))
-&gt; AnnRelationSelectG
     src (ConnectionSelect src Void (UnpreparedValue src))
-&gt; AnnFieldG src Void (UnpreparedValue src)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AnnRelationSelectG
  src (ConnectionSelect src Void (UnpreparedValue src))
-&gt; ArraySelectG src Void (UnpreparedValue src)
forall (b :: BackendType) r v.
ArrayConnectionSelect b r v -&gt; ArraySelectG b r v
</span><a href="Hasura.RQL.IR.Select.html#ASConnection"><span class="hs-identifier hs-var">ASConnection</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnRelationSelectG
   src (ConnectionSelect src Void (UnpreparedValue src))
 -&gt; AnnFieldG src Void (UnpreparedValue src))
-&gt; AnnRelationSelectG
     src (ConnectionSelect src Void (UnpreparedValue src))
-&gt; AnnFieldG src Void (UnpreparedValue src)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AnnRelationSelectG
  src (ConnectionSelect src Void (UnpreparedValue src))
</span><a href="#local-6989586621688527745"><span class="hs-identifier hs-var">transformed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe RemoteJoin
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFComputedField"><span class="hs-identifier hs-type">AFComputedField</span></a></span><span> </span><span id="local-6989586621688527743"><span class="annot"><span class="annottext">XComputedField src
</span><a href="#local-6989586621688527743"><span class="hs-identifier hs-var">computedField</span></a></span></span><span> </span><span id="local-6989586621688527742"><span class="annot"><span class="annottext">ComputedFieldName
</span><a href="#local-6989586621688527742"><span class="hs-identifier hs-var">computedFieldName</span></a></span></span><span> </span><span id="local-6989586621688527741"><span class="annot"><span class="annottext">ComputedFieldSelect
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
</span><a href="#local-6989586621688527741"><span class="hs-identifier hs-var">computedFieldSelect</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-306"></span><span>        </span><span id="local-6989586621688527740"><span class="annot"><span class="annottext">ComputedFieldSelect src Void (UnpreparedValue src)
</span><a href="#local-6989586621688527740"><span class="hs-identifier hs-var">transformed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ComputedFieldSelect
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
</span><a href="#local-6989586621688527741"><span class="hs-identifier hs-var">computedFieldSelect</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-307"></span><span>          </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#CFSScalar"><span class="hs-identifier hs-type">CFSScalar</span></a></span><span> </span><span id="local-6989586621688527738"><span class="annot"><span class="annottext">ComputedFieldScalarSelect src (UnpreparedValue src)
</span><a href="#local-6989586621688527738"><span class="hs-identifier hs-var">cfss</span></a></span></span><span> </span><span id="local-6989586621688527737"><span class="annot"><span class="annottext">Maybe (AnnColumnCaseBoolExp src (UnpreparedValue src))
</span><a href="#local-6989586621688527737"><span class="hs-identifier hs-var">cbe</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ComputedFieldSelect src Void (UnpreparedValue src)
-&gt; Collector (ComputedFieldSelect src Void (UnpreparedValue src))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ComputedFieldSelect src Void (UnpreparedValue src)
 -&gt; Collector (ComputedFieldSelect src Void (UnpreparedValue src)))
-&gt; ComputedFieldSelect src Void (UnpreparedValue src)
-&gt; Collector (ComputedFieldSelect src Void (UnpreparedValue src))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ComputedFieldScalarSelect src (UnpreparedValue src)
-&gt; Maybe (AnnColumnCaseBoolExp src (UnpreparedValue src))
-&gt; ComputedFieldSelect src Void (UnpreparedValue src)
forall (b :: BackendType) r v.
ComputedFieldScalarSelect b v
-&gt; Maybe (AnnColumnCaseBoolExp b v) -&gt; ComputedFieldSelect b r v
</span><a href="Hasura.RQL.IR.Select.html#CFSScalar"><span class="hs-identifier hs-var">CFSScalar</span></a></span><span> </span><span class="annot"><span class="annottext">ComputedFieldScalarSelect src (UnpreparedValue src)
</span><a href="#local-6989586621688527738"><span class="hs-identifier hs-var">cfss</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (AnnColumnCaseBoolExp src (UnpreparedValue src))
</span><a href="#local-6989586621688527737"><span class="hs-identifier hs-var">cbe</span></a></span><span>
</span><span id="line-308"></span><span>          </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#CFSTable"><span class="hs-identifier hs-type">CFSTable</span></a></span><span> </span><span id="local-6989586621688527735"><span class="annot"><span class="annottext">JsonAggSelect
</span><a href="#local-6989586621688527735"><span class="hs-identifier hs-var">jsonAggSel</span></a></span></span><span> </span><span id="local-6989586621688527734"><span class="annot"><span class="annottext">AnnSimpleSelectG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
</span><a href="#local-6989586621688527734"><span class="hs-identifier hs-var">annSel</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-309"></span><span>            </span><span id="local-6989586621688527733"><span class="annot"><span class="annottext">AnnSimpleSelectG src Void (UnpreparedValue src)
</span><a href="#local-6989586621688527733"><span class="hs-identifier hs-var">transformed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AnnSimpleSelectG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; Collector (AnnSimpleSelectG src Void (UnpreparedValue src))
forall (b :: BackendType).
Backend b =&gt;
AnnSimpleSelectG
  b (RemoteRelationshipField UnpreparedValue) (UnpreparedValue b)
-&gt; Collector (AnnSimpleSelectG b Void (UnpreparedValue b))
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformSelect"><span class="hs-identifier hs-var">transformSelect</span></a></span><span> </span><span class="annot"><span class="annottext">AnnSimpleSelectG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
</span><a href="#local-6989586621688527734"><span class="hs-identifier hs-var">annSel</span></a></span><span>
</span><span id="line-310"></span><span>            </span><span class="annot"><span class="annottext">ComputedFieldSelect src Void (UnpreparedValue src)
-&gt; Collector (ComputedFieldSelect src Void (UnpreparedValue src))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ComputedFieldSelect src Void (UnpreparedValue src)
 -&gt; Collector (ComputedFieldSelect src Void (UnpreparedValue src)))
-&gt; ComputedFieldSelect src Void (UnpreparedValue src)
-&gt; Collector (ComputedFieldSelect src Void (UnpreparedValue src))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">JsonAggSelect
-&gt; AnnSimpleSelectG src Void (UnpreparedValue src)
-&gt; ComputedFieldSelect src Void (UnpreparedValue src)
forall (b :: BackendType) r v.
JsonAggSelect
-&gt; AnnSimpleSelectG b r v -&gt; ComputedFieldSelect b r v
</span><a href="Hasura.RQL.IR.Select.html#CFSTable"><span class="hs-identifier hs-var">CFSTable</span></a></span><span> </span><span class="annot"><span class="annottext">JsonAggSelect
</span><a href="#local-6989586621688527735"><span class="hs-identifier hs-var">jsonAggSel</span></a></span><span> </span><span class="annot"><span class="annottext">AnnSimpleSelectG src Void (UnpreparedValue src)
</span><a href="#local-6989586621688527733"><span class="hs-identifier hs-var">transformed</span></a></span><span>
</span><span id="line-311"></span><span>        </span><span class="annot"><span class="annottext">(AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
-&gt; Collector
     (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XComputedField src
-&gt; ComputedFieldName
-&gt; ComputedFieldSelect src Void (UnpreparedValue src)
-&gt; AnnFieldG src Void (UnpreparedValue src)
forall (b :: BackendType) r v.
XComputedField b
-&gt; ComputedFieldName
-&gt; ComputedFieldSelect b r v
-&gt; AnnFieldG b r v
</span><a href="Hasura.RQL.IR.Select.html#AFComputedField"><span class="hs-identifier hs-var">AFComputedField</span></a></span><span> </span><span class="annot"><span class="annottext">XComputedField src
</span><a href="#local-6989586621688527743"><span class="hs-identifier hs-var">computedField</span></a></span><span> </span><span class="annot"><span class="annottext">ComputedFieldName
</span><a href="#local-6989586621688527742"><span class="hs-identifier hs-var">computedFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">ComputedFieldSelect src Void (UnpreparedValue src)
</span><a href="#local-6989586621688527740"><span class="hs-identifier hs-var">transformed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe RemoteJoin
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>      </span><span class="hs-comment">-- Remote AnnFields, whose elements require annotation so that they can be</span><span>
</span><span id="line-313"></span><span>      </span><span class="hs-comment">-- used to construct a remote join.</span><span>
</span><span id="line-314"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AFRemote"><span class="hs-identifier hs-type">AFRemote</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#RemoteRelationshipSelect"><span class="hs-identifier hs-type">RemoteRelationshipSelect</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688527729"><span id="local-6989586621688527730"><span class="annot"><span class="annottext">HashMap FieldName (DBJoinField src)
RemoteRelationshipField UnpreparedValue
_rrsRelationship :: forall (b :: BackendType) r. RemoteRelationshipSelect b r -&gt; r
_rrsLHSJoinFields :: forall (b :: BackendType) r.
RemoteRelationshipSelect b r -&gt; HashMap FieldName (DBJoinField b)
_rrsRelationship :: RemoteRelationshipField UnpreparedValue
_rrsLHSJoinFields :: HashMap FieldName (DBJoinField src)
</span><a href="Hasura.RQL.IR.Select.html#_rrsRelationship"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-315"></span><span>        </span><span class="annot"><span class="annottext">(AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
-&gt; Collector
     (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-316"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-comment">-- We generate this so that the response has a key with the relationship,</span><span>
</span><span id="line-317"></span><span>            </span><span class="hs-comment">-- without which preserving the order of fields in the final response</span><span>
</span><span id="line-318"></span><span>            </span><span class="hs-comment">-- would require a lot of bookkeeping.</span><span>
</span><span id="line-319"></span><span>            </span><span class="annot"><span class="annottext">AnnFieldG src Void (UnpreparedValue src)
</span><a href="#local-6989586621688527726"><span class="hs-identifier hs-var">remoteAnnPlaceholder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-320"></span><span>            </span><span class="annot"><span class="annottext">RemoteJoin -&gt; Maybe RemoteJoin
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(RemoteJoin -&gt; Maybe RemoteJoin) -&gt; RemoteJoin -&gt; Maybe RemoteJoin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName JoinColumnAlias
-&gt; RemoteRelationshipField UnpreparedValue -&gt; RemoteJoin
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#createRemoteJoin"><span class="hs-identifier hs-var">createRemoteJoin</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName JoinColumnAlias
</span><a href="#local-6989586621688527724"><span class="hs-identifier hs-var">joinColumnAliases</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteRelationshipField UnpreparedValue
</span><a href="#local-6989586621688527729"><span class="hs-identifier hs-var">_rrsRelationship</span></a></span><span>
</span><span id="line-321"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688527723"><span class="annot"><span class="annottext">transformedFields :: AnnFieldsG src Void (UnpreparedValue src)
</span><a href="#local-6989586621688527723"><span class="hs-identifier hs-var hs-var">transformedFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((FieldName,
  (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin))
 -&gt; (FieldName, AnnFieldG src Void (UnpreparedValue src)))
-&gt; Fields
     (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
-&gt; AnnFieldsG src Void (UnpreparedValue src)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(((FieldName,
   (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin))
  -&gt; (FieldName, AnnFieldG src Void (UnpreparedValue src)))
 -&gt; Fields
      (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
 -&gt; AnnFieldsG src Void (UnpreparedValue src))
-&gt; (((AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
     -&gt; AnnFieldG src Void (UnpreparedValue src))
    -&gt; (FieldName,
        (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin))
    -&gt; (FieldName, AnnFieldG src Void (UnpreparedValue src)))
-&gt; ((AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
    -&gt; AnnFieldG src Void (UnpreparedValue src))
-&gt; Fields
     (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
-&gt; AnnFieldsG src Void (UnpreparedValue src)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
 -&gt; AnnFieldG src Void (UnpreparedValue src))
-&gt; (FieldName,
    (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin))
-&gt; (FieldName, AnnFieldG src Void (UnpreparedValue src))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
-&gt; AnnFieldG src Void (UnpreparedValue src)
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">Fields (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
</span><a href="#local-6989586621688527768"><span class="hs-identifier hs-var">annotatedFields</span></a></span><span>
</span><span id="line-324"></span><span>      </span><span id="local-6989586621688527722"><span class="annot"><span class="annottext">remoteJoins :: [(QualifiedFieldName, RemoteJoin)]
</span><a href="#local-6989586621688527722"><span class="hs-identifier hs-var hs-var">remoteJoins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-325"></span><span>        </span><span class="annot"><span class="annottext">Fields (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
</span><a href="#local-6989586621688527768"><span class="hs-identifier hs-var">annotatedFields</span></a></span><span> </span><span class="annot"><span class="annottext">Fields (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
-&gt; (Fields
      (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
    -&gt; [(QualifiedFieldName, RemoteJoin)])
-&gt; [(QualifiedFieldName, RemoteJoin)]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">((FieldName,
  (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin))
 -&gt; Maybe (QualifiedFieldName, RemoteJoin))
-&gt; Fields
     (AnnFieldG src Void (UnpreparedValue src), Maybe RemoteJoin)
-&gt; [(QualifiedFieldName, RemoteJoin)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621688527720"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527720"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnFieldG src Void (UnpreparedValue src)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688527719"><span class="annot"><span class="annottext">Maybe RemoteJoin
</span><a href="#local-6989586621688527719"><span class="hs-identifier hs-var">mRemoteJoin</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-326"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; Text -&gt; QualifiedFieldName
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#QualifiedFieldName"><span class="hs-identifier hs-var">QualifiedFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; Text
</span><a href="Hasura.RQL.Types.Common.html#getFieldNameTxt"><span class="hs-identifier hs-var hs-var">getFieldNameTxt</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527720"><span class="hs-identifier hs-var">fieldName</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RemoteJoin -&gt; (QualifiedFieldName, RemoteJoin))
-&gt; Maybe RemoteJoin -&gt; Maybe (QualifiedFieldName, RemoteJoin)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe RemoteJoin
</span><a href="#local-6989586621688527719"><span class="hs-identifier hs-var">mRemoteJoin</span></a></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(QualifiedFieldName, RemoteJoin)]
-&gt; Maybe (NEHashMap QualifiedFieldName RemoteJoin)
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; Maybe (NEHashMap k v)
</span><a href="Data.HashMap.Strict.NonEmpty.html#fromList"><span class="hs-identifier hs-var">NEMap.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(QualifiedFieldName, RemoteJoin)]
</span><a href="#local-6989586621688527722"><span class="hs-identifier hs-var">remoteJoins</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-329"></span><span>    </span><span class="annot"><span class="annottext">Maybe (NEHashMap QualifiedFieldName RemoteJoin)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AnnFieldsG src Void (UnpreparedValue src)
-&gt; Collector (AnnFieldsG src Void (UnpreparedValue src))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">AnnFieldsG src Void (UnpreparedValue src)
</span><a href="#local-6989586621688527723"><span class="hs-identifier hs-var">transformedFields</span></a></span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621688527717"><span class="annot"><span class="annottext">NEHashMap QualifiedFieldName RemoteJoin
</span><a href="#local-6989586621688527717"><span class="hs-identifier hs-var">neRemoteJoins</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-331"></span><span>      </span><span class="annot"><span class="annottext">NEHashMap QualifiedFieldName RemoteJoin -&gt; Collector ()
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#collect"><span class="hs-identifier hs-var">collect</span></a></span><span> </span><span class="annot"><span class="annottext">NEHashMap QualifiedFieldName RemoteJoin
</span><a href="#local-6989586621688527717"><span class="hs-identifier hs-var">neRemoteJoins</span></a></span><span>
</span><span id="line-332"></span><span>      </span><span class="annot"><span class="annottext">AnnFieldsG src Void (UnpreparedValue src)
-&gt; Collector (AnnFieldsG src Void (UnpreparedValue src))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(AnnFieldsG src Void (UnpreparedValue src)
 -&gt; Collector (AnnFieldsG src Void (UnpreparedValue src)))
-&gt; AnnFieldsG src Void (UnpreparedValue src)
-&gt; Collector (AnnFieldsG src Void (UnpreparedValue src))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">AnnFieldsG src Void (UnpreparedValue src)
</span><a href="#local-6989586621688527723"><span class="hs-identifier hs-var">transformedFields</span></a></span><span> </span><span class="annot"><span class="annottext">AnnFieldsG src Void (UnpreparedValue src)
-&gt; AnnFieldsG src Void (UnpreparedValue src)
-&gt; AnnFieldsG src Void (UnpreparedValue src)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AnnFieldsG src Void (UnpreparedValue src)
</span><a href="#local-6989586621688527716"><span class="hs-identifier hs-var">phantomFields</span></a></span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-comment">-- Placeholder text to annotate a remote relationship field.</span><span>
</span><span id="line-335"></span><span>    </span><span class="annot"><a href="#local-6989586621688527726"><span class="hs-identifier hs-type">remoteAnnPlaceholder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnFieldG"><span class="hs-identifier hs-type">AnnFieldG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528185"><span class="hs-identifier hs-type">src</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528185"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>    </span><span id="local-6989586621688527726"><span class="annot"><span class="annottext">remoteAnnPlaceholder :: AnnFieldG src Void (UnpreparedValue src)
</span><a href="#local-6989586621688527726"><span class="hs-identifier hs-var hs-var">remoteAnnPlaceholder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; AnnFieldG src Void (UnpreparedValue src)
forall (b :: BackendType) r v. Text -&gt; AnnFieldG b r v
</span><a href="Hasura.RQL.IR.Select.html#AFExpression"><span class="hs-identifier hs-var">AFExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;remote relationship placeholder&quot;</span></span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-comment">-- This is a map of column name to its alias of all columns in the</span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-comment">-- selection set.</span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><a href="#local-6989586621688527715"><span class="hs-identifier hs-type">columnFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HashMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Column"><span class="hs-identifier hs-type">Column</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528185"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span id="local-6989586621688527715"><span class="annot"><span class="annottext">columnFields :: HashMap (Column src) FieldName
</span><a href="#local-6989586621688527715"><span class="hs-identifier hs-var hs-var">columnFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-342"></span><span>      </span><span class="annot"><span class="annottext">[(Column src, FieldName)] -&gt; HashMap (Column src) FieldName
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Column src, FieldName)] -&gt; HashMap (Column src) FieldName)
-&gt; [(Column src, FieldName)] -&gt; HashMap (Column src) FieldName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-343"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AnnColumnField src (UnpreparedValue src) -&gt; Column src
forall (b :: BackendType) v. AnnColumnField b v -&gt; Column b
</span><a href="Hasura.RQL.IR.Select.html#_acfColumn"><span class="hs-identifier hs-var hs-var">_acfColumn</span></a></span><span> </span><span class="annot"><span class="annottext">AnnColumnField src (UnpreparedValue src)
</span><a href="#local-6989586621688527712"><span class="hs-identifier hs-var">annColumn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527711"><span class="hs-identifier hs-var">alias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688527711"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527711"><span class="hs-identifier hs-var">alias</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688527712"><span class="annot"><span class="annottext">AnnColumnField src (UnpreparedValue src)
</span><a href="#local-6989586621688527712"><span class="hs-identifier hs-var">annColumn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (AnnFieldG
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (AnnColumnField src (UnpreparedValue src))
-&gt; AnnFieldsG
     src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; [(FieldName, AnnColumnField src (UnpreparedValue src))]
forall super sub any.
Traversal' super sub -&gt; [(any, super)] -&gt; [(any, sub)]
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getFields"><span class="hs-identifier hs-var">getFields</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) r v.
Prism' (AnnFieldG b r v) (AnnColumnField b v)
Traversal'
  (AnnFieldG
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (AnnColumnField src (UnpreparedValue src))
</span><a href="Hasura.RQL.IR.Select.html#_AFColumn"><span class="hs-identifier hs-var">_AFColumn</span></a></span><span> </span><span class="annot"><span class="annottext">AnnFieldsG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
</span><a href="#local-6989586621688527769"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-comment">-- This is a map of computed field name to its alias of all computed fields</span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-comment">-- in the selection set.</span><span>
</span><span id="line-349"></span><span>    </span><span class="annot"><a href="#local-6989586621688527708"><span class="hs-identifier hs-type">computedFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.HashMap</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.ComputedField.html#ComputedFieldName"><span class="hs-identifier hs-type">ComputedFieldName</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span id="local-6989586621688527708"><span class="annot"><span class="annottext">computedFields :: HashMap ComputedFieldName FieldName
</span><a href="#local-6989586621688527708"><span class="hs-identifier hs-var hs-var">computedFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-351"></span><span>      </span><span class="annot"><span class="annottext">[(ComputedFieldName, FieldName)]
-&gt; HashMap ComputedFieldName FieldName
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(ComputedFieldName, FieldName)]
 -&gt; HashMap ComputedFieldName FieldName)
-&gt; [(ComputedFieldName, FieldName)]
-&gt; HashMap ComputedFieldName FieldName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-352"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComputedFieldName
</span><a href="#local-6989586621688527707"><span class="hs-identifier hs-var">fieldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527706"><span class="hs-identifier hs-var">alias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- Note that we do not currently care about input arguments to a computed</span><span>
</span><span id="line-354"></span><span>            </span><span class="hs-comment">-- field because only computed fields which do not accept input arguments</span><span>
</span><span id="line-355"></span><span>            </span><span class="hs-comment">-- are currently allowed.</span><span>
</span><span id="line-356"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621688527706"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527706"><span class="hs-identifier hs-var">alias</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688527707"><span class="annot"><span class="annottext">ComputedFieldName
</span><a href="#local-6989586621688527707"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (AnnFieldG
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  ComputedFieldName
-&gt; AnnFieldsG
     src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; [(FieldName, ComputedFieldName)]
forall super sub any.
Traversal' super sub -&gt; [(any, super)] -&gt; [(any, sub)]
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getFields"><span class="hs-identifier hs-var">getFields</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((XComputedField src, ComputedFieldName,
  ComputedFieldSelect
    src
    (RemoteRelationshipField UnpreparedValue)
    (UnpreparedValue src))
 -&gt; f (XComputedField src, ComputedFieldName,
       ComputedFieldSelect
         src
         (RemoteRelationshipField UnpreparedValue)
         (UnpreparedValue src)))
-&gt; AnnFieldG
     src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; f (AnnFieldG
        src
        (RemoteRelationshipField UnpreparedValue)
        (UnpreparedValue src))
forall (b :: BackendType) r v.
Prism'
  (AnnFieldG b r v)
  (XComputedField b, ComputedFieldName, ComputedFieldSelect b r v)
</span><a href="Hasura.RQL.IR.Select.html#_AFComputedField"><span class="hs-identifier hs-var">_AFComputedField</span></a></span><span> </span><span class="annot"><span class="annottext">(((XComputedField src, ComputedFieldName,
   ComputedFieldSelect
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  -&gt; f (XComputedField src, ComputedFieldName,
        ComputedFieldSelect
          src
          (RemoteRelationshipField UnpreparedValue)
          (UnpreparedValue src)))
 -&gt; AnnFieldG
      src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
 -&gt; f (AnnFieldG
         src
         (RemoteRelationshipField UnpreparedValue)
         (UnpreparedValue src)))
-&gt; ((ComputedFieldName -&gt; f ComputedFieldName)
    -&gt; (XComputedField src, ComputedFieldName,
        ComputedFieldSelect
          src
          (RemoteRelationshipField UnpreparedValue)
          (UnpreparedValue src))
    -&gt; f (XComputedField src, ComputedFieldName,
          ComputedFieldSelect
            src
            (RemoteRelationshipField UnpreparedValue)
            (UnpreparedValue src)))
-&gt; (ComputedFieldName -&gt; f ComputedFieldName)
-&gt; AnnFieldG
     src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; f (AnnFieldG
        src
        (RemoteRelationshipField UnpreparedValue)
        (UnpreparedValue src))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ComputedFieldName -&gt; f ComputedFieldName)
-&gt; (XComputedField src, ComputedFieldName,
    ComputedFieldSelect
      src
      (RemoteRelationshipField UnpreparedValue)
      (UnpreparedValue src))
-&gt; f (XComputedField src, ComputedFieldName,
      ComputedFieldSelect
        src
        (RemoteRelationshipField UnpreparedValue)
        (UnpreparedValue src))
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AnnFieldsG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
</span><a href="#local-6989586621688527769"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-357"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-comment">-- Annotate a 'DBJoinField' with its field name and an alias so that it may</span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-comment">-- be used to construct a remote join.</span><span>
</span><span id="line-361"></span><span>    </span><span class="annot"><a href="#local-6989586621688527704"><span class="hs-identifier hs-type">annotateDBJoinField</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-362"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Remote.html#DBJoinField"><span class="hs-identifier hs-type">DBJoinField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528185"><span class="hs-identifier hs-type">src</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Remote.html#DBJoinField"><span class="hs-identifier hs-type">DBJoinField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528185"><span class="hs-identifier hs-type">src</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#JoinColumnAlias"><span class="hs-identifier hs-type">JoinColumnAlias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>    </span><span id="local-6989586621688527704"><span class="annot"><span class="annottext">annotateDBJoinField :: FieldName -&gt; DBJoinField src -&gt; (DBJoinField src, JoinColumnAlias)
</span><a href="#local-6989586621688527704"><span class="hs-identifier hs-var hs-var">annotateDBJoinField</span></a></span></span><span> </span><span id="local-6989586621688527703"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527703"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-364"></span><span>      </span><span id="local-6989586621688527702"><span class="annot"><span class="annottext">jc :: DBJoinField src
</span><a href="#local-6989586621688527702"><span class="hs-identifier hs-var">jc</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Remote.html#JoinColumn"><span class="hs-identifier hs-type">JoinColumn</span></a></span><span> </span><span id="local-6989586621688527700"><span class="annot"><span class="annottext">Column src
</span><a href="#local-6989586621688527700"><span class="hs-identifier hs-var">column</span></a></span></span><span> </span><span class="annot"><span class="annottext">ColumnType src
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-365"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688527699"><span class="annot"><span class="annottext">alias :: JoinColumnAlias
</span><a href="#local-6989586621688527699"><span class="hs-identifier hs-var hs-var">alias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldName
-&gt; Column src
-&gt; HashMap (Column src) FieldName
-&gt; [FieldName]
-&gt; JoinColumnAlias
forall field.
(Eq field, Hashable field) =&gt;
FieldName
-&gt; field
-&gt; HashMap field FieldName
-&gt; [FieldName]
-&gt; JoinColumnAlias
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getJoinColumnAlias"><span class="hs-identifier hs-var">getJoinColumnAlias</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527703"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Column src
</span><a href="#local-6989586621688527700"><span class="hs-identifier hs-var">column</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap (Column src) FieldName
</span><a href="#local-6989586621688527715"><span class="hs-identifier hs-var">columnFields</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldName]
</span><a href="#local-6989586621688527697"><span class="hs-identifier hs-var">allAliases</span></a></span><span>
</span><span id="line-366"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DBJoinField src
</span><a href="#local-6989586621688527702"><span class="hs-identifier hs-var">jc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">JoinColumnAlias
</span><a href="#local-6989586621688527699"><span class="hs-identifier hs-var">alias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>      </span><span id="local-6989586621688527696"><span class="annot"><span class="annottext">jcf :: DBJoinField src
</span><a href="#local-6989586621688527696"><span class="hs-identifier hs-var">jcf</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Remote.html#JoinComputedField"><span class="hs-identifier hs-type">JoinComputedField</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Remote.html#ScalarComputedField"><span class="hs-identifier hs-type">ScalarComputedField</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688527688"><span id="local-6989586621688527689"><span id="local-6989586621688527690"><span id="local-6989586621688527691"><span id="local-6989586621688527692"><span id="local-6989586621688527693"><span class="annot"><span class="annottext">Maybe FunctionSessionArgument
FunctionName src
ScalarType src
XComputedField src
FunctionTableArgument
ComputedFieldName
_scfType :: forall (b :: BackendType). ScalarComputedField b -&gt; ScalarType b
_scfSessionArgument :: forall (b :: BackendType).
ScalarComputedField b -&gt; Maybe FunctionSessionArgument
_scfTableArgument :: forall (b :: BackendType).
ScalarComputedField b -&gt; FunctionTableArgument
_scfFunction :: forall (b :: BackendType). ScalarComputedField b -&gt; FunctionName b
_scfName :: forall (b :: BackendType).
ScalarComputedField b -&gt; ComputedFieldName
_scfXField :: forall (b :: BackendType).
ScalarComputedField b -&gt; XComputedField b
_scfType :: ScalarType src
_scfSessionArgument :: Maybe FunctionSessionArgument
_scfTableArgument :: FunctionTableArgument
_scfFunction :: FunctionName src
_scfName :: ComputedFieldName
_scfXField :: XComputedField src
</span><a href="Hasura.RQL.Types.Relationships.Remote.html#_scfType"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-368"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688527681"><span class="annot"><span class="annottext">alias :: JoinColumnAlias
</span><a href="#local-6989586621688527681"><span class="hs-identifier hs-var hs-var">alias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldName
-&gt; ComputedFieldName
-&gt; HashMap ComputedFieldName FieldName
-&gt; [FieldName]
-&gt; JoinColumnAlias
forall field.
(Eq field, Hashable field) =&gt;
FieldName
-&gt; field
-&gt; HashMap field FieldName
-&gt; [FieldName]
-&gt; JoinColumnAlias
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getJoinColumnAlias"><span class="hs-identifier hs-var">getJoinColumnAlias</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527703"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">ComputedFieldName
</span><a href="#local-6989586621688527692"><span class="hs-identifier hs-var">_scfName</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap ComputedFieldName FieldName
</span><a href="#local-6989586621688527708"><span class="hs-identifier hs-var">computedFields</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldName]
</span><a href="#local-6989586621688527697"><span class="hs-identifier hs-var">allAliases</span></a></span><span>
</span><span id="line-369"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DBJoinField src
</span><a href="#local-6989586621688527696"><span class="hs-identifier hs-var">jcf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">JoinColumnAlias
</span><a href="#local-6989586621688527681"><span class="hs-identifier hs-var">alias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-371"></span><span>        </span><span id="local-6989586621688527697"><span class="annot"><span class="annottext">allAliases :: [FieldName]
</span><a href="#local-6989586621688527697"><span class="hs-identifier hs-var hs-var">allAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FieldName,
  AnnFieldG
    src
    (RemoteRelationshipField UnpreparedValue)
    (UnpreparedValue src))
 -&gt; FieldName)
-&gt; AnnFieldsG
     src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; [FieldName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(FieldName,
 AnnFieldG
   src
   (RemoteRelationshipField UnpreparedValue)
   (UnpreparedValue src))
-&gt; FieldName
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">AnnFieldsG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
</span><a href="#local-6989586621688527769"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-comment">-- goes through all the remote relationships in the selection set and emits</span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-comment">-- 1. a map of join field names to their aliases in the lhs response</span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-comment">-- 2. a list of extra fields that need to be included in the lhs query</span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-comment">--    that are required for the join</span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621688527724"><span class="annot"><span class="annottext">HashMap FieldName JoinColumnAlias
</span><a href="#local-6989586621688527724"><span class="hs-identifier hs-var">joinColumnAliases</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688527716"><span class="annot"><span class="annottext">AnnFieldsG src Void (UnpreparedValue src)
</span><a href="#local-6989586621688527716"><span class="hs-identifier hs-var">phantomFields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-378"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688527680"><span class="annot"><span class="annottext">lhsJoinFields :: HashMap FieldName (DBJoinField src)
</span><a href="#local-6989586621688527680"><span class="hs-identifier hs-var hs-var">lhsJoinFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-379"></span><span>            </span><span class="annot"><span class="annottext">[HashMap FieldName (DBJoinField src)]
-&gt; HashMap FieldName (DBJoinField src)
forall k v. (Eq k, Hashable k) =&gt; [HashMap k v] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">Map.unions</span></span><span> </span><span class="annot"><span class="annottext">([HashMap FieldName (DBJoinField src)]
 -&gt; HashMap FieldName (DBJoinField src))
-&gt; [HashMap FieldName (DBJoinField src)]
-&gt; HashMap FieldName (DBJoinField src)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((FieldName,
  RemoteRelationshipSelect
    src (RemoteRelationshipField UnpreparedValue))
 -&gt; HashMap FieldName (DBJoinField src))
-&gt; [(FieldName,
     RemoteRelationshipSelect
       src (RemoteRelationshipField UnpreparedValue))]
-&gt; [HashMap FieldName (DBJoinField src)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RemoteRelationshipSelect
  src (RemoteRelationshipField UnpreparedValue)
-&gt; HashMap FieldName (DBJoinField src)
forall (b :: BackendType) r.
RemoteRelationshipSelect b r -&gt; HashMap FieldName (DBJoinField b)
</span><a href="Hasura.RQL.IR.Select.html#_rrsLHSJoinFields"><span class="hs-identifier hs-var hs-var">_rrsLHSJoinFields</span></a></span><span> </span><span class="annot"><span class="annottext">(RemoteRelationshipSelect
   src (RemoteRelationshipField UnpreparedValue)
 -&gt; HashMap FieldName (DBJoinField src))
-&gt; ((FieldName,
     RemoteRelationshipSelect
       src (RemoteRelationshipField UnpreparedValue))
    -&gt; RemoteRelationshipSelect
         src (RemoteRelationshipField UnpreparedValue))
-&gt; (FieldName,
    RemoteRelationshipSelect
      src (RemoteRelationshipField UnpreparedValue))
-&gt; HashMap FieldName (DBJoinField src)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FieldName,
 RemoteRelationshipSelect
   src (RemoteRelationshipField UnpreparedValue))
-&gt; RemoteRelationshipSelect
     src (RemoteRelationshipField UnpreparedValue)
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(FieldName,
   RemoteRelationshipSelect
     src (RemoteRelationshipField UnpreparedValue))]
 -&gt; [HashMap FieldName (DBJoinField src)])
-&gt; [(FieldName,
     RemoteRelationshipSelect
       src (RemoteRelationshipField UnpreparedValue))]
-&gt; [HashMap FieldName (DBJoinField src)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Traversal'
  (AnnFieldG
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (RemoteRelationshipSelect
     src (RemoteRelationshipField UnpreparedValue))
-&gt; AnnFieldsG
     src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
-&gt; [(FieldName,
     RemoteRelationshipSelect
       src (RemoteRelationshipField UnpreparedValue))]
forall super sub any.
Traversal' super sub -&gt; [(any, super)] -&gt; [(any, sub)]
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getFields"><span class="hs-identifier hs-var">getFields</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) r v.
Prism' (AnnFieldG b r v) (RemoteRelationshipSelect b r)
Traversal'
  (AnnFieldG
     src
     (RemoteRelationshipField UnpreparedValue)
     (UnpreparedValue src))
  (RemoteRelationshipSelect
     src (RemoteRelationshipField UnpreparedValue))
</span><a href="Hasura.RQL.IR.Select.html#_AFRemote"><span class="hs-identifier hs-var">_AFRemote</span></a></span><span> </span><span class="annot"><span class="annottext">AnnFieldsG
  src (RemoteRelationshipField UnpreparedValue) (UnpreparedValue src)
</span><a href="#local-6989586621688527769"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-380"></span><span>          </span><span id="local-6989586621688527677"><span class="annot"><span class="annottext">annotatedJoinColumns :: HashMap FieldName (DBJoinField src, JoinColumnAlias)
</span><a href="#local-6989586621688527677"><span class="hs-identifier hs-var hs-var">annotatedJoinColumns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FieldName
 -&gt; DBJoinField src -&gt; (DBJoinField src, JoinColumnAlias))
-&gt; HashMap FieldName (DBJoinField src)
-&gt; HashMap FieldName (DBJoinField src, JoinColumnAlias)
forall k v1 v2. (k -&gt; v1 -&gt; v2) -&gt; HashMap k v1 -&gt; HashMap k v2
</span><span class="hs-identifier hs-var">Map.mapWithKey</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; DBJoinField src -&gt; (DBJoinField src, JoinColumnAlias)
</span><a href="#local-6989586621688527704"><span class="hs-identifier hs-var">annotateDBJoinField</span></a></span><span> </span><span class="annot"><span class="annottext">(HashMap FieldName (DBJoinField src)
 -&gt; HashMap FieldName (DBJoinField src, JoinColumnAlias))
-&gt; HashMap FieldName (DBJoinField src)
-&gt; HashMap FieldName (DBJoinField src, JoinColumnAlias)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName (DBJoinField src)
</span><a href="#local-6989586621688527680"><span class="hs-identifier hs-var">lhsJoinFields</span></a></span><span>
</span><span id="line-381"></span><span>          </span><span id="local-6989586621688527675"><span class="annot"><span class="annottext">phantomFields_ :: AnnFieldsG src Void (UnpreparedValue src)
</span><a href="#local-6989586621688527675"><span class="hs-identifier hs-var hs-var">phantomFields_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-382"></span><span>            </span><span class="annot"><span class="annottext">HashMap FieldName (DBJoinField src, JoinColumnAlias)
-&gt; [(DBJoinField src, JoinColumnAlias)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName (DBJoinField src, JoinColumnAlias)
</span><a href="#local-6989586621688527677"><span class="hs-identifier hs-var">annotatedJoinColumns</span></a></span><span> </span><span class="annot"><span class="annottext">[(DBJoinField src, JoinColumnAlias)]
-&gt; ([(DBJoinField src, JoinColumnAlias)]
    -&gt; AnnFieldsG src Void (UnpreparedValue src))
-&gt; AnnFieldsG src Void (UnpreparedValue src)
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">((DBJoinField src, JoinColumnAlias)
 -&gt; Maybe (FieldName, AnnFieldG src Void (UnpreparedValue src)))
-&gt; [(DBJoinField src, JoinColumnAlias)]
-&gt; AnnFieldsG src Void (UnpreparedValue src)
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621688527673"><span class="annot"><span class="annottext">DBJoinField src
</span><a href="#local-6989586621688527673"><span class="hs-identifier hs-var">joinField</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688527672"><span class="annot"><span class="annottext">JoinColumnAlias
</span><a href="#local-6989586621688527672"><span class="hs-identifier hs-var">alias</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-383"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">JoinColumnAlias
</span><a href="#local-6989586621688527672"><span class="hs-identifier hs-var">alias</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-384"></span><span>                </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#JCSelected"><span class="hs-identifier hs-type">JCSelected</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (FieldName, AnnFieldG src Void (UnpreparedValue src))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-385"></span><span>                </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#JCPhantom"><span class="hs-identifier hs-type">JCPhantom</span></a></span><span> </span><span id="local-6989586621688527669"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527669"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DBJoinField src
</span><a href="#local-6989586621688527673"><span class="hs-identifier hs-var">joinField</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-386"></span><span>                  </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Remote.html#JoinColumn"><span class="hs-identifier hs-type">JoinColumn</span></a></span><span> </span><span id="local-6989586621688527668"><span class="annot"><span class="annottext">Column src
</span><a href="#local-6989586621688527668"><span class="hs-identifier hs-var">column</span></a></span></span><span> </span><span id="local-6989586621688527667"><span class="annot"><span class="annottext">ColumnType src
</span><a href="#local-6989586621688527667"><span class="hs-identifier hs-var">columnType</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-387"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688527666"><span class="annot"><span class="annottext">annotatedColumn :: AnnFieldG src Void (UnpreparedValue src)
</span><a href="#local-6989586621688527666"><span class="hs-identifier hs-var hs-var">annotatedColumn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-388"></span><span>                          </span><span class="annot"><span class="annottext">AnnColumnField src (UnpreparedValue src)
-&gt; AnnFieldG src Void (UnpreparedValue src)
forall (b :: BackendType) r v.
AnnColumnField b v -&gt; AnnFieldG b r v
</span><a href="Hasura.RQL.IR.Select.html#AFColumn"><span class="hs-identifier hs-var">AFColumn</span></a></span><span> </span><span class="annot"><span class="annottext">(AnnColumnField src (UnpreparedValue src)
 -&gt; AnnFieldG src Void (UnpreparedValue src))
-&gt; AnnColumnField src (UnpreparedValue src)
-&gt; AnnFieldG src Void (UnpreparedValue src)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Column src
-&gt; ColumnType src
-&gt; Bool
-&gt; Maybe (ColumnOp src)
-&gt; Maybe (AnnColumnCaseBoolExp src (UnpreparedValue src))
-&gt; AnnColumnField src (UnpreparedValue src)
forall (b :: BackendType) v.
Column b
-&gt; ColumnType b
-&gt; Bool
-&gt; Maybe (ColumnOp b)
-&gt; Maybe (AnnColumnCaseBoolExp b v)
-&gt; AnnColumnField b v
</span><a href="Hasura.RQL.IR.Select.html#AnnColumnField"><span class="hs-identifier hs-var">AnnColumnField</span></a></span><span> </span><span class="annot"><span class="annottext">Column src
</span><a href="#local-6989586621688527668"><span class="hs-identifier hs-var">column</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnType src
</span><a href="#local-6989586621688527667"><span class="hs-identifier hs-var">columnType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Maybe (ColumnOp src)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe (AnnColumnCaseBoolExp src (UnpreparedValue src))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-389"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(FieldName, AnnFieldG src Void (UnpreparedValue src))
-&gt; Maybe (FieldName, AnnFieldG src Void (UnpreparedValue src))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527669"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AnnFieldG src Void (UnpreparedValue src)
</span><a href="#local-6989586621688527666"><span class="hs-identifier hs-var">annotatedColumn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>                  </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Remote.html#JoinComputedField"><span class="hs-identifier hs-type">JoinComputedField</span></a></span><span> </span><span id="local-6989586621688527664"><span class="annot"><span class="annottext">ScalarComputedField src
</span><a href="#local-6989586621688527664"><span class="hs-identifier hs-var">computedFieldInfo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-391"></span><span>                    </span><span class="annot"><span class="annottext">(FieldName, AnnFieldG src Void (UnpreparedValue src))
-&gt; Maybe (FieldName, AnnFieldG src Void (UnpreparedValue src))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527669"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ScalarComputedField src -&gt; AnnFieldG src Void (UnpreparedValue src)
forall (b :: BackendType).
ScalarComputedField b -&gt; AnnFieldG b Void (UnpreparedValue b)
</span><a href="#local-6989586621688527663"><span class="hs-identifier hs-var">mkScalarComputedFieldSelect</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarComputedField src
</span><a href="#local-6989586621688527664"><span class="hs-identifier hs-var">computedFieldInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((DBJoinField src, JoinColumnAlias) -&gt; JoinColumnAlias)
-&gt; HashMap FieldName (DBJoinField src, JoinColumnAlias)
-&gt; HashMap FieldName JoinColumnAlias
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(DBJoinField src, JoinColumnAlias) -&gt; JoinColumnAlias
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName (DBJoinField src, JoinColumnAlias)
</span><a href="#local-6989586621688527677"><span class="hs-identifier hs-var">annotatedJoinColumns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AnnFieldsG src Void (UnpreparedValue src)
</span><a href="#local-6989586621688527675"><span class="hs-identifier hs-var">phantomFields_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span>    </span><span id="local-6989586621688528031"><span class="annot"><a href="#local-6989586621688527663"><span class="hs-identifier hs-type">mkScalarComputedFieldSelect</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-395"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Remote.html#ScalarComputedField"><span class="hs-identifier hs-type">ScalarComputedField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528031"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-396"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnFieldG"><span class="hs-identifier hs-type">AnnFieldG</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528031"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528031"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-397"></span><span>    </span><span id="local-6989586621688527663"><span class="annot"><span class="annottext">mkScalarComputedFieldSelect :: ScalarComputedField b -&gt; AnnFieldG b Void (UnpreparedValue b)
</span><a href="#local-6989586621688527663"><span class="hs-identifier hs-var hs-var">mkScalarComputedFieldSelect</span></a></span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Remote.html#ScalarComputedField"><span class="hs-identifier hs-type">ScalarComputedField</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688527657"><span id="local-6989586621688527658"><span id="local-6989586621688527659"><span id="local-6989586621688527660"><span id="local-6989586621688527661"><span id="local-6989586621688527662"><span class="annot"><span class="annottext">Maybe FunctionSessionArgument
FunctionName b
ScalarType b
XComputedField b
FunctionTableArgument
ComputedFieldName
_scfType :: ScalarType b
_scfSessionArgument :: Maybe FunctionSessionArgument
_scfTableArgument :: FunctionTableArgument
_scfFunction :: FunctionName b
_scfName :: ComputedFieldName
_scfXField :: XComputedField b
_scfType :: forall (b :: BackendType). ScalarComputedField b -&gt; ScalarType b
_scfSessionArgument :: forall (b :: BackendType).
ScalarComputedField b -&gt; Maybe FunctionSessionArgument
_scfTableArgument :: forall (b :: BackendType).
ScalarComputedField b -&gt; FunctionTableArgument
_scfFunction :: forall (b :: BackendType). ScalarComputedField b -&gt; FunctionName b
_scfName :: forall (b :: BackendType).
ScalarComputedField b -&gt; ComputedFieldName
_scfXField :: forall (b :: BackendType).
ScalarComputedField b -&gt; XComputedField b
</span><a href="#local-6989586621688527657"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-398"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688527656"><span class="annot"><span class="annottext">functionArgs :: FunctionArgsExpG (ArgumentExp (UnpreparedValue b))
</span><a href="#local-6989586621688527656"><span class="hs-identifier hs-var hs-var">functionArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-399"></span><span>            </span><span class="annot"><span class="annottext">([ArgumentExp (UnpreparedValue b)]
 -&gt; HashMap Text (ArgumentExp (UnpreparedValue b))
 -&gt; FunctionArgsExpG (ArgumentExp (UnpreparedValue b)))
-&gt; HashMap Text (ArgumentExp (UnpreparedValue b))
-&gt; [ArgumentExp (UnpreparedValue b)]
-&gt; FunctionArgsExpG (ArgumentExp (UnpreparedValue b))
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">[ArgumentExp (UnpreparedValue b)]
-&gt; HashMap Text (ArgumentExp (UnpreparedValue b))
-&gt; FunctionArgsExpG (ArgumentExp (UnpreparedValue b))
forall a. [a] -&gt; HashMap Text a -&gt; FunctionArgsExpG a
</span><a href="Hasura.RQL.IR.Select.html#FunctionArgsExp"><span class="hs-identifier hs-var">FunctionArgsExp</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Text (ArgumentExp (UnpreparedValue b))
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">([ArgumentExp (UnpreparedValue b)]
 -&gt; FunctionArgsExpG (ArgumentExp (UnpreparedValue b)))
-&gt; [ArgumentExp (UnpreparedValue b)]
-&gt; FunctionArgsExpG (ArgumentExp (UnpreparedValue b))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-400"></span><span>              </span><span class="annot"><span class="annottext">UnpreparedValue b
-&gt; FunctionTableArgument
-&gt; Maybe FunctionSessionArgument
-&gt; [ArgumentExp (UnpreparedValue b)]
forall v.
v
-&gt; FunctionTableArgument
-&gt; Maybe FunctionSessionArgument
-&gt; [ArgumentExp v]
</span><a href="Hasura.RQL.IR.Select.html#functionArgsWithTableRowAndSession"><span class="hs-identifier hs-var">functionArgsWithTableRowAndSession</span></a></span><span> </span><span class="annot"><span class="annottext">UnpreparedValue b
forall (b :: BackendType). UnpreparedValue b
</span><a href="Hasura.GraphQL.Parser.Column.html#UVSession"><span class="hs-identifier hs-var">UVSession</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionTableArgument
</span><a href="#local-6989586621688527659"><span class="hs-identifier hs-var">_scfTableArgument</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FunctionSessionArgument
</span><a href="#local-6989586621688527658"><span class="hs-identifier hs-var">_scfSessionArgument</span></a></span><span>
</span><span id="line-401"></span><span>          </span><span id="local-6989586621688527651"><span class="annot"><span class="annottext">fieldSelect :: ComputedFieldSelect b Void (UnpreparedValue b)
</span><a href="#local-6989586621688527651"><span class="hs-identifier hs-var hs-var">fieldSelect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-402"></span><span>            </span><span class="annot"><span class="annottext">(ComputedFieldScalarSelect b (UnpreparedValue b)
 -&gt; Maybe (AnnColumnCaseBoolExp b (UnpreparedValue b))
 -&gt; ComputedFieldSelect b Void (UnpreparedValue b))
-&gt; Maybe (AnnColumnCaseBoolExp b (UnpreparedValue b))
-&gt; ComputedFieldScalarSelect b (UnpreparedValue b)
-&gt; ComputedFieldSelect b Void (UnpreparedValue b)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">ComputedFieldScalarSelect b (UnpreparedValue b)
-&gt; Maybe (AnnColumnCaseBoolExp b (UnpreparedValue b))
-&gt; ComputedFieldSelect b Void (UnpreparedValue b)
forall (b :: BackendType) r v.
ComputedFieldScalarSelect b v
-&gt; Maybe (AnnColumnCaseBoolExp b v) -&gt; ComputedFieldSelect b r v
</span><a href="Hasura.RQL.IR.Select.html#CFSScalar"><span class="hs-identifier hs-var">CFSScalar</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (AnnColumnCaseBoolExp b (UnpreparedValue b))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">(ComputedFieldScalarSelect b (UnpreparedValue b)
 -&gt; ComputedFieldSelect b Void (UnpreparedValue b))
-&gt; ComputedFieldScalarSelect b (UnpreparedValue b)
-&gt; ComputedFieldSelect b Void (UnpreparedValue b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-403"></span><span>              </span><span class="annot"><span class="annottext">FunctionName b
-&gt; FunctionArgsExpG (ArgumentExp (UnpreparedValue b))
-&gt; ScalarType b
-&gt; Maybe (ColumnOp b)
-&gt; ComputedFieldScalarSelect b (UnpreparedValue b)
forall (b :: BackendType) v.
FunctionName b
-&gt; FunctionArgsExpTableRow v
-&gt; ScalarType b
-&gt; Maybe (ColumnOp b)
-&gt; ComputedFieldScalarSelect b v
</span><a href="Hasura.RQL.IR.Select.html#ComputedFieldScalarSelect"><span class="hs-identifier hs-var">ComputedFieldScalarSelect</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionName b
</span><a href="#local-6989586621688527660"><span class="hs-identifier hs-var">_scfFunction</span></a></span><span> </span><span class="annot"><span class="annottext">FunctionArgsExpG (ArgumentExp (UnpreparedValue b))
</span><a href="#local-6989586621688527656"><span class="hs-identifier hs-var">functionArgs</span></a></span><span> </span><span class="annot"><span class="annottext">ScalarType b
</span><a href="#local-6989586621688527657"><span class="hs-identifier hs-var">_scfType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ColumnOp b)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-404"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">XComputedField b
-&gt; ComputedFieldName
-&gt; ComputedFieldSelect b Void (UnpreparedValue b)
-&gt; AnnFieldG b Void (UnpreparedValue b)
forall (b :: BackendType) r v.
XComputedField b
-&gt; ComputedFieldName
-&gt; ComputedFieldSelect b r v
-&gt; AnnFieldG b r v
</span><a href="Hasura.RQL.IR.Select.html#AFComputedField"><span class="hs-identifier hs-var">AFComputedField</span></a></span><span> </span><span class="annot"><span class="annottext">XComputedField b
</span><a href="#local-6989586621688527662"><span class="hs-identifier hs-var">_scfXField</span></a></span><span> </span><span class="annot"><span class="annottext">ComputedFieldName
</span><a href="#local-6989586621688527661"><span class="hs-identifier hs-var">_scfName</span></a></span><span> </span><span class="annot"><span class="annottext">ComputedFieldSelect b Void (UnpreparedValue b)
</span><a href="#local-6989586621688527651"><span class="hs-identifier hs-var">fieldSelect</span></a></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="hs-comment">-- | Transforms an action's selection set.</span><span>
</span><span id="line-407"></span><span class="hs-comment">--</span><span>
</span><span id="line-408"></span><span class="hs-comment">-- This function takes an 'ActionFieldsG', which corresponds to a selection of</span><span>
</span><span id="line-409"></span><span class="hs-comment">-- fields on the result of an action, and extracts remote joins: for every field</span><span>
</span><span id="line-410"></span><span class="hs-comment">-- we encounter that maps to a remote destination (either a source or a remote</span><span>
</span><span id="line-411"></span><span class="hs-comment">-- schema), we replace it with a phantom field and 'collect' the corresponding</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- 'RemoteJoin'.</span><span>
</span><span id="line-413"></span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformActionFields"><span class="hs-identifier hs-type">transformActionFields</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-414"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Action.html#ActionFieldsG"><span class="hs-identifier hs-type">ActionFieldsG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-415"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-type">Collector</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Action.html#ActionFields"><span class="hs-identifier hs-type">ActionFields</span></a></span><span>
</span><span id="line-416"></span><span id="transformActionFields"><span class="annot"><span class="annottext">transformActionFields :: ActionFieldsG (RemoteRelationshipField UnpreparedValue)
-&gt; Collector ActionFields
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformActionFields"><span class="hs-identifier hs-var hs-var">transformActionFields</span></a></span></span><span> </span><span id="local-6989586621688527649"><span class="annot"><span class="annottext">ActionFieldsG (RemoteRelationshipField UnpreparedValue)
</span><a href="#local-6989586621688527649"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-417"></span><span>  </span><span class="hs-comment">-- Produces a list of transformed fields that may or may not have an</span><span>
</span><span id="line-418"></span><span>  </span><span class="hs-comment">-- associated remote join.</span><span>
</span><span id="line-419"></span><span>  </span><span id="local-6989586621688527648"><span class="annot"><span class="annottext">Fields (ActionFieldG Void, Maybe RemoteJoin)
</span><a href="#local-6989586621688527648"><span class="hs-identifier hs-var">annotatedFields</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-420"></span><span>    </span><span class="annot"><span class="annottext">ActionFieldsG (RemoteRelationshipField UnpreparedValue)
</span><a href="#local-6989586621688527649"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">ActionFieldsG (RemoteRelationshipField UnpreparedValue)
-&gt; (ActionFieldsG (RemoteRelationshipField UnpreparedValue)
    -&gt; Collector (Fields (ActionFieldG Void, Maybe RemoteJoin)))
-&gt; Collector (Fields (ActionFieldG Void, Maybe RemoteJoin))
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(ActionFieldG (RemoteRelationshipField UnpreparedValue)
 -&gt; Collector (ActionFieldG Void, Maybe RemoteJoin))
-&gt; ActionFieldsG (RemoteRelationshipField UnpreparedValue)
-&gt; Collector (Fields (ActionFieldG Void, Maybe RemoteJoin))
forall a b. (a -&gt; Collector b) -&gt; Fields a -&gt; Collector (Fields b)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#traverseFields"><span class="hs-identifier hs-var">traverseFields</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-421"></span><span>      </span><span class="hs-comment">-- ActionFields which do not need to be transformed.</span><span>
</span><span id="line-422"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Action.html#ACFScalar"><span class="hs-identifier hs-type">ACFScalar</span></a></span><span> </span><span id="local-6989586621688527646"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527646"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ActionFieldG Void, Maybe RemoteJoin)
-&gt; Collector (ActionFieldG Void, Maybe RemoteJoin)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; ActionFieldG Void
forall r. Name -&gt; ActionFieldG r
</span><a href="Hasura.RQL.IR.Action.html#ACFScalar"><span class="hs-identifier hs-var">ACFScalar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527646"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe RemoteJoin
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Action.html#ACFExpression"><span class="hs-identifier hs-type">ACFExpression</span></a></span><span> </span><span id="local-6989586621688527644"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621688527644"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ActionFieldG Void, Maybe RemoteJoin)
-&gt; Collector (ActionFieldG Void, Maybe RemoteJoin)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ActionFieldG Void
forall r. Text -&gt; ActionFieldG r
</span><a href="Hasura.RQL.IR.Action.html#ACFExpression"><span class="hs-identifier hs-var">ACFExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621688527644"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe RemoteJoin
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>      </span><span class="hs-comment">-- Remote ActionFields, whose elements require annotation so that they can be</span><span>
</span><span id="line-425"></span><span>      </span><span class="hs-comment">-- used to construct a remote join.</span><span>
</span><span id="line-426"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Action.html#ACFRemote"><span class="hs-identifier hs-type">ACFRemote</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Action.html#ActionRemoteRelationshipSelect"><span class="hs-identifier hs-type">ActionRemoteRelationshipSelect</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688527640"><span id="local-6989586621688527641"><span class="annot"><span class="annottext">HashMap FieldName Name
RemoteRelationshipField UnpreparedValue
_arrsRelationship :: forall r. ActionRemoteRelationshipSelect r -&gt; r
_arrsLHSJoinFields :: forall r.
ActionRemoteRelationshipSelect r -&gt; HashMap FieldName Name
_arrsRelationship :: RemoteRelationshipField UnpreparedValue
_arrsLHSJoinFields :: HashMap FieldName Name
</span><a href="Hasura.RQL.IR.Action.html#_arrsRelationship"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-427"></span><span>        </span><span class="annot"><span class="annottext">(ActionFieldG Void, Maybe RemoteJoin)
-&gt; Collector (ActionFieldG Void, Maybe RemoteJoin)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-428"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-comment">-- We generate this so that the response has a key with the relationship,</span><span>
</span><span id="line-429"></span><span>            </span><span class="hs-comment">-- without which preserving the order of fields in the final response</span><span>
</span><span id="line-430"></span><span>            </span><span class="hs-comment">-- would require a lot of bookkeeping.</span><span>
</span><span id="line-431"></span><span>            </span><span class="annot"><span class="annottext">ActionFieldG Void
</span><a href="#local-6989586621688527637"><span class="hs-identifier hs-var">remoteActionPlaceholder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-432"></span><span>            </span><span class="annot"><span class="annottext">RemoteJoin -&gt; Maybe RemoteJoin
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(RemoteJoin -&gt; Maybe RemoteJoin) -&gt; RemoteJoin -&gt; Maybe RemoteJoin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName JoinColumnAlias
-&gt; RemoteRelationshipField UnpreparedValue -&gt; RemoteJoin
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#createRemoteJoin"><span class="hs-identifier hs-var">createRemoteJoin</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName JoinColumnAlias
</span><a href="#local-6989586621688527636"><span class="hs-identifier hs-var">joinColumnAliases</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteRelationshipField UnpreparedValue
</span><a href="#local-6989586621688527640"><span class="hs-identifier hs-var">_arrsRelationship</span></a></span><span>
</span><span id="line-433"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>      </span><span class="annot"><a href="Hasura.RQL.IR.Action.html#ACFNestedObject"><span class="hs-identifier hs-type">ACFNestedObject</span></a></span><span> </span><span id="local-6989586621688527634"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527634"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621688527633"><span class="annot"><span class="annottext">ActionFieldsG (RemoteRelationshipField UnpreparedValue)
</span><a href="#local-6989586621688527633"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-435"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">Maybe RemoteJoin
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ActionFieldG Void -&gt; (ActionFieldG Void, Maybe RemoteJoin))
-&gt; (ActionFields -&gt; ActionFieldG Void)
-&gt; ActionFields
-&gt; (ActionFieldG Void, Maybe RemoteJoin)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; ActionFields -&gt; ActionFieldG Void
forall r. Name -&gt; ActionFieldsG r -&gt; ActionFieldG r
</span><a href="Hasura.RQL.IR.Action.html#ACFNestedObject"><span class="hs-identifier hs-var">ACFNestedObject</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527634"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">(ActionFields -&gt; (ActionFieldG Void, Maybe RemoteJoin))
-&gt; Collector ActionFields
-&gt; Collector (ActionFieldG Void, Maybe RemoteJoin)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ActionFieldsG (RemoteRelationshipField UnpreparedValue)
-&gt; Collector ActionFields
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformActionFields"><span class="hs-identifier hs-var">transformActionFields</span></a></span><span> </span><span class="annot"><span class="annottext">ActionFieldsG (RemoteRelationshipField UnpreparedValue)
</span><a href="#local-6989586621688527633"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688527632"><span class="annot"><span class="annottext">transformedFields :: ActionFields
</span><a href="#local-6989586621688527632"><span class="hs-identifier hs-var hs-var">transformedFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((FieldName, (ActionFieldG Void, Maybe RemoteJoin))
 -&gt; (FieldName, ActionFieldG Void))
-&gt; Fields (ActionFieldG Void, Maybe RemoteJoin) -&gt; ActionFields
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(((FieldName, (ActionFieldG Void, Maybe RemoteJoin))
  -&gt; (FieldName, ActionFieldG Void))
 -&gt; Fields (ActionFieldG Void, Maybe RemoteJoin) -&gt; ActionFields)
-&gt; (((ActionFieldG Void, Maybe RemoteJoin) -&gt; ActionFieldG Void)
    -&gt; (FieldName, (ActionFieldG Void, Maybe RemoteJoin))
    -&gt; (FieldName, ActionFieldG Void))
-&gt; ((ActionFieldG Void, Maybe RemoteJoin) -&gt; ActionFieldG Void)
-&gt; Fields (ActionFieldG Void, Maybe RemoteJoin)
-&gt; ActionFields
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((ActionFieldG Void, Maybe RemoteJoin) -&gt; ActionFieldG Void)
-&gt; (FieldName, (ActionFieldG Void, Maybe RemoteJoin))
-&gt; (FieldName, ActionFieldG Void)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ActionFieldG Void, Maybe RemoteJoin) -&gt; ActionFieldG Void
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">Fields (ActionFieldG Void, Maybe RemoteJoin)
</span><a href="#local-6989586621688527648"><span class="hs-identifier hs-var">annotatedFields</span></a></span><span>
</span><span id="line-438"></span><span>      </span><span id="local-6989586621688527631"><span class="annot"><span class="annottext">remoteJoins :: [(QualifiedFieldName, RemoteJoin)]
</span><a href="#local-6989586621688527631"><span class="hs-identifier hs-var hs-var">remoteJoins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-439"></span><span>        </span><span class="annot"><span class="annottext">Fields (ActionFieldG Void, Maybe RemoteJoin)
</span><a href="#local-6989586621688527648"><span class="hs-identifier hs-var">annotatedFields</span></a></span><span> </span><span class="annot"><span class="annottext">Fields (ActionFieldG Void, Maybe RemoteJoin)
-&gt; (Fields (ActionFieldG Void, Maybe RemoteJoin)
    -&gt; [(QualifiedFieldName, RemoteJoin)])
-&gt; [(QualifiedFieldName, RemoteJoin)]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">((FieldName, (ActionFieldG Void, Maybe RemoteJoin))
 -&gt; Maybe (QualifiedFieldName, RemoteJoin))
-&gt; Fields (ActionFieldG Void, Maybe RemoteJoin)
-&gt; [(QualifiedFieldName, RemoteJoin)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621688527630"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527630"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionFieldG Void
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688527629"><span class="annot"><span class="annottext">Maybe RemoteJoin
</span><a href="#local-6989586621688527629"><span class="hs-identifier hs-var">mRemoteJoin</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-440"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; Text -&gt; QualifiedFieldName
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#QualifiedFieldName"><span class="hs-identifier hs-var">QualifiedFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; Text
</span><a href="Hasura.RQL.Types.Common.html#getFieldNameTxt"><span class="hs-identifier hs-var hs-var">getFieldNameTxt</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527630"><span class="hs-identifier hs-var">fieldName</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RemoteJoin -&gt; (QualifiedFieldName, RemoteJoin))
-&gt; Maybe RemoteJoin -&gt; Maybe (QualifiedFieldName, RemoteJoin)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe RemoteJoin
</span><a href="#local-6989586621688527629"><span class="hs-identifier hs-var">mRemoteJoin</span></a></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(QualifiedFieldName, RemoteJoin)]
-&gt; Maybe (NEHashMap QualifiedFieldName RemoteJoin)
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; Maybe (NEHashMap k v)
</span><a href="Data.HashMap.Strict.NonEmpty.html#fromList"><span class="hs-identifier hs-var">NEMap.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(QualifiedFieldName, RemoteJoin)]
</span><a href="#local-6989586621688527631"><span class="hs-identifier hs-var">remoteJoins</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-443"></span><span>    </span><span class="annot"><span class="annottext">Maybe (NEHashMap QualifiedFieldName RemoteJoin)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ActionFields -&gt; Collector ActionFields
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ActionFields
</span><a href="#local-6989586621688527632"><span class="hs-identifier hs-var">transformedFields</span></a></span><span>
</span><span id="line-444"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621688527628"><span class="annot"><span class="annottext">NEHashMap QualifiedFieldName RemoteJoin
</span><a href="#local-6989586621688527628"><span class="hs-identifier hs-var">neRemoteJoins</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-445"></span><span>      </span><span class="annot"><span class="annottext">NEHashMap QualifiedFieldName RemoteJoin -&gt; Collector ()
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#collect"><span class="hs-identifier hs-var">collect</span></a></span><span> </span><span class="annot"><span class="annottext">NEHashMap QualifiedFieldName RemoteJoin
</span><a href="#local-6989586621688527628"><span class="hs-identifier hs-var">neRemoteJoins</span></a></span><span>
</span><span id="line-446"></span><span>      </span><span class="annot"><span class="annottext">ActionFields -&gt; Collector ActionFields
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ActionFields -&gt; Collector ActionFields)
-&gt; ActionFields -&gt; Collector ActionFields
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ActionFields
</span><a href="#local-6989586621688527632"><span class="hs-identifier hs-var">transformedFields</span></a></span><span> </span><span class="annot"><span class="annottext">ActionFields -&gt; ActionFields -&gt; ActionFields
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ActionFields
</span><a href="#local-6989586621688527627"><span class="hs-identifier hs-var">phantomFields</span></a></span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-448"></span><span>    </span><span class="hs-comment">-- Placeholder text to annotate a remote relationship field.</span><span>
</span><span id="line-449"></span><span>    </span><span class="annot"><a href="#local-6989586621688527637"><span class="hs-identifier hs-type">remoteActionPlaceholder</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Action.html#ActionFieldG"><span class="hs-identifier hs-type">ActionFieldG</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span>
</span><span id="line-450"></span><span>    </span><span id="local-6989586621688527637"><span class="annot"><span class="annottext">remoteActionPlaceholder :: ActionFieldG Void
</span><a href="#local-6989586621688527637"><span class="hs-identifier hs-var hs-var">remoteActionPlaceholder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ActionFieldG Void
forall r. Text -&gt; ActionFieldG r
</span><a href="Hasura.RQL.IR.Action.html#ACFExpression"><span class="hs-identifier hs-var">ACFExpression</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;remote relationship placeholder&quot;</span></span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span>    </span><span class="hs-comment">-- This is a map of column name to its alias of all columns in the</span><span>
</span><span id="line-453"></span><span>    </span><span class="hs-comment">-- selection set.</span><span>
</span><span id="line-454"></span><span>    </span><span class="annot"><a href="#local-6989586621688527626"><span class="hs-identifier hs-type">scalarFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HashMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.Name</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span>
</span><span id="line-455"></span><span>    </span><span id="local-6989586621688527626"><span class="annot"><span class="annottext">scalarFields :: HashMap Name FieldName
</span><a href="#local-6989586621688527626"><span class="hs-identifier hs-var hs-var">scalarFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-456"></span><span>      </span><span class="annot"><span class="annottext">[(Name, FieldName)] -&gt; HashMap Name FieldName
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, FieldName)] -&gt; HashMap Name FieldName)
-&gt; [(Name, FieldName)] -&gt; HashMap Name FieldName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-457"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527625"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527624"><span class="hs-identifier hs-var">alias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688527624"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527624"><span class="hs-identifier hs-var">alias</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688527625"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527625"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (ActionFieldG (RemoteRelationshipField UnpreparedValue)) Name
-&gt; ActionFieldsG (RemoteRelationshipField UnpreparedValue)
-&gt; [(FieldName, Name)]
forall super sub any.
Traversal' super sub -&gt; [(any, super)] -&gt; [(any, sub)]
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getFields"><span class="hs-identifier hs-var">getFields</span></a></span><span> </span><span class="annot"><span class="annottext">forall r. Prism' (ActionFieldG r) Name
Traversal'
  (ActionFieldG (RemoteRelationshipField UnpreparedValue)) Name
</span><a href="Hasura.RQL.IR.Action.html#_ACFScalar"><span class="hs-identifier hs-var">_ACFScalar</span></a></span><span> </span><span class="annot"><span class="annottext">ActionFieldsG (RemoteRelationshipField UnpreparedValue)
</span><a href="#local-6989586621688527649"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-459"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span>    </span><span class="hs-comment">-- Annotate a join field with its field name and an alias so that it may</span><span>
</span><span id="line-462"></span><span>    </span><span class="hs-comment">-- be used to construct a remote join.</span><span>
</span><span id="line-463"></span><span>    </span><span class="annot"><a href="#local-6989586621688527622"><span class="hs-identifier hs-type">annotateJoinField</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-464"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">G.Name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#JoinColumnAlias"><span class="hs-identifier hs-type">JoinColumnAlias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>    </span><span id="local-6989586621688527622"><span class="annot"><span class="annottext">annotateJoinField :: FieldName -&gt; Name -&gt; (Name, JoinColumnAlias)
</span><a href="#local-6989586621688527622"><span class="hs-identifier hs-var hs-var">annotateJoinField</span></a></span></span><span> </span><span id="local-6989586621688527621"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527621"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span> </span><span id="local-6989586621688527620"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527620"><span class="hs-identifier hs-var">field</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-466"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688527619"><span class="annot"><span class="annottext">alias :: JoinColumnAlias
</span><a href="#local-6989586621688527619"><span class="hs-identifier hs-var hs-var">alias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FieldName
-&gt; Name -&gt; HashMap Name FieldName -&gt; [FieldName] -&gt; JoinColumnAlias
forall field.
(Eq field, Hashable field) =&gt;
FieldName
-&gt; field
-&gt; HashMap field FieldName
-&gt; [FieldName]
-&gt; JoinColumnAlias
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getJoinColumnAlias"><span class="hs-identifier hs-var">getJoinColumnAlias</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527621"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527620"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Name FieldName
</span><a href="#local-6989586621688527626"><span class="hs-identifier hs-var">scalarFields</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldName]
</span><a href="#local-6989586621688527618"><span class="hs-identifier hs-var">allAliases</span></a></span><span>
</span><span id="line-467"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527620"><span class="hs-identifier hs-var">field</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">JoinColumnAlias
</span><a href="#local-6989586621688527619"><span class="hs-identifier hs-var">alias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-469"></span><span>        </span><span id="local-6989586621688527618"><span class="annot"><span class="annottext">allAliases :: [FieldName]
</span><a href="#local-6989586621688527618"><span class="hs-identifier hs-var hs-var">allAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((FieldName,
  ActionFieldG (RemoteRelationshipField UnpreparedValue))
 -&gt; FieldName)
-&gt; ActionFieldsG (RemoteRelationshipField UnpreparedValue)
-&gt; [FieldName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(FieldName, ActionFieldG (RemoteRelationshipField UnpreparedValue))
-&gt; FieldName
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">ActionFieldsG (RemoteRelationshipField UnpreparedValue)
</span><a href="#local-6989586621688527649"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span>    </span><span class="hs-comment">-- goes through all the remote relationships in the selection set and emits</span><span>
</span><span id="line-472"></span><span>    </span><span class="hs-comment">-- 1. a map of join field names to their aliases in the lhs response</span><span>
</span><span id="line-473"></span><span>    </span><span class="hs-comment">-- 2. a list of extra fields that need to be included in the lhs query</span><span>
</span><span id="line-474"></span><span>    </span><span class="hs-comment">--    that are required for the join</span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621688527636"><span class="annot"><span class="annottext">HashMap FieldName JoinColumnAlias
</span><a href="#local-6989586621688527636"><span class="hs-identifier hs-var">joinColumnAliases</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688527627"><span class="annot"><span class="annottext">ActionFields
</span><a href="#local-6989586621688527627"><span class="hs-identifier hs-var">phantomFields</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Action.html#ActionFieldG"><span class="hs-identifier hs-type">ActionFieldG</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-476"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688527617"><span class="annot"><span class="annottext">lhsJoinFields :: HashMap FieldName Name
</span><a href="#local-6989586621688527617"><span class="hs-identifier hs-var hs-var">lhsJoinFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-477"></span><span>            </span><span class="annot"><span class="annottext">[HashMap FieldName Name] -&gt; HashMap FieldName Name
forall k v. (Eq k, Hashable k) =&gt; [HashMap k v] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">Map.unions</span></span><span> </span><span class="annot"><span class="annottext">([HashMap FieldName Name] -&gt; HashMap FieldName Name)
-&gt; [HashMap FieldName Name] -&gt; HashMap FieldName Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((FieldName,
  ActionRemoteRelationshipSelect
    (RemoteRelationshipField UnpreparedValue))
 -&gt; HashMap FieldName Name)
-&gt; [(FieldName,
     ActionRemoteRelationshipSelect
       (RemoteRelationshipField UnpreparedValue))]
-&gt; [HashMap FieldName Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionRemoteRelationshipSelect
  (RemoteRelationshipField UnpreparedValue)
-&gt; HashMap FieldName Name
forall r.
ActionRemoteRelationshipSelect r -&gt; HashMap FieldName Name
</span><a href="Hasura.RQL.IR.Action.html#_arrsLHSJoinFields"><span class="hs-identifier hs-var hs-var">_arrsLHSJoinFields</span></a></span><span> </span><span class="annot"><span class="annottext">(ActionRemoteRelationshipSelect
   (RemoteRelationshipField UnpreparedValue)
 -&gt; HashMap FieldName Name)
-&gt; ((FieldName,
     ActionRemoteRelationshipSelect
       (RemoteRelationshipField UnpreparedValue))
    -&gt; ActionRemoteRelationshipSelect
         (RemoteRelationshipField UnpreparedValue))
-&gt; (FieldName,
    ActionRemoteRelationshipSelect
      (RemoteRelationshipField UnpreparedValue))
-&gt; HashMap FieldName Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FieldName,
 ActionRemoteRelationshipSelect
   (RemoteRelationshipField UnpreparedValue))
-&gt; ActionRemoteRelationshipSelect
     (RemoteRelationshipField UnpreparedValue)
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(FieldName,
   ActionRemoteRelationshipSelect
     (RemoteRelationshipField UnpreparedValue))]
 -&gt; [HashMap FieldName Name])
-&gt; [(FieldName,
     ActionRemoteRelationshipSelect
       (RemoteRelationshipField UnpreparedValue))]
-&gt; [HashMap FieldName Name]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Traversal'
  (ActionFieldG (RemoteRelationshipField UnpreparedValue))
  (ActionRemoteRelationshipSelect
     (RemoteRelationshipField UnpreparedValue))
-&gt; ActionFieldsG (RemoteRelationshipField UnpreparedValue)
-&gt; [(FieldName,
     ActionRemoteRelationshipSelect
       (RemoteRelationshipField UnpreparedValue))]
forall super sub any.
Traversal' super sub -&gt; [(any, super)] -&gt; [(any, sub)]
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getFields"><span class="hs-identifier hs-var">getFields</span></a></span><span> </span><span class="annot"><span class="annottext">forall r.
Prism' (ActionFieldG r) (ActionRemoteRelationshipSelect r)
Traversal'
  (ActionFieldG (RemoteRelationshipField UnpreparedValue))
  (ActionRemoteRelationshipSelect
     (RemoteRelationshipField UnpreparedValue))
</span><a href="Hasura.RQL.IR.Action.html#_ACFRemote"><span class="hs-identifier hs-var">_ACFRemote</span></a></span><span> </span><span class="annot"><span class="annottext">ActionFieldsG (RemoteRelationshipField UnpreparedValue)
</span><a href="#local-6989586621688527649"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-478"></span><span>          </span><span id="local-6989586621688527615"><span class="annot"><span class="annottext">annotatedJoinColumns :: HashMap FieldName (Name, JoinColumnAlias)
</span><a href="#local-6989586621688527615"><span class="hs-identifier hs-var hs-var">annotatedJoinColumns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FieldName -&gt; Name -&gt; (Name, JoinColumnAlias))
-&gt; HashMap FieldName Name
-&gt; HashMap FieldName (Name, JoinColumnAlias)
forall k v1 v2. (k -&gt; v1 -&gt; v2) -&gt; HashMap k v1 -&gt; HashMap k v2
</span><span class="hs-identifier hs-var">Map.mapWithKey</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Name -&gt; (Name, JoinColumnAlias)
</span><a href="#local-6989586621688527622"><span class="hs-identifier hs-var">annotateJoinField</span></a></span><span> </span><span class="annot"><span class="annottext">(HashMap FieldName Name
 -&gt; HashMap FieldName (Name, JoinColumnAlias))
-&gt; HashMap FieldName Name
-&gt; HashMap FieldName (Name, JoinColumnAlias)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName Name
</span><a href="#local-6989586621688527617"><span class="hs-identifier hs-var">lhsJoinFields</span></a></span><span>
</span><span id="line-479"></span><span>          </span><span id="local-6989586621688527614"><span class="annot"><span class="annottext">ActionFields
</span><a href="#local-6989586621688527614"><span class="hs-identifier hs-var">phantomFields_</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Action.html#ActionFieldG"><span class="hs-identifier hs-type">ActionFieldG</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-480"></span><span>            </span><span class="annot"><span class="annottext">HashMap FieldName (Name, JoinColumnAlias)
-&gt; [(Name, JoinColumnAlias)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName (Name, JoinColumnAlias)
</span><a href="#local-6989586621688527615"><span class="hs-identifier hs-var">annotatedJoinColumns</span></a></span><span> </span><span class="annot"><span class="annottext">[(Name, JoinColumnAlias)]
-&gt; ([(Name, JoinColumnAlias)] -&gt; ActionFields) -&gt; ActionFields
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">((Name, JoinColumnAlias) -&gt; Maybe (FieldName, ActionFieldG Void))
-&gt; [(Name, JoinColumnAlias)] -&gt; ActionFields
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621688527613"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527613"><span class="hs-identifier hs-var">joinField</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688527612"><span class="annot"><span class="annottext">JoinColumnAlias
</span><a href="#local-6989586621688527612"><span class="hs-identifier hs-var">alias</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-481"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">JoinColumnAlias
</span><a href="#local-6989586621688527612"><span class="hs-identifier hs-var">alias</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-482"></span><span>                </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#JCSelected"><span class="hs-identifier hs-type">JCSelected</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (FieldName, ActionFieldG Void)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-483"></span><span>                </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#JCPhantom"><span class="hs-identifier hs-type">JCPhantom</span></a></span><span> </span><span id="local-6989586621688527611"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527611"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-484"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688527610"><span class="annot"><span class="annottext">annotatedColumn :: ActionFieldG Void
</span><a href="#local-6989586621688527610"><span class="hs-identifier hs-var hs-var">annotatedColumn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-485"></span><span>                        </span><span class="annot"><span class="annottext">Name -&gt; ActionFieldG Void
forall r. Name -&gt; ActionFieldG r
</span><a href="Hasura.RQL.IR.Action.html#ACFScalar"><span class="hs-identifier hs-var">ACFScalar</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527613"><span class="hs-identifier hs-var">joinField</span></a></span><span>
</span><span id="line-486"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(FieldName, ActionFieldG Void)
-&gt; Maybe (FieldName, ActionFieldG Void)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527611"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ActionFieldG Void
</span><a href="#local-6989586621688527610"><span class="hs-identifier hs-var">annotatedColumn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Name, JoinColumnAlias) -&gt; JoinColumnAlias)
-&gt; HashMap FieldName (Name, JoinColumnAlias)
-&gt; HashMap FieldName JoinColumnAlias
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Name, JoinColumnAlias) -&gt; JoinColumnAlias
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName (Name, JoinColumnAlias)
</span><a href="#local-6989586621688527615"><span class="hs-identifier hs-var">annotatedJoinColumns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ActionFields
</span><a href="#local-6989586621688527614"><span class="hs-identifier hs-var">phantomFields_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span class="hs-comment">-- | Transforms a GraphQL selection set.</span><span>
</span><span id="line-490"></span><span class="hs-comment">--</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- This function takes an 'SelectionSet', which corresponds to a selection of</span><span>
</span><span id="line-492"></span><span class="hs-comment">-- fields on a remote GraphQL schema, and extracts remote joins: for every field</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- we encounter that maps to a remote destination (either a source or another</span><span>
</span><span id="line-494"></span><span class="hs-comment">-- remote schema), we replace it with a phantom field and 'collect' the</span><span>
</span><span id="line-495"></span><span class="hs-comment">-- corresponding 'RemoteJoin'.</span><span>
</span><span id="line-496"></span><span id="local-6989586621688528116"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformObjectSelectionSet"><span class="hs-identifier hs-type">transformObjectSelectionSet</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-497"></span><span>  </span><span class="hs-comment">-- | The type name on which this selection set is defined; this is only</span><span>
</span><span id="line-498"></span><span>  </span><span class="hs-comment">-- expected to be provided for unions and interfaces, not for regular objects,</span><span>
</span><span id="line-499"></span><span>  </span><span class="hs-comment">-- as this is used to determine whether a selection set is potentially</span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-comment">-- &quot;ambiguous&quot; or not, and regular objects cannot. This will be used as the</span><span>
</span><span id="line-501"></span><span>  </span><span class="hs-comment">-- type name in the 'QualifiedFieldName' key of the join tree if this</span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-comment">-- selection set or its subselections contain remote joins.</span><span>
</span><span id="line-503"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">G.Name</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-504"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#ObjectSelectionSet"><span class="hs-identifier hs-type">ObjectSelectionSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621688528116"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-505"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#Collector"><span class="hs-identifier hs-type">Collector</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#ObjectSelectionSet"><span class="hs-identifier hs-type">ObjectSelectionSet</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Void</span></span><span> </span><span class="annot"><a href="#local-6989586621688528116"><span class="hs-identifier hs-type">var</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-506"></span><span id="transformObjectSelectionSet"><span class="annot"><span class="annottext">transformObjectSelectionSet :: Maybe Name
-&gt; ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var
-&gt; Collector (ObjectSelectionSet Void var)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformObjectSelectionSet"><span class="hs-identifier hs-var hs-var">transformObjectSelectionSet</span></a></span></span><span> </span><span id="local-6989586621688527609"><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621688527609"><span class="hs-identifier hs-var">typename</span></a></span></span><span> </span><span id="local-6989586621688527608"><span class="annot"><span class="annottext">ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527608"><span class="hs-identifier hs-var">selectionSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-507"></span><span>  </span><span class="hs-comment">-- we need to keep track of whether any subfield contained a remote join</span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621688527607"><span class="annot"><span class="annottext">InsOrdHashMap Name (GraphQLField Void var, Maybe RemoteJoin)
</span><a href="#local-6989586621688527607"><span class="hs-identifier hs-var">annotatedFields</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688527606"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621688527606"><span class="hs-identifier hs-var">subfieldsContainRemoteJoins</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-509"></span><span>    </span><span class="annot"><span class="annottext">(Maybe RemoteJoins -&gt; Bool)
-&gt; Collector
     (InsOrdHashMap Name (GraphQLField Void var, Maybe RemoteJoin))
-&gt; Collector
     (InsOrdHashMap Name (GraphQLField Void var, Maybe RemoteJoin),
      Bool)
forall w (m :: * -&gt; *) b a.
MonadWriter w m =&gt;
(w -&gt; b) -&gt; m a -&gt; m (a, b)
</span><span class="hs-identifier hs-var">listens</span></span><span> </span><span class="annot"><span class="annottext">Maybe RemoteJoins -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Collector
   (InsOrdHashMap Name (GraphQLField Void var, Maybe RemoteJoin))
 -&gt; Collector
      (InsOrdHashMap Name (GraphQLField Void var, Maybe RemoteJoin),
       Bool))
-&gt; Collector
     (InsOrdHashMap Name (GraphQLField Void var, Maybe RemoteJoin))
-&gt; Collector
     (InsOrdHashMap Name (GraphQLField Void var, Maybe RemoteJoin),
      Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-510"></span><span>      </span><span class="annot"><span class="annottext">((Name
  -&gt; Field (RemoteRelationshipField UnpreparedValue) var
  -&gt; Collector (GraphQLField Void var, Maybe RemoteJoin))
 -&gt; ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var
 -&gt; Collector
      (InsOrdHashMap Name (GraphQLField Void var, Maybe RemoteJoin)))
-&gt; ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var
-&gt; (Name
    -&gt; Field (RemoteRelationshipField UnpreparedValue) var
    -&gt; Collector (GraphQLField Void var, Maybe RemoteJoin))
-&gt; Collector
     (InsOrdHashMap Name (GraphQLField Void var, Maybe RemoteJoin))
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Name
 -&gt; Field (RemoteRelationshipField UnpreparedValue) var
 -&gt; Collector (GraphQLField Void var, Maybe RemoteJoin))
-&gt; ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var
-&gt; Collector
     (InsOrdHashMap Name (GraphQLField Void var, Maybe RemoteJoin))
forall (f :: * -&gt; *) k a b.
Applicative f =&gt;
(k -&gt; a -&gt; f b) -&gt; InsOrdHashMap k a -&gt; f (InsOrdHashMap k b)
</span><span class="hs-identifier hs-var">OMap.traverseWithKey</span></span><span> </span><span class="annot"><span class="annottext">ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527608"><span class="hs-identifier hs-var">selectionSet</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621688527602"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527602"><span class="hs-identifier hs-var">alias</span></a></span></span><span> </span><span id="local-6989586621688527601"><span class="annot"><span class="annottext">Field (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527601"><span class="hs-identifier hs-var">field</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-511"></span><span>        </span><span class="annot"><span class="annottext">Maybe Text
-&gt; Text
-&gt; Collector (GraphQLField Void var, Maybe RemoteJoin)
-&gt; Collector (GraphQLField Void var, Maybe RemoteJoin)
forall a. Maybe Text -&gt; Text -&gt; Collector a -&gt; Collector a
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#withField"><span class="hs-identifier hs-var">withField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Text) -&gt; Maybe Name -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621688527609"><span class="hs-identifier hs-var">typename</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527602"><span class="hs-identifier hs-var">alias</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-512"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Field (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527601"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-513"></span><span>            </span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#FieldGraphQL"><span class="hs-identifier hs-type">FieldGraphQL</span></a></span><span> </span><span id="local-6989586621688527598"><span class="annot"><span class="annottext">GraphQLField (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527598"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">Maybe RemoteJoin
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(GraphQLField Void var
 -&gt; (GraphQLField Void var, Maybe RemoteJoin))
-&gt; Collector (GraphQLField Void var)
-&gt; Collector (GraphQLField Void var, Maybe RemoteJoin)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">GraphQLField (RemoteRelationshipField UnpreparedValue) var
-&gt; Collector (GraphQLField Void var)
forall var.
GraphQLField (RemoteRelationshipField UnpreparedValue) var
-&gt; Collector (GraphQLField Void var)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#transformGraphQLField"><span class="hs-identifier hs-var">transformGraphQLField</span></a></span><span> </span><span class="annot"><span class="annottext">GraphQLField (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527598"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-514"></span><span>            </span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#FieldRemote"><span class="hs-identifier hs-type">FieldRemote</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#SchemaRemoteRelationshipSelect"><span class="hs-identifier hs-type">SchemaRemoteRelationshipSelect</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688527594"><span id="local-6989586621688527595"><span class="annot"><span class="annottext">HashMap FieldName Name
RemoteRelationshipField UnpreparedValue
_srrsRelationship :: forall r. SchemaRemoteRelationshipSelect r -&gt; r
_srrsLHSJoinFields :: forall r.
SchemaRemoteRelationshipSelect r -&gt; HashMap FieldName Name
_srrsRelationship :: RemoteRelationshipField UnpreparedValue
_srrsLHSJoinFields :: HashMap FieldName Name
</span><a href="Hasura.RQL.IR.RemoteSchema.html#_srrsRelationship"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-515"></span><span>              </span><span class="annot"><span class="annottext">(GraphQLField Void var, Maybe RemoteJoin)
-&gt; Collector (GraphQLField Void var, Maybe RemoteJoin)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-516"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Name -&gt; GraphQLField Void var
forall r var. Name -&gt; GraphQLField r var
</span><a href="#local-6989586621688527591"><span class="hs-identifier hs-var">mkPlaceholderField</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527602"><span class="hs-identifier hs-var">alias</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-517"></span><span>                  </span><span class="annot"><span class="annottext">RemoteJoin -&gt; Maybe RemoteJoin
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(RemoteJoin -&gt; Maybe RemoteJoin) -&gt; RemoteJoin -&gt; Maybe RemoteJoin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName JoinColumnAlias
-&gt; RemoteRelationshipField UnpreparedValue -&gt; RemoteJoin
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#createRemoteJoin"><span class="hs-identifier hs-var">createRemoteJoin</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName JoinColumnAlias
</span><a href="#local-6989586621688527590"><span class="hs-identifier hs-var">joinColumnAliases</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteRelationshipField UnpreparedValue
</span><a href="#local-6989586621688527594"><span class="hs-identifier hs-var">_srrsRelationship</span></a></span><span>
</span><span id="line-518"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688527589"><span class="annot"><span class="annottext">internalTypeAlias :: Name
</span><a href="#local-6989586621688527589"><span class="hs-identifier hs-var hs-var">internalTypeAlias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Hasura.GraphQL.Parser.Constants.html#___hasura_internal_typename"><span class="hs-identifier hs-var">G.___hasura_internal_typename</span></a></span><span>
</span><span id="line-520"></span><span>      </span><span id="local-6989586621688527587"><span class="annot"><span class="annottext">remoteJoins :: InsOrdHashMap Name RemoteJoin
</span><a href="#local-6989586621688527587"><span class="hs-identifier hs-var hs-var">remoteJoins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((GraphQLField Void var, Maybe RemoteJoin) -&gt; Maybe RemoteJoin)
-&gt; InsOrdHashMap Name (GraphQLField Void var, Maybe RemoteJoin)
-&gt; InsOrdHashMap Name RemoteJoin
forall v1 v2 k.
(v1 -&gt; Maybe v2) -&gt; InsOrdHashMap k v1 -&gt; InsOrdHashMap k v2
</span><span class="hs-identifier hs-var">OMap.mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">(GraphQLField Void var, Maybe RemoteJoin) -&gt; Maybe RemoteJoin
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap Name (GraphQLField Void var, Maybe RemoteJoin)
</span><a href="#local-6989586621688527607"><span class="hs-identifier hs-var">annotatedFields</span></a></span><span>
</span><span id="line-521"></span><span>      </span><span id="local-6989586621688527585"><span class="annot"><span class="annottext">additionalFields :: InsOrdHashMap Name (GraphQLField Void var)
</span><a href="#local-6989586621688527585"><span class="hs-identifier hs-var hs-var">additionalFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-522"></span><span>        </span><span class="hs-keyword">if</span><span>
</span><span id="line-523"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621688527609"><span class="hs-identifier hs-var">typename</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InsOrdHashMap Name RemoteJoin -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap Name RemoteJoin
</span><a href="#local-6989586621688527587"><span class="hs-identifier hs-var">remoteJoins</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621688527606"><span class="hs-identifier hs-var">subfieldsContainRemoteJoins</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-524"></span><span>              </span><span class="hs-comment">-- We are in a situation in which the type name matters, and we know</span><span>
</span><span id="line-525"></span><span>              </span><span class="hs-comment">-- that there is at least one remote join in this part of tree, meaning</span><span>
</span><span id="line-526"></span><span>              </span><span class="hs-comment">-- we might need to branch on the typename when traversing the join</span><span>
</span><span id="line-527"></span><span>              </span><span class="hs-comment">-- tree: we insert a custom field that will return the type name.</span><span>
</span><span id="line-528"></span><span>              </span><span class="annot"><span class="annottext">Name
-&gt; GraphQLField Void var
-&gt; InsOrdHashMap Name (GraphQLField Void var)
forall k v. Hashable k =&gt; k -&gt; v -&gt; InsOrdHashMap k v
</span><span class="hs-identifier hs-var">OMap.singleton</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527589"><span class="hs-identifier hs-var">internalTypeAlias</span></a></span><span> </span><span class="annot"><span class="annottext">(GraphQLField Void var
 -&gt; InsOrdHashMap Name (GraphQLField Void var))
-&gt; GraphQLField Void var
-&gt; InsOrdHashMap Name (GraphQLField Void var)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-529"></span><span>                </span><span class="annot"><span class="annottext">Maybe Name
-&gt; Name
-&gt; HashMap Name (Value var)
-&gt; [Directive var]
-&gt; SelectionSet Void var
-&gt; GraphQLField Void var
forall var r.
Maybe Name
-&gt; Name
-&gt; HashMap Name (Value var)
-&gt; [Directive var]
-&gt; SelectionSet r var
-&gt; GraphQLField r var
</span><a href="Hasura.RQL.IR.RemoteSchema.html#mkGraphQLField"><span class="hs-identifier hs-var">mkGraphQLField</span></a></span><span>
</span><span id="line-530"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527589"><span class="hs-identifier hs-var">internalTypeAlias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>                  </span><span class="annot"><span class="annottext">Name
</span><a href="Hasura.GraphQL.Parser.Constants.html#___typename"><span class="hs-identifier hs-var">G.___typename</span></a></span><span>
</span><span id="line-532"></span><span>                  </span><span class="annot"><span class="annottext">HashMap Name (Value var)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-533"></span><span>                  </span><span class="annot"><span class="annottext">[Directive var]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-534"></span><span>                  </span><span class="annot"><span class="annottext">SelectionSet Void var
forall r var. SelectionSet r var
</span><a href="Hasura.RQL.IR.RemoteSchema.html#SelectionSetNone"><span class="hs-identifier hs-var">SelectionSetNone</span></a></span><span>
</span><span id="line-535"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-536"></span><span>              </span><span class="hs-comment">-- Either the typename doesn't matter, or this tree doesn't have remote</span><span>
</span><span id="line-537"></span><span>              </span><span class="hs-comment">-- joins; this selection set isn't &quot;ambiguous&quot;.</span><span>
</span><span id="line-538"></span><span>              </span><span class="annot"><span class="annottext">InsOrdHashMap Name (GraphQLField Void var)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-539"></span><span>      </span><span id="local-6989586621688527577"><span class="annot"><span class="annottext">transformedFields :: InsOrdHashMap Name (GraphQLField Void var)
</span><a href="#local-6989586621688527577"><span class="hs-identifier hs-var hs-var">transformedFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((GraphQLField Void var, Maybe RemoteJoin)
 -&gt; GraphQLField Void var)
-&gt; InsOrdHashMap Name (GraphQLField Void var, Maybe RemoteJoin)
-&gt; InsOrdHashMap Name (GraphQLField Void var)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(GraphQLField Void var, Maybe RemoteJoin) -&gt; GraphQLField Void var
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap Name (GraphQLField Void var, Maybe RemoteJoin)
</span><a href="#local-6989586621688527607"><span class="hs-identifier hs-var">annotatedFields</span></a></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap Name (GraphQLField Void var)
-&gt; InsOrdHashMap Name (GraphQLField Void var)
-&gt; InsOrdHashMap Name (GraphQLField Void var)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap Name (GraphQLField Void var)
</span><a href="#local-6989586621688527585"><span class="hs-identifier hs-var">additionalFields</span></a></span><span>
</span><span id="line-540"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Name, RemoteJoin)] -&gt; Maybe (NEHashMap Name RemoteJoin)
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; Maybe (NEHashMap k v)
</span><a href="Data.HashMap.Strict.NonEmpty.html#fromList"><span class="hs-identifier hs-var">NEMap.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Name, RemoteJoin)] -&gt; Maybe (NEHashMap Name RemoteJoin))
-&gt; [(Name, RemoteJoin)] -&gt; Maybe (NEHashMap Name RemoteJoin)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap Name RemoteJoin -&gt; [(Name, RemoteJoin)]
forall k v. InsOrdHashMap k v -&gt; [(k, v)]
</span><span class="hs-identifier hs-var">OMap.toList</span></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap Name RemoteJoin
</span><a href="#local-6989586621688527587"><span class="hs-identifier hs-var">remoteJoins</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-541"></span><span>    </span><span class="annot"><span class="annottext">Maybe (NEHashMap Name RemoteJoin)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ObjectSelectionSet Void var
-&gt; Collector (ObjectSelectionSet Void var)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ObjectSelectionSet Void var
 -&gt; Collector (ObjectSelectionSet Void var))
-&gt; ObjectSelectionSet Void var
-&gt; Collector (ObjectSelectionSet Void var)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(GraphQLField Void var -&gt; Field Void var)
-&gt; InsOrdHashMap Name (GraphQLField Void var)
-&gt; ObjectSelectionSet Void var
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">GraphQLField Void var -&gt; Field Void var
forall r var. GraphQLField r var -&gt; Field r var
</span><a href="Hasura.RQL.IR.RemoteSchema.html#FieldGraphQL"><span class="hs-identifier hs-var">FieldGraphQL</span></a></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap Name (GraphQLField Void var)
</span><a href="#local-6989586621688527577"><span class="hs-identifier hs-var">transformedFields</span></a></span><span>
</span><span id="line-542"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621688527575"><span class="annot"><span class="annottext">NEHashMap Name RemoteJoin
</span><a href="#local-6989586621688527575"><span class="hs-identifier hs-var">neRemoteJoins</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-543"></span><span>      </span><span class="annot"><span class="annottext">NEHashMap QualifiedFieldName RemoteJoin -&gt; Collector ()
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#collect"><span class="hs-identifier hs-var">collect</span></a></span><span> </span><span class="annot"><span class="annottext">(NEHashMap QualifiedFieldName RemoteJoin -&gt; Collector ())
-&gt; NEHashMap QualifiedFieldName RemoteJoin -&gt; Collector ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; QualifiedFieldName)
-&gt; NEHashMap Name RemoteJoin
-&gt; NEHashMap QualifiedFieldName RemoteJoin
forall k2 k1 v.
(Eq k2, Hashable k2) =&gt;
(k1 -&gt; k2) -&gt; NEHashMap k1 v -&gt; NEHashMap k2 v
</span><a href="Data.HashMap.Strict.NonEmpty.html#mapKeys"><span class="hs-identifier hs-var">NEMap.mapKeys</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621688527573"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527573"><span class="hs-identifier hs-var">fieldGName</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; Text -&gt; QualifiedFieldName
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#QualifiedFieldName"><span class="hs-identifier hs-var">QualifiedFieldName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Text) -&gt; Maybe Name -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Name
</span><a href="#local-6989586621688527609"><span class="hs-identifier hs-var">typename</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527573"><span class="hs-identifier hs-var">fieldGName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NEHashMap Name RemoteJoin
</span><a href="#local-6989586621688527575"><span class="hs-identifier hs-var">neRemoteJoins</span></a></span><span>
</span><span id="line-544"></span><span>      </span><span class="annot"><span class="annottext">ObjectSelectionSet Void var
-&gt; Collector (ObjectSelectionSet Void var)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ObjectSelectionSet Void var
 -&gt; Collector (ObjectSelectionSet Void var))
-&gt; ObjectSelectionSet Void var
-&gt; Collector (ObjectSelectionSet Void var)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-545"></span><span>        </span><span class="annot"><span class="annottext">(GraphQLField Void var -&gt; Field Void var)
-&gt; InsOrdHashMap Name (GraphQLField Void var)
-&gt; ObjectSelectionSet Void var
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span>
</span><span id="line-546"></span><span>          </span><span class="annot"><span class="annottext">GraphQLField Void var -&gt; Field Void var
forall r var. GraphQLField r var -&gt; Field r var
</span><a href="Hasura.RQL.IR.RemoteSchema.html#FieldGraphQL"><span class="hs-identifier hs-var">FieldGraphQL</span></a></span><span>
</span><span id="line-547"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">InsOrdHashMap Name (GraphQLField Void var)
</span><a href="#local-6989586621688527577"><span class="hs-identifier hs-var">transformedFields</span></a></span><span> </span><span class="annot"><span class="annottext">InsOrdHashMap Name (GraphQLField Void var)
-&gt; InsOrdHashMap Name (GraphQLField Void var)
-&gt; InsOrdHashMap Name (GraphQLField Void var)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Name, GraphQLField Void var)]
-&gt; InsOrdHashMap Name (GraphQLField Void var)
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; InsOrdHashMap k v
</span><span class="hs-identifier hs-var">OMap.fromList</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphQLField Void var -&gt; Name
forall r var. GraphQLField r var -&gt; Name
</span><a href="Hasura.RQL.IR.RemoteSchema.html#_fAlias"><span class="hs-identifier hs-var hs-var">_fAlias</span></a></span><span> </span><span class="annot"><span class="annottext">GraphQLField Void var
</span><a href="#local-6989586621688527570"><span class="hs-identifier hs-var">fld</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GraphQLField Void var
</span><a href="#local-6989586621688527570"><span class="hs-identifier hs-var">fld</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621688527570"><span class="annot"><span class="annottext">GraphQLField Void var
</span><a href="#local-6989586621688527570"><span class="hs-identifier hs-var">fld</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HashMap FieldName (GraphQLField Void var)
-&gt; [GraphQLField Void var]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName (GraphQLField Void var)
</span><a href="#local-6989586621688527569"><span class="hs-identifier hs-var">phantomFields</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-549"></span><span>    </span><span id="local-6989586621688527568"><span class="annot"><span class="annottext">nameToField :: Name -&gt; FieldName
</span><a href="#local-6989586621688527568"><span class="hs-identifier hs-var hs-var">nameToField</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; FieldName
</span><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-var">FieldName</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; FieldName) -&gt; (Name -&gt; Text) -&gt; Name -&gt; FieldName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span>
</span><span id="line-550"></span><span>    </span><span id="local-6989586621688527566"><span class="annot"><span class="annottext">allAliases :: [FieldName]
</span><a href="#local-6989586621688527566"><span class="hs-identifier hs-var hs-var">allAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Name, Field (RemoteRelationshipField UnpreparedValue) var)
 -&gt; FieldName)
-&gt; [(Name, Field (RemoteRelationshipField UnpreparedValue) var)]
-&gt; [FieldName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; FieldName
</span><a href="#local-6989586621688527568"><span class="hs-identifier hs-var">nameToField</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; FieldName)
-&gt; ((Name, Field (RemoteRelationshipField UnpreparedValue) var)
    -&gt; Name)
-&gt; (Name, Field (RemoteRelationshipField UnpreparedValue) var)
-&gt; FieldName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Name, Field (RemoteRelationshipField UnpreparedValue) var) -&gt; Name
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Name, Field (RemoteRelationshipField UnpreparedValue) var)]
 -&gt; [FieldName])
-&gt; [(Name, Field (RemoteRelationshipField UnpreparedValue) var)]
-&gt; [FieldName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var
-&gt; [(Name, Field (RemoteRelationshipField UnpreparedValue) var)]
forall k v. InsOrdHashMap k v -&gt; [(k, v)]
</span><span class="hs-identifier hs-var">OMap.toList</span></span><span> </span><span class="annot"><span class="annottext">ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527608"><span class="hs-identifier hs-var">selectionSet</span></a></span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span>    </span><span id="local-6989586621688527591"><span class="annot"><span class="annottext">mkPlaceholderField :: Name -&gt; GraphQLField r var
</span><a href="#local-6989586621688527591"><span class="hs-identifier hs-var hs-var">mkPlaceholderField</span></a></span></span><span> </span><span id="local-6989586621688527565"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527565"><span class="hs-identifier hs-var">alias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-553"></span><span>      </span><span class="annot"><span class="annottext">Maybe Name
-&gt; Name
-&gt; HashMap Name (Value var)
-&gt; [Directive var]
-&gt; SelectionSet r var
-&gt; GraphQLField r var
forall var r.
Maybe Name
-&gt; Name
-&gt; HashMap Name (Value var)
-&gt; [Directive var]
-&gt; SelectionSet r var
-&gt; GraphQLField r var
</span><a href="Hasura.RQL.IR.RemoteSchema.html#mkGraphQLField"><span class="hs-identifier hs-var">mkGraphQLField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527565"><span class="hs-identifier hs-var">alias</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Hasura.GraphQL.Parser.Constants.html#___typename"><span class="hs-identifier hs-var">G.___typename</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Name (Value var)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">[Directive var]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">SelectionSet r var
forall r var. SelectionSet r var
</span><a href="Hasura.RQL.IR.RemoteSchema.html#SelectionSetNone"><span class="hs-identifier hs-var">SelectionSetNone</span></a></span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span>    </span><span class="hs-comment">-- A map of graphql scalar fields (without any arguments) to their aliases</span><span>
</span><span id="line-556"></span><span>    </span><span class="hs-comment">-- in the selection set. We do not yet support lhs join fields which take</span><span>
</span><span id="line-557"></span><span>    </span><span class="hs-comment">-- arguments. To be consistent with that, we ignore fields with arguments</span><span>
</span><span id="line-558"></span><span>    </span><span id="local-6989586621688527564"><span class="annot"><span class="annottext">noArgsGraphQLFields :: HashMap Name FieldName
</span><a href="#local-6989586621688527564"><span class="hs-identifier hs-var hs-var">noArgsGraphQLFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-559"></span><span>      </span><span class="annot"><span class="annottext">[(Name, FieldName)] -&gt; HashMap Name FieldName
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, FieldName)] -&gt; HashMap Name FieldName)
-&gt; [(Name, FieldName)] -&gt; HashMap Name FieldName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-560"></span><span>        </span><span class="annot"><span class="annottext">(((Name, Field (RemoteRelationshipField UnpreparedValue) var)
  -&gt; Maybe (Name, FieldName))
 -&gt; [(Name, Field (RemoteRelationshipField UnpreparedValue) var)]
 -&gt; [(Name, FieldName)])
-&gt; [(Name, Field (RemoteRelationshipField UnpreparedValue) var)]
-&gt; ((Name, Field (RemoteRelationshipField UnpreparedValue) var)
    -&gt; Maybe (Name, FieldName))
-&gt; [(Name, FieldName)]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">((Name, Field (RemoteRelationshipField UnpreparedValue) var)
 -&gt; Maybe (Name, FieldName))
-&gt; [(Name, Field (RemoteRelationshipField UnpreparedValue) var)]
-&gt; [(Name, FieldName)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var
-&gt; [(Name, Field (RemoteRelationshipField UnpreparedValue) var)]
forall k v. InsOrdHashMap k v -&gt; [(k, v)]
</span><span class="hs-identifier hs-var">OMap.toList</span></span><span> </span><span class="annot"><span class="annottext">ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527608"><span class="hs-identifier hs-var">selectionSet</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621688527563"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527563"><span class="hs-identifier hs-var">alias</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688527562"><span class="annot"><span class="annottext">Field (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527562"><span class="hs-identifier hs-var">field</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Field (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527562"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-561"></span><span>          </span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#FieldGraphQL"><span class="hs-identifier hs-type">FieldGraphQL</span></a></span><span> </span><span id="local-6989586621688527561"><span class="annot"><span class="annottext">GraphQLField (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527561"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-562"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">HashMap Name (Value var) -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphQLField (RemoteRelationshipField UnpreparedValue) var
-&gt; HashMap Name (Value var)
forall r var. GraphQLField r var -&gt; HashMap Name (Value var)
</span><a href="Hasura.RQL.IR.RemoteSchema.html#_fArguments"><span class="hs-identifier hs-var hs-var">_fArguments</span></a></span><span> </span><span class="annot"><span class="annottext">GraphQLField (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527561"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(Name, FieldName) -&gt; Maybe (Name, FieldName)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GraphQLField (RemoteRelationshipField UnpreparedValue) var -&gt; Name
forall r var. GraphQLField r var -&gt; Name
</span><a href="Hasura.RQL.IR.RemoteSchema.html#_fName"><span class="hs-identifier hs-var hs-var">_fName</span></a></span><span> </span><span class="annot"><span class="annottext">GraphQLField (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527561"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; FieldName
</span><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-var">FieldName</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; FieldName) -&gt; Text -&gt; FieldName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Text
</span><span class="hs-identifier hs-var hs-var">G.unName</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527563"><span class="hs-identifier hs-var">alias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (Name, FieldName)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-565"></span><span>          </span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#FieldRemote"><span class="hs-identifier hs-type">FieldRemote</span></a></span><span> </span><span class="annot"><span class="annottext">SchemaRemoteRelationshipSelect
  (RemoteRelationshipField UnpreparedValue)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Name, FieldName)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span>    </span><span id="local-6989586621688527558"><span class="annot"><span class="annottext">annotateLHSJoinField :: FieldName -&gt; Name -&gt; (GraphQLField Void var, JoinColumnAlias)
</span><a href="#local-6989586621688527558"><span class="hs-identifier hs-var hs-var">annotateLHSJoinField</span></a></span></span><span> </span><span id="local-6989586621688527557"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527557"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span> </span><span id="local-6989586621688527556"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527556"><span class="hs-identifier hs-var">lhsJoinField</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-568"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688527555"><span class="annot"><span class="annottext">columnAlias :: JoinColumnAlias
</span><a href="#local-6989586621688527555"><span class="hs-identifier hs-var hs-var">columnAlias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-569"></span><span>            </span><span class="annot"><span class="annottext">FieldName
-&gt; Name -&gt; HashMap Name FieldName -&gt; [FieldName] -&gt; JoinColumnAlias
forall field.
(Eq field, Hashable field) =&gt;
FieldName
-&gt; field
-&gt; HashMap field FieldName
-&gt; [FieldName]
-&gt; JoinColumnAlias
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getJoinColumnAlias"><span class="hs-identifier hs-var">getJoinColumnAlias</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527557"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527556"><span class="hs-identifier hs-var">lhsJoinField</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Name FieldName
</span><a href="#local-6989586621688527564"><span class="hs-identifier hs-var">noArgsGraphQLFields</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldName]
</span><a href="#local-6989586621688527566"><span class="hs-identifier hs-var">allAliases</span></a></span><span>
</span><span id="line-570"></span><span>          </span><span class="hs-comment">-- This alias is generated in 'getJoinColumnAlias', and is guaranteed</span><span>
</span><span id="line-571"></span><span>          </span><span class="hs-comment">-- to be a valid GraphQLName.</span><span>
</span><span id="line-572"></span><span>          </span><span id="local-6989586621688527554"><span class="annot"><span class="annottext">columnGraphQLName :: Name
</span><a href="#local-6989586621688527554"><span class="hs-identifier hs-var hs-var">columnGraphQLName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-573"></span><span>            </span><span class="annot"><span class="annottext">Text -&gt; Name
</span><span class="hs-identifier hs-var">G.unsafeMkName</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Name) -&gt; Text -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Text
</span><a href="Hasura.RQL.Types.Common.html#getFieldNameTxt"><span class="hs-identifier hs-var hs-var">getFieldNameTxt</span></a></span><span> </span><span class="annot"><span class="annottext">(FieldName -&gt; Text) -&gt; FieldName -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">JoinColumnAlias -&gt; FieldName
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#getAliasFieldName"><span class="hs-identifier hs-var">getAliasFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">JoinColumnAlias
</span><a href="#local-6989586621688527555"><span class="hs-identifier hs-var">columnAlias</span></a></span><span>
</span><span id="line-574"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Maybe Name
-&gt; Name
-&gt; HashMap Name (Value var)
-&gt; [Directive var]
-&gt; SelectionSet Void var
-&gt; GraphQLField Void var
forall var r.
Maybe Name
-&gt; Name
-&gt; HashMap Name (Value var)
-&gt; [Directive var]
-&gt; SelectionSet r var
-&gt; GraphQLField r var
</span><a href="Hasura.RQL.IR.RemoteSchema.html#mkGraphQLField"><span class="hs-identifier hs-var">mkGraphQLField</span></a></span><span>
</span><span id="line-575"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Maybe Name
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527554"><span class="hs-identifier hs-var">columnGraphQLName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>              </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621688527556"><span class="hs-identifier hs-var">lhsJoinField</span></a></span><span>
</span><span id="line-577"></span><span>              </span><span class="annot"><span class="annottext">HashMap Name (Value var)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-578"></span><span>              </span><span class="annot"><span class="annottext">[Directive var]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-579"></span><span>              </span><span class="annot"><span class="annottext">SelectionSet Void var
forall r var. SelectionSet r var
</span><a href="Hasura.RQL.IR.RemoteSchema.html#SelectionSetNone"><span class="hs-identifier hs-var">SelectionSetNone</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-580"></span><span>            </span><span class="annot"><span class="annottext">JoinColumnAlias
</span><a href="#local-6989586621688527555"><span class="hs-identifier hs-var">columnAlias</span></a></span><span>
</span><span id="line-581"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621688527590"><span class="annot"><span class="annottext">HashMap FieldName JoinColumnAlias
</span><a href="#local-6989586621688527590"><span class="hs-identifier hs-var">joinColumnAliases</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688527569"><span class="annot"><span class="annottext">HashMap FieldName (GraphQLField Void var)
</span><a href="#local-6989586621688527569"><span class="hs-identifier hs-var">phantomFields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-584"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688527551"><span class="annot"><span class="annottext">lhsJoinFields :: HashMap FieldName Name
</span><a href="#local-6989586621688527551"><span class="hs-identifier hs-var hs-var">lhsJoinFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-585"></span><span>            </span><span class="annot"><span class="annottext">[HashMap FieldName Name] -&gt; HashMap FieldName Name
forall k v. (Eq k, Hashable k) =&gt; [HashMap k v] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">Map.unions</span></span><span> </span><span class="annot"><span class="annottext">([HashMap FieldName Name] -&gt; HashMap FieldName Name)
-&gt; [HashMap FieldName Name] -&gt; HashMap FieldName Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SchemaRemoteRelationshipSelect
   (RemoteRelationshipField UnpreparedValue)
 -&gt; HashMap FieldName Name)
-&gt; [SchemaRemoteRelationshipSelect
      (RemoteRelationshipField UnpreparedValue)]
-&gt; [HashMap FieldName Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">SchemaRemoteRelationshipSelect
  (RemoteRelationshipField UnpreparedValue)
-&gt; HashMap FieldName Name
forall r.
SchemaRemoteRelationshipSelect r -&gt; HashMap FieldName Name
</span><a href="Hasura.RQL.IR.RemoteSchema.html#_srrsLHSJoinFields"><span class="hs-identifier hs-var hs-var">_srrsLHSJoinFields</span></a></span><span> </span><span class="annot"><span class="annottext">([SchemaRemoteRelationshipSelect
    (RemoteRelationshipField UnpreparedValue)]
 -&gt; [HashMap FieldName Name])
-&gt; [SchemaRemoteRelationshipSelect
      (RemoteRelationshipField UnpreparedValue)]
-&gt; [HashMap FieldName Name]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Field (RemoteRelationshipField UnpreparedValue) var
 -&gt; Maybe
      (SchemaRemoteRelationshipSelect
         (RemoteRelationshipField UnpreparedValue)))
-&gt; [Field (RemoteRelationshipField UnpreparedValue) var]
-&gt; [SchemaRemoteRelationshipSelect
      (RemoteRelationshipField UnpreparedValue)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Getting
  (First
     (SchemaRemoteRelationshipSelect
        (RemoteRelationshipField UnpreparedValue)))
  (Field (RemoteRelationshipField UnpreparedValue) var)
  (SchemaRemoteRelationshipSelect
     (RemoteRelationshipField UnpreparedValue))
-&gt; Field (RemoteRelationshipField UnpreparedValue) var
-&gt; Maybe
     (SchemaRemoteRelationshipSelect
        (RemoteRelationshipField UnpreparedValue))
forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">preview</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (First
     (SchemaRemoteRelationshipSelect
        (RemoteRelationshipField UnpreparedValue)))
  (Field (RemoteRelationshipField UnpreparedValue) var)
  (SchemaRemoteRelationshipSelect
     (RemoteRelationshipField UnpreparedValue))
forall r var.
Prism' (Field r var) (SchemaRemoteRelationshipSelect r)
</span><a href="Hasura.RQL.IR.RemoteSchema.html#_FieldRemote"><span class="hs-identifier hs-var">_FieldRemote</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Field (RemoteRelationshipField UnpreparedValue) var]
 -&gt; [SchemaRemoteRelationshipSelect
       (RemoteRelationshipField UnpreparedValue)])
-&gt; [Field (RemoteRelationshipField UnpreparedValue) var]
-&gt; [SchemaRemoteRelationshipSelect
      (RemoteRelationshipField UnpreparedValue)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var
-&gt; [Field (RemoteRelationshipField UnpreparedValue) var]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">ObjectSelectionSet (RemoteRelationshipField UnpreparedValue) var
</span><a href="#local-6989586621688527608"><span class="hs-identifier hs-var">selectionSet</span></a></span><span>
</span><span id="line-586"></span><span>          </span><span id="local-6989586621688527549"><span class="annot"><span class="annottext">annotatedJoinColumns :: HashMap FieldName (GraphQLField Void var, JoinColumnAlias)
</span><a href="#local-6989586621688527549"><span class="hs-identifier hs-var hs-var">annotatedJoinColumns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FieldName -&gt; Name -&gt; (GraphQLField Void var, JoinColumnAlias))
-&gt; HashMap FieldName Name
-&gt; HashMap FieldName (GraphQLField Void var, JoinColumnAlias)
forall k v1 v2. (k -&gt; v1 -&gt; v2) -&gt; HashMap k v1 -&gt; HashMap k v2
</span><span class="hs-identifier hs-var">Map.mapWithKey</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Name -&gt; (GraphQLField Void var, JoinColumnAlias)
</span><a href="#local-6989586621688527558"><span class="hs-identifier hs-var">annotateLHSJoinField</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName Name
</span><a href="#local-6989586621688527551"><span class="hs-identifier hs-var">lhsJoinFields</span></a></span><span>
</span><span id="line-587"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((GraphQLField Void var, JoinColumnAlias) -&gt; JoinColumnAlias)
-&gt; HashMap FieldName (GraphQLField Void var, JoinColumnAlias)
-&gt; HashMap FieldName JoinColumnAlias
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(GraphQLField Void var, JoinColumnAlias) -&gt; JoinColumnAlias
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName (GraphQLField Void var, JoinColumnAlias)
</span><a href="#local-6989586621688527549"><span class="hs-identifier hs-var">annotatedJoinColumns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">((GraphQLField Void var, JoinColumnAlias) -&gt; GraphQLField Void var)
-&gt; HashMap FieldName (GraphQLField Void var, JoinColumnAlias)
-&gt; HashMap FieldName (GraphQLField Void var)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(GraphQLField Void var, JoinColumnAlias) -&gt; GraphQLField Void var
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName (GraphQLField Void var, JoinColumnAlias)
</span><a href="#local-6989586621688527549"><span class="hs-identifier hs-var">annotatedJoinColumns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-590"></span><span class="hs-comment">-- Internal helpers</span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span class="hs-comment">-- | Converts a remote relationship field into a 'RemoteJoin' that</span><span>
</span><span id="line-593"></span><span class="hs-comment">-- the execution engine understands.</span><span>
</span><span id="line-594"></span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#createRemoteJoin"><span class="hs-identifier hs-type">createRemoteJoin</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-595"></span><span>  </span><span class="hs-comment">-- We need information about 'how' the lhs join fields appear in the lhs</span><span>
</span><span id="line-596"></span><span>  </span><span class="hs-comment">-- response to construct a 'RemoteJoin' node</span><span>
</span><span id="line-597"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Map.HashMap</span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#JoinColumnAlias"><span class="hs-identifier hs-type">JoinColumnAlias</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-598"></span><span>  </span><span class="hs-comment">-- The remote relationship field as captured in the IR</span><span>
</span><span id="line-599"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteRelationshipField"><span class="hs-identifier hs-type">RemoteRelationshipField</span></a></span><span> </span><span class="annot"><a href="Hasura.GraphQL.Parser.Column.html#UnpreparedValue"><span class="hs-identifier hs-type">UnpreparedValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-600"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#RemoteJoin"><span class="hs-identifier hs-type">RemoteJoin</span></a></span><span>
</span><span id="line-601"></span><span id="createRemoteJoin"><span class="annot"><span class="annottext">createRemoteJoin :: HashMap FieldName JoinColumnAlias
-&gt; RemoteRelationshipField UnpreparedValue -&gt; RemoteJoin
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#createRemoteJoin"><span class="hs-identifier hs-var hs-var">createRemoteJoin</span></a></span></span><span> </span><span id="local-6989586621688527548"><span class="annot"><span class="annottext">HashMap FieldName JoinColumnAlias
</span><a href="#local-6989586621688527548"><span class="hs-identifier hs-var">joinColumnAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-602"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteSchemaField"><span class="hs-identifier hs-type">RemoteSchemaField</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.IR.RemoteSchema.html#RemoteSchemaSelect"><span class="hs-identifier hs-type">RemoteSchemaSelect</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688527541"><span id="local-6989586621688527542"><span id="local-6989586621688527543"><span id="local-6989586621688527544"><span id="local-6989586621688527545"><span class="annot"><span class="annottext">[RemoteFieldArgument]
NonEmpty FieldCall
ResultCustomizer
RemoteSchemaInfo
SelectionSet
  (RemoteRelationshipField UnpreparedValue) RemoteSchemaVariable
_rselRemoteSchema :: forall r. RemoteSchemaSelect r -&gt; RemoteSchemaInfo
_rselFieldCall :: forall r. RemoteSchemaSelect r -&gt; NonEmpty FieldCall
_rselSelection :: forall r.
RemoteSchemaSelect r -&gt; SelectionSet r RemoteSchemaVariable
_rselResultCustomizer :: forall r. RemoteSchemaSelect r -&gt; ResultCustomizer
_rselArgs :: forall r. RemoteSchemaSelect r -&gt; [RemoteFieldArgument]
_rselRemoteSchema :: RemoteSchemaInfo
_rselFieldCall :: NonEmpty FieldCall
_rselSelection :: SelectionSet
  (RemoteRelationshipField UnpreparedValue) RemoteSchemaVariable
_rselResultCustomizer :: ResultCustomizer
_rselArgs :: [RemoteFieldArgument]
</span><a href="Hasura.RQL.IR.RemoteSchema.html#_rselRemoteSchema"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-603"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688527535"><span class="annot"><span class="annottext">inputArgsToMap :: [RemoteFieldArgument]
-&gt; HashMap Name (InputValue RemoteSchemaVariable)
</span><a href="#local-6989586621688527535"><span class="hs-identifier hs-var hs-var">inputArgsToMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Name, InputValue RemoteSchemaVariable)]
-&gt; HashMap Name (InputValue RemoteSchemaVariable)
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, InputValue RemoteSchemaVariable)]
 -&gt; HashMap Name (InputValue RemoteSchemaVariable))
-&gt; ([RemoteFieldArgument]
    -&gt; [(Name, InputValue RemoteSchemaVariable)])
-&gt; [RemoteFieldArgument]
-&gt; HashMap Name (InputValue RemoteSchemaVariable)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(RemoteFieldArgument -&gt; (Name, InputValue RemoteSchemaVariable))
-&gt; [RemoteFieldArgument]
-&gt; [(Name, InputValue RemoteSchemaVariable)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RemoteFieldArgument -&gt; Name
</span><a href="Hasura.RQL.IR.RemoteSchema.html#_rfaArgument"><span class="hs-identifier hs-var hs-var">_rfaArgument</span></a></span><span> </span><span class="annot"><span class="annottext">(RemoteFieldArgument -&gt; Name)
-&gt; (RemoteFieldArgument -&gt; InputValue RemoteSchemaVariable)
-&gt; RemoteFieldArgument
-&gt; (Name, InputValue RemoteSchemaVariable)
forall (a :: * -&gt; * -&gt; *) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">RemoteFieldArgument -&gt; InputValue RemoteSchemaVariable
</span><a href="Hasura.RQL.IR.RemoteSchema.html#_rfaValue"><span class="hs-identifier hs-var hs-var">_rfaValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-604"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621688527531"><span class="annot"><span class="annottext">SelectionSet Void RemoteSchemaVariable
</span><a href="#local-6989586621688527531"><span class="hs-identifier hs-var">transformedSchemaRelationship</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688527530"><span class="annot"><span class="annottext">Maybe RemoteJoins
</span><a href="#local-6989586621688527530"><span class="hs-identifier hs-var">schemaRelationshipJoins</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-605"></span><span>          </span><span class="annot"><span class="annottext">SelectionSet
  (RemoteRelationshipField UnpreparedValue) RemoteSchemaVariable
-&gt; (SelectionSet Void RemoteSchemaVariable, Maybe RemoteJoins)
forall var.
SelectionSet (RemoteRelationshipField UnpreparedValue) var
-&gt; (SelectionSet Void var, Maybe RemoteJoins)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsGraphQLSelectionSet"><span class="hs-identifier hs-var">getRemoteJoinsGraphQLSelectionSet</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionSet
  (RemoteRelationshipField UnpreparedValue) RemoteSchemaVariable
</span><a href="#local-6989586621688527543"><span class="hs-identifier hs-var">_rselSelection</span></a></span><span>
</span><span id="line-606"></span><span>        </span><span id="local-6989586621688527529"><span class="annot"><span class="annottext">remoteJoin :: RemoteSchemaJoin
</span><a href="#local-6989586621688527529"><span class="hs-identifier hs-var hs-var">remoteJoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-607"></span><span>          </span><span class="annot"><span class="annottext">HashMap Name (InputValue RemoteSchemaVariable)
-&gt; ResultCustomizer
-&gt; SelectionSet Void RemoteSchemaVariable
-&gt; HashMap FieldName JoinColumnAlias
-&gt; NonEmpty FieldCall
-&gt; RemoteSchemaInfo
-&gt; RemoteSchemaJoin
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#RemoteSchemaJoin"><span class="hs-identifier hs-var">RemoteSchemaJoin</span></a></span><span>
</span><span id="line-608"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RemoteFieldArgument]
-&gt; HashMap Name (InputValue RemoteSchemaVariable)
</span><a href="#local-6989586621688527535"><span class="hs-identifier hs-var">inputArgsToMap</span></a></span><span> </span><span class="annot"><span class="annottext">[RemoteFieldArgument]
</span><a href="#local-6989586621688527545"><span class="hs-identifier hs-var">_rselArgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span>            </span><span class="annot"><span class="annottext">ResultCustomizer
</span><a href="#local-6989586621688527544"><span class="hs-identifier hs-var">_rselResultCustomizer</span></a></span><span>
</span><span id="line-610"></span><span>            </span><span class="annot"><span class="annottext">SelectionSet Void RemoteSchemaVariable
</span><a href="#local-6989586621688527531"><span class="hs-identifier hs-var">transformedSchemaRelationship</span></a></span><span>
</span><span id="line-611"></span><span>            </span><span class="annot"><span class="annottext">HashMap FieldName JoinColumnAlias
</span><a href="#local-6989586621688527548"><span class="hs-identifier hs-var">joinColumnAliases</span></a></span><span>
</span><span id="line-612"></span><span>            </span><span class="annot"><span class="annottext">NonEmpty FieldCall
</span><a href="#local-6989586621688527542"><span class="hs-identifier hs-var">_rselFieldCall</span></a></span><span>
</span><span id="line-613"></span><span>            </span><span class="annot"><span class="annottext">RemoteSchemaInfo
</span><a href="#local-6989586621688527541"><span class="hs-identifier hs-var">_rselRemoteSchema</span></a></span><span>
</span><span id="line-614"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">RemoteSchemaJoin -&gt; Maybe RemoteJoins -&gt; RemoteJoin
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#RemoteJoinRemoteSchema"><span class="hs-identifier hs-var">RemoteJoinRemoteSchema</span></a></span><span> </span><span class="annot"><span class="annottext">RemoteSchemaJoin
</span><a href="#local-6989586621688527529"><span class="hs-identifier hs-var">remoteJoin</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RemoteJoins
</span><a href="#local-6989586621688527530"><span class="hs-identifier hs-var">schemaRelationshipJoins</span></a></span><span>
</span><span id="line-615"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.Root.html#RemoteSourceField"><span class="hs-identifier hs-type">RemoteSourceField</span></a></span><span> </span><span id="local-6989586621688527525"><span class="annot"><span class="annottext">AnyBackend
  (RemoteSourceSelect
     (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
</span><a href="#local-6989586621688527525"><span class="hs-identifier hs-var">anySourceSelect</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-616"></span><span>    </span><span class="annot"><span class="annottext">AnyBackend
  (RemoteSourceSelect
     (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
-&gt; (forall (b :: BackendType).
    Backend b =&gt;
    RemoteSourceSelect
      (RemoteRelationshipField UnpreparedValue) UnpreparedValue b
    -&gt; RemoteJoin)
-&gt; RemoteJoin
forall (c :: BackendType -&gt; Constraint) (i :: BackendType -&gt; *) r.
AllBackendsSatisfy c =&gt;
AnyBackend i -&gt; (forall (b :: BackendType). c b =&gt; i b -&gt; r) -&gt; r
</span><a href="Hasura.SQL.AnyBackend.html#dispatchAnyBackend"><span class="hs-identifier hs-var">AB.dispatchAnyBackend</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="annot"><span class="annottext">AnyBackend
  (RemoteSourceSelect
     (RemoteRelationshipField UnpreparedValue) UnpreparedValue)
</span><a href="#local-6989586621688527525"><span class="hs-identifier hs-var">anySourceSelect</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#RemoteSourceSelect"><span class="hs-identifier hs-type">RemoteSourceSelect</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688527519"><span id="local-6989586621688527520"><span id="local-6989586621688527521"><span id="local-6989586621688527522"><span class="annot"><span class="annottext">HashMap FieldName (ScalarType b, Column b)
SourceConfig b
SourceName
SourceRelationshipSelection
  b (RemoteRelationshipField UnpreparedValue) UnpreparedValue
_rssJoinMapping :: forall r (vf :: BackendType -&gt; *) (tgt :: BackendType).
RemoteSourceSelect r vf tgt
-&gt; HashMap FieldName (ScalarType tgt, Column tgt)
_rssSelection :: forall r (vf :: BackendType -&gt; *) (tgt :: BackendType).
RemoteSourceSelect r vf tgt -&gt; SourceRelationshipSelection tgt r vf
_rssConfig :: forall r (vf :: BackendType -&gt; *) (tgt :: BackendType).
RemoteSourceSelect r vf tgt -&gt; SourceConfig tgt
_rssName :: forall r (vf :: BackendType -&gt; *) (tgt :: BackendType).
RemoteSourceSelect r vf tgt -&gt; SourceName
_rssJoinMapping :: HashMap FieldName (ScalarType b, Column b)
_rssSelection :: SourceRelationshipSelection
  b (RemoteRelationshipField UnpreparedValue) UnpreparedValue
_rssConfig :: SourceConfig b
_rssName :: SourceName
</span><a href="Hasura.RQL.IR.Select.html#_rssJoinMapping"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-617"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688527514"><span class="annot"><span class="annottext">SourceRelationshipSelection b Void UnpreparedValue
</span><a href="#local-6989586621688527514"><span class="hs-identifier hs-var">transformedSourceRelationship</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688527513"><span class="annot"><span class="annottext">Maybe RemoteJoins
</span><a href="#local-6989586621688527513"><span class="hs-identifier hs-var">sourceRelationshipJoins</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-618"></span><span>            </span><span class="annot"><span class="annottext">SourceRelationshipSelection
  b (RemoteRelationshipField UnpreparedValue) UnpreparedValue
-&gt; (SourceRelationshipSelection b Void UnpreparedValue,
    Maybe RemoteJoins)
forall (b :: BackendType).
Backend b =&gt;
SourceRelationshipSelection
  b (RemoteRelationshipField UnpreparedValue) UnpreparedValue
-&gt; (SourceRelationshipSelection b Void UnpreparedValue,
    Maybe RemoteJoins)
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getRemoteJoinsSourceRelation"><span class="hs-identifier hs-var">getRemoteJoinsSourceRelation</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRelationshipSelection
  b (RemoteRelationshipField UnpreparedValue) UnpreparedValue
</span><a href="#local-6989586621688527520"><span class="hs-identifier hs-var">_rssSelection</span></a></span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span>          </span><span class="hs-comment">-- the invariant here is that the the keys in joinColumnAliases and</span><span>
</span><span id="line-621"></span><span>          </span><span class="hs-comment">-- _rssJoinMapping are the same. We could've opted for a more type</span><span>
</span><span id="line-622"></span><span>          </span><span class="hs-comment">-- safe representation Map k (a, b) instead of (Map k a, Map k b)</span><span>
</span><span id="line-623"></span><span>          </span><span class="hs-comment">-- but that would make the type of lhs join columns creep into</span><span>
</span><span id="line-624"></span><span>          </span><span class="hs-comment">-- RemoteRelationshipField which would make the type a little</span><span>
</span><span id="line-625"></span><span>          </span><span class="hs-comment">-- unweildy</span><span>
</span><span id="line-626"></span><span>          </span><span id="local-6989586621688527512"><span class="annot"><span class="annottext">joinColumns :: HashMap FieldName (JoinColumnAlias, (Column b, ScalarType b))
</span><a href="#local-6989586621688527512"><span class="hs-identifier hs-var hs-var">joinColumns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-627"></span><span>            </span><span class="annot"><span class="annottext">HashMap FieldName (ScalarType b, Column b)
</span><a href="#local-6989586621688527519"><span class="hs-identifier hs-var">_rssJoinMapping</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName (ScalarType b, Column b)
-&gt; (HashMap FieldName (ScalarType b, Column b)
    -&gt; HashMap FieldName (JoinColumnAlias, (Column b, ScalarType b)))
-&gt; HashMap FieldName (JoinColumnAlias, (Column b, ScalarType b))
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">(FieldName
 -&gt; (ScalarType b, Column b)
 -&gt; Maybe (JoinColumnAlias, (Column b, ScalarType b)))
-&gt; HashMap FieldName (ScalarType b, Column b)
-&gt; HashMap FieldName (JoinColumnAlias, (Column b, ScalarType b))
forall k v1 v2.
(k -&gt; v1 -&gt; Maybe v2) -&gt; HashMap k v1 -&gt; HashMap k v2
</span><span class="hs-identifier hs-var">Map.mapMaybeWithKey</span></span><span>
</span><span id="line-628"></span><span>              </span><span class="hs-glyph">\</span><span id="local-6989586621688527510"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527510"><span class="hs-identifier hs-var">joinFieldName</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621688527509"><span class="annot"><span class="annottext">ScalarType b
</span><a href="#local-6989586621688527509"><span class="hs-identifier hs-var">rhsColumnType</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688527508"><span class="annot"><span class="annottext">Column b
</span><a href="#local-6989586621688527508"><span class="hs-identifier hs-var">rhsColumn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-629"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Column b
</span><a href="#local-6989586621688527508"><span class="hs-identifier hs-var">rhsColumn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ScalarType b
</span><a href="#local-6989586621688527509"><span class="hs-identifier hs-var">rhsColumnType</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>                  </span><span class="annot"><span class="annottext">(JoinColumnAlias -&gt; (JoinColumnAlias, (Column b, ScalarType b)))
-&gt; Maybe JoinColumnAlias
-&gt; Maybe (JoinColumnAlias, (Column b, ScalarType b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FieldName
-&gt; HashMap FieldName JoinColumnAlias -&gt; Maybe JoinColumnAlias
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527510"><span class="hs-identifier hs-var">joinFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap FieldName JoinColumnAlias
</span><a href="#local-6989586621688527548"><span class="hs-identifier hs-var">joinColumnAliases</span></a></span><span>
</span><span id="line-631"></span><span>          </span><span id="local-6989586621688527506"><span class="annot"><span class="annottext">anySourceJoin :: AnyBackend RemoteSourceJoin
</span><a href="#local-6989586621688527506"><span class="hs-identifier hs-var hs-var">anySourceJoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-632"></span><span>            </span><span class="annot"><span class="annottext">RemoteSourceJoin b -&gt; AnyBackend RemoteSourceJoin
forall (b :: BackendType) (i :: BackendType -&gt; *).
HasTag b =&gt;
i b -&gt; AnyBackend i
</span><a href="Hasura.SQL.AnyBackend.html#mkAnyBackend"><span class="hs-identifier hs-var">AB.mkAnyBackend</span></a></span><span> </span><span class="annot"><span class="annottext">(RemoteSourceJoin b -&gt; AnyBackend RemoteSourceJoin)
-&gt; RemoteSourceJoin b -&gt; AnyBackend RemoteSourceJoin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-633"></span><span>              </span><span class="annot"><span class="annottext">SourceName
-&gt; SourceConfig b
-&gt; SourceRelationshipSelection b Void UnpreparedValue
-&gt; HashMap FieldName (JoinColumnAlias, (Column b, ScalarType b))
-&gt; RemoteSourceJoin b
forall (b :: BackendType).
SourceName
-&gt; SourceConfig b
-&gt; SourceRelationshipSelection b Void UnpreparedValue
-&gt; HashMap FieldName (JoinColumnAlias, (Column b, ScalarType b))
-&gt; RemoteSourceJoin b
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#RemoteSourceJoin"><span class="hs-identifier hs-var">RemoteSourceJoin</span></a></span><span>
</span><span id="line-634"></span><span>                </span><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621688527522"><span class="hs-identifier hs-var">_rssName</span></a></span><span>
</span><span id="line-635"></span><span>                </span><span class="annot"><span class="annottext">SourceConfig b
</span><a href="#local-6989586621688527521"><span class="hs-identifier hs-var">_rssConfig</span></a></span><span>
</span><span id="line-636"></span><span>                </span><span class="annot"><span class="annottext">SourceRelationshipSelection b Void UnpreparedValue
</span><a href="#local-6989586621688527514"><span class="hs-identifier hs-var">transformedSourceRelationship</span></a></span><span>
</span><span id="line-637"></span><span>                </span><span class="annot"><span class="annottext">HashMap FieldName (JoinColumnAlias, (Column b, ScalarType b))
</span><a href="#local-6989586621688527512"><span class="hs-identifier hs-var">joinColumns</span></a></span><span>
</span><span id="line-638"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">AnyBackend RemoteSourceJoin -&gt; Maybe RemoteJoins -&gt; RemoteJoin
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#RemoteJoinSource"><span class="hs-identifier hs-var">RemoteJoinSource</span></a></span><span> </span><span class="annot"><span class="annottext">AnyBackend RemoteSourceJoin
</span><a href="#local-6989586621688527506"><span class="hs-identifier hs-var">anySourceJoin</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RemoteJoins
</span><a href="#local-6989586621688527513"><span class="hs-identifier hs-var">sourceRelationshipJoins</span></a></span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span class="hs-comment">-- | Constructs a 'JoinColumnAlias' for a given field in a selection set.</span><span>
</span><span id="line-641"></span><span class="hs-comment">--</span><span>
</span><span id="line-642"></span><span class="hs-comment">-- If the field was already requested, we leave it unchanged, to avoid</span><span>
</span><span id="line-643"></span><span class="hs-comment">-- double-fetching the same information. However, if this field is a &quot;phantom&quot;</span><span>
</span><span id="line-644"></span><span class="hs-comment">-- field, that we only add for the purpose of fetching a join key, we rename it</span><span>
</span><span id="line-645"></span><span class="hs-comment">-- in a way that is guaranteed to avoid conflicts.</span><span>
</span><span id="line-646"></span><span class="hs-comment">--</span><span>
</span><span id="line-647"></span><span class="hs-comment">-- NOTE: if the @fieldName@ argument is a valid GraphQL name, then the</span><span>
</span><span id="line-648"></span><span class="hs-comment">-- constructed alias MUST also be a valid GraphQL name.</span><span>
</span><span id="line-649"></span><span id="local-6989586621688528050"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getJoinColumnAlias"><span class="hs-identifier hs-type">getJoinColumnAlias</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-650"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621688528050"><span class="hs-identifier hs-type">field</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621688528050"><span class="hs-identifier hs-type">field</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-651"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-652"></span><span>  </span><span class="annot"><a href="#local-6989586621688528050"><span class="hs-identifier hs-type">field</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-653"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">HashMap</span></span><span> </span><span class="annot"><a href="#local-6989586621688528050"><span class="hs-identifier hs-type">field</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-654"></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-655"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#JoinColumnAlias"><span class="hs-identifier hs-type">JoinColumnAlias</span></a></span></span><span>
</span><span id="line-656"></span><span id="getJoinColumnAlias"><span class="annot"><span class="annottext">getJoinColumnAlias :: FieldName
-&gt; field
-&gt; HashMap field FieldName
-&gt; [FieldName]
-&gt; JoinColumnAlias
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getJoinColumnAlias"><span class="hs-identifier hs-var hs-var">getJoinColumnAlias</span></a></span></span><span> </span><span id="local-6989586621688527502"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527502"><span class="hs-identifier hs-var">fieldName</span></a></span></span><span> </span><span id="local-6989586621688527501"><span class="annot"><span class="annottext">field
</span><a href="#local-6989586621688527501"><span class="hs-identifier hs-var">field</span></a></span></span><span> </span><span id="local-6989586621688527500"><span class="annot"><span class="annottext">HashMap field FieldName
</span><a href="#local-6989586621688527500"><span class="hs-identifier hs-var">selectedFields</span></a></span></span><span> </span><span id="local-6989586621688527499"><span class="annot"><span class="annottext">[FieldName]
</span><a href="#local-6989586621688527499"><span class="hs-identifier hs-var">allAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-657"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">field -&gt; HashMap field FieldName -&gt; Maybe FieldName
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">field
</span><a href="#local-6989586621688527501"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap field FieldName
</span><a href="#local-6989586621688527500"><span class="hs-identifier hs-var">selectedFields</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-658"></span><span>    </span><span class="annot"><span class="annottext">Maybe FieldName
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; JoinColumnAlias
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#JCPhantom"><span class="hs-identifier hs-var">JCPhantom</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527498"><span class="hs-identifier hs-var">uniqueAlias</span></a></span><span>
</span><span id="line-659"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621688527497"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527497"><span class="hs-identifier hs-var">fieldAlias</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; JoinColumnAlias
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Types.html#JCSelected"><span class="hs-identifier hs-var">JCSelected</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527497"><span class="hs-identifier hs-var">fieldAlias</span></a></span><span>
</span><span id="line-660"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-661"></span><span>    </span><span class="hs-comment">-- This generates an alias for a phantom field that does not conflict with</span><span>
</span><span id="line-662"></span><span>    </span><span class="hs-comment">-- any of the existing aliases in the selection set</span><span>
</span><span id="line-663"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-664"></span><span>    </span><span class="hs-comment">-- If we generate a unique name for each field name which is longer than</span><span>
</span><span id="line-665"></span><span>    </span><span class="hs-comment">-- the longest alias in the selection set, the generated name would be</span><span>
</span><span id="line-666"></span><span>    </span><span class="hs-comment">-- unique.</span><span>
</span><span id="line-667"></span><span>    </span><span class="annot"><a href="#local-6989586621688527498"><span class="hs-identifier hs-type">uniqueAlias</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-type">FieldName</span></a></span><span>
</span><span id="line-668"></span><span>    </span><span id="local-6989586621688527498"><span class="annot"><span class="annottext">uniqueAlias :: FieldName
</span><a href="#local-6989586621688527498"><span class="hs-identifier hs-var hs-var">uniqueAlias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-669"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688527496"><span class="annot"><span class="annottext">suffix :: Text
</span><a href="#local-6989586621688527496"><span class="hs-identifier hs-var hs-var">suffix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-670"></span><span>            </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;_join_column&quot;</span></span><span>
</span><span id="line-671"></span><span>              </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span>
</span><span id="line-672"></span><span>              </span><span class="hs-comment">-- 12 is the length of &quot;_join_column&quot;</span><span>
</span><span id="line-673"></span><span>              </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.replicate</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621688527494"><span class="hs-identifier hs-var">longestAliasLength</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName -&gt; Text
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527502"><span class="hs-identifier hs-var">fieldName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;_&quot;</span></span><span>
</span><span id="line-674"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621688527502"><span class="hs-identifier hs-var">fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; FieldName -&gt; FieldName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FieldName
</span><a href="Hasura.RQL.Types.Common.html#FieldName"><span class="hs-identifier hs-var">FieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621688527496"><span class="hs-identifier hs-var">suffix</span></a></span><span>
</span><span id="line-675"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-676"></span><span>        </span><span id="local-6989586621688527494"><span class="annot"><span class="annottext">longestAliasLength :: Int
</span><a href="#local-6989586621688527494"><span class="hs-identifier hs-var hs-var">longestAliasLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; [Int] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(FieldName -&gt; Int) -&gt; [FieldName] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Int) -&gt; (FieldName -&gt; Text) -&gt; FieldName -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">FieldName -&gt; Text
</span><span class="hs-identifier hs-var">coerce</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FieldName]
</span><a href="#local-6989586621688527499"><span class="hs-identifier hs-var">allAliases</span></a></span><span>
</span><span id="line-677"></span><span>
</span><span id="line-678"></span><span class="hs-comment">-- | Get the fields targeted by some 'Traversal' for an arbitrary list of</span><span>
</span><span id="line-679"></span><span class="hs-comment">-- tuples, discarding any elements whose fields cannot be focused upon.</span><span>
</span><span id="line-680"></span><span id="local-6989586621688528054"><span id="local-6989586621688528055"><span id="local-6989586621688528056"><span class="annot"><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getFields"><span class="hs-identifier hs-type">getFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversal'</span></span><span> </span><span class="annot"><a href="#local-6989586621688528056"><span class="hs-identifier hs-type">super</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688528055"><span class="hs-identifier hs-type">sub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621688528054"><span class="hs-identifier hs-type">any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621688528056"><span class="hs-identifier hs-type">super</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621688528054"><span class="hs-identifier hs-type">any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621688528055"><span class="hs-identifier hs-type">sub</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-681"></span><span id="getFields"><span class="annot"><span class="annottext">getFields :: Traversal' super sub -&gt; [(any, super)] -&gt; [(any, sub)]
</span><a href="Hasura.GraphQL.Execute.RemoteJoin.Collect.html#getFields"><span class="hs-identifier hs-var hs-var">getFields</span></a></span></span><span> </span><span id="local-6989586621688527490"><span class="annot"><span class="annottext">Traversal' super sub
</span><a href="#local-6989586621688527490"><span class="hs-identifier hs-var">focus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((any, super) -&gt; Maybe (any, sub))
-&gt; [(any, super)] -&gt; [(any, sub)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(super -&gt; Maybe sub) -&gt; (any, super) -&gt; Maybe (any, sub)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">((super -&gt; Maybe sub) -&gt; (any, super) -&gt; Maybe (any, sub))
-&gt; (super -&gt; Maybe sub) -&gt; (any, super) -&gt; Maybe (any, sub)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Getting (First sub) super sub -&gt; super -&gt; Maybe sub
forall s (m :: * -&gt; *) a.
MonadReader s m =&gt;
Getting (First a) s a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">preview</span></span><span> </span><span class="annot"><span class="annottext">Getting (First sub) super sub
Traversal' super sub
</span><a href="#local-6989586621688527490"><span class="hs-identifier hs-var">focus</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-682"></span></pre></body></html>