!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("ra-data-hasura",[],r):"object"==typeof exports?exports["ra-data-hasura"]=r():e["ra-data-hasura"]=r()}("undefined"!=typeof self?self:this,function(){return function(e){var r={};function t(a){if(r[a])return r[a].exports;var n=r[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}return t.m=e,t.c=r,t.d=function(e,r,a){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:a})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var n in e)t.d(a,n,function(r){return e[r]}.bind(null,n));return a},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=0)}([function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=t(1);var n=function(e){return JSON.parse(JSON.stringify(e))};r.default=function(e,r){var t=function(e,r,t){var u,s,i,o={},d={};switch(e){case"GET_LIST":var c=n(a.selectQuery),l=n(a.countQuery);c.args.table=r,c.args.limit=t.pagination.perPage,c.args.offset=t.pagination.page*t.pagination.perPage-t.pagination.perPage,c.args.where=t.filter,c.args.order_by={column:t.sort.field,type:t.sort.order.toLowerCase()},l.args.table=r,(d=n(a.bulkQuery)).args.push(c),d.args.push(l);break;case"GET_ONE":(d=n(a.selectQuery)).args.table=r,d.args.where={id:{$eq:t.id}};break;case"CREATE":var g=Object.keys(t.data);(d=n(a.insertQuery)).args.table=r,d.args.objects.push(t.data),g.push("id"),d.args.returning=g;break;case"UPDATE":var p=Object.keys(t.data);(d=n(a.updateQuery)).args.table=r,d.args.$set=t.data,d.args.where={id:{$eq:t.id}},p.push("id"),d.args.returning=p;break;case"UPDATE_MANY":var f=Object.keys(t.data);(d=n(a.updateQuery)).args.table=r,d.args.$set=t.data,d.args.where={id:{$in:t.ids}},f.push("id"),d.args.returning=f;break;case"DELETE":var y=Object.keys(t.previousData);(d=n(a.deleteQuery)).args.table=r,d.args.where={id:{$eq:t.id}},y.push("id"),d.args.returning=y;break;case"DELETE_MANY":(d=n(a.deleteQuery)).args.table=r,d.args.where={id:{$in:t.ids}},d.args.returning=["id"];break;case"GET_MANY":(d=n(a.selectQuery)).args.table=r,d.args.where={id:{$in:t.ids}};break;case"GET_MANY_REFERENCE":var b=n(a.selectQuery),E=n(a.countQuery);c.args.table=r,c.args.limit=t.pagination.perPage,c.args.offset=t.pagination.page*t.pagination.perPage-t.pagination.perPage,c.args.where=(u={},s=t.target,i=t.id,s in u?Object.defineProperty(u,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):u[s]=i,u),c.args.order_by={column:t.sort.field,type:t.sort.order.toLowerCase()},l.args.table=r,(d=n(a.bulkQuery)).args.push(b),d.args.push(E);break;default:throw new Error("Unsupported type ".concat(e))}return o.body=JSON.stringify(d),{options:o}};return function(a,n,u){var s=t(a,n,u).options;return s.method="POST",s.headers=r,fetch(e+"/v1/query",s).then(function(e){return e.json().then(function(e){return function(e,r,t,a){if("error"in e||"code"in e)throw new Error(JSON.stringify(e));switch(r){case"GET_LIST":return{data:e[0],total:e[1].count};case"GET_ONE":return{data:e[0]};case"CREATE":case"UPDATE":return{data:e.returning[0]};case"UPDATE_MANY":return{data:e.returning.map(function(e){return e.id})};case"DELETE":return{data:e.returning[0]};case"DELETE_MANY":return{data:e.returning.map(function(e){return e.id})};case"GET_MANY":return{data:e};case"GET_MANY_REFERENCE":return{data:e[0],total:e[1].count};default:return{data:e}}}(e,a)})})}},e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.deleteQuery=r.updateQuery=r.insertQuery=r.countQuery=r.selectQuery=r.bulkQuery=void 0;r.bulkQuery={type:"bulk",args:[]};r.selectQuery={type:"select",args:{table:"",columns:["*"]}};r.countQuery={type:"count",args:{table:"",where:{id:{$gt:0}}}};r.insertQuery={type:"insert",args:{table:"",objects:[],returning:[]}};r.updateQuery={type:"update",args:{table:"",$set:{},where:{},returning:[]}};r.deleteQuery={type:"delete",args:{table:"",where:{},returning:[]}}}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yYS1kYXRhLWhhc3VyYS93ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCJ3ZWJwYWNrOi8vcmEtZGF0YS1oYXN1cmEvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vcmEtZGF0YS1oYXN1cmEvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcmEtZGF0YS1oYXN1cmEvLi9zcmMvcXVlcmllcy5qcyJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJzZWxmIiwidGhpcyIsImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJfcXVlcmllcyIsImNsb25lUXVlcnkiLCJxdWVyeSIsIkpTT04iLCJwYXJzZSIsInN0cmluZ2lmeSIsInNlcnZlckVuZHBvaW50IiwiaGVhZGVycyIsImNvbnZlcnREYXRhUmVxdWVzdFRvSFRUUCIsInR5cGUiLCJyZXNvdXJjZSIsInBhcmFtcyIsIm9wdGlvbnMiLCJmaW5hbFF1ZXJ5IiwiZmluYWxTZWxlY3RRdWVyeSIsInNlbGVjdFF1ZXJ5IiwiZmluYWxDb3VudFF1ZXJ5IiwiY291bnRRdWVyeSIsImFyZ3MiLCJ0YWJsZSIsImxpbWl0IiwicGFnaW5hdGlvbiIsInBlclBhZ2UiLCJvZmZzZXQiLCJwYWdlIiwid2hlcmUiLCJmaWx0ZXIiLCJvcmRlcl9ieSIsImNvbHVtbiIsInNvcnQiLCJmaWVsZCIsIm9yZGVyIiwidG9Mb3dlckNhc2UiLCJidWxrUXVlcnkiLCJwdXNoIiwiaWQiLCIkZXEiLCJjcmVhdGVGaWVsZHMiLCJrZXlzIiwiZGF0YSIsImluc2VydFF1ZXJ5Iiwib2JqZWN0cyIsInJldHVybmluZyIsInVwZGF0ZUZpZWxkcyIsInVwZGF0ZVF1ZXJ5IiwidXBkYXRlTWFueUZpZWxkcyIsIiRpbiIsImlkcyIsImRlbGV0ZUZpZWxkcyIsInByZXZpb3VzRGF0YSIsImRlbGV0ZVF1ZXJ5IiwiZmluYWxNYW55UXVlcnkiLCJmaW5hbE1hbnlDb3VudFF1ZXJ5IiwidGFyZ2V0IiwiRXJyb3IiLCJjb25jYXQiLCJib2R5IiwibWV0aG9kIiwiZmV0Y2giLCJ0aGVuIiwicmVzcG9uc2UiLCJqc29uIiwidG90YWwiLCJtYXAiLCJpdGVtIiwiY291bnQiLCJjb252ZXJ0SFRUUFJlc3BvbnNlIiwiY29sdW1ucyIsIiRndCIsIiRzZXQiXSwibWFwcGluZ3MiOiJDQUFBLFNBQUFBLEVBQUFDLEdBQ0EsaUJBQUFDLFNBQUEsaUJBQUFDLE9BQ0FBLE9BQUFELFFBQUFELElBQ0EsbUJBQUFHLGVBQUFDLElBQ0FELE9BQUEsb0JBQUFILEdBQ0EsaUJBQUFDLFFBQ0FBLFFBQUEsa0JBQUFELElBRUFELEVBQUEsa0JBQUFDLElBUkEsQ0FTQyxvQkFBQUssVUFBQUMsS0FBQSxXQUNELG1CQ1RBLElBQUFDLEVBQUEsR0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQVIsUUFHQSxJQUFBQyxFQUFBSyxFQUFBRSxHQUFBLENBQ0FDLEVBQUFELEVBQ0FFLEdBQUEsRUFDQVYsUUFBQSxJQVVBLE9BTkFXLEVBQUFILEdBQUFJLEtBQUFYLEVBQUFELFFBQUFDLElBQUFELFFBQUFPLEdBR0FOLEVBQUFTLEdBQUEsRUFHQVQsRUFBQUQsUUEwREEsT0FyREFPLEVBQUFNLEVBQUFGLEVBR0FKLEVBQUFPLEVBQUFSLEVBR0FDLEVBQUFRLEVBQUEsU0FBQWYsRUFBQWdCLEVBQUFDLEdBQ0FWLEVBQUFXLEVBQUFsQixFQUFBZ0IsSUFDQUcsT0FBQUMsZUFBQXBCLEVBQUFnQixFQUFBLENBQTBDSyxZQUFBLEVBQUFDLElBQUFMLEtBSzFDVixFQUFBZ0IsRUFBQSxTQUFBdkIsR0FDQSxvQkFBQXdCLGVBQUFDLGFBQ0FOLE9BQUFDLGVBQUFwQixFQUFBd0IsT0FBQUMsWUFBQSxDQUF3REMsTUFBQSxXQUV4RFAsT0FBQUMsZUFBQXBCLEVBQUEsY0FBaUQwQixPQUFBLEtBUWpEbkIsRUFBQW9CLEVBQUEsU0FBQUQsRUFBQUUsR0FFQSxHQURBLEVBQUFBLElBQUFGLEVBQUFuQixFQUFBbUIsSUFDQSxFQUFBRSxFQUFBLE9BQUFGLEVBQ0EsS0FBQUUsR0FBQSxpQkFBQUYsUUFBQUcsV0FBQSxPQUFBSCxFQUNBLElBQUFJLEVBQUFYLE9BQUFZLE9BQUEsTUFHQSxHQUZBeEIsRUFBQWdCLEVBQUFPLEdBQ0FYLE9BQUFDLGVBQUFVLEVBQUEsV0FBeUNULFlBQUEsRUFBQUssVUFDekMsRUFBQUUsR0FBQSxpQkFBQUYsRUFBQSxRQUFBTSxLQUFBTixFQUFBbkIsRUFBQVEsRUFBQWUsRUFBQUUsRUFBQSxTQUFBQSxHQUFnSCxPQUFBTixFQUFBTSxJQUFxQkMsS0FBQSxLQUFBRCxJQUNySSxPQUFBRixHQUlBdkIsRUFBQTJCLEVBQUEsU0FBQWpDLEdBQ0EsSUFBQWdCLEVBQUFoQixLQUFBNEIsV0FDQSxXQUEyQixPQUFBNUIsRUFBQSxTQUMzQixXQUFpQyxPQUFBQSxHQUVqQyxPQURBTSxFQUFBUSxFQUFBRSxFQUFBLElBQUFBLEdBQ0FBLEdBSUFWLEVBQUFXLEVBQUEsU0FBQWlCLEVBQUFDLEdBQXNELE9BQUFqQixPQUFBa0IsVUFBQUMsZUFBQTFCLEtBQUF1QixFQUFBQyxJQUd0RDdCLEVBQUFnQyxFQUFBLEdBSUFoQyxJQUFBaUMsRUFBQSxvR0NsRkEsSUFBQUMsRUFBQWxDLEVBQUEsR0FTQSxJQUFNbUMsRUFBYSxTQUFDQyxHQUNsQixPQUFPQyxLQUFLQyxNQUFNRCxLQUFLRSxVQUFVSCxlQUdwQixTQUFDSSxFQUFnQkMsR0FDOUIsSUFBTUMsRUFBMkIsU0FBQ0MsRUFBTUMsRUFBVUMsR0FDaEQsVUFBTUMsRUFBVSxHQUNaQyxFQUFhLEdBRWpCLE9BQVFKLEdBQ04sSUFBSyxXQUVILElBQU1LLEVBQW1CYixFQUFVRCxFQUFBZSxhQUM3QkMsRUFBa0JmLEVBQVVELEVBQUFpQixZQUVsQ0gsRUFBaUJJLEtBQUtDLE1BQVFULEVBQzlCSSxFQUFpQkksS0FBS0UsTUFBUVQsRUFBT1UsV0FBV0MsUUFDaERSLEVBQWlCSSxLQUFLSyxPQUFVWixFQUFPVSxXQUFXRyxLQUFPYixFQUFPVSxXQUFXQyxRQUFXWCxFQUFPVSxXQUFXQyxRQUN4R1IsRUFBaUJJLEtBQUtPLE1BQVFkLEVBQU9lLE9BQ3JDWixFQUFpQkksS0FBS1MsU0FBVyxDQUFDQyxPQUFRakIsRUFBT2tCLEtBQUtDLE1BQU9yQixLQUFNRSxFQUFPa0IsS0FBS0UsTUFBTUMsZUFDckZoQixFQUFnQkUsS0FBS0MsTUFBUVQsR0FDN0JHLEVBQWFaLEVBQVVELEVBQUFpQyxZQUNaZixLQUFLZ0IsS0FBS3BCLEdBQ3JCRCxFQUFXSyxLQUFLZ0IsS0FBS2xCLEdBQ3JCLE1BQ0YsSUFBSyxXQUVISCxFQUFhWixFQUFVRCxFQUFBZSxjQUNaRyxLQUFLQyxNQUFRVCxFQUN4QkcsRUFBV0ssS0FBS08sTUFBUSxDQUFFVSxHQUFJLENBQUVDLElBQU96QixFQUFPd0IsS0FDOUMsTUFDRixJQUFLLFNBRUgsSUFBTUUsRUFBZTNELE9BQU80RCxLQUFLM0IsRUFBTzRCLE9BRXhDMUIsRUFBYVosRUFBVUQsRUFBQXdDLGNBQ1p0QixLQUFLQyxNQUFRVCxFQUN4QkcsRUFBV0ssS0FBS3VCLFFBQVFQLEtBQUt2QixFQUFPNEIsTUFFcENGLEVBQWFILEtBQUssTUFDbEJyQixFQUFXSyxLQUFLd0IsVUFBWUwsRUFDNUIsTUFDRixJQUFLLFNBRUgsSUFBTU0sRUFBZWpFLE9BQU80RCxLQUFLM0IsRUFBTzRCLE9BRXhDMUIsRUFBYVosRUFBVUQsRUFBQTRDLGNBQ1oxQixLQUFLQyxNQUFRVCxFQUN4QkcsRUFBV0ssS0FBWCxLQUEwQlAsRUFBTzRCLEtBQ2pDMUIsRUFBV0ssS0FBS08sTUFBUSxDQUFFVSxHQUFJLENBQUVDLElBQU96QixFQUFPd0IsS0FFOUNRLEVBQWFULEtBQUssTUFDbEJyQixFQUFXSyxLQUFLd0IsVUFBWUMsRUFDNUIsTUFDRixJQUFLLGNBRUgsSUFBTUUsRUFBbUJuRSxPQUFPNEQsS0FBSzNCLEVBQU80QixPQUU1QzFCLEVBQWFaLEVBQVVELEVBQUE0QyxjQUNaMUIsS0FBS0MsTUFBUVQsRUFDeEJHLEVBQVdLLEtBQVgsS0FBMEJQLEVBQU80QixLQUNqQzFCLEVBQVdLLEtBQUtPLE1BQVEsQ0FBRVUsR0FBTSxDQUFFVyxJQUFPbkMsRUFBT29DLE1BRWhERixFQUFpQlgsS0FBSyxNQUN0QnJCLEVBQVdLLEtBQUt3QixVQUFZRyxFQUM1QixNQUNGLElBQUssU0FFSCxJQUFNRyxFQUFldEUsT0FBTzRELEtBQUszQixFQUFPc0MsZUFFeENwQyxFQUFhWixFQUFVRCxFQUFBa0QsY0FDWmhDLEtBQUtDLE1BQVFULEVBQ3hCRyxFQUFXSyxLQUFLTyxNQUFRLENBQUVVLEdBQUksQ0FBRUMsSUFBT3pCLEVBQU93QixLQUU5Q2EsRUFBYWQsS0FBSyxNQUNsQnJCLEVBQVdLLEtBQUt3QixVQUFZTSxFQUM1QixNQUNGLElBQUssZUFFSG5DLEVBQWFaLEVBQVVELEVBQUFrRCxjQUNaaEMsS0FBS0MsTUFBUVQsRUFDeEJHLEVBQVdLLEtBQUtPLE1BQVEsQ0FBRVUsR0FBTSxDQUFFVyxJQUFPbkMsRUFBT29DLE1BRWhEbEMsRUFBV0ssS0FBS3dCLFVBQVksQ0FBQyxNQUM3QixNQUNGLElBQUssWUFFSDdCLEVBQWFaLEVBQVVELEVBQUFlLGNBQ1pHLEtBQUtDLE1BQVFULEVBQ3hCRyxFQUFXSyxLQUFLTyxNQUFRLENBQUVVLEdBQU0sQ0FBRVcsSUFBT25DLEVBQU9vQyxNQUNoRCxNQUNGLElBQUsscUJBRUgsSUFBTUksRUFBaUJsRCxFQUFVRCxFQUFBZSxhQUMzQnFDLEVBQXNCbkQsRUFBVUQsRUFBQWlCLFlBRXRDSCxFQUFpQkksS0FBS0MsTUFBUVQsRUFDOUJJLEVBQWlCSSxLQUFLRSxNQUFRVCxFQUFPVSxXQUFXQyxRQUNoRFIsRUFBaUJJLEtBQUtLLE9BQVVaLEVBQU9VLFdBQVdHLEtBQU9iLEVBQU9VLFdBQVdDLFFBQVdYLEVBQU9VLFdBQVdDLFFBQ3hHUixFQUFpQkksS0FBS08sU0FBdEIsS0FBaUNkLEVBQU8wQyxTQUFTMUMsRUFBT3dCLG1HQUN4RHJCLEVBQWlCSSxLQUFLUyxTQUFXLENBQUNDLE9BQVFqQixFQUFPa0IsS0FBS0MsTUFBT3JCLEtBQU1FLEVBQU9rQixLQUFLRSxNQUFNQyxlQUNyRmhCLEVBQWdCRSxLQUFLQyxNQUFRVCxHQUM3QkcsRUFBYVosRUFBVUQsRUFBQWlDLFlBQ1pmLEtBQUtnQixLQUFLaUIsR0FDckJ0QyxFQUFXSyxLQUFLZ0IsS0FBS2tCLEdBQ3JCLE1BQ0YsUUFDRSxNQUFNLElBQUlFLE1BQUosb0JBQUFDLE9BQThCOUMsSUFHeEMsT0FEQUcsRUFBUTRDLEtBQU9yRCxLQUFLRSxVQUFVUSxHQUN2QixDQUFFRCxZQTREWCxPQUFPLFNBQUNILEVBQU1DLEVBQVVDLEdBQVcsSUFDekJDLEVBQVlKLEVBQ2xCQyxFQUNBQyxFQUNBQyxHQUhNQyxRQVFSLE9BRkFBLEVBQVE2QyxPQUFTLE9BQ2pCN0MsRUFBUUwsUUFBVUEsRUFDWG1ELE1BQU1wRCxFQUFpQixZQUFhTSxHQUFTK0MsS0FBSyxTQUFVQyxHQUNqRSxPQUFPQSxFQUFTQyxPQUFPRixLQUFLLFNBQUNwQixHQUMzQixPQXBFc0IsU0FBQ3FCLEVBQVVuRCxFQUFNQyxFQUFVQyxHQUVyRCxHQUFJLFVBQVdpRCxHQUFZLFNBQVVBLEVBQ25DLE1BQU0sSUFBSU4sTUFBTW5ELEtBQUtFLFVBQVV1RCxJQUVqQyxPQUFRbkQsR0FDTixJQUFLLFdBQ0gsTUFBTyxDQUNMOEIsS0FBTXFCLEVBQVMsR0FDZkUsTUFBT0YsRUFBUyxHQUFULE9BRVgsSUFBSyxVQUNILE1BQU8sQ0FDTHJCLEtBQU1xQixFQUFTLElBRW5CLElBQUssU0FJTCxJQUFLLFNBQ0gsTUFBTyxDQUNMckIsS0FBTXFCLEVBQVNsQixVQUFVLElBRTdCLElBQUssY0FLSCxNQUFPLENBQ0xILEtBTGlCcUIsRUFBU2xCLFVBQVVxQixJQUFJLFNBQUNDLEdBQ3pDLE9BQU9BLEVBQUs3QixNQU1oQixJQUFLLFNBQ0gsTUFBTyxDQUNMSSxLQUFNcUIsRUFBU2xCLFVBQVUsSUFFN0IsSUFBSyxjQUtILE1BQU8sQ0FDTEgsS0FMaUJxQixFQUFTbEIsVUFBVXFCLElBQUksU0FBQ0MsR0FDekMsT0FBT0EsRUFBSzdCLE1BTWhCLElBQUssV0FDSCxNQUFPLENBQ0xJLEtBQU1xQixHQUVWLElBQUsscUJBQ0gsTUFBTyxDQUNMckIsS0FBTXFCLEVBQVMsR0FDZkUsTUFBT0YsRUFBUyxHQUFHSyxPQUV2QixRQUNFLE1BQU8sQ0FBRTFCLEtBQU1xQixJQWVSTSxDQUFvQjNCLEVBQU05QixnTkM3THZCLENBQ2hCQSxLQUFNLE9BQ05TLEtBQU0sa0JBR1ksQ0FDbEJULEtBQU0sU0FDTlMsS0FBTSxDQUNKQyxNQUFPLEdBQ1BnRCxRQUFTLENBQUMsb0JBSUssQ0FDakIxRCxLQUFNLFFBQ05TLEtBQU0sQ0FDSkMsTUFBTyxHQUNQTSxNQUFPLENBQUVVLEdBQUksQ0FBRWlDLElBQU8sb0JBSU4sQ0FDbEIzRCxLQUFNLFNBQ05TLEtBQU0sQ0FDSkMsTUFBTyxHQUNQc0IsUUFBUyxHQUNUQyxVQUFXLG1CQUlLLENBQ2xCakMsS0FBTSxTQUNOUyxLQUFNLENBQ0pDLE1BQU8sR0FDUGtELEtBQU0sR0FDTjVDLE1BQU8sR0FDUGlCLFVBQVcsbUJBSUssQ0FDbEJqQyxLQUFNLFNBQ05TLEtBQU0sQ0FDSkMsTUFBTyxHQUNQTSxNQUFPLEdBQ1BpQixVQUFXIiwiZmlsZSI6InJhLWRhdGEtaGFzdXJhLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFwicmEtZGF0YS1oYXN1cmFcIiwgW10sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wicmEtZGF0YS1oYXN1cmFcIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wicmEtZGF0YS1oYXN1cmFcIl0gPSBmYWN0b3J5KCk7XG59KSh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDogdGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuIiwiaW1wb3J0IHtcbiAgYnVsa1F1ZXJ5LFxuICBzZWxlY3RRdWVyeSxcbiAgY291bnRRdWVyeSxcbiAgaW5zZXJ0UXVlcnksXG4gIHVwZGF0ZVF1ZXJ5LFxuICBkZWxldGVRdWVyeVxufSBmcm9tICcuL3F1ZXJpZXMnO1xuXG5jb25zdCBjbG9uZVF1ZXJ5ID0gKHF1ZXJ5KSA9PiB7XG4gIHJldHVybiBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHF1ZXJ5KSk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCAoc2VydmVyRW5kcG9pbnQsIGhlYWRlcnMpID0+IHtcbiAgY29uc3QgY29udmVydERhdGFSZXF1ZXN0VG9IVFRQID0gKHR5cGUsIHJlc291cmNlLCBwYXJhbXMpID0+IHtcbiAgICBjb25zdCBvcHRpb25zID0ge307XG4gICAgbGV0IGZpbmFsUXVlcnkgPSB7fTtcblxuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgY2FzZSAnR0VUX0xJU1QnOlxuICAgICAgICAvLyBzZWxlY3QgbXVsdGlwbGVcbiAgICAgICAgY29uc3QgZmluYWxTZWxlY3RRdWVyeSA9IGNsb25lUXVlcnkoc2VsZWN0UXVlcnkpO1xuICAgICAgICBjb25zdCBmaW5hbENvdW50UXVlcnkgPSBjbG9uZVF1ZXJ5KGNvdW50UXVlcnkpO1xuXG4gICAgICAgIGZpbmFsU2VsZWN0UXVlcnkuYXJncy50YWJsZSA9IHJlc291cmNlO1xuICAgICAgICBmaW5hbFNlbGVjdFF1ZXJ5LmFyZ3MubGltaXQgPSBwYXJhbXMucGFnaW5hdGlvbi5wZXJQYWdlO1xuICAgICAgICBmaW5hbFNlbGVjdFF1ZXJ5LmFyZ3Mub2Zmc2V0ID0gKHBhcmFtcy5wYWdpbmF0aW9uLnBhZ2UgKiBwYXJhbXMucGFnaW5hdGlvbi5wZXJQYWdlKSAtIHBhcmFtcy5wYWdpbmF0aW9uLnBlclBhZ2U7XG4gICAgICAgIGZpbmFsU2VsZWN0UXVlcnkuYXJncy53aGVyZSA9IHBhcmFtcy5maWx0ZXI7XG4gICAgICAgIGZpbmFsU2VsZWN0UXVlcnkuYXJncy5vcmRlcl9ieSA9IHtjb2x1bW46IHBhcmFtcy5zb3J0LmZpZWxkLCB0eXBlOiBwYXJhbXMuc29ydC5vcmRlci50b0xvd2VyQ2FzZSgpfTtcbiAgICAgICAgZmluYWxDb3VudFF1ZXJ5LmFyZ3MudGFibGUgPSByZXNvdXJjZTtcbiAgICAgICAgZmluYWxRdWVyeSA9IGNsb25lUXVlcnkoYnVsa1F1ZXJ5KTtcbiAgICAgICAgZmluYWxRdWVyeS5hcmdzLnB1c2goZmluYWxTZWxlY3RRdWVyeSk7XG4gICAgICAgIGZpbmFsUXVlcnkuYXJncy5wdXNoKGZpbmFsQ291bnRRdWVyeSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnR0VUX09ORSc6XG4gICAgICAgIC8vIHNlbGVjdCBvbmVcbiAgICAgICAgZmluYWxRdWVyeSA9IGNsb25lUXVlcnkoc2VsZWN0UXVlcnkpO1xuICAgICAgICBmaW5hbFF1ZXJ5LmFyZ3MudGFibGUgPSByZXNvdXJjZTtcbiAgICAgICAgZmluYWxRdWVyeS5hcmdzLndoZXJlID0geyBpZDogeyAnJGVxJzogcGFyYW1zLmlkIH0gfTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdDUkVBVEUnOlxuICAgICAgICAvLyBjcmVhdGUgb25lXG4gICAgICAgIGNvbnN0IGNyZWF0ZUZpZWxkcyA9IE9iamVjdC5rZXlzKHBhcmFtcy5kYXRhKTtcblxuICAgICAgICBmaW5hbFF1ZXJ5ID0gY2xvbmVRdWVyeShpbnNlcnRRdWVyeSk7XG4gICAgICAgIGZpbmFsUXVlcnkuYXJncy50YWJsZSA9IHJlc291cmNlO1xuICAgICAgICBmaW5hbFF1ZXJ5LmFyZ3Mub2JqZWN0cy5wdXNoKHBhcmFtcy5kYXRhKTtcbiAgICAgICAgLy8gaWQgaXMgbWFuZGF0b3J5XG4gICAgICAgIGNyZWF0ZUZpZWxkcy5wdXNoKCdpZCcpO1xuICAgICAgICBmaW5hbFF1ZXJ5LmFyZ3MucmV0dXJuaW5nID0gY3JlYXRlRmllbGRzO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ1VQREFURSc6XG4gICAgICAgIC8vIHVwZGF0ZSBvbmVcbiAgICAgICAgY29uc3QgdXBkYXRlRmllbGRzID0gT2JqZWN0LmtleXMocGFyYW1zLmRhdGEpO1xuXG4gICAgICAgIGZpbmFsUXVlcnkgPSBjbG9uZVF1ZXJ5KHVwZGF0ZVF1ZXJ5KTtcbiAgICAgICAgZmluYWxRdWVyeS5hcmdzLnRhYmxlID0gcmVzb3VyY2U7XG4gICAgICAgIGZpbmFsUXVlcnkuYXJnc1snJHNldCddID0gcGFyYW1zLmRhdGE7XG4gICAgICAgIGZpbmFsUXVlcnkuYXJncy53aGVyZSA9IHsgaWQ6IHsgJyRlcSc6IHBhcmFtcy5pZCB9fTtcbiAgICAgICAgLy8gaWQgaXMgbWFuZGF0b3J5XG4gICAgICAgIHVwZGF0ZUZpZWxkcy5wdXNoKCdpZCcpO1xuICAgICAgICBmaW5hbFF1ZXJ5LmFyZ3MucmV0dXJuaW5nID0gdXBkYXRlRmllbGRzO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ1VQREFURV9NQU5ZJzpcbiAgICAgICAgLy8gdXBkYXRlIG11bHRpcGxlIGlkcyB3aXRoIGdpdmVuIGRhdGFcbiAgICAgICAgY29uc3QgdXBkYXRlTWFueUZpZWxkcyA9IE9iamVjdC5rZXlzKHBhcmFtcy5kYXRhKTtcblxuICAgICAgICBmaW5hbFF1ZXJ5ID0gY2xvbmVRdWVyeSh1cGRhdGVRdWVyeSk7XG4gICAgICAgIGZpbmFsUXVlcnkuYXJncy50YWJsZSA9IHJlc291cmNlO1xuICAgICAgICBmaW5hbFF1ZXJ5LmFyZ3NbJyRzZXQnXSA9IHBhcmFtcy5kYXRhO1xuICAgICAgICBmaW5hbFF1ZXJ5LmFyZ3Mud2hlcmUgPSB7ICdpZCc6IHsgJyRpbic6IHBhcmFtcy5pZHMgfSB9O1xuICAgICAgICAvLyBpZCBpcyBtYW5kYXRvcnlcbiAgICAgICAgdXBkYXRlTWFueUZpZWxkcy5wdXNoKCdpZCcpO1xuICAgICAgICBmaW5hbFF1ZXJ5LmFyZ3MucmV0dXJuaW5nID0gdXBkYXRlTWFueUZpZWxkcztcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdERUxFVEUnOlxuICAgICAgICAvLyBkZWxldGUgb25lXG4gICAgICAgIGNvbnN0IGRlbGV0ZUZpZWxkcyA9IE9iamVjdC5rZXlzKHBhcmFtcy5wcmV2aW91c0RhdGEpO1xuXG4gICAgICAgIGZpbmFsUXVlcnkgPSBjbG9uZVF1ZXJ5KGRlbGV0ZVF1ZXJ5KTtcbiAgICAgICAgZmluYWxRdWVyeS5hcmdzLnRhYmxlID0gcmVzb3VyY2U7XG4gICAgICAgIGZpbmFsUXVlcnkuYXJncy53aGVyZSA9IHsgaWQ6IHsgJyRlcSc6IHBhcmFtcy5pZCB9fTtcbiAgICAgICAgLy8gaWQgaXMgbWFuZGF0b3J5XG4gICAgICAgIGRlbGV0ZUZpZWxkcy5wdXNoKCdpZCcpO1xuICAgICAgICBmaW5hbFF1ZXJ5LmFyZ3MucmV0dXJuaW5nID0gZGVsZXRlRmllbGRzO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ0RFTEVURV9NQU5ZJzpcbiAgICAgICAgLy8gZGVsZXRlIG11bHRpcGxlXG4gICAgICAgIGZpbmFsUXVlcnkgPSBjbG9uZVF1ZXJ5KGRlbGV0ZVF1ZXJ5KTtcbiAgICAgICAgZmluYWxRdWVyeS5hcmdzLnRhYmxlID0gcmVzb3VyY2U7XG4gICAgICAgIGZpbmFsUXVlcnkuYXJncy53aGVyZSA9IHsgJ2lkJzogeyAnJGluJzogcGFyYW1zLmlkcyB9IH07XG4gICAgICAgIC8vIGlkIGlzIG1hbmRhdG9yeVxuICAgICAgICBmaW5hbFF1ZXJ5LmFyZ3MucmV0dXJuaW5nID0gWydpZCddO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ0dFVF9NQU5ZJzpcbiAgICAgICAgLy8gc2VsZWN0IG11bHRpcGxlIHdpdGhpbiB3aGVyZSBjbGF1c2VcbiAgICAgICAgZmluYWxRdWVyeSA9IGNsb25lUXVlcnkoc2VsZWN0UXVlcnkpO1xuICAgICAgICBmaW5hbFF1ZXJ5LmFyZ3MudGFibGUgPSByZXNvdXJjZTtcbiAgICAgICAgZmluYWxRdWVyeS5hcmdzLndoZXJlID0geyAnaWQnOiB7ICckaW4nOiBwYXJhbXMuaWRzIH0gfTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdHRVRfTUFOWV9SRUZFUkVOQ0UnOlxuICAgICAgICAvLyBzZWxlY3QgbXVsdGlwbGUgd2l0aCByZWxhdGlvbnNcbiAgICAgICAgY29uc3QgZmluYWxNYW55UXVlcnkgPSBjbG9uZVF1ZXJ5KHNlbGVjdFF1ZXJ5KTtcbiAgICAgICAgY29uc3QgZmluYWxNYW55Q291bnRRdWVyeSA9IGNsb25lUXVlcnkoY291bnRRdWVyeSk7XG5cbiAgICAgICAgZmluYWxTZWxlY3RRdWVyeS5hcmdzLnRhYmxlID0gcmVzb3VyY2U7XG4gICAgICAgIGZpbmFsU2VsZWN0UXVlcnkuYXJncy5saW1pdCA9IHBhcmFtcy5wYWdpbmF0aW9uLnBlclBhZ2U7XG4gICAgICAgIGZpbmFsU2VsZWN0UXVlcnkuYXJncy5vZmZzZXQgPSAocGFyYW1zLnBhZ2luYXRpb24ucGFnZSAqIHBhcmFtcy5wYWdpbmF0aW9uLnBlclBhZ2UpIC0gcGFyYW1zLnBhZ2luYXRpb24ucGVyUGFnZTtcbiAgICAgICAgZmluYWxTZWxlY3RRdWVyeS5hcmdzLndoZXJlID0geyBbcGFyYW1zLnRhcmdldF06IHBhcmFtcy5pZCB9O1xuICAgICAgICBmaW5hbFNlbGVjdFF1ZXJ5LmFyZ3Mub3JkZXJfYnkgPSB7Y29sdW1uOiBwYXJhbXMuc29ydC5maWVsZCwgdHlwZTogcGFyYW1zLnNvcnQub3JkZXIudG9Mb3dlckNhc2UoKX07XG4gICAgICAgIGZpbmFsQ291bnRRdWVyeS5hcmdzLnRhYmxlID0gcmVzb3VyY2U7XG4gICAgICAgIGZpbmFsUXVlcnkgPSBjbG9uZVF1ZXJ5KGJ1bGtRdWVyeSk7XG4gICAgICAgIGZpbmFsUXVlcnkuYXJncy5wdXNoKGZpbmFsTWFueVF1ZXJ5KTtcbiAgICAgICAgZmluYWxRdWVyeS5hcmdzLnB1c2goZmluYWxNYW55Q291bnRRdWVyeSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCB0eXBlICR7dHlwZX1gKTtcbiAgICB9O1xuICAgIG9wdGlvbnMuYm9keSA9IEpTT04uc3RyaW5naWZ5KGZpbmFsUXVlcnkpO1xuICAgIHJldHVybiB7IG9wdGlvbnMgfTtcbiAgfTtcblxuICBjb25zdCBjb252ZXJ0SFRUUFJlc3BvbnNlID0gKHJlc3BvbnNlLCB0eXBlLCByZXNvdXJjZSwgcGFyYW1zKSA9PiB7XG4gICAgLy8gaGFuZGxlIGVycm9ycyBhbmQgdGhyb3cgd2l0aCB0aGUgbWVzc2FnZVxuICAgIGlmICgnZXJyb3InIGluIHJlc3BvbnNlIHx8ICdjb2RlJyBpbiByZXNwb25zZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlKSk7XG4gICAgfVxuICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgY2FzZSAnR0VUX0xJU1QnOlxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGRhdGE6IHJlc3BvbnNlWzBdLFxuICAgICAgICAgIHRvdGFsOiByZXNwb25zZVsxXVsnY291bnQnXVxuICAgICAgICB9O1xuICAgICAgY2FzZSAnR0VUX09ORSc6XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZGF0YTogcmVzcG9uc2VbMF1cbiAgICAgICAgfTtcbiAgICAgIGNhc2UgJ0NSRUFURSc6XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZGF0YTogcmVzcG9uc2UucmV0dXJuaW5nWzBdXG4gICAgICAgIH07XG4gICAgICBjYXNlICdVUERBVEUnOlxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGRhdGE6IHJlc3BvbnNlLnJldHVybmluZ1swXVxuICAgICAgICB9O1xuICAgICAgY2FzZSAnVVBEQVRFX01BTlknOlxuICAgICAgICBjb25zdCB1cGRhdGVkSWRzID0gcmVzcG9uc2UucmV0dXJuaW5nLm1hcCgoaXRlbSkgPT4ge1xuICAgICAgICAgIHJldHVybiBpdGVtLmlkO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGRhdGE6IHVwZGF0ZWRJZHNcbiAgICAgICAgfTtcbiAgICAgIGNhc2UgJ0RFTEVURSc6XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZGF0YTogcmVzcG9uc2UucmV0dXJuaW5nWzBdXG4gICAgICAgIH07XG4gICAgICBjYXNlICdERUxFVEVfTUFOWSc6XG4gICAgICAgIGNvbnN0IGRlbGV0ZWRJZHMgPSByZXNwb25zZS5yZXR1cm5pbmcubWFwKChpdGVtKSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGl0ZW0uaWQ7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZGF0YTogZGVsZXRlZElkc1xuICAgICAgICB9O1xuICAgICAgY2FzZSAnR0VUX01BTlknOlxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGRhdGE6IHJlc3BvbnNlXG4gICAgICAgIH07XG4gICAgICBjYXNlICdHRVRfTUFOWV9SRUZFUkVOQ0UnOlxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGRhdGE6IHJlc3BvbnNlWzBdLFxuICAgICAgICAgIHRvdGFsOiByZXNwb25zZVsxXS5jb3VudFxuICAgICAgICB9O1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIHsgZGF0YTogcmVzcG9uc2UgfTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuICh0eXBlLCByZXNvdXJjZSwgcGFyYW1zKSA9PiB7XG4gICAgY29uc3QgeyBvcHRpb25zIH0gPSBjb252ZXJ0RGF0YVJlcXVlc3RUb0hUVFAoXG4gICAgICB0eXBlLFxuICAgICAgcmVzb3VyY2UsXG4gICAgICBwYXJhbXNcbiAgICApO1xuXG4gICAgb3B0aW9ucy5tZXRob2QgPSAnUE9TVCc7XG4gICAgb3B0aW9ucy5oZWFkZXJzID0gaGVhZGVycztcbiAgICByZXR1cm4gZmV0Y2goc2VydmVyRW5kcG9pbnQgKyAnL3YxL3F1ZXJ5Jywgb3B0aW9ucykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCkudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICByZXR1cm4gY29udmVydEhUVFBSZXNwb25zZShkYXRhLCB0eXBlLCByZXNvdXJjZSwgcGFyYW1zKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xufTtcbiIsIi8vIGRlZmluZSBoYXN1cmEganNvbiBhcGkgcXVlcmllc1xuY29uc3QgYnVsa1F1ZXJ5ID0ge1xuICB0eXBlOiAnYnVsaycsXG4gIGFyZ3M6IFtdXG59O1xuXG5jb25zdCBzZWxlY3RRdWVyeSA9IHtcbiAgdHlwZTogJ3NlbGVjdCcsXG4gIGFyZ3M6IHtcbiAgICB0YWJsZTogJycsXG4gICAgY29sdW1uczogWycqJ11cbiAgfVxufTtcblxuY29uc3QgY291bnRRdWVyeSA9IHtcbiAgdHlwZTogJ2NvdW50JyxcbiAgYXJnczoge1xuICAgIHRhYmxlOiAnJyxcbiAgICB3aGVyZTogeyBpZDogeyAnJGd0JzogMCB9fVxuICB9XG59O1xuXG5jb25zdCBpbnNlcnRRdWVyeSA9IHtcbiAgdHlwZTogJ2luc2VydCcsXG4gIGFyZ3M6IHtcbiAgICB0YWJsZTogJycsXG4gICAgb2JqZWN0czogW10sXG4gICAgcmV0dXJuaW5nOiBbXVxuICB9XG59O1xuXG5jb25zdCB1cGRhdGVRdWVyeSA9IHtcbiAgdHlwZTogJ3VwZGF0ZScsXG4gIGFyZ3M6IHtcbiAgICB0YWJsZTogJycsXG4gICAgJHNldDoge30sXG4gICAgd2hlcmU6IHt9LFxuICAgIHJldHVybmluZzogW11cbiAgfVxufTtcblxuY29uc3QgZGVsZXRlUXVlcnkgPSB7XG4gIHR5cGU6ICdkZWxldGUnLFxuICBhcmdzOiB7XG4gICAgdGFibGU6ICcnLFxuICAgIHdoZXJlOiB7fSxcbiAgICByZXR1cm5pbmc6IFtdXG4gIH1cbn07XG5cbmV4cG9ydCB7IGJ1bGtRdWVyeSwgc2VsZWN0UXVlcnksIGNvdW50UXVlcnksIGluc2VydFF1ZXJ5LCB1cGRhdGVRdWVyeSwgZGVsZXRlUXVlcnkgfTtcblxuIl0sInNvdXJjZVJvb3QiOiIifQ==