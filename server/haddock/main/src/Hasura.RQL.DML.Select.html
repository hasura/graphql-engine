<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hasura.RQL.DML.Select</span><span>
</span><span id="line-2"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Select.html#runSelect"><span class="hs-identifier">runSelect</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-3"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-4"></span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Control</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadBaseControl</span></span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HM</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier">Data.Sequence</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DS</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Text.Extended.html"><span class="hs-identifier">Data.Text.Extended</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.4.20220919/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier">Database.PG.Query</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PG</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html"><span class="hs-identifier">Hasura.Backends.Postgres.Connection.MonadTx</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Execute.Types.html"><span class="hs-identifier">Hasura.Backends.Postgres.Execute.Types</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html"><span class="hs-identifier">Hasura.Backends.Postgres.SQL.DML</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html"><span class="hs-identifier">Hasura.Backends.Postgres.SQL.Types</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#TableName"><span class="hs-identifier">TableName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.Translate.Select.html"><span class="hs-identifier">Hasura.Backends.Postgres.Translate.Select</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html"><span class="hs-identifier">Hasura.Base.Error</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.EncJSON.html"><span class="hs-identifier">Hasura.EncJSON</span></a></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.4.20220919/hasura-prelude-0.1.0.0/opt/doc/html/hasura-prelude/src"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html"><span class="hs-identifier">Hasura.RQL.DML.Internal</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Types.html"><span class="hs-identifier">Hasura.RQL.DML.Types</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.BoolExp.html"><span class="hs-identifier">Hasura.RQL.IR.BoolExp</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.OrderBy.html"><span class="hs-identifier">Hasura.RQL.IR.OrderBy</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.IR.Select.html"><span class="hs-identifier">Hasura.RQL.IR.Select</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html"><span class="hs-identifier">Hasura.RQL.Types.Backend</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Column.html"><span class="hs-identifier">Hasura.RQL.Types.Column</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html"><span class="hs-identifier">Hasura.RQL.Types.Common</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html"><span class="hs-identifier">Hasura.RQL.Types.Metadata</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html"><span class="hs-identifier">Hasura.RQL.Types.Relationships.Local</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html"><span class="hs-identifier">Hasura.RQL.Types.SchemaCache</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Table.html"><span class="hs-identifier">Hasura.RQL.Types.Table</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.SQL.Backend.html"><span class="hs-identifier">Hasura.SQL.Backend</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.SQL.Types.html"><span class="hs-identifier">Hasura.SQL.Types</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html"><span class="hs-identifier">Hasura.Server.Types</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Session.html"><span class="hs-identifier">Hasura.Session</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Tracing.html"><span class="hs-identifier">Hasura.Tracing</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tracing</span></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">type</span><span> </span><span id="SelectQExt"><span class="annot"><a href="Hasura.RQL.DML.Select.html#SelectQExt"><span class="hs-identifier hs-var">SelectQExt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SelectG"><span class="hs-identifier hs-type">SelectG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ExtCol"><span class="hs-identifier hs-type">ExtCol</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.BoolExp.html#BoolExp"><span class="hs-identifier hs-type">BoolExp</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">-- Columns in RQL</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- This technically doesn't need to be generalized to all backends as</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- it is specific to this module; however the generalization work was</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- already done, and there's no particular reason to force this to be</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- specific.</span><span>
</span><span id="line-45"></span><span class="hs-keyword">data</span><span> </span><span id="ExtCol"><span class="annot"><a href="Hasura.RQL.DML.Select.html#ExtCol"><span class="hs-identifier hs-var">ExtCol</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690475231"><span class="annot"><a href="#local-6989586621690475231"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.SQL.Backend.html#BackendType"><span class="hs-identifier hs-type">BackendType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ECSimple"><span class="annot"><a href="Hasura.RQL.DML.Select.html#ECSimple"><span class="hs-identifier hs-var">ECSimple</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#Column"><span class="hs-identifier hs-type">Column</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475231"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ECRel"><span class="annot"><a href="Hasura.RQL.DML.Select.html#ECRel"><span class="hs-identifier hs-var">ECRel</span></a></span></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#RelName"><span class="hs-identifier hs-type">RelName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#RelName"><span class="hs-identifier hs-type">RelName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Select.html#SelectQExt"><span class="hs-identifier hs-type">SelectQExt</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span id="local-6989586621690475247"><span class="annot"><a href="Hasura.RQL.DML.Select.html#convSelCol"><span class="hs-identifier hs-type">convSelCol</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Session.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475247"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475247"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#TableInfoRM"><span class="hs-identifier hs-type">TableInfoRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690475247"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FieldInfoMap"><span class="hs-identifier hs-type">FieldInfoMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#SelPermInfo"><span class="hs-identifier hs-type">SelPermInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SelCol"><span class="hs-identifier hs-type">SelCol</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><a href="#local-6989586621690475247"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ExtCol"><span class="hs-identifier hs-type">ExtCol</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-55"></span><span id="convSelCol"><span class="annot"><span class="annottext">convSelCol :: forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; SelCol
-&gt; m [ExtCol ('Postgres 'Vanilla)]
</span><a href="Hasura.RQL.DML.Select.html#convSelCol"><span class="hs-identifier hs-var hs-var">convSelCol</span></a></span></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SCExtSimple"><span class="hs-identifier hs-type">SCExtSimple</span></a></span><span> </span><span id="local-6989586621690474838"><span class="annot"><span class="annottext">PGCol
</span><a href="#local-6989586621690474838"><span class="hs-identifier hs-var">cn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall (b :: BackendType). Column b -&gt; ExtCol b
</span><a href="Hasura.RQL.DML.Select.html#ECSimple"><span class="hs-identifier hs-var">ECSimple</span></a></span><span> </span><span class="annot"><span class="annottext">PGCol
</span><a href="#local-6989586621690474838"><span class="hs-identifier hs-var">cn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-57"></span><span class="annot"><a href="Hasura.RQL.DML.Select.html#convSelCol"><span class="hs-identifier hs-var">convSelCol</span></a></span><span> </span><span id="local-6989586621690474837"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474837"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SCExtRel"><span class="hs-identifier hs-type">SCExtRel</span></a></span><span> </span><span id="local-6989586621690474835"><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690474835"><span class="hs-identifier hs-var">rn</span></a></span></span><span> </span><span id="local-6989586621690474834"><span class="annot"><span class="annottext">Maybe RelName
</span><a href="#local-6989586621690474834"><span class="hs-identifier hs-var">malias</span></a></span></span><span> </span><span id="local-6989586621690474833"><span class="annot"><span class="annottext">SelectQ
</span><a href="#local-6989586621690474833"><span class="hs-identifier hs-var">selQ</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-comment">-- Point to the name key</span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690474831"><span class="annot"><span class="annottext">pgWhenRelErr :: Text
</span><a href="#local-6989586621690474831"><span class="hs-identifier hs-var hs-var">pgWhenRelErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;only relationships can be expanded&quot;</span></span><span>
</span><span id="line-60"></span><span>  </span><span id="local-6989586621690474830"><span class="annot"><span class="annottext">RelInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474830"><span class="hs-identifier hs-var">relInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-62"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (backend :: BackendType).
MonadError QErr m =&gt;
FieldInfoMap (FieldInfo backend)
-&gt; RelName -&gt; Text -&gt; m (RelInfo backend)
</span><a href="Hasura.RQL.Types.Table.html#askRelType"><span class="hs-identifier hs-var">askRelType</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474837"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690474835"><span class="hs-identifier hs-var">rn</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690474831"><span class="hs-identifier hs-var">pgWhenRelErr</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelInfo"><span class="hs-identifier hs-type">RelInfo</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RelType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HashMap (Column ('Postgres 'Vanilla)) (Column ('Postgres 'Vanilla))
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621690474826"><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474826"><span class="hs-identifier hs-var">relTab</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">InsertOrder
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474830"><span class="hs-identifier hs-var">relInfo</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621690474825"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474825"><span class="hs-identifier hs-var">rfim</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690474824"><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474824"><span class="hs-identifier hs-var">rspi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
RelName
-&gt; TableName ('Postgres 'Vanilla)
-&gt; m (FieldInfoMap (FieldInfo ('Postgres 'Vanilla)),
      SelPermInfo ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Internal.html#fetchRelDet"><span class="hs-identifier hs-var">fetchRelDet</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690474835"><span class="hs-identifier hs-var">rn</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474826"><span class="hs-identifier hs-var">relTab</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span id="local-6989586621690474822"><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621690474822"><span class="hs-identifier hs-var">resolvedSelQ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla) -&gt; SelectQ -&gt; m SelectQExt
</span><a href="Hasura.RQL.DML.Select.html#resolveStar"><span class="hs-identifier hs-var">resolveStar</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474825"><span class="hs-identifier hs-var">rfim</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474824"><span class="hs-identifier hs-var">rspi</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQ
</span><a href="#local-6989586621690474833"><span class="hs-identifier hs-var">selQ</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall (b :: BackendType).
RelName -&gt; Maybe RelName -&gt; SelectQExt -&gt; ExtCol b
</span><a href="Hasura.RQL.DML.Select.html#ECRel"><span class="hs-identifier hs-var">ECRel</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690474835"><span class="hs-identifier hs-var">rn</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RelName
</span><a href="#local-6989586621690474834"><span class="hs-identifier hs-var">malias</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621690474822"><span class="hs-identifier hs-var">resolvedSelQ</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-67"></span><span class="annot"><a href="Hasura.RQL.DML.Select.html#convSelCol"><span class="hs-identifier hs-var">convSelCol</span></a></span><span> </span><span id="local-6989586621690474820"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474820"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span></span><span> </span><span id="local-6989586621690474819"><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474819"><span class="hs-identifier hs-var">spi</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SCStar"><span class="hs-identifier hs-type">SCStar</span></a></span><span> </span><span id="local-6989586621690474817"><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621690474817"><span class="hs-identifier hs-var">wildcard</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; Wildcard
-&gt; m [ExtCol ('Postgres 'Vanilla)]
</span><a href="Hasura.RQL.DML.Select.html#convWildcard"><span class="hs-identifier hs-var">convWildcard</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474820"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474819"><span class="hs-identifier hs-var">spi</span></a></span><span> </span><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621690474817"><span class="hs-identifier hs-var">wildcard</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span id="local-6989586621690475210"><span class="annot"><a href="Hasura.RQL.DML.Select.html#convWildcard"><span class="hs-identifier hs-type">convWildcard</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Session.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475210"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475210"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#TableInfoRM"><span class="hs-identifier hs-type">TableInfoRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690475210"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FieldInfoMap"><span class="hs-identifier hs-type">FieldInfoMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#SelPermInfo"><span class="hs-identifier hs-type">SelPermInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-74"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#Wildcard"><span class="hs-identifier hs-type">Wildcard</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><a href="#local-6989586621690475210"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ExtCol"><span class="hs-identifier hs-type">ExtCol</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-76"></span><span id="convWildcard"><span class="annot"><span class="annottext">convWildcard :: forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; Wildcard
-&gt; m [ExtCol ('Postgres 'Vanilla)]
</span><a href="Hasura.RQL.DML.Select.html#convWildcard"><span class="hs-identifier hs-var hs-var">convWildcard</span></a></span></span><span> </span><span id="local-6989586621690474789"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474789"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span></span><span> </span><span id="local-6989586621690474788"><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474788"><span class="hs-identifier hs-var">selPermInfo</span></a></span></span><span> </span><span id="local-6989586621690474787"><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621690474787"><span class="hs-identifier hs-var">wildcard</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621690474787"><span class="hs-identifier hs-var">wildcard</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><span class="annottext">Wildcard
</span><a href="Hasura.RQL.DML.Types.html#Star"><span class="hs-identifier hs-var">Star</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtCol ('Postgres 'Vanilla)]
</span><a href="#local-6989586621690474785"><span class="hs-identifier hs-var">simpleCols</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#StarDot"><span class="hs-identifier hs-type">StarDot</span></a></span><span> </span><span id="local-6989586621690474783"><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621690474783"><span class="hs-identifier hs-var">wc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ExtCol ('Postgres 'Vanilla)]
</span><a href="#local-6989586621690474785"><span class="hs-identifier hs-var">simpleCols</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Filterable f =&gt; f (Maybe a) -&gt; f a
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Wildcard -&gt; m [Maybe (ExtCol ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690474780"><span class="hs-identifier hs-var">relExtCols</span></a></span><span> </span><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621690474783"><span class="hs-identifier hs-var">wc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-81"></span><span>    </span><span id="local-6989586621690474779"><span class="annot"><span class="annottext">cols :: HashMap
  (Column ('Postgres 'Vanilla))
  (Maybe (AnnColumnCaseBoolExpPartialSQL ('Postgres 'Vanilla)))
</span><a href="#local-6989586621690474779"><span class="hs-identifier hs-var hs-var">cols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
SelPermInfo b
-&gt; HashMap (Column b) (Maybe (AnnColumnCaseBoolExpPartialSQL b))
</span><a href="Hasura.RQL.Types.Table.html#spiCols"><span class="hs-identifier hs-var">spiCols</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474788"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span id="local-6989586621690474777"><span class="annot"><span class="annottext">pgCols :: [PGCol]
</span><a href="#local-6989586621690474777"><span class="hs-identifier hs-var hs-var">pgCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). ColumnInfo b -&gt; Column b
</span><a href="Hasura.RQL.Types.Column.html#ciColumn"><span class="hs-identifier hs-var">ciColumn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (backend :: BackendType).
FieldInfoMap (FieldInfo backend) -&gt; [ColumnInfo backend]
</span><a href="Hasura.RQL.Types.Table.html#getCols"><span class="hs-identifier hs-var">getCols</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474789"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span id="local-6989586621690474774"><span class="annot"><span class="annottext">relColInfos :: [RelInfo ('Postgres 'Vanilla)]
</span><a href="#local-6989586621690474774"><span class="hs-identifier hs-var hs-var">relColInfos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (backend :: BackendType).
FieldInfoMap (FieldInfo backend) -&gt; [RelInfo backend]
</span><a href="Hasura.RQL.Types.Table.html#getRels"><span class="hs-identifier hs-var">getRels</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474789"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span>    </span><span id="local-6989586621690474785"><span class="annot"><span class="annottext">simpleCols :: [ExtCol ('Postgres 'Vanilla)]
</span><a href="#local-6989586621690474785"><span class="hs-identifier hs-var hs-var">simpleCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). Column b -&gt; ExtCol b
</span><a href="Hasura.RQL.DML.Select.html#ECSimple"><span class="hs-identifier hs-var">ECSimple</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. (Eq k, Hashable k) =&gt; k -&gt; HashMap k a -&gt; Bool
</span><span class="hs-operator hs-var">`HM.member`</span></span><span> </span><span class="annot"><span class="annottext">HashMap
  (Column ('Postgres 'Vanilla))
  (Maybe (AnnColumnCaseBoolExpPartialSQL ('Postgres 'Vanilla)))
</span><a href="#local-6989586621690474779"><span class="hs-identifier hs-var">cols</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PGCol]
</span><a href="#local-6989586621690474777"><span class="hs-identifier hs-var">pgCols</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span>    </span><span id="local-6989586621690474750"><span class="annot"><span class="annottext">mkRelCol :: Wildcard -&gt; RelInfo b -&gt; m (Maybe (ExtCol b))
</span><a href="#local-6989586621690474750"><span class="hs-identifier hs-var hs-var">mkRelCol</span></a></span></span><span> </span><span id="local-6989586621690474749"><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621690474749"><span class="hs-identifier hs-var">wc</span></a></span></span><span> </span><span id="local-6989586621690474748"><span class="annot"><span class="annottext">RelInfo b
</span><a href="#local-6989586621690474748"><span class="hs-identifier hs-var">relInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-88"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690474747"><span class="annot"><span class="annottext">relName :: RelName
</span><a href="#local-6989586621690474747"><span class="hs-identifier hs-var hs-var">relName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). RelInfo b -&gt; RelName
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riName"><span class="hs-identifier hs-var">riName</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo b
</span><a href="#local-6989586621690474748"><span class="hs-identifier hs-var">relInfo</span></a></span><span>
</span><span id="line-89"></span><span>          </span><span id="local-6989586621690474745"><span class="annot"><span class="annottext">relTab :: TableName b
</span><a href="#local-6989586621690474745"><span class="hs-identifier hs-var hs-var">relTab</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). RelInfo b -&gt; TableName b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riRTable"><span class="hs-identifier hs-var">riRTable</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo b
</span><a href="#local-6989586621690474748"><span class="hs-identifier hs-var">relInfo</span></a></span><span>
</span><span id="line-90"></span><span>      </span><span id="local-6989586621690474743"><span class="annot"><span class="annottext">TableInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474743"><span class="hs-identifier hs-var">relTabInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
TableName ('Postgres 'Vanilla)
-&gt; m (TableInfo ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Internal.html#fetchRelTabInfo"><span class="hs-identifier hs-var">fetchRelTabInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TableName b
</span><a href="#local-6989586621690474745"><span class="hs-identifier hs-var">relTab</span></a></span><span>
</span><span id="line-91"></span><span>      </span><span id="local-6989586621690474741"><span class="annot"><span class="annottext">Maybe (SelPermInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474741"><span class="hs-identifier hs-var">mRelSelPerm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) c.
UserInfoM m =&gt;
Lens' (RolePermInfo ('Postgres 'Vanilla)) (Maybe c)
-&gt; TableInfo ('Postgres 'Vanilla) -&gt; m (Maybe c)
</span><a href="Hasura.RQL.DML.Internal.html#askPermInfo"><span class="hs-identifier hs-var">askPermInfo</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
Lens' (RolePermInfo b) (Maybe (SelPermInfo b))
</span><a href="Hasura.RQL.Types.Table.html#permSel"><span class="hs-identifier hs-var">permSel</span></a></span><span> </span><span class="annot"><span class="annottext">TableInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474743"><span class="hs-identifier hs-var">relTabInfo</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (SelPermInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474741"><span class="hs-identifier hs-var">mRelSelPerm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690474735"><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474735"><span class="hs-identifier hs-var">relSelPermInfo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-94"></span><span>        </span><span id="local-6989586621690474734"><span class="annot"><span class="annottext">[ExtCol ('Postgres 'Vanilla)]
</span><a href="#local-6989586621690474734"><span class="hs-identifier hs-var">rExtCols</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; Wildcard
-&gt; m [ExtCol ('Postgres 'Vanilla)]
</span><a href="Hasura.RQL.DML.Select.html#convWildcard"><span class="hs-identifier hs-var">convWildcard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType) field primaryKeyColumn.
TableCoreInfoG b field primaryKeyColumn -&gt; FieldInfoMap field
</span><a href="Hasura.RQL.Types.Table.html#_tciFieldInfoMap"><span class="hs-identifier hs-var">_tciFieldInfoMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). TableInfo b -&gt; TableCoreInfo b
</span><a href="Hasura.RQL.Types.Table.html#_tiCoreInfo"><span class="hs-identifier hs-var">_tiCoreInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TableInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474743"><span class="hs-identifier hs-var">relTabInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474735"><span class="hs-identifier hs-var">relSelPermInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621690474749"><span class="hs-identifier hs-var">wc</span></a></span><span>
</span><span id="line-95"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-96"></span><span>          </span><span class="annot"><span class="annottext">forall (b :: BackendType).
RelName -&gt; Maybe RelName -&gt; SelectQExt -&gt; ExtCol b
</span><a href="Hasura.RQL.DML.Select.html#ECRel"><span class="hs-identifier hs-var">ECRel</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690474747"><span class="hs-identifier hs-var">relName</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-97"></span><span>            </span><span class="annot"><span class="annottext">forall a b c.
[a]
-&gt; Maybe b
-&gt; Maybe OrderByExp
-&gt; Maybe c
-&gt; Maybe c
-&gt; SelectG a b c
</span><a href="Hasura.RQL.DML.Types.html#SelectG"><span class="hs-identifier hs-var">SelectG</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtCol ('Postgres 'Vanilla)]
</span><a href="#local-6989586621690474734"><span class="hs-identifier hs-var">rExtCols</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621690474780"><span class="annot"><span class="annottext">relExtCols :: Wildcard -&gt; m [Maybe (ExtCol ('Postgres 'Vanilla))]
</span><a href="#local-6989586621690474780"><span class="hs-identifier hs-var hs-var">relExtCols</span></a></span></span><span> </span><span id="local-6989586621690474730"><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621690474730"><span class="hs-identifier hs-var">wc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {b :: BackendType} {m :: * -&gt; *} {b :: BackendType}.
(TableName b ~ QualifiedTable, MonadError QErr m,
 TableInfoRM ('Postgres 'Vanilla) m, UserInfoM m) =&gt;
Wildcard -&gt; RelInfo b -&gt; m (Maybe (ExtCol b))
</span><a href="#local-6989586621690474750"><span class="hs-identifier hs-var">mkRelCol</span></a></span><span> </span><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621690474730"><span class="hs-identifier hs-var">wc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RelInfo ('Postgres 'Vanilla)]
</span><a href="#local-6989586621690474774"><span class="hs-identifier hs-var">relColInfos</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span id="local-6989586621690475212"><span class="annot"><a href="Hasura.RQL.DML.Select.html#resolveStar"><span class="hs-identifier hs-type">resolveStar</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Session.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475212"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475212"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#TableInfoRM"><span class="hs-identifier hs-type">TableInfoRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690475212"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FieldInfoMap"><span class="hs-identifier hs-type">FieldInfoMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#SelPermInfo"><span class="hs-identifier hs-type">SelPermInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SelectQ"><span class="hs-identifier hs-type">SelectQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><a href="#local-6989586621690475212"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.DML.Select.html#SelectQExt"><span class="hs-identifier hs-type">SelectQExt</span></a></span></span><span>
</span><span id="line-107"></span><span id="resolveStar"><span class="annot"><span class="annottext">resolveStar :: forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla) -&gt; SelectQ -&gt; m SelectQExt
</span><a href="Hasura.RQL.DML.Select.html#resolveStar"><span class="hs-identifier hs-var hs-var">resolveStar</span></a></span></span><span> </span><span id="local-6989586621690474696"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474696"><span class="hs-identifier hs-var">fim</span></a></span></span><span> </span><span id="local-6989586621690474695"><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474695"><span class="hs-identifier hs-var">selPermInfo</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SelectG"><span class="hs-identifier hs-type">SelectG</span></a></span><span> </span><span id="local-6989586621690474694"><span class="annot"><span class="annottext">[SelCol]
</span><a href="#local-6989586621690474694"><span class="hs-identifier hs-var">selCols</span></a></span></span><span> </span><span id="local-6989586621690474693"><span class="annot"><span class="annottext">Maybe (BoolExp ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474693"><span class="hs-identifier hs-var">mWh</span></a></span></span><span> </span><span id="local-6989586621690474692"><span class="annot"><span class="annottext">Maybe OrderByExp
</span><a href="#local-6989586621690474692"><span class="hs-identifier hs-var">mOb</span></a></span></span><span> </span><span id="local-6989586621690474691"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621690474691"><span class="hs-identifier hs-var">mLt</span></a></span></span><span> </span><span id="local-6989586621690474690"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621690474690"><span class="hs-identifier hs-var">mOf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-108"></span><span>  </span><span id="local-6989586621690474689"><span class="annot"><span class="annottext">[ExtCol ('Postgres 'Vanilla)]
</span><a href="#local-6989586621690474689"><span class="hs-identifier hs-var">procOverrides</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Filterable f =&gt; f (Maybe a) -&gt; f a
</span><span class="hs-identifier hs-var">catMaybes</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;columns&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-110"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. QErrM m =&gt; [a] -&gt; (a -&gt; m b) -&gt; m [b]
</span><a href="Hasura.Base.Error.html#indexedForM"><span class="hs-identifier hs-var">indexedForM</span></a></span><span> </span><span class="annot"><span class="annottext">[SelCol]
</span><a href="#local-6989586621690474694"><span class="hs-identifier hs-var">selCols</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690474685"><span class="annot"><span class="annottext">SelCol
</span><a href="#local-6989586621690474685"><span class="hs-identifier hs-var">selCol</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SelCol
</span><a href="#local-6989586621690474685"><span class="hs-identifier hs-var">selCol</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-111"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SCStar"><span class="hs-identifier hs-type">SCStar</span></a></span><span> </span><span class="annot"><span class="annottext">Wildcard
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-112"></span><span>        </span><span class="annot"><span class="annottext">SelCol
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; SelCol
-&gt; m [ExtCol ('Postgres 'Vanilla)]
</span><a href="Hasura.RQL.DML.Select.html#convSelCol"><span class="hs-identifier hs-var">convSelCol</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474696"><span class="hs-identifier hs-var">fim</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474695"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span> </span><span class="annot"><span class="annottext">SelCol
</span><a href="#local-6989586621690474685"><span class="hs-identifier hs-var">selCol</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span id="local-6989586621690474684"><span class="annot"><span class="annottext">[ExtCol ('Postgres 'Vanilla)]
</span><a href="#local-6989586621690474684"><span class="hs-identifier hs-var">everything</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Wildcard]
</span><a href="#local-6989586621690474683"><span class="hs-identifier hs-var">wildcards</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><span class="annottext">[Wildcard]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; Wildcard
-&gt; m [ExtCol ('Postgres 'Vanilla)]
</span><a href="Hasura.RQL.DML.Select.html#convWildcard"><span class="hs-identifier hs-var">convWildcard</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474696"><span class="hs-identifier hs-var">fim</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474695"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">maximum</span></a></span><span> </span><span class="annot"><span class="annottext">[Wildcard]
</span><a href="#local-6989586621690474683"><span class="hs-identifier hs-var">wildcards</span></a></span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690474681"><span class="annot"><span class="annottext">extCols :: [ExtCol ('Postgres 'Vanilla)]
</span><a href="#local-6989586621690474681"><span class="hs-identifier hs-var hs-var">extCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">unionBy</span></a></span><span> </span><span class="annot"><span class="annottext">forall {b :: BackendType} {b :: BackendType}.
(Column b ~ Column b, Eq (Column b)) =&gt;
ExtCol b -&gt; ExtCol b -&gt; Bool
</span><a href="#local-6989586621690474679"><span class="hs-identifier hs-var">equals</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtCol ('Postgres 'Vanilla)]
</span><a href="#local-6989586621690474689"><span class="hs-identifier hs-var">procOverrides</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtCol ('Postgres 'Vanilla)]
</span><a href="#local-6989586621690474684"><span class="hs-identifier hs-var">everything</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b c.
[a]
-&gt; Maybe b
-&gt; Maybe OrderByExp
-&gt; Maybe c
-&gt; Maybe c
-&gt; SelectG a b c
</span><a href="Hasura.RQL.DML.Types.html#SelectG"><span class="hs-identifier hs-var">SelectG</span></a></span><span> </span><span class="annot"><span class="annottext">[ExtCol ('Postgres 'Vanilla)]
</span><a href="#local-6989586621690474681"><span class="hs-identifier hs-var">extCols</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (BoolExp ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474693"><span class="hs-identifier hs-var">mWh</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe OrderByExp
</span><a href="#local-6989586621690474692"><span class="hs-identifier hs-var">mOb</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621690474691"><span class="hs-identifier hs-var">mLt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621690474690"><span class="hs-identifier hs-var">mOf</span></a></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621690474683"><span class="annot"><span class="annottext">wildcards :: [Wildcard]
</span><a href="#local-6989586621690474683"><span class="hs-identifier hs-var hs-var">wildcards</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. [Either a b] -&gt; [a]
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">lefts</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">SelCol -&gt; Either Wildcard SelCol
</span><a href="#local-6989586621690474677"><span class="hs-identifier hs-var">mkEither</span></a></span><span> </span><span class="annot"><span class="annottext">[SelCol]
</span><a href="#local-6989586621690474694"><span class="hs-identifier hs-var">selCols</span></a></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span>    </span><span id="local-6989586621690474677"><span class="annot"><span class="annottext">mkEither :: SelCol -&gt; Either Wildcard SelCol
</span><a href="#local-6989586621690474677"><span class="hs-identifier hs-var hs-var">mkEither</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SCStar"><span class="hs-identifier hs-type">SCStar</span></a></span><span> </span><span id="local-6989586621690474676"><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621690474676"><span class="hs-identifier hs-var">wc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">Wildcard
</span><a href="#local-6989586621690474676"><span class="hs-identifier hs-var">wc</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><a href="#local-6989586621690474677"><span class="hs-identifier hs-var">mkEither</span></a></span><span> </span><span id="local-6989586621690474675"><span class="annot"><span class="annottext">SelCol
</span><a href="#local-6989586621690474675"><span class="hs-identifier hs-var">selCol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">SelCol
</span><a href="#local-6989586621690474675"><span class="hs-identifier hs-var">selCol</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span>    </span><span id="local-6989586621690474679"><span class="annot"><span class="annottext">equals :: ExtCol b -&gt; ExtCol b -&gt; Bool
</span><a href="#local-6989586621690474679"><span class="hs-identifier hs-var hs-var">equals</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ECSimple"><span class="hs-identifier hs-type">ECSimple</span></a></span><span> </span><span id="local-6989586621690474668"><span class="annot"><span class="annottext">Column b
</span><a href="#local-6989586621690474668"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ECSimple"><span class="hs-identifier hs-type">ECSimple</span></a></span><span> </span><span id="local-6989586621690474667"><span class="annot"><span class="annottext">Column b
</span><a href="#local-6989586621690474667"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Column b
</span><a href="#local-6989586621690474668"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Column b
</span><a href="#local-6989586621690474667"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><a href="#local-6989586621690474679"><span class="hs-identifier hs-var">equals</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ECRel"><span class="hs-identifier hs-type">ECRel</span></a></span><span> </span><span id="local-6989586621690474666"><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690474666"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe RelName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ECRel"><span class="hs-identifier hs-type">ECRel</span></a></span><span> </span><span id="local-6989586621690474665"><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690474665"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe RelName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690474666"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690474665"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><a href="#local-6989586621690474679"><span class="hs-identifier hs-var">equals</span></a></span><span> </span><span class="annot"><span class="annottext">ExtCol b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ExtCol b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span id="local-6989586621690475130"><span class="annot"><a href="Hasura.RQL.DML.Select.html#convOrderByElem"><span class="hs-identifier hs-type">convOrderByElem</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Session.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475130"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475130"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#TableInfoRM"><span class="hs-identifier hs-type">TableInfoRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690475130"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-130"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#SessionVariableBuilder"><span class="hs-identifier hs-type">SessionVariableBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475130"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FieldInfoMap"><span class="hs-identifier hs-type">FieldInfoMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#SelPermInfo"><span class="hs-identifier hs-type">SelPermInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.OrderBy.html#OrderByCol"><span class="hs-identifier hs-type">OrderByCol</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-133"></span><span>  </span><span class="annot"><a href="#local-6989586621690475130"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnotatedOrderByElement"><span class="hs-identifier hs-type">AnnotatedOrderByElement</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-134"></span><span id="convOrderByElem"><span class="annot"><span class="annottext">convOrderByElem :: forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
SessionVariableBuilder m
-&gt; (FieldInfoMap (FieldInfo ('Postgres 'Vanilla)),
    SelPermInfo ('Postgres 'Vanilla))
-&gt; OrderByCol
-&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)
</span><a href="Hasura.RQL.DML.Select.html#convOrderByElem"><span class="hs-identifier hs-var hs-var">convOrderByElem</span></a></span></span><span> </span><span id="local-6989586621690474610"><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621690474610"><span class="hs-identifier hs-var">sessVarBldr</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690474609"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474609"><span class="hs-identifier hs-var">flds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690474608"><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474608"><span class="hs-identifier hs-var">spi</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-135"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.OrderBy.html#OCPG"><span class="hs-identifier hs-type">OCPG</span></a></span><span> </span><span id="local-6989586621690474606"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621690474606"><span class="hs-identifier hs-var">fldName</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-136"></span><span>    </span><span id="local-6989586621690474605"><span class="annot"><span class="annottext">FieldInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474605"><span class="hs-identifier hs-var">fldInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) fieldInfo.
MonadError QErr m =&gt;
FieldInfoMap fieldInfo -&gt; FieldName -&gt; m fieldInfo
</span><a href="Hasura.RQL.Types.Table.html#askFieldInfo"><span class="hs-identifier hs-var">askFieldInfo</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474609"><span class="hs-identifier hs-var">flds</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621690474606"><span class="hs-identifier hs-var">fldName</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FieldInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474605"><span class="hs-identifier hs-var">fldInfo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-138"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FIColumn"><span class="hs-identifier hs-type">FIColumn</span></a></span><span> </span><span id="local-6989586621690474602"><span class="annot"><span class="annottext">ColumnInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474602"><span class="hs-identifier hs-var">colInfo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m) =&gt;
SelPermInfo ('Postgres 'Vanilla)
-&gt; Column ('Postgres 'Vanilla) -&gt; m ()
</span><a href="Hasura.RQL.DML.Internal.html#checkSelOnCol"><span class="hs-identifier hs-var">checkSelOnCol</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474608"><span class="hs-identifier hs-var">spi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType). ColumnInfo b -&gt; Column b
</span><a href="Hasura.RQL.Types.Column.html#ciColumn"><span class="hs-identifier hs-var">ciColumn</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474602"><span class="hs-identifier hs-var">colInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690474600"><span class="annot"><span class="annottext">ty :: ColumnType ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474600"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). ColumnInfo b -&gt; ColumnType b
</span><a href="Hasura.RQL.Types.Column.html#ciType"><span class="hs-identifier hs-var">ciType</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474602"><span class="hs-identifier hs-var">colInfo</span></a></span><span>
</span><span id="line-141"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType).
(ScalarType b -&gt; Bool) -&gt; ColumnType b -&gt; Bool
</span><a href="Hasura.RQL.Types.Column.html#isScalarColumnWhere"><span class="hs-identifier hs-var">isScalarColumnWhere</span></a></span><span> </span><span class="annot"><span class="annottext">PGScalarType -&gt; Bool
</span><a href="Hasura.Backends.Postgres.SQL.Types.html#isGeoType"><span class="hs-identifier hs-var">isGeoType</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnType ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474600"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-142"></span><span>          </span><span class="hs-keyword">then</span><span>
</span><span id="line-143"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#UnexpectedPayload"><span class="hs-identifier hs-var">UnexpectedPayload</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-144"></span><span>              </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621690474606"><span class="hs-identifier hs-var">fldName</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; has type 'geometry' and cannot be used in order_by&quot;</span></span><span>
</span><span id="line-145"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) v.
ColumnInfo b -&gt; AnnotatedOrderByElement b v
</span><a href="Hasura.RQL.IR.Select.html#AOCColumn"><span class="hs-identifier hs-var">AOCColumn</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474602"><span class="hs-identifier hs-var">colInfo</span></a></span><span>
</span><span id="line-146"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FIRelationship"><span class="hs-identifier hs-type">FIRelationship</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres 'Vanilla)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#UnexpectedPayload"><span class="hs-identifier hs-var">UnexpectedPayload</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-148"></span><span>          </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621690474606"><span class="hs-identifier hs-var">fldName</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; is a relationship and should be expanded&quot;</span></span><span>
</span><span id="line-149"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FIComputedField"><span class="hs-identifier hs-type">FIComputedField</span></a></span><span> </span><span class="annot"><span class="annottext">ComputedFieldInfo ('Postgres 'Vanilla)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#UnexpectedPayload"><span class="hs-identifier hs-var">UnexpectedPayload</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-151"></span><span>          </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621690474606"><span class="hs-identifier hs-var">fldName</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; is a computed field and can't be used in 'order_by'&quot;</span></span><span>
</span><span id="line-152"></span><span>      </span><span class="hs-comment">-- TODO Rakesh (from master)</span><span>
</span><span id="line-153"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FIRemoteRelationship"><span class="hs-identifier hs-type">FIRemoteRelationship</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#UnexpectedPayload"><span class="hs-identifier hs-var">UnexpectedPayload</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621690474606"><span class="hs-identifier hs-var">fldName</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; is a remote field&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>  </span><span class="annot"><a href="Hasura.RQL.IR.OrderBy.html#OCRel"><span class="hs-identifier hs-type">OCRel</span></a></span><span> </span><span id="local-6989586621690474588"><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621690474588"><span class="hs-identifier hs-var">fldName</span></a></span></span><span> </span><span id="local-6989586621690474587"><span class="annot"><span class="annottext">OrderByCol
</span><a href="#local-6989586621690474587"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-156"></span><span>    </span><span id="local-6989586621690474586"><span class="annot"><span class="annottext">FieldInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474586"><span class="hs-identifier hs-var">fldInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) fieldInfo.
MonadError QErr m =&gt;
FieldInfoMap fieldInfo -&gt; FieldName -&gt; m fieldInfo
</span><a href="Hasura.RQL.Types.Table.html#askFieldInfo"><span class="hs-identifier hs-var">askFieldInfo</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474609"><span class="hs-identifier hs-var">flds</span></a></span><span> </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621690474588"><span class="hs-identifier hs-var">fldName</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FieldInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474586"><span class="hs-identifier hs-var">fldInfo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-158"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FIColumn"><span class="hs-identifier hs-type">FIColumn</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres 'Vanilla)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#UnexpectedPayload"><span class="hs-identifier hs-var">UnexpectedPayload</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-160"></span><span>          </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621690474588"><span class="hs-identifier hs-var">fldName</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; is a Postgres column and cannot be chained further&quot;</span></span><span>
</span><span id="line-161"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FIComputedField"><span class="hs-identifier hs-type">FIComputedField</span></a></span><span> </span><span class="annot"><span class="annottext">ComputedFieldInfo ('Postgres 'Vanilla)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#UnexpectedPayload"><span class="hs-identifier hs-var">UnexpectedPayload</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-163"></span><span>          </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621690474588"><span class="hs-identifier hs-var">fldName</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; is a computed field and can't be used in 'order_by'&quot;</span></span><span>
</span><span id="line-164"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FIRelationship"><span class="hs-identifier hs-type">FIRelationship</span></a></span><span> </span><span id="local-6989586621690474585"><span class="annot"><span class="annottext">RelInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474585"><span class="hs-identifier hs-var">relInfo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-165"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType). RelInfo b -&gt; RelType
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riType"><span class="hs-identifier hs-var">riType</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474585"><span class="hs-identifier hs-var">relInfo</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">RelType
</span><a href="Hasura.RQL.Types.Common.html#ArrRel"><span class="hs-identifier hs-var">ArrRel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-166"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#UnexpectedPayload"><span class="hs-identifier hs-var">UnexpectedPayload</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-167"></span><span>            </span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621690474588"><span class="hs-identifier hs-var">fldName</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; is an array relationship and can't be used in 'order_by'&quot;</span></span><span>
</span><span id="line-168"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621690474581"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474581"><span class="hs-identifier hs-var">relFim</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690474580"><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474580"><span class="hs-identifier hs-var">relSelPermInfo</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
RelName
-&gt; TableName ('Postgres 'Vanilla)
-&gt; m (FieldInfoMap (FieldInfo ('Postgres 'Vanilla)),
      SelPermInfo ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Internal.html#fetchRelDet"><span class="hs-identifier hs-var">fetchRelDet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType). RelInfo b -&gt; RelName
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riName"><span class="hs-identifier hs-var">riName</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474585"><span class="hs-identifier hs-var">relInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType). RelInfo b -&gt; TableName b
</span><a href="Hasura.RQL.Types.Relationships.Local.html#riRTable"><span class="hs-identifier hs-var">riRTable</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474585"><span class="hs-identifier hs-var">relInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>        </span><span id="local-6989586621690474579"><span class="annot"><span class="annottext">AnnBoolExp ('Postgres 'Vanilla) SQLExp
</span><a href="#local-6989586621690474579"><span class="hs-identifier hs-var">resolvedSelFltr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *).
Applicative f =&gt;
SessionVariableBuilder f
-&gt; AnnBoolExpPartialSQL ('Postgres 'Vanilla)
-&gt; f (AnnBoolExpSQL ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Internal.html#convAnnBoolExpPartialSQL"><span class="hs-identifier hs-var">convAnnBoolExpPartialSQL</span></a></span><span> </span><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621690474610"><span class="hs-identifier hs-var">sessVarBldr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). SelPermInfo b -&gt; AnnBoolExpPartialSQL b
</span><a href="Hasura.RQL.Types.Table.html#spiFilter"><span class="hs-identifier hs-var">spiFilter</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474580"><span class="hs-identifier hs-var">relSelPermInfo</span></a></span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><span class="annottext">forall (b :: BackendType) v.
RelInfo b
-&gt; AnnBoolExp b v
-&gt; AnnotatedOrderByElement b v
-&gt; AnnotatedOrderByElement b v
</span><a href="Hasura.RQL.IR.Select.html#AOCObjectRelation"><span class="hs-identifier hs-var">AOCObjectRelation</span></a></span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474585"><span class="hs-identifier hs-var">relInfo</span></a></span><span> </span><span class="annot"><span class="annottext">AnnBoolExp ('Postgres 'Vanilla) SQLExp
</span><a href="#local-6989586621690474579"><span class="hs-identifier hs-var">resolvedSelFltr</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
SessionVariableBuilder m
-&gt; (FieldInfoMap (FieldInfo ('Postgres 'Vanilla)),
    SelPermInfo ('Postgres 'Vanilla))
-&gt; OrderByCol
-&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)
</span><a href="Hasura.RQL.DML.Select.html#convOrderByElem"><span class="hs-identifier hs-var">convOrderByElem</span></a></span><span> </span><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621690474610"><span class="hs-identifier hs-var">sessVarBldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474581"><span class="hs-identifier hs-var">relFim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474580"><span class="hs-identifier hs-var">relSelPermInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OrderByCol
</span><a href="#local-6989586621690474587"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-171"></span><span>      </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FIRemoteRelationship"><span class="hs-identifier hs-type">FIRemoteRelationship</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#UnexpectedPayload"><span class="hs-identifier hs-var">UnexpectedPayload</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldName
</span><a href="#local-6989586621690474588"><span class="hs-identifier hs-var">fldName</span></a></span><span> </span><span class="annot"><span class="annottext">forall t. ToTxt t =&gt; t -&gt; Text -&gt; Text
</span><a href="Data.Text.Extended.html#%3C%3C%3E"><span class="hs-operator hs-var">&lt;&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; is a remote field&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span id="local-6989586621690475100"><span class="annot"><a href="Hasura.RQL.DML.Select.html#convSelectQ"><span class="hs-identifier hs-type">convSelectQ</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Session.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475100"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><a href="Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475100"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#TableInfoRM"><span class="hs-identifier hs-type">TableInfoRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690475100"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><a href="Hasura.Server.Types.html#HasServerConfigCtx"><span class="hs-identifier hs-type">HasServerConfigCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475100"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-180"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Backend.html#TableName"><span class="hs-identifier hs-type">TableName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FieldInfoMap"><span class="hs-identifier hs-type">FieldInfoMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- Table information of current table</span><span>
</span><span id="line-182"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#SelPermInfo"><span class="hs-identifier hs-type">SelPermInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- Additional select permission info</span><span>
</span><span id="line-183"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Select.html#SelectQExt"><span class="hs-identifier hs-type">SelectQExt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- Given Select Query</span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#SessionVariableBuilder"><span class="hs-identifier hs-type">SessionVariableBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475100"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ValueParser"><span class="hs-identifier hs-type">ValueParser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690475100"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><a href="#local-6989586621690475100"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnSimpleSelect"><span class="hs-identifier hs-type">AnnSimpleSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-187"></span><span id="convSelectQ"><span class="annot"><span class="annottext">convSelectQ :: forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m,
 HasServerConfigCtx m) =&gt;
TableName ('Postgres 'Vanilla)
-&gt; FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; SelectQExt
-&gt; SessionVariableBuilder m
-&gt; ValueParser ('Postgres 'Vanilla) m SQLExp
-&gt; m (AnnSimpleSelect ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Select.html#convSelectQ"><span class="hs-identifier hs-var hs-var">convSelectQ</span></a></span></span><span> </span><span id="local-6989586621690474501"><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474501"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span id="local-6989586621690474500"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474500"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span></span><span> </span><span id="local-6989586621690474499"><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474499"><span class="hs-identifier hs-var">selPermInfo</span></a></span></span><span> </span><span id="local-6989586621690474498"><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621690474498"><span class="hs-identifier hs-var">selQ</span></a></span></span><span> </span><span id="local-6989586621690474497"><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621690474497"><span class="hs-identifier hs-var">sessVarBldr</span></a></span></span><span> </span><span id="local-6989586621690474496"><span class="annot"><span class="annottext">ValueParser ('Postgres 'Vanilla) m SQLExp
</span><a href="#local-6989586621690474496"><span class="hs-identifier hs-var">prepValBldr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-comment">-- Convert where clause</span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621690474495"><span class="annot"><span class="annottext">Maybe (AnnBoolExp ('Postgres 'Vanilla) SQLExp)
</span><a href="#local-6989586621690474495"><span class="hs-identifier hs-var">wClause</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. SelectG a b c -&gt; Maybe b
</span><a href="Hasura.RQL.DML.Types.html#sqWhere"><span class="hs-identifier hs-var">sqWhere</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621690474498"><span class="hs-identifier hs-var">selQ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621690474493"><span class="annot"><span class="annottext">BoolExp ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474493"><span class="hs-identifier hs-var">boolExp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;where&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-191"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; BoolExp ('Postgres 'Vanilla)
-&gt; SessionVariableBuilder m
-&gt; TableName ('Postgres 'Vanilla)
-&gt; ValueParser
     ('Postgres 'Vanilla) m (SQLExpression ('Postgres 'Vanilla))
-&gt; m (AnnBoolExpSQL ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Internal.html#convBoolExp"><span class="hs-identifier hs-var">convBoolExp</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474500"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474499"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span> </span><span class="annot"><span class="annottext">BoolExp ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474493"><span class="hs-identifier hs-var">boolExp</span></a></span><span> </span><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621690474497"><span class="hs-identifier hs-var">sessVarBldr</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474501"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">ValueParser ('Postgres 'Vanilla) m SQLExp
</span><a href="#local-6989586621690474496"><span class="hs-identifier hs-var">prepValBldr</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span>  </span><span id="local-6989586621690474491"><span class="annot"><span class="annottext">[(FieldName, AnnFieldG ('Postgres 'Vanilla) Void SQLExp)]
</span><a href="#local-6989586621690474491"><span class="hs-identifier hs-var">annFlds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;columns&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. QErrM m =&gt; [a] -&gt; (a -&gt; m b) -&gt; m [b]
</span><a href="Hasura.Base.Error.html#indexedForM"><span class="hs-identifier hs-var">indexedForM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. SelectG a b c -&gt; [a]
</span><a href="Hasura.RQL.DML.Types.html#sqColumns"><span class="hs-identifier hs-var">sqColumns</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621690474498"><span class="hs-identifier hs-var">selQ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-195"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ECSimple"><span class="hs-identifier hs-type">ECSimple</span></a></span><span> </span><span id="local-6989586621690474489"><span class="annot"><span class="annottext">Column ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474489"><span class="hs-identifier hs-var">pgCol</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-196"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621690474488"><span class="annot"><span class="annottext">ColumnInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474488"><span class="hs-identifier hs-var">colInfo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690474487"><span class="annot"><span class="annottext">Maybe (AnnColumnCaseBoolExpPartialSQL ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474487"><span class="hs-identifier hs-var">caseBoolExpMaybe</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; PGCol
-&gt; m (ColumnInfo ('Postgres 'Vanilla),
      Maybe (AnnColumnCaseBoolExpPartialSQL ('Postgres 'Vanilla)))
</span><a href="Hasura.RQL.DML.Select.html#convExtSimple"><span class="hs-identifier hs-var">convExtSimple</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474500"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474499"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Column ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474489"><span class="hs-identifier hs-var">pgCol</span></a></span><span>
</span><span id="line-197"></span><span>        </span><span id="local-6989586621690474485"><span class="annot"><span class="annottext">Maybe (AnnColumnCaseBoolExp ('Postgres 'Vanilla) SQLExp)
</span><a href="#local-6989586621690474485"><span class="hs-identifier hs-var">resolvedCaseBoolExp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-198"></span><span>          </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *).
Applicative f =&gt;
SessionVariableBuilder f
-&gt; AnnColumnCaseBoolExpPartialSQL ('Postgres 'Vanilla)
-&gt; f (AnnColumnCaseBoolExp
        ('Postgres 'Vanilla) (SQLExpression ('Postgres 'Vanilla)))
</span><a href="Hasura.RQL.DML.Internal.html#convAnnColumnCaseBoolExpPartialSQL"><span class="hs-identifier hs-var">convAnnColumnCaseBoolExpPartialSQL</span></a></span><span> </span><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621690474497"><span class="hs-identifier hs-var">sessVarBldr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (AnnColumnCaseBoolExpPartialSQL ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474487"><span class="hs-identifier hs-var">caseBoolExpMaybe</span></a></span><span>
</span><span id="line-199"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType). Backend b =&gt; Column b -&gt; FieldName
</span><a href="Hasura.RQL.Types.Column.html#fromCol"><span class="hs-identifier hs-var">fromCol</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Column ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474489"><span class="hs-identifier hs-var">pgCol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (backend :: BackendType) v r.
Column backend
-&gt; ColumnType backend
-&gt; Maybe (AnnColumnCaseBoolExp backend v)
-&gt; Maybe (ScalarSelectionArguments backend)
-&gt; AnnFieldG backend r v
</span><a href="Hasura.RQL.IR.Select.html#mkAnnColumnField"><span class="hs-identifier hs-var">mkAnnColumnField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType). ColumnInfo b -&gt; Column b
</span><a href="Hasura.RQL.Types.Column.html#ciColumn"><span class="hs-identifier hs-var">ciColumn</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474488"><span class="hs-identifier hs-var">colInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType). ColumnInfo b -&gt; ColumnType b
</span><a href="Hasura.RQL.Types.Column.html#ciType"><span class="hs-identifier hs-var">ciType</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474488"><span class="hs-identifier hs-var">colInfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (AnnColumnCaseBoolExp ('Postgres 'Vanilla) SQLExp)
</span><a href="#local-6989586621690474485"><span class="hs-identifier hs-var">resolvedCaseBoolExp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Select.html#ECRel"><span class="hs-identifier hs-type">ECRel</span></a></span><span> </span><span id="local-6989586621690474480"><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690474480"><span class="hs-identifier hs-var">relName</span></a></span></span><span> </span><span id="local-6989586621690474479"><span class="annot"><span class="annottext">Maybe RelName
</span><a href="#local-6989586621690474479"><span class="hs-identifier hs-var">mAlias</span></a></span></span><span> </span><span id="local-6989586621690474478"><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621690474478"><span class="hs-identifier hs-var">relSelQ</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-201"></span><span>        </span><span id="local-6989586621690474477"><span class="annot"><span class="annottext">Either
  (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
  (ArraySelectG ('Postgres 'Vanilla) Void SQLExp)
</span><a href="#local-6989586621690474477"><span class="hs-identifier hs-var">annRel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-202"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m,
 HasServerConfigCtx m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; RelName
-&gt; Maybe RelName
-&gt; SelectQExt
-&gt; SessionVariableBuilder m
-&gt; ValueParser ('Postgres 'Vanilla) m SQLExp
-&gt; m (Either
        (ObjectRelationSelect ('Postgres 'Vanilla))
        (ArraySelect ('Postgres 'Vanilla)))
</span><a href="Hasura.RQL.DML.Select.html#convExtRel"><span class="hs-identifier hs-var">convExtRel</span></a></span><span>
</span><span id="line-203"></span><span>            </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474500"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span>
</span><span id="line-204"></span><span>            </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690474480"><span class="hs-identifier hs-var">relName</span></a></span><span>
</span><span id="line-205"></span><span>            </span><span class="annot"><span class="annottext">Maybe RelName
</span><a href="#local-6989586621690474479"><span class="hs-identifier hs-var">mAlias</span></a></span><span>
</span><span id="line-206"></span><span>            </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621690474478"><span class="hs-identifier hs-var">relSelQ</span></a></span><span>
</span><span id="line-207"></span><span>            </span><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621690474497"><span class="hs-identifier hs-var">sessVarBldr</span></a></span><span>
</span><span id="line-208"></span><span>            </span><span class="annot"><span class="annottext">ValueParser ('Postgres 'Vanilla) m SQLExp
</span><a href="#local-6989586621690474496"><span class="hs-identifier hs-var">prepValBldr</span></a></span><span>
</span><span id="line-209"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-210"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">RelName -&gt; FieldName
</span><a href="Hasura.RQL.Types.Relationships.Local.html#fromRel"><span class="hs-identifier hs-var">fromRel</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690474480"><span class="hs-identifier hs-var">relName</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RelName
</span><a href="#local-6989586621690474479"><span class="hs-identifier hs-var">mAlias</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-211"></span><span>            </span><span class="annot"><span class="annottext">forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) r v.
ObjectRelationSelectG b r v -&gt; AnnFieldG b r v
</span><a href="Hasura.RQL.IR.Select.html#AFObjectRelation"><span class="hs-identifier hs-var">AFObjectRelation</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) r v.
ArraySelectG b r v -&gt; AnnFieldG b r v
</span><a href="Hasura.RQL.IR.Select.html#AFArrayRelation"><span class="hs-identifier hs-var">AFArrayRelation</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  (ObjectRelationSelectG ('Postgres 'Vanilla) Void SQLExp)
  (ArraySelectG ('Postgres 'Vanilla) Void SQLExp)
</span><a href="#local-6989586621690474477"><span class="hs-identifier hs-var">annRel</span></a></span><span>
</span><span id="line-212"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span>  </span><span id="local-6989586621690474470"><span class="annot"><span class="annottext">Maybe
  [OrderByItemG
     ('Postgres 'Vanilla)
     (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)]
</span><a href="#local-6989586621690474470"><span class="hs-identifier hs-var">annOrdByML</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. SelectG a b c -&gt; Maybe OrderByExp
</span><a href="Hasura.RQL.DML.Types.html#sqOrderBy"><span class="hs-identifier hs-var">sqOrderBy</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621690474498"><span class="hs-identifier hs-var">selQ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#OrderByExp"><span class="hs-identifier hs-type">OrderByExp</span></a></span><span> </span><span id="local-6989586621690474467"><span class="annot"><span class="annottext">[OrderByItem ('Postgres 'Vanilla)]
</span><a href="#local-6989586621690474467"><span class="hs-identifier hs-var">obItems</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;order_by&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-216"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. QErrM m =&gt; [a] -&gt; (a -&gt; m b) -&gt; m [b]
</span><a href="Hasura.Base.Error.html#indexedForM"><span class="hs-identifier hs-var">indexedForM</span></a></span><span> </span><span class="annot"><span class="annottext">[OrderByItem ('Postgres 'Vanilla)]
</span><a href="#local-6989586621690474467"><span class="hs-identifier hs-var">obItems</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-218"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
SessionVariableBuilder m
-&gt; (FieldInfoMap (FieldInfo ('Postgres 'Vanilla)),
    SelPermInfo ('Postgres 'Vanilla))
-&gt; OrderByCol
-&gt; m (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)
</span><a href="Hasura.RQL.DML.Select.html#convOrderByElem"><span class="hs-identifier hs-var">convOrderByElem</span></a></span><span> </span><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621690474497"><span class="hs-identifier hs-var">sessVarBldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474500"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474499"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690474466"><span class="annot"><span class="annottext">annOrdByM :: Maybe
  (NonEmpty
     (OrderByItemG
        ('Postgres 'Vanilla)
        (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)))
</span><a href="#local-6989586621690474466"><span class="hs-identifier hs-var hs-var">annOrdByM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe (NonEmpty a)
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">NE.nonEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe
  [OrderByItemG
     ('Postgres 'Vanilla)
     (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)]
</span><a href="#local-6989586621690474470"><span class="hs-identifier hs-var">annOrdByML</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-comment">-- validate limit and offset values</span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;limit&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadError QErr m =&gt; Int -&gt; m ()
</span><a href="Hasura.RQL.DML.Internal.html#onlyPositiveInt"><span class="hs-identifier hs-var">onlyPositiveInt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621690474461"><span class="hs-identifier hs-var">mQueryLimit</span></a></span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;offset&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadError QErr m =&gt; Int -&gt; m ()
</span><a href="Hasura.RQL.DML.Internal.html#onlyPositiveInt"><span class="hs-identifier hs-var">onlyPositiveInt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621690474460"><span class="hs-identifier hs-var">mQueryOffset</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span>  </span><span id="local-6989586621690474459"><span class="annot"><span class="annottext">AnnBoolExp ('Postgres 'Vanilla) SQLExp
</span><a href="#local-6989586621690474459"><span class="hs-identifier hs-var">resolvedSelFltr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *).
Applicative f =&gt;
SessionVariableBuilder f
-&gt; AnnBoolExpPartialSQL ('Postgres 'Vanilla)
-&gt; f (AnnBoolExpSQL ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Internal.html#convAnnBoolExpPartialSQL"><span class="hs-identifier hs-var">convAnnBoolExpPartialSQL</span></a></span><span> </span><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621690474497"><span class="hs-identifier hs-var">sessVarBldr</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-228"></span><span>      </span><span class="annot"><span class="annottext">forall (b :: BackendType). SelPermInfo b -&gt; AnnBoolExpPartialSQL b
</span><a href="Hasura.RQL.Types.Table.html#spiFilter"><span class="hs-identifier hs-var">spiFilter</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474499"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690474458"><span class="annot"><span class="annottext">tabFrom :: SelectFromG ('Postgres 'Vanilla) SQLExp
</span><a href="#local-6989586621690474458"><span class="hs-identifier hs-var hs-var">tabFrom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) v. TableName b -&gt; SelectFromG b v
</span><a href="Hasura.RQL.IR.Select.html#FromTable"><span class="hs-identifier hs-var">FromTable</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474501"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-231"></span><span>      </span><span id="local-6989586621690474456"><span class="annot"><span class="annottext">tabPerm :: TablePermG ('Postgres 'Vanilla) SQLExp
</span><a href="#local-6989586621690474456"><span class="hs-identifier hs-var hs-var">tabPerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) v.
AnnBoolExp b v -&gt; Maybe Int -&gt; TablePermG b v
</span><a href="Hasura.RQL.IR.Select.html#TablePerm"><span class="hs-identifier hs-var">TablePerm</span></a></span><span> </span><span class="annot"><span class="annottext">AnnBoolExp ('Postgres 'Vanilla) SQLExp
</span><a href="#local-6989586621690474459"><span class="hs-identifier hs-var">resolvedSelFltr</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621690474454"><span class="hs-identifier hs-var">mPermLimit</span></a></span><span>
</span><span id="line-232"></span><span>      </span><span id="local-6989586621690474453"><span class="annot"><span class="annottext">tabArgs :: SelectArgsG ('Postgres 'Vanilla) SQLExp
</span><a href="#local-6989586621690474453"><span class="hs-identifier hs-var hs-var">tabArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) v.
Maybe (AnnBoolExp b v)
-&gt; Maybe (NonEmpty (AnnotatedOrderByItemG b v))
-&gt; Maybe Int
-&gt; Maybe Int64
-&gt; Maybe (NonEmpty (Column b))
-&gt; SelectArgsG b v
</span><a href="Hasura.RQL.IR.Select.html#SelectArgs"><span class="hs-identifier hs-var">SelectArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (AnnBoolExp ('Postgres 'Vanilla) SQLExp)
</span><a href="#local-6989586621690474495"><span class="hs-identifier hs-var">wClause</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe
  (NonEmpty
     (OrderByItemG
        ('Postgres 'Vanilla)
        (AnnotatedOrderByElement ('Postgres 'Vanilla) SQLExp)))
</span><a href="#local-6989586621690474466"><span class="hs-identifier hs-var">annOrdByM</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621690474461"><span class="hs-identifier hs-var">mQueryLimit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621690474460"><span class="hs-identifier hs-var">mQueryOffset</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span>  </span><span id="local-6989586621690474451"><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690474451"><span class="hs-identifier hs-var">strfyNum</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SQLGenCtx -&gt; StringifyNumbers
</span><a href="Hasura.RQL.Types.Common.html#stringifyNum"><span class="hs-identifier hs-var">stringifyNum</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ServerConfigCtx -&gt; SQLGenCtx
</span><a href="Hasura.Server.Types.html#_sccSQLGenCtx"><span class="hs-identifier hs-var">_sccSQLGenCtx</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). HasServerConfigCtx m =&gt; m ServerConfigCtx
</span><a href="Hasura.Server.Types.html#askServerConfigCtx"><span class="hs-identifier hs-var">askServerConfigCtx</span></a></span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) (f :: * -&gt; *) v.
Fields (f v)
-&gt; SelectFromG b v
-&gt; TablePermG b v
-&gt; SelectArgsG b v
-&gt; StringifyNumbers
-&gt; Maybe NamingCase
-&gt; AnnSelectG b f v
</span><a href="Hasura.RQL.IR.Select.html#AnnSelectG"><span class="hs-identifier hs-var">AnnSelectG</span></a></span><span> </span><span class="annot"><span class="annottext">[(FieldName, AnnFieldG ('Postgres 'Vanilla) Void SQLExp)]
</span><a href="#local-6989586621690474491"><span class="hs-identifier hs-var">annFlds</span></a></span><span> </span><span class="annot"><span class="annottext">SelectFromG ('Postgres 'Vanilla) SQLExp
</span><a href="#local-6989586621690474458"><span class="hs-identifier hs-var">tabFrom</span></a></span><span> </span><span class="annot"><span class="annottext">TablePermG ('Postgres 'Vanilla) SQLExp
</span><a href="#local-6989586621690474456"><span class="hs-identifier hs-var">tabPerm</span></a></span><span> </span><span class="annot"><span class="annottext">SelectArgsG ('Postgres 'Vanilla) SQLExp
</span><a href="#local-6989586621690474453"><span class="hs-identifier hs-var">tabArgs</span></a></span><span> </span><span class="annot"><span class="annottext">StringifyNumbers
</span><a href="#local-6989586621690474451"><span class="hs-identifier hs-var">strfyNum</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-237"></span><span>    </span><span id="local-6989586621690474460"><span class="annot"><span class="annottext">mQueryOffset :: Maybe Int
</span><a href="#local-6989586621690474460"><span class="hs-identifier hs-var hs-var">mQueryOffset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c. SelectG a b c -&gt; Maybe c
</span><a href="Hasura.RQL.DML.Types.html#sqOffset"><span class="hs-identifier hs-var">sqOffset</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621690474498"><span class="hs-identifier hs-var">selQ</span></a></span><span>
</span><span id="line-238"></span><span>    </span><span id="local-6989586621690474461"><span class="annot"><span class="annottext">mQueryLimit :: Maybe Int
</span><a href="#local-6989586621690474461"><span class="hs-identifier hs-var hs-var">mQueryLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c. SelectG a b c -&gt; Maybe c
</span><a href="Hasura.RQL.DML.Types.html#sqLimit"><span class="hs-identifier hs-var">sqLimit</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621690474498"><span class="hs-identifier hs-var">selQ</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span id="local-6989586621690474454"><span class="annot"><span class="annottext">mPermLimit :: Maybe Int
</span><a href="#local-6989586621690474454"><span class="hs-identifier hs-var hs-var">mPermLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). SelPermInfo b -&gt; Maybe Int
</span><a href="Hasura.RQL.Types.Table.html#spiLimit"><span class="hs-identifier hs-var">spiLimit</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474499"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span id="local-6989586621690475083"><span class="annot"><a href="Hasura.RQL.DML.Select.html#convExtSimple"><span class="hs-identifier hs-type">convExtSimple</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Session.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475083"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475083"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FieldInfoMap"><span class="hs-identifier hs-type">FieldInfoMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#SelPermInfo"><span class="hs-identifier hs-type">SelPermInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.Types.html#PGCol"><span class="hs-identifier hs-type">PGCol</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><a href="#local-6989586621690475083"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ColumnInfo"><span class="hs-identifier hs-type">ColumnInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.BoolExp.html#AnnColumnCaseBoolExpPartialSQL"><span class="hs-identifier hs-type">AnnColumnCaseBoolExpPartialSQL</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-247"></span><span id="convExtSimple"><span class="annot"><span class="annottext">convExtSimple :: forall (m :: * -&gt; *).
(UserInfoM m, QErrM m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; PGCol
-&gt; m (ColumnInfo ('Postgres 'Vanilla),
      Maybe (AnnColumnCaseBoolExpPartialSQL ('Postgres 'Vanilla)))
</span><a href="Hasura.RQL.DML.Select.html#convExtSimple"><span class="hs-identifier hs-var hs-var">convExtSimple</span></a></span></span><span> </span><span id="local-6989586621690474429"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474429"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span></span><span> </span><span id="local-6989586621690474428"><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474428"><span class="hs-identifier hs-var">selPermInfo</span></a></span></span><span> </span><span id="local-6989586621690474427"><span class="annot"><span class="annottext">PGCol
</span><a href="#local-6989586621690474427"><span class="hs-identifier hs-var">pgCol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m) =&gt;
SelPermInfo ('Postgres 'Vanilla)
-&gt; Column ('Postgres 'Vanilla) -&gt; m ()
</span><a href="Hasura.RQL.DML.Internal.html#checkSelOnCol"><span class="hs-identifier hs-var">checkSelOnCol</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474428"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span> </span><span class="annot"><span class="annottext">PGCol
</span><a href="#local-6989586621690474427"><span class="hs-identifier hs-var">pgCol</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span id="local-6989586621690474426"><span class="annot"><span class="annottext">ColumnInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474426"><span class="hs-identifier hs-var">colInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (backend :: BackendType).
(MonadError QErr m, Backend backend) =&gt;
FieldInfoMap (FieldInfo backend)
-&gt; Column backend -&gt; Text -&gt; m (ColumnInfo backend)
</span><a href="Hasura.RQL.Types.Table.html#askColInfo"><span class="hs-identifier hs-var">askColInfo</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474429"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span> </span><span class="annot"><span class="annottext">PGCol
</span><a href="#local-6989586621690474427"><span class="hs-identifier hs-var">pgCol</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690474424"><span class="hs-identifier hs-var">relWhenPGErr</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ColumnInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474426"><span class="hs-identifier hs-var">colInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">join</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">HM.lookup</span></span><span> </span><span class="annot"><span class="annottext">PGCol
</span><a href="#local-6989586621690474427"><span class="hs-identifier hs-var">pgCol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType).
SelPermInfo b
-&gt; HashMap (Column b) (Maybe (AnnColumnCaseBoolExpPartialSQL b))
</span><a href="Hasura.RQL.Types.Table.html#spiCols"><span class="hs-identifier hs-var">spiCols</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474428"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621690474424"><span class="annot"><span class="annottext">relWhenPGErr :: Text
</span><a href="#local-6989586621690474424"><span class="hs-identifier hs-var hs-var">relWhenPGErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;relationships have to be expanded&quot;</span></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span id="local-6989586621690475070"><span class="annot"><a href="Hasura.RQL.DML.Select.html#convExtRel"><span class="hs-identifier hs-type">convExtRel</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Session.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475070"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><a href="Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475070"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#TableInfoRM"><span class="hs-identifier hs-type">TableInfoRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690475070"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-258"></span><span>    </span><span class="annot"><a href="Hasura.Server.Types.html#HasServerConfigCtx"><span class="hs-identifier hs-type">HasServerConfigCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475070"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FieldInfoMap"><span class="hs-identifier hs-type">FieldInfoMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Table.html#FieldInfo"><span class="hs-identifier hs-type">FieldInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-261"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#RelName"><span class="hs-identifier hs-type">RelName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#RelName"><span class="hs-identifier hs-type">RelName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-263"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Select.html#SelectQExt"><span class="hs-identifier hs-type">SelectQExt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-264"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#SessionVariableBuilder"><span class="hs-identifier hs-type">SessionVariableBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690475070"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-265"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ValueParser"><span class="hs-identifier hs-type">ValueParser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690475070"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-266"></span><span>  </span><span class="annot"><a href="#local-6989586621690475070"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ObjectRelationSelect"><span class="hs-identifier hs-type">ObjectRelationSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#ArraySelect"><span class="hs-identifier hs-type">ArraySelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-267"></span><span id="convExtRel"><span class="annot"><span class="annottext">convExtRel :: forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m,
 HasServerConfigCtx m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; RelName
-&gt; Maybe RelName
-&gt; SelectQExt
-&gt; SessionVariableBuilder m
-&gt; ValueParser ('Postgres 'Vanilla) m SQLExp
-&gt; m (Either
        (ObjectRelationSelect ('Postgres 'Vanilla))
        (ArraySelect ('Postgres 'Vanilla)))
</span><a href="Hasura.RQL.DML.Select.html#convExtRel"><span class="hs-identifier hs-var hs-var">convExtRel</span></a></span></span><span> </span><span id="local-6989586621690474396"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474396"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span></span><span> </span><span id="local-6989586621690474395"><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690474395"><span class="hs-identifier hs-var">relName</span></a></span></span><span> </span><span id="local-6989586621690474394"><span class="annot"><span class="annottext">Maybe RelName
</span><a href="#local-6989586621690474394"><span class="hs-identifier hs-var">mAlias</span></a></span></span><span> </span><span id="local-6989586621690474393"><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621690474393"><span class="hs-identifier hs-var">selQ</span></a></span></span><span> </span><span id="local-6989586621690474392"><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621690474392"><span class="hs-identifier hs-var">sessVarBldr</span></a></span></span><span> </span><span id="local-6989586621690474391"><span class="annot"><span class="annottext">ValueParser ('Postgres 'Vanilla) m SQLExp
</span><a href="#local-6989586621690474391"><span class="hs-identifier hs-var">prepValBldr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-comment">-- Point to the name key</span><span>
</span><span id="line-269"></span><span>  </span><span id="local-6989586621690474390"><span class="annot"><span class="annottext">RelInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474390"><span class="hs-identifier hs-var">relInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-270"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-271"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (backend :: BackendType).
MonadError QErr m =&gt;
FieldInfoMap (FieldInfo backend)
-&gt; RelName -&gt; Text -&gt; m (RelInfo backend)
</span><a href="Hasura.RQL.Types.Table.html#askRelType"><span class="hs-identifier hs-var">askRelType</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474396"><span class="hs-identifier hs-var">fieldInfoMap</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690474395"><span class="hs-identifier hs-var">relName</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690474389"><span class="hs-identifier hs-var">pgWhenRelErr</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.Types.Relationships.Local.html#RelInfo"><span class="hs-identifier hs-type">RelInfo</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621690474388"><span class="annot"><span class="annottext">RelType
</span><a href="#local-6989586621690474388"><span class="hs-identifier hs-var">relTy</span></a></span></span><span> </span><span id="local-6989586621690474387"><span class="annot"><span class="annottext">HashMap (Column ('Postgres 'Vanilla)) (Column ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474387"><span class="hs-identifier hs-var">colMapping</span></a></span></span><span> </span><span id="local-6989586621690474386"><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474386"><span class="hs-identifier hs-var">relTab</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">InsertOrder
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RelInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474390"><span class="hs-identifier hs-var">relInfo</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621690474385"><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474385"><span class="hs-identifier hs-var">relCIM</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690474384"><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474384"><span class="hs-identifier hs-var">relSPI</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
RelName
-&gt; TableName ('Postgres 'Vanilla)
-&gt; m (FieldInfoMap (FieldInfo ('Postgres 'Vanilla)),
      SelPermInfo ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Internal.html#fetchRelDet"><span class="hs-identifier hs-var">fetchRelDet</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690474395"><span class="hs-identifier hs-var">relName</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474386"><span class="hs-identifier hs-var">relTab</span></a></span><span>
</span><span id="line-274"></span><span>  </span><span id="local-6989586621690474383"><span class="annot"><span class="annottext">AnnSelectG
  ('Postgres 'Vanilla) (AnnFieldG ('Postgres 'Vanilla) Void) SQLExp
</span><a href="#local-6989586621690474383"><span class="hs-identifier hs-var">annSel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m,
 HasServerConfigCtx m) =&gt;
TableName ('Postgres 'Vanilla)
-&gt; FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; SelectQExt
-&gt; SessionVariableBuilder m
-&gt; ValueParser ('Postgres 'Vanilla) m SQLExp
-&gt; m (AnnSimpleSelect ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Select.html#convSelectQ"><span class="hs-identifier hs-var">convSelectQ</span></a></span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474386"><span class="hs-identifier hs-var">relTab</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474385"><span class="hs-identifier hs-var">relCIM</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474384"><span class="hs-identifier hs-var">relSPI</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621690474393"><span class="hs-identifier hs-var">selQ</span></a></span><span> </span><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621690474392"><span class="hs-identifier hs-var">sessVarBldr</span></a></span><span> </span><span class="annot"><span class="annottext">ValueParser ('Postgres 'Vanilla) m SQLExp
</span><a href="#local-6989586621690474391"><span class="hs-identifier hs-var">prepValBldr</span></a></span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RelType
</span><a href="#local-6989586621690474388"><span class="hs-identifier hs-var">relTy</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><span class="annottext">RelType
</span><a href="Hasura.RQL.Types.Common.html#ObjRel"><span class="hs-identifier hs-var">ObjRel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-277"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621690474381"><span class="hs-identifier hs-var">misused</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Code -&gt; Text -&gt; m a
</span><a href="Hasura.Base.Error.html#throw400"><span class="hs-identifier hs-var">throw400</span></a></span><span> </span><span class="annot"><span class="annottext">Code
</span><a href="Hasura.Base.Error.html#UnexpectedPayload"><span class="hs-identifier hs-var">UnexpectedPayload</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621690474380"><span class="hs-identifier hs-var">objRelMisuseMsg</span></a></span><span>
</span><span id="line-278"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-279"></span><span>        </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-280"></span><span>          </span><span class="annot"><span class="annottext">forall (b :: BackendType) a.
RelName
-&gt; HashMap (Column b) (Column b) -&gt; a -&gt; AnnRelationSelectG b a
</span><a href="Hasura.RQL.IR.Select.html#AnnRelationSelectG"><span class="hs-identifier hs-var">AnnRelationSelectG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690474395"><span class="hs-identifier hs-var">relName</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RelName
</span><a href="#local-6989586621690474394"><span class="hs-identifier hs-var">mAlias</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashMap (Column ('Postgres 'Vanilla)) (Column ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474387"><span class="hs-identifier hs-var">colMapping</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-281"></span><span>            </span><span class="annot"><span class="annottext">forall (b :: BackendType) r v.
AnnFieldsG b r v
-&gt; TableName b -&gt; AnnBoolExp b v -&gt; AnnObjectSelectG b r v
</span><a href="Hasura.RQL.IR.Select.html#AnnObjectSelectG"><span class="hs-identifier hs-var">AnnObjectSelectG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (b :: BackendType) (f :: * -&gt; *) v.
AnnSelectG b f v -&gt; Fields (f v)
</span><a href="Hasura.RQL.IR.Select.html#%24sel%3A_asnFields%3AAnnSelectG"><span class="hs-identifier hs-var">_asnFields</span></a></span><span> </span><span class="annot"><span class="annottext">AnnSelectG
  ('Postgres 'Vanilla) (AnnFieldG ('Postgres 'Vanilla) Void) SQLExp
</span><a href="#local-6989586621690474383"><span class="hs-identifier hs-var">annSel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TableName ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474386"><span class="hs-identifier hs-var">relTab</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) v. TablePermG b v -&gt; AnnBoolExp b v
</span><a href="Hasura.RQL.IR.Select.html#%24sel%3A_tpFilter%3ATablePerm"><span class="hs-identifier hs-var">_tpFilter</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) (f :: * -&gt; *) v.
AnnSelectG b f v -&gt; TablePermG b v
</span><a href="Hasura.RQL.IR.Select.html#%24sel%3A_asnPerm%3AAnnSelectG"><span class="hs-identifier hs-var">_asnPerm</span></a></span><span> </span><span class="annot"><span class="annottext">AnnSelectG
  ('Postgres 'Vanilla) (AnnFieldG ('Postgres 'Vanilla) Void) SQLExp
</span><a href="#local-6989586621690474383"><span class="hs-identifier hs-var">annSel</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><span class="annottext">RelType
</span><a href="Hasura.RQL.Types.Common.html#ArrRel"><span class="hs-identifier hs-var">ArrRel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-283"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-284"></span><span>        </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-285"></span><span>          </span><span class="annot"><span class="annottext">forall (b :: BackendType) r v.
ArrayRelationSelectG b r v -&gt; ArraySelectG b r v
</span><a href="Hasura.RQL.IR.Select.html#ASSimple"><span class="hs-identifier hs-var">ASSimple</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-286"></span><span>            </span><span class="annot"><span class="annottext">forall (b :: BackendType) a.
RelName
-&gt; HashMap (Column b) (Column b) -&gt; a -&gt; AnnRelationSelectG b a
</span><a href="Hasura.RQL.IR.Select.html#AnnRelationSelectG"><span class="hs-identifier hs-var">AnnRelationSelectG</span></a></span><span>
</span><span id="line-287"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">RelName
</span><a href="#local-6989586621690474395"><span class="hs-identifier hs-var">relName</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RelName
</span><a href="#local-6989586621690474394"><span class="hs-identifier hs-var">mAlias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>              </span><span class="annot"><span class="annottext">HashMap (Column ('Postgres 'Vanilla)) (Column ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474387"><span class="hs-identifier hs-var">colMapping</span></a></span><span>
</span><span id="line-289"></span><span>              </span><span class="annot"><span class="annottext">AnnSelectG
  ('Postgres 'Vanilla) (AnnFieldG ('Postgres 'Vanilla) Void) SQLExp
</span><a href="#local-6989586621690474383"><span class="hs-identifier hs-var">annSel</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-291"></span><span>    </span><span id="local-6989586621690474389"><span class="annot"><span class="annottext">pgWhenRelErr :: Text
</span><a href="#local-6989586621690474389"><span class="hs-identifier hs-var hs-var">pgWhenRelErr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;only relationships can be expanded&quot;</span></span><span>
</span><span id="line-292"></span><span>    </span><span id="local-6989586621690474381"><span class="annot"><span class="annottext">misused :: Bool
</span><a href="#local-6989586621690474381"><span class="hs-identifier hs-var hs-var">misused</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-293"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">or</span></a></span><span>
</span><span id="line-294"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. SelectG a b c -&gt; Maybe b
</span><a href="Hasura.RQL.DML.Types.html#sqWhere"><span class="hs-identifier hs-var">sqWhere</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621690474393"><span class="hs-identifier hs-var">selQ</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-295"></span><span>          </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. SelectG a b c -&gt; Maybe c
</span><a href="Hasura.RQL.DML.Types.html#sqLimit"><span class="hs-identifier hs-var">sqLimit</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621690474393"><span class="hs-identifier hs-var">selQ</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-296"></span><span>          </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. SelectG a b c -&gt; Maybe c
</span><a href="Hasura.RQL.DML.Types.html#sqOffset"><span class="hs-identifier hs-var">sqOffset</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621690474393"><span class="hs-identifier hs-var">selQ</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-297"></span><span>          </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">isJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. SelectG a b c -&gt; Maybe OrderByExp
</span><a href="Hasura.RQL.DML.Types.html#sqOrderBy"><span class="hs-identifier hs-var">sqOrderBy</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621690474393"><span class="hs-identifier hs-var">selQ</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-299"></span><span>    </span><span id="local-6989586621690474380"><span class="annot"><span class="annottext">objRelMisuseMsg :: Text
</span><a href="#local-6989586621690474380"><span class="hs-identifier hs-var hs-var">objRelMisuseMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-300"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;when selecting an 'obj_relationship' 'where', 'order_by', 'limit' and 'offset'  can't be used&quot;</span></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span id="local-6989586621690474991"><span class="annot"><a href="Hasura.RQL.DML.Select.html#convSelectQuery"><span class="hs-identifier hs-type">convSelectQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Session.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690474991"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><a href="Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690474991"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#TableInfoRM"><span class="hs-identifier hs-type">TableInfoRM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690474991"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><a href="Hasura.Server.Types.html#HasServerConfigCtx"><span class="hs-identifier hs-type">HasServerConfigCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690474991"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-308"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Internal.html#SessionVariableBuilder"><span class="hs-identifier hs-type">SessionVariableBuilder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690474991"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-309"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Column.html#ValueParser"><span class="hs-identifier hs-type">ValueParser</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621690474991"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.Backends.Postgres.SQL.DML.html#SQLExp"><span class="hs-identifier hs-type">S.SQLExp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-310"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SelectQuery"><span class="hs-identifier hs-type">SelectQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-311"></span><span>  </span><span class="annot"><a href="#local-6989586621690474991"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnSimpleSelect"><span class="hs-identifier hs-type">AnnSimpleSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-312"></span><span id="convSelectQuery"><span class="annot"><span class="annottext">convSelectQuery :: forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m,
 HasServerConfigCtx m) =&gt;
SessionVariableBuilder m
-&gt; ValueParser ('Postgres 'Vanilla) m SQLExp
-&gt; SelectQuery
-&gt; m (AnnSimpleSelect ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Select.html#convSelectQuery"><span class="hs-identifier hs-var hs-var">convSelectQuery</span></a></span></span><span> </span><span id="local-6989586621690474344"><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621690474344"><span class="hs-identifier hs-var">sessVarBldr</span></a></span></span><span> </span><span id="local-6989586621690474343"><span class="annot"><span class="annottext">ValueParser ('Postgres 'Vanilla) m SQLExp
</span><a href="#local-6989586621690474343"><span class="hs-identifier hs-var">prepArgBuilder</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.DML.Types.html#DMLQuery"><span class="hs-identifier hs-type">DMLQuery</span></a></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621690474341"><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690474341"><span class="hs-identifier hs-var">qt</span></a></span></span><span> </span><span id="local-6989586621690474340"><span class="annot"><span class="annottext">SelectQ
</span><a href="#local-6989586621690474340"><span class="hs-identifier hs-var">selQ</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-313"></span><span>  </span><span id="local-6989586621690474339"><span class="annot"><span class="annottext">TableInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474339"><span class="hs-identifier hs-var">tabInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. QErrM m =&gt; Text -&gt; m a -&gt; m a
</span><a href="Hasura.Base.Error.html#withPathK"><span class="hs-identifier hs-var">withPathK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;table&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
TableName ('Postgres 'Vanilla)
-&gt; m (TableInfo ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Internal.html#askTableInfoSource"><span class="hs-identifier hs-var">askTableInfoSource</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690474341"><span class="hs-identifier hs-var">qt</span></a></span><span>
</span><span id="line-314"></span><span>  </span><span id="local-6989586621690474337"><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474337"><span class="hs-identifier hs-var">selPermInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m) =&gt;
TableInfo ('Postgres 'Vanilla)
-&gt; m (SelPermInfo ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Internal.html#askSelPermInfo"><span class="hs-identifier hs-var">askSelPermInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TableInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474339"><span class="hs-identifier hs-var">tabInfo</span></a></span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690474335"><span class="annot"><span class="annottext">fieldInfo :: FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474335"><span class="hs-identifier hs-var hs-var">fieldInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) field primaryKeyColumn.
TableCoreInfoG b field primaryKeyColumn -&gt; FieldInfoMap field
</span><a href="Hasura.RQL.Types.Table.html#_tciFieldInfoMap"><span class="hs-identifier hs-var">_tciFieldInfoMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). TableInfo b -&gt; TableCoreInfo b
</span><a href="Hasura.RQL.Types.Table.html#_tiCoreInfo"><span class="hs-identifier hs-var">_tiCoreInfo</span></a></span><span> </span><span class="annot"><span class="annottext">TableInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474339"><span class="hs-identifier hs-var">tabInfo</span></a></span><span>
</span><span id="line-316"></span><span>  </span><span id="local-6989586621690474334"><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621690474334"><span class="hs-identifier hs-var">extSelQ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m) =&gt;
FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla) -&gt; SelectQ -&gt; m SelectQExt
</span><a href="Hasura.RQL.DML.Select.html#resolveStar"><span class="hs-identifier hs-var">resolveStar</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474335"><span class="hs-identifier hs-var">fieldInfo</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474337"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQ
</span><a href="#local-6989586621690474340"><span class="hs-identifier hs-var">selQ</span></a></span><span>
</span><span id="line-317"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m) =&gt;
HashSet Text -&gt; m ()
</span><a href="Hasura.RQL.DML.Internal.html#validateHeaders"><span class="hs-identifier hs-var">validateHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType). SelPermInfo b -&gt; HashSet Text
</span><a href="Hasura.RQL.Types.Table.html#spiRequiredHeaders"><span class="hs-identifier hs-var">spiRequiredHeaders</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474337"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span>
</span><span id="line-318"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m,
 HasServerConfigCtx m) =&gt;
TableName ('Postgres 'Vanilla)
-&gt; FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
-&gt; SelPermInfo ('Postgres 'Vanilla)
-&gt; SelectQExt
-&gt; SessionVariableBuilder m
-&gt; ValueParser ('Postgres 'Vanilla) m SQLExp
-&gt; m (AnnSimpleSelect ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Select.html#convSelectQ"><span class="hs-identifier hs-var">convSelectQ</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedTable
</span><a href="#local-6989586621690474341"><span class="hs-identifier hs-var">qt</span></a></span><span> </span><span class="annot"><span class="annottext">FieldInfoMap (FieldInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474335"><span class="hs-identifier hs-var">fieldInfo</span></a></span><span> </span><span class="annot"><span class="annottext">SelPermInfo ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474337"><span class="hs-identifier hs-var">selPermInfo</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQExt
</span><a href="#local-6989586621690474334"><span class="hs-identifier hs-var">extSelQ</span></a></span><span> </span><span class="annot"><span class="annottext">SessionVariableBuilder m
</span><a href="#local-6989586621690474344"><span class="hs-identifier hs-var">sessVarBldr</span></a></span><span> </span><span class="annot"><span class="annottext">ValueParser ('Postgres 'Vanilla) m SQLExp
</span><a href="#local-6989586621690474343"><span class="hs-identifier hs-var">prepArgBuilder</span></a></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="annot"><a href="Hasura.RQL.DML.Select.html#selectP2"><span class="hs-identifier hs-type">selectP2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Common.html#JsonAggSelect"><span class="hs-identifier hs-type">JsonAggSelect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnSimpleSelect"><span class="hs-identifier hs-type">AnnSimpleSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">DS.Seq</span></a></span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.4.20220919/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.4.20220919/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.TxE</span></a></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span><span>
</span><span id="line-321"></span><span id="selectP2"><span class="annot"><span class="annottext">selectP2 :: JsonAggSelect
-&gt; (AnnSimpleSelect ('Postgres 'Vanilla), Seq PrepArg)
-&gt; TxE QErr EncJSON
</span><a href="Hasura.RQL.DML.Select.html#selectP2"><span class="hs-identifier hs-var hs-var">selectP2</span></a></span></span><span> </span><span id="local-6989586621690474330"><span class="annot"><span class="annottext">JsonAggSelect
</span><a href="#local-6989586621690474330"><span class="hs-identifier hs-var">jsonAggSelect</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621690474329"><span class="annot"><span class="annottext">AnnSimpleSelect ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474329"><span class="hs-identifier hs-var">sel</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621690474328"><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621690474328"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-322"></span><span>  </span><span class="annot"><span class="annottext">forall a. Identity a -&gt; a
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">runIdentity</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. SingleRow a -&gt; a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.4.20220919/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.getRow</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a e.
(MonadIO m, FromRes a) =&gt;
(PGTxErr -&gt; e) -&gt; Query -&gt; [PrepArg] -&gt; Bool -&gt; TxET e m a
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.4.20220919/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.rawQE</span></a></span><span> </span><span class="annot"><span class="annottext">PGTxErr -&gt; QErr
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#dmlTxErrorHandler"><span class="hs-identifier hs-var">dmlTxErrorHandler</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder -&gt; Query
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.4.20220919/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.fromBuilder</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621690474322"><span class="hs-identifier hs-var">selectSQL</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">Seq PrepArg
</span><a href="#local-6989586621690474328"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-325"></span><span>    </span><span id="local-6989586621690474322"><span class="annot"><span class="annottext">selectSQL :: Builder
</span><a href="#local-6989586621690474322"><span class="hs-identifier hs-var hs-var">selectSQL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. ToSQL a =&gt; a -&gt; Builder
</span><a href="Hasura.SQL.Types.html#toSQL"><span class="hs-identifier hs-var">toSQL</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (pgKind :: PostgresKind).
(Backend ('Postgres pgKind), PostgresAnnotatedFieldJSON pgKind) =&gt;
JsonAggSelect -&gt; AnnSimpleSelect ('Postgres pgKind) -&gt; Select
</span><a href="Hasura.Backends.Postgres.Translate.Select.Simple.html#mkSQLSelect"><span class="hs-identifier hs-var">mkSQLSelect</span></a></span><span> </span><span class="annot"><span class="annottext">JsonAggSelect
</span><a href="#local-6989586621690474330"><span class="hs-identifier hs-var">jsonAggSelect</span></a></span><span> </span><span class="annot"><span class="annottext">AnnSimpleSelect ('Postgres 'Vanilla)
</span><a href="#local-6989586621690474329"><span class="hs-identifier hs-var">sel</span></a></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span id="local-6989586621690474969"><span class="annot"><a href="Hasura.RQL.DML.Select.html#phaseOne"><span class="hs-identifier hs-type">phaseOne</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690474969"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Session.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690474969"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#CacheRM"><span class="hs-identifier hs-type">CacheRM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690474969"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html#HasServerConfigCtx"><span class="hs-identifier hs-type">HasServerConfigCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690474969"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-329"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SelectQuery"><span class="hs-identifier hs-type">SelectQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-330"></span><span>  </span><span class="annot"><a href="#local-6989586621690474969"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnSimpleSelect"><span class="hs-identifier hs-type">AnnSimpleSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">DS.Seq</span></a></span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.4.20220919/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-331"></span><span id="phaseOne"><span class="annot"><span class="annottext">phaseOne :: forall (m :: * -&gt; *).
(QErrM m, UserInfoM m, CacheRM m, HasServerConfigCtx m) =&gt;
SelectQuery
-&gt; m (AnnSimpleSelect ('Postgres 'Vanilla), Seq PrepArg)
</span><a href="Hasura.RQL.DML.Select.html#phaseOne"><span class="hs-identifier hs-var hs-var">phaseOne</span></a></span></span><span> </span><span id="local-6989586621690474272"><span class="annot"><span class="annottext">SelectQuery
</span><a href="#local-6989586621690474272"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621690474271"><span class="annot"><span class="annottext">sourceName :: SourceName
</span><a href="#local-6989586621690474271"><span class="hs-identifier hs-var hs-var">sourceName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. DMLQuery a -&gt; SourceName
</span><a href="Hasura.RQL.DML.Types.html#getSourceDMLQuery"><span class="hs-identifier hs-var">getSourceDMLQuery</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQuery
</span><a href="#local-6989586621690474272"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-333"></span><span>  </span><span id="local-6989586621690474269"><span class="annot"><span class="annottext">HashMap
  (TableName ('Postgres 'Vanilla)) (TableInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474269"><span class="hs-identifier hs-var">tableCache</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.Table.html#TableCache"><span class="hs-identifier hs-type">TableCache</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) (m :: * -&gt; *).
(Backend b, CacheRM m) =&gt;
SourceName -&gt; m (Maybe (TableCache b))
</span><a href="Hasura.RQL.Types.SchemaCache.html#askTableCache"><span class="hs-identifier hs-var">askTableCache</span></a></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621690474271"><span class="hs-identifier hs-var">sourceName</span></a></span><span>
</span><span id="line-334"></span><span>  </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) (m :: * -&gt; *) a.
TableCacheRT b m a -&gt; (SourceName, TableCache b) -&gt; m a
</span><a href="Hasura.RQL.Types.SchemaCache.html#runTableCacheRT"><span class="hs-identifier hs-var">runTableCacheRT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceName
</span><a href="#local-6989586621690474271"><span class="hs-identifier hs-var">sourceName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HashMap
  (TableName ('Postgres 'Vanilla)) (TableInfo ('Postgres 'Vanilla))
</span><a href="#local-6989586621690474269"><span class="hs-identifier hs-var">tableCache</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-335"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. DMLP1T m a -&gt; m (a, Seq PrepArg)
</span><a href="Hasura.RQL.DML.Internal.html#runDMLP1T"><span class="hs-identifier hs-var">runDMLP1T</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-336"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(UserInfoM m, QErrM m, TableInfoRM ('Postgres 'Vanilla) m,
 HasServerConfigCtx m) =&gt;
SessionVariableBuilder m
-&gt; ValueParser ('Postgres 'Vanilla) m SQLExp
-&gt; SelectQuery
-&gt; m (AnnSimpleSelect ('Postgres 'Vanilla))
</span><a href="Hasura.RQL.DML.Select.html#convSelectQuery"><span class="hs-identifier hs-var">convSelectQuery</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; SessionVariableBuilder f
</span><a href="Hasura.RQL.DML.Internal.html#sessVarFromCurrentSetting"><span class="hs-identifier hs-var">sessVarFromCurrentSetting</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadError QErr m =&gt;
(ColumnType ('Postgres 'Vanilla) -&gt; Value -&gt; m SQLExp)
-&gt; CollectableType (ColumnType ('Postgres 'Vanilla))
-&gt; Value
-&gt; m SQLExp
</span><a href="Hasura.RQL.DML.Internal.html#valueParserWithCollectableType"><span class="hs-identifier hs-var">valueParserWithCollectableType</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
QErrM m =&gt;
ColumnType ('Postgres 'Vanilla) -&gt; Value -&gt; DMLP1T m SQLExp
</span><a href="Hasura.RQL.DML.Internal.html#binRHSBuilder"><span class="hs-identifier hs-var">binRHSBuilder</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SelectQuery
</span><a href="#local-6989586621690474272"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span id="local-6989586621690474921"><span class="annot"><a href="Hasura.RQL.DML.Select.html#phaseTwo"><span class="hs-identifier hs-type">phaseTwo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#MonadTx"><span class="hs-identifier hs-type">MonadTx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690474921"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.RQL.IR.Select.html#AnnSimpleSelect"><span class="hs-identifier hs-type">AnnSimpleSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/containers-0.6.5.1/src"><span class="hs-identifier hs-type">DS.Seq</span></a></span><span> </span><span class="annot"><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.4.20220919/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-type">PG.PrepArg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621690474921"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span></span><span>
</span><span id="line-339"></span><span id="phaseTwo"><span class="annot"><span class="annottext">phaseTwo :: forall (m :: * -&gt; *).
MonadTx m =&gt;
(AnnSimpleSelect ('Postgres 'Vanilla), Seq PrepArg) -&gt; m EncJSON
</span><a href="Hasura.RQL.DML.Select.html#phaseTwo"><span class="hs-identifier hs-var hs-var">phaseTwo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-340"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadTx m =&gt; TxE QErr a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#liftTx"><span class="hs-identifier hs-var">liftTx</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">JsonAggSelect
-&gt; (AnnSimpleSelect ('Postgres 'Vanilla), Seq PrepArg)
-&gt; TxE QErr EncJSON
</span><a href="Hasura.RQL.DML.Select.html#selectP2"><span class="hs-identifier hs-var">selectP2</span></a></span><span> </span><span class="annot"><span class="annottext">JsonAggSelect
</span><a href="Hasura.RQL.Types.Common.html#JASMultipleRows"><span class="hs-identifier hs-var">JASMultipleRows</span></a></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span id="local-6989586621690474916"><span class="annot"><a href="Hasura.RQL.DML.Select.html#runSelect"><span class="hs-identifier hs-type">runSelect</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErrM"><span class="hs-identifier hs-type">QErrM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690474916"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-344"></span><span>    </span><span class="annot"><a href="Hasura.Session.html#UserInfoM"><span class="hs-identifier hs-type">UserInfoM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690474916"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-345"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.SchemaCache.html#CacheRM"><span class="hs-identifier hs-type">CacheRM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690474916"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-346"></span><span>    </span><span class="annot"><a href="Hasura.Server.Types.html#HasServerConfigCtx"><span class="hs-identifier hs-type">HasServerConfigCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690474916"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690474916"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadBaseControl</span></span><span> </span><span class="annot"><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690474916"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-349"></span><span>    </span><span class="annot"><a href="Hasura.Tracing.html#MonadTrace"><span class="hs-identifier hs-type">Tracing.MonadTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690474916"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-350"></span><span>    </span><span class="annot"><a href="Hasura.RQL.Types.Metadata.html#MetadataM"><span class="hs-identifier hs-type">MetadataM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621690474916"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-352"></span><span>  </span><span class="annot"><a href="Hasura.RQL.DML.Types.html#SelectQuery"><span class="hs-identifier hs-type">SelectQuery</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-353"></span><span>  </span><span class="annot"><a href="#local-6989586621690474916"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Hasura.EncJSON.html#EncJSON"><span class="hs-identifier hs-type">EncJSON</span></a></span></span><span>
</span><span id="line-354"></span><span id="runSelect"><span class="annot"><span class="annottext">runSelect :: forall (m :: * -&gt; *).
(QErrM m, UserInfoM m, CacheRM m, HasServerConfigCtx m, MonadIO m,
 MonadBaseControl IO m, MonadTrace m, MetadataM m) =&gt;
SelectQuery -&gt; m EncJSON
</span><a href="Hasura.RQL.DML.Select.html#runSelect"><span class="hs-identifier hs-var hs-var">runSelect</span></a></span></span><span> </span><span id="local-6989586621690474229"><span class="annot"><span class="annottext">SelectQuery
</span><a href="#local-6989586621690474229"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-355"></span><span>  </span><span id="local-6989586621690474228"><span class="annot"><span class="annottext">PGSourceConfig
</span><a href="#local-6989586621690474228"><span class="hs-identifier hs-var">sourceConfig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (b :: BackendType) (m :: * -&gt; *).
(CacheRM m, MonadError QErr m, Backend b, MetadataM m) =&gt;
SourceName -&gt; m (SourceConfig b)
</span><a href="Hasura.RQL.Types.SchemaCache.html#askSourceConfig"><span class="hs-identifier hs-var">askSourceConfig</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Hasura.SQL.Backend.html#Vanilla"><span class="hs-identifier hs-type">Vanilla</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. DMLQuery a -&gt; SourceName
</span><a href="Hasura.RQL.DML.Types.html#getSourceDMLQuery"><span class="hs-identifier hs-var">getSourceDMLQuery</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQuery
</span><a href="#local-6989586621690474229"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(QErrM m, UserInfoM m, CacheRM m, HasServerConfigCtx m) =&gt;
SelectQuery
-&gt; m (AnnSimpleSelect ('Postgres 'Vanilla), Seq PrepArg)
</span><a href="Hasura.RQL.DML.Select.html#phaseOne"><span class="hs-identifier hs-var">phaseOne</span></a></span><span> </span><span class="annot"><span class="annottext">SelectQuery
</span><a href="#local-6989586621690474229"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(MonadIO m, MonadBaseControl IO m, MonadError QErr m, MonadTrace m,
 UserInfoM m) =&gt;
PGExecCtx -&gt; TxAccess -&gt; TxET QErr m a -&gt; m a
</span><a href="Hasura.Backends.Postgres.Connection.MonadTx.html#runTxWithCtx"><span class="hs-identifier hs-var">runTxWithCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGSourceConfig -&gt; PGExecCtx
</span><a href="Hasura.Backends.Postgres.Execute.Types.html#_pscExecCtx"><span class="hs-identifier hs-var">_pscExecCtx</span></a></span><span> </span><span class="annot"><span class="annottext">PGSourceConfig
</span><a href="#local-6989586621690474228"><span class="hs-identifier hs-var">sourceConfig</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxAccess
</span><a href="../file:///workdir/dist-newstyle/build/x86_64-linux/ghc-9.2.4.20220919/pg-client-0.1.0/opt/doc/html/pg-client/src"><span class="hs-identifier hs-var">PG.ReadOnly</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///root/.ghcup/ghc/9.2.4/share/doc/ghc-9.2.4.20220919/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadTx m =&gt;
(AnnSimpleSelect ('Postgres 'Vanilla), Seq PrepArg) -&gt; m EncJSON
</span><a href="Hasura.RQL.DML.Select.html#phaseTwo"><span class="hs-identifier hs-var">phaseTwo</span></a></span><span>
</span><span id="line-357"></span></pre></body></html>