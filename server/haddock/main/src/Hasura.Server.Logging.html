<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- This is taken from wai-logger and customised for our use</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hasura.Server.Logging</span><span>
</span><span id="line-4"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#StartupLog"><span class="hs-identifier">StartupLog</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#PGLog"><span class="hs-identifier">PGLog</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#RequestMode"><span class="hs-identifier">RequestMode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#mkInconsMetadataLog"><span class="hs-identifier">mkInconsMetadataLog</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#mkHttpAccessLogContext"><span class="hs-identifier">mkHttpAccessLogContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#mkHttpErrorLogContext"><span class="hs-identifier">mkHttpErrorLogContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#mkHttpLog"><span class="hs-identifier">mkHttpLog</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpInfoLog"><span class="hs-identifier">HttpInfoLog</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#OperationLog"><span class="hs-identifier">OperationLog</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogContext"><span class="hs-identifier">HttpLogContext</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#WebHookLog"><span class="hs-identifier">WebHookLog</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Hasura.HTTP.html#HttpException"><span class="hs-identifier">HttpException</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier">HttpLog</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#GQLBatchQueryOperationLog"><span class="hs-identifier">GQLBatchQueryOperationLog</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#GQLQueryOperationSuccessLog"><span class="hs-identifier">GQLQueryOperationSuccessLog</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#GQLQueryOperationErrorLog"><span class="hs-identifier">GQLQueryOperationErrorLog</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#MetadataLog"><span class="hs-identifier">MetadataLog</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Hasura.Server.Utils.html#EnvVarsMovedToMetadata"><span class="hs-identifier">EnvVarsMovedToMetadata</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Hasura.Server.Utils.html#DeprecatedEnvVars"><span class="hs-identifier">DeprecatedEnvVars</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#logDeprecatedEnvVars"><span class="hs-identifier">logDeprecatedEnvVars</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#CommonHttpLogMetadata"><span class="hs-identifier">CommonHttpLogMetadata</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogMetadata"><span class="hs-identifier">HttpLogMetadata</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#buildHttpLogMetadata"><span class="hs-identifier">buildHttpLogMetadata</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#emptyHttpLogMetadata"><span class="hs-identifier">emptyHttpLogMetadata</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">where</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.TH</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BL</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Environment.html"><span class="hs-identifier">Data.Environment</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Env</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HM</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashSet</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.TByteString.html"><span class="hs-identifier">Data.TByteString</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TBS</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Text.Extended.html"><span class="hs-identifier">Data.Text.Extended</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Base.Error.html"><span class="hs-identifier">Hasura.Base.Error</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.ParameterizedQueryHash.html"><span class="hs-identifier">Hasura.GraphQL.ParameterizedQueryHash</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html"><span class="hs-identifier">Hasura.GraphQL.Transport.HTTP.Protocol</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GH</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.HTTP.html"><span class="hs-identifier">Hasura.HTTP</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Logging.html"><span class="hs-identifier">Hasura.Logging</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Metadata.Class.html"><span class="hs-identifier">Hasura.Metadata.Class</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Prelude.html"><span class="hs-identifier">Hasura.Prelude</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.RQL.Types.html"><span class="hs-identifier">Hasura.RQL.Types</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Compression.html"><span class="hs-identifier">Hasura.Server.Compression</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Types.html"><span class="hs-identifier">Hasura.Server.Types</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Server.Utils.html"><span class="hs-identifier">Hasura.Server.Utils</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Hasura.Server.Utils.html#DeprecatedEnvVars"><span class="hs-identifier">DeprecatedEnvVars</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><a href="Hasura.Server.Utils.html#EnvVarsMovedToMetadata"><span class="hs-identifier">EnvVarsMovedToMetadata</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><a href="Hasura.Server.Utils.html#deprecatedEnvVars"><span class="hs-identifier">deprecatedEnvVars</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><a href="Hasura.Server.Utils.html#envVarsMovedToMetadata"><span class="hs-identifier">envVarsMovedToMetadata</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Session.html"><span class="hs-identifier">Hasura.Session</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hasura.Tracing.html"><span class="hs-identifier">Hasura.Tracing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Tracing.html#TraceT"><span class="hs-identifier">TraceT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Network.HTTP.Types</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HTTP</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Network.Wai.Extended.html"><span class="hs-identifier">Network.Wai.Extended</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Wai</span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">data</span><span> </span><span id="StartupLog"><span class="annot"><a href="Hasura.Server.Logging.html#StartupLog"><span class="hs-identifier hs-var">StartupLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="StartupLog"><span class="annot"><a href="Hasura.Server.Logging.html#StartupLog"><span class="hs-identifier hs-var">StartupLog</span></a></span></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="slLogLevel"><span class="annot"><span class="annottext">StartupLog -&gt; LogLevel
</span><a href="Hasura.Server.Logging.html#slLogLevel"><span class="hs-identifier hs-var hs-var">slLogLevel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Logging.html#LogLevel"><span class="hs-identifier hs-type">LogLevel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>    </span><span id="slKind"><span class="annot"><span class="annottext">StartupLog -&gt; Text
</span><a href="Hasura.Server.Logging.html#slKind"><span class="hs-identifier hs-var hs-var">slKind</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>    </span><span id="slInfo"><span class="annot"><span class="annottext">StartupLog -&gt; Value
</span><a href="Hasura.Server.Logging.html#slInfo"><span class="hs-identifier hs-var hs-var">slInfo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688129870"><span id="local-6989586621688129872"><span id="local-6989586621688129874"><span class="annot"><span class="annottext">Int -&gt; StartupLog -&gt; ShowS
[StartupLog] -&gt; ShowS
StartupLog -&gt; String
(Int -&gt; StartupLog -&gt; ShowS)
-&gt; (StartupLog -&gt; String)
-&gt; ([StartupLog] -&gt; ShowS)
-&gt; Show StartupLog
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [StartupLog] -&gt; ShowS
$cshowList :: [StartupLog] -&gt; ShowS
show :: StartupLog -&gt; String
$cshow :: StartupLog -&gt; String
showsPrec :: Int -&gt; StartupLog -&gt; ShowS
$cshowsPrec :: Int -&gt; StartupLog -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688129865"><span id="local-6989586621688129867"><span class="annot"><span class="annottext">StartupLog -&gt; StartupLog -&gt; Bool
(StartupLog -&gt; StartupLog -&gt; Bool)
-&gt; (StartupLog -&gt; StartupLog -&gt; Bool) -&gt; Eq StartupLog
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: StartupLog -&gt; StartupLog -&gt; Bool
$c/= :: StartupLog -&gt; StartupLog -&gt; Bool
== :: StartupLog -&gt; StartupLog -&gt; Bool
$c== :: StartupLog -&gt; StartupLog -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621688129857"><span id="local-6989586621688129859"><span id="local-6989586621688129861"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#StartupLog"><span class="hs-identifier hs-type">StartupLog</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-71"></span><span>  </span><span id="local-6989586621688129855"><span class="annot"><span class="annottext">toJSON :: StartupLog -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Logging.html#StartupLog"><span class="hs-identifier hs-type">StartupLog</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621688129853"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621688129853"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621688129852"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621688129852"><span class="hs-identifier hs-var">info</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span>
</span><span id="line-73"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;kind&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621688129853"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>        </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;info&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621688129852"><span class="hs-identifier hs-var">info</span></a></span><span>
</span><span id="line-75"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.Logging.html#ToEngineLog"><span class="hs-identifier hs-type">ToEngineLog</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#StartupLog"><span class="hs-identifier hs-type">StartupLog</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">Hasura</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>  </span><span id="local-6989586621688129846"><span class="annot"><span class="annottext">toEngineLog :: StartupLog -&gt; (LogLevel, EngineLogType Hasura, Value)
</span><a href="Hasura.Logging.html#toEngineLog"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEngineLog</span></a></span></span><span> </span><span id="local-6989586621688129844"><span class="annot"><span class="annottext">StartupLog
</span><a href="#local-6989586621688129844"><span class="hs-identifier hs-var">startupLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartupLog -&gt; LogLevel
</span><a href="Hasura.Server.Logging.html#slLogLevel"><span class="hs-identifier hs-var hs-var">slLogLevel</span></a></span><span> </span><span class="annot"><span class="annottext">StartupLog
</span><a href="#local-6989586621688129844"><span class="hs-identifier hs-var">startupLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EngineLogType Hasura
</span><a href="Hasura.Logging.html#ELTStartup"><span class="hs-identifier hs-var">ELTStartup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartupLog -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">StartupLog
</span><a href="#local-6989586621688129844"><span class="hs-identifier hs-var">startupLog</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">data</span><span> </span><span id="PGLog"><span class="annot"><a href="Hasura.Server.Logging.html#PGLog"><span class="hs-identifier hs-var">PGLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PGLog"><span class="annot"><a href="Hasura.Server.Logging.html#PGLog"><span class="hs-identifier hs-var">PGLog</span></a></span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="plLogLevel"><span class="annot"><span class="annottext">PGLog -&gt; LogLevel
</span><a href="Hasura.Server.Logging.html#plLogLevel"><span class="hs-identifier hs-var hs-var">plLogLevel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Logging.html#LogLevel"><span class="hs-identifier hs-type">LogLevel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>    </span><span id="plMessage"><span class="annot"><span class="annottext">PGLog -&gt; Text
</span><a href="Hasura.Server.Logging.html#plMessage"><span class="hs-identifier hs-var hs-var">plMessage</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688129834"><span id="local-6989586621688129836"><span id="local-6989586621688129838"><span class="annot"><span class="annottext">Int -&gt; PGLog -&gt; ShowS
[PGLog] -&gt; ShowS
PGLog -&gt; String
(Int -&gt; PGLog -&gt; ShowS)
-&gt; (PGLog -&gt; String) -&gt; ([PGLog] -&gt; ShowS) -&gt; Show PGLog
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PGLog] -&gt; ShowS
$cshowList :: [PGLog] -&gt; ShowS
show :: PGLog -&gt; String
$cshow :: PGLog -&gt; String
showsPrec :: Int -&gt; PGLog -&gt; ShowS
$cshowsPrec :: Int -&gt; PGLog -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688129830"><span id="local-6989586621688129832"><span class="annot"><span class="annottext">PGLog -&gt; PGLog -&gt; Bool
(PGLog -&gt; PGLog -&gt; Bool) -&gt; (PGLog -&gt; PGLog -&gt; Bool) -&gt; Eq PGLog
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PGLog -&gt; PGLog -&gt; Bool
$c/= :: PGLog -&gt; PGLog -&gt; Bool
== :: PGLog -&gt; PGLog -&gt; Bool
$c== :: PGLog -&gt; PGLog -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621688129823"><span id="local-6989586621688129825"><span id="local-6989586621688129827"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#PGLog"><span class="hs-identifier hs-type">PGLog</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621688129822"><span class="annot"><span class="annottext">toJSON :: PGLog -&gt; Value
</span><a href="#local-6989586621688129822"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Logging.html#PGLog"><span class="hs-identifier hs-type">PGLog</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621688129821"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621688129821"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;message&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621688129821"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.Logging.html#ToEngineLog"><span class="hs-identifier hs-type">ToEngineLog</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#PGLog"><span class="hs-identifier hs-type">PGLog</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">Hasura</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-92"></span><span>  </span><span id="local-6989586621688129818"><span class="annot"><span class="annottext">toEngineLog :: PGLog -&gt; (LogLevel, EngineLogType Hasura, Value)
</span><a href="#local-6989586621688129818"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEngineLog</span></a></span></span><span> </span><span id="local-6989586621688129817"><span class="annot"><span class="annottext">PGLog
</span><a href="#local-6989586621688129817"><span class="hs-identifier hs-var">pgLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PGLog -&gt; LogLevel
</span><a href="Hasura.Server.Logging.html#plLogLevel"><span class="hs-identifier hs-var hs-var">plLogLevel</span></a></span><span> </span><span class="annot"><span class="annottext">PGLog
</span><a href="#local-6989586621688129817"><span class="hs-identifier hs-var">pgLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InternalLogTypes -&gt; EngineLogType Hasura
</span><a href="Hasura.Logging.html#ELTInternal"><span class="hs-identifier hs-var">ELTInternal</span></a></span><span> </span><span class="annot"><span class="annottext">InternalLogTypes
</span><a href="Hasura.Logging.html#ILTPgClient"><span class="hs-identifier hs-var">ILTPgClient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PGLog -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">PGLog
</span><a href="#local-6989586621688129817"><span class="hs-identifier hs-var">pgLog</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-keyword">data</span><span> </span><span id="MetadataLog"><span class="annot"><a href="Hasura.Server.Logging.html#MetadataLog"><span class="hs-identifier hs-var">MetadataLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MetadataLog"><span class="annot"><a href="Hasura.Server.Logging.html#MetadataLog"><span class="hs-identifier hs-var">MetadataLog</span></a></span></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="mlLogLevel"><span class="annot"><span class="annottext">MetadataLog -&gt; LogLevel
</span><a href="Hasura.Server.Logging.html#mlLogLevel"><span class="hs-identifier hs-var hs-var">mlLogLevel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Logging.html#LogLevel"><span class="hs-identifier hs-type">LogLevel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>    </span><span id="mlMessage"><span class="annot"><span class="annottext">MetadataLog -&gt; Text
</span><a href="Hasura.Server.Logging.html#mlMessage"><span class="hs-identifier hs-var hs-var">mlMessage</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>    </span><span id="mlInfo"><span class="annot"><span class="annottext">MetadataLog -&gt; Value
</span><a href="Hasura.Server.Logging.html#mlInfo"><span class="hs-identifier hs-var hs-var">mlInfo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688129805"><span id="local-6989586621688129807"><span id="local-6989586621688129809"><span class="annot"><span class="annottext">Int -&gt; MetadataLog -&gt; ShowS
[MetadataLog] -&gt; ShowS
MetadataLog -&gt; String
(Int -&gt; MetadataLog -&gt; ShowS)
-&gt; (MetadataLog -&gt; String)
-&gt; ([MetadataLog] -&gt; ShowS)
-&gt; Show MetadataLog
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MetadataLog] -&gt; ShowS
$cshowList :: [MetadataLog] -&gt; ShowS
show :: MetadataLog -&gt; String
$cshow :: MetadataLog -&gt; String
showsPrec :: Int -&gt; MetadataLog -&gt; ShowS
$cshowsPrec :: Int -&gt; MetadataLog -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688129801"><span id="local-6989586621688129803"><span class="annot"><span class="annottext">MetadataLog -&gt; MetadataLog -&gt; Bool
(MetadataLog -&gt; MetadataLog -&gt; Bool)
-&gt; (MetadataLog -&gt; MetadataLog -&gt; Bool) -&gt; Eq MetadataLog
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: MetadataLog -&gt; MetadataLog -&gt; Bool
$c/= :: MetadataLog -&gt; MetadataLog -&gt; Bool
== :: MetadataLog -&gt; MetadataLog -&gt; Bool
$c== :: MetadataLog -&gt; MetadataLog -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621688129794"><span id="local-6989586621688129796"><span id="local-6989586621688129798"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#MetadataLog"><span class="hs-identifier hs-type">MetadataLog</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>  </span><span id="local-6989586621688129793"><span class="annot"><span class="annottext">toJSON :: MetadataLog -&gt; Value
</span><a href="#local-6989586621688129793"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Logging.html#MetadataLog"><span class="hs-identifier hs-type">MetadataLog</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621688129792"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621688129792"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621688129791"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621688129791"><span class="hs-identifier hs-var">infoVal</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span>
</span><span id="line-105"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;message&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621688129792"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>        </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;info&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621688129791"><span class="hs-identifier hs-var">infoVal</span></a></span><span>
</span><span id="line-107"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.Logging.html#ToEngineLog"><span class="hs-identifier hs-type">ToEngineLog</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#MetadataLog"><span class="hs-identifier hs-type">MetadataLog</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">Hasura</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621688129788"><span class="annot"><span class="annottext">toEngineLog :: MetadataLog -&gt; (LogLevel, EngineLogType Hasura, Value)
</span><a href="#local-6989586621688129788"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEngineLog</span></a></span></span><span> </span><span id="local-6989586621688129787"><span class="annot"><span class="annottext">MetadataLog
</span><a href="#local-6989586621688129787"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MetadataLog -&gt; LogLevel
</span><a href="Hasura.Server.Logging.html#mlLogLevel"><span class="hs-identifier hs-var hs-var">mlLogLevel</span></a></span><span> </span><span class="annot"><span class="annottext">MetadataLog
</span><a href="#local-6989586621688129787"><span class="hs-identifier hs-var">ml</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InternalLogTypes -&gt; EngineLogType Hasura
</span><a href="Hasura.Logging.html#ELTInternal"><span class="hs-identifier hs-var">ELTInternal</span></a></span><span> </span><span class="annot"><span class="annottext">InternalLogTypes
</span><a href="Hasura.Logging.html#ILTMetadata"><span class="hs-identifier hs-var">ILTMetadata</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MetadataLog -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">MetadataLog
</span><a href="#local-6989586621688129787"><span class="hs-identifier hs-var">ml</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="annot"><a href="Hasura.Server.Logging.html#mkInconsMetadataLog"><span class="hs-identifier hs-type">mkInconsMetadataLog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Hasura.RQL.Types.Metadata.Object.html#InconsistentMetadata"><span class="hs-identifier hs-type">InconsistentMetadata</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#MetadataLog"><span class="hs-identifier hs-type">MetadataLog</span></a></span><span>
</span><span id="line-114"></span><span id="mkInconsMetadataLog"><span class="annot"><span class="annottext">mkInconsMetadataLog :: [InconsistentMetadata] -&gt; MetadataLog
</span><a href="Hasura.Server.Logging.html#mkInconsMetadataLog"><span class="hs-identifier hs-var hs-var">mkInconsMetadataLog</span></a></span></span><span> </span><span id="local-6989586621688129785"><span class="annot"><span class="annottext">[InconsistentMetadata]
</span><a href="#local-6989586621688129785"><span class="hs-identifier hs-var">objs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><span class="annottext">LogLevel -&gt; Text -&gt; Value -&gt; MetadataLog
</span><a href="Hasura.Server.Logging.html#MetadataLog"><span class="hs-identifier hs-var">MetadataLog</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="Hasura.Logging.html#LevelWarn"><span class="hs-identifier hs-var">LevelWarn</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Inconsistent Metadata!&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; MetadataLog) -&gt; Value -&gt; MetadataLog
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;objects&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [InconsistentMetadata] -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">[InconsistentMetadata]
</span><a href="#local-6989586621688129785"><span class="hs-identifier hs-var">objs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-keyword">data</span><span> </span><span id="WebHookLog"><span class="annot"><a href="Hasura.Server.Logging.html#WebHookLog"><span class="hs-identifier hs-var">WebHookLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="WebHookLog"><span class="annot"><a href="Hasura.Server.Logging.html#WebHookLog"><span class="hs-identifier hs-var">WebHookLog</span></a></span></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="whlLogLevel"><span class="annot"><span class="annottext">WebHookLog -&gt; LogLevel
</span><a href="Hasura.Server.Logging.html#whlLogLevel"><span class="hs-identifier hs-var hs-var">whlLogLevel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Logging.html#LogLevel"><span class="hs-identifier hs-type">LogLevel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-120"></span><span>    </span><span id="whlStatusCode"><span class="annot"><span class="annottext">WebHookLog -&gt; Maybe Status
</span><a href="Hasura.Server.Logging.html#whlStatusCode"><span class="hs-identifier hs-var hs-var">whlStatusCode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">HTTP.Status</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-121"></span><span>    </span><span id="whlUrl"><span class="annot"><span class="annottext">WebHookLog -&gt; Text
</span><a href="Hasura.Server.Logging.html#whlUrl"><span class="hs-identifier hs-var hs-var">whlUrl</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span>
</span><span id="line-122"></span><span>    </span><span id="whlMethod"><span class="annot"><span class="annottext">WebHookLog -&gt; StdMethod
</span><a href="Hasura.Server.Logging.html#whlMethod"><span class="hs-identifier hs-var hs-var">whlMethod</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">HTTP.StdMethod</span></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>    </span><span id="whlError"><span class="annot"><span class="annottext">WebHookLog -&gt; Maybe HttpException
</span><a href="Hasura.Server.Logging.html#whlError"><span class="hs-identifier hs-var hs-var">whlError</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.HTTP.html#HttpException"><span class="hs-identifier hs-type">HttpException</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-124"></span><span>    </span><span id="whlResponse"><span class="annot"><span class="annottext">WebHookLog -&gt; Maybe Text
</span><a href="Hasura.Server.Logging.html#whlResponse"><span class="hs-identifier hs-var hs-var">whlResponse</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-125"></span><span>    </span><span id="whlMessage"><span class="annot"><span class="annottext">WebHookLog -&gt; Maybe Text
</span><a href="Hasura.Server.Logging.html#whlMessage"><span class="hs-identifier hs-var hs-var">whlMessage</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688129770"><span id="local-6989586621688129772"><span id="local-6989586621688129774"><span class="annot"><span class="annottext">Int -&gt; WebHookLog -&gt; ShowS
[WebHookLog] -&gt; ShowS
WebHookLog -&gt; String
(Int -&gt; WebHookLog -&gt; ShowS)
-&gt; (WebHookLog -&gt; String)
-&gt; ([WebHookLog] -&gt; ShowS)
-&gt; Show WebHookLog
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [WebHookLog] -&gt; ShowS
$cshowList :: [WebHookLog] -&gt; ShowS
show :: WebHookLog -&gt; String
$cshow :: WebHookLog -&gt; String
showsPrec :: Int -&gt; WebHookLog -&gt; ShowS
$cshowsPrec :: Int -&gt; WebHookLog -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.Logging.html#ToEngineLog"><span class="hs-identifier hs-type">ToEngineLog</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#WebHookLog"><span class="hs-identifier hs-type">WebHookLog</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">Hasura</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621688129767"><span class="annot"><span class="annottext">toEngineLog :: WebHookLog -&gt; (LogLevel, EngineLogType Hasura, Value)
</span><a href="#local-6989586621688129767"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEngineLog</span></a></span></span><span> </span><span id="local-6989586621688129766"><span class="annot"><span class="annottext">WebHookLog
</span><a href="#local-6989586621688129766"><span class="hs-identifier hs-var">webHookLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WebHookLog -&gt; LogLevel
</span><a href="Hasura.Server.Logging.html#whlLogLevel"><span class="hs-identifier hs-var hs-var">whlLogLevel</span></a></span><span> </span><span class="annot"><span class="annottext">WebHookLog
</span><a href="#local-6989586621688129766"><span class="hs-identifier hs-var">webHookLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EngineLogType Hasura
</span><a href="Hasura.Logging.html#ELTWebhookLog"><span class="hs-identifier hs-var">ELTWebhookLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WebHookLog -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">WebHookLog
</span><a href="#local-6989586621688129766"><span class="hs-identifier hs-var">webHookLog</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621688129758"><span id="local-6989586621688129760"><span id="local-6989586621688129762"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#WebHookLog"><span class="hs-identifier hs-type">WebHookLog</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>  </span><span id="local-6989586621688129757"><span class="annot"><span class="annottext">toJSON :: WebHookLog -&gt; Value
</span><a href="#local-6989586621688129757"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span id="local-6989586621688129756"><span class="annot"><span class="annottext">WebHookLog
</span><a href="#local-6989586621688129756"><span class="hs-identifier hs-var">whl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span>
</span><span id="line-136"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;status_code&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Int -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status -&gt; Int
</span><span class="hs-identifier hs-var hs-var">HTTP.statusCode</span></span><span> </span><span class="annot"><span class="annottext">(Status -&gt; Int) -&gt; Maybe Status -&gt; Maybe Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">WebHookLog -&gt; Maybe Status
</span><a href="Hasura.Server.Logging.html#whlStatusCode"><span class="hs-identifier hs-var hs-var">whlStatusCode</span></a></span><span> </span><span class="annot"><span class="annottext">WebHookLog
</span><a href="#local-6989586621688129756"><span class="hs-identifier hs-var">whl</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-137"></span><span>        </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;url&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">WebHookLog -&gt; Text
</span><a href="Hasura.Server.Logging.html#whlUrl"><span class="hs-identifier hs-var hs-var">whlUrl</span></a></span><span> </span><span class="annot"><span class="annottext">WebHookLog
</span><a href="#local-6989586621688129756"><span class="hs-identifier hs-var">whl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;method&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">StdMethod -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WebHookLog -&gt; StdMethod
</span><a href="Hasura.Server.Logging.html#whlMethod"><span class="hs-identifier hs-var hs-var">whlMethod</span></a></span><span> </span><span class="annot"><span class="annottext">WebHookLog
</span><a href="#local-6989586621688129756"><span class="hs-identifier hs-var">whl</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;http_error&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe HttpException -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">WebHookLog -&gt; Maybe HttpException
</span><a href="Hasura.Server.Logging.html#whlError"><span class="hs-identifier hs-var hs-var">whlError</span></a></span><span> </span><span class="annot"><span class="annottext">WebHookLog
</span><a href="#local-6989586621688129756"><span class="hs-identifier hs-var">whl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;response&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">WebHookLog -&gt; Maybe Text
</span><a href="Hasura.Server.Logging.html#whlResponse"><span class="hs-identifier hs-var hs-var">whlResponse</span></a></span><span> </span><span class="annot"><span class="annottext">WebHookLog
</span><a href="#local-6989586621688129756"><span class="hs-identifier hs-var">whl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;message&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">WebHookLog -&gt; Maybe Text
</span><a href="Hasura.Server.Logging.html#whlMessage"><span class="hs-identifier hs-var hs-var">whlMessage</span></a></span><span> </span><span class="annot"><span class="annottext">WebHookLog
</span><a href="#local-6989586621688129756"><span class="hs-identifier hs-var">whl</span></a></span><span>
</span><span id="line-142"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | GQLQueryOperationSuccessLog captures all the data required to construct</span><span>
</span><span id="line-145"></span><span class="hs-comment">--   an HTTP success log.</span><span>
</span><span id="line-146"></span><span class="hs-keyword">data</span><span> </span><span id="GQLQueryOperationSuccessLog"><span class="annot"><a href="Hasura.Server.Logging.html#GQLQueryOperationSuccessLog"><span class="hs-identifier hs-var">GQLQueryOperationSuccessLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GQLQueryOperationSuccessLog"><span class="annot"><a href="Hasura.Server.Logging.html#GQLQueryOperationSuccessLog"><span class="hs-identifier hs-var">GQLQueryOperationSuccessLog</span></a></span></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="gqolQuery"><span class="annot"><span class="annottext">GQLQueryOperationSuccessLog -&gt; GQLReqUnparsed
</span><a href="Hasura.Server.Logging.html#gqolQuery"><span class="hs-identifier hs-var hs-var">gqolQuery</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLReqUnparsed"><span class="hs-identifier hs-type">GH.GQLReqUnparsed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-148"></span><span>    </span><span id="gqolQueryExecutionTime"><span class="annot"><span class="annottext">GQLQueryOperationSuccessLog -&gt; DiffTime
</span><a href="Hasura.Server.Logging.html#gqolQueryExecutionTime"><span class="hs-identifier hs-var hs-var">gqolQueryExecutionTime</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">DiffTime</span></span><span class="hs-special">,</span><span>
</span><span id="line-149"></span><span>    </span><span id="gqolResponseSize"><span class="annot"><span class="annottext">GQLQueryOperationSuccessLog -&gt; Int64
</span><a href="Hasura.Server.Logging.html#gqolResponseSize"><span class="hs-identifier hs-var hs-var">gqolResponseSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">,</span><span>
</span><span id="line-150"></span><span>    </span><span id="gqolRequestSize"><span class="annot"><span class="annottext">GQLQueryOperationSuccessLog -&gt; Int64
</span><a href="Hasura.Server.Logging.html#gqolRequestSize"><span class="hs-identifier hs-var hs-var">gqolRequestSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">,</span><span>
</span><span id="line-151"></span><span>    </span><span id="gqolParameterizedQueryHash"><span class="annot"><span class="annottext">GQLQueryOperationSuccessLog -&gt; ParameterizedQueryHash
</span><a href="Hasura.Server.Logging.html#gqolParameterizedQueryHash"><span class="hs-identifier hs-var hs-var">gqolParameterizedQueryHash</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.GraphQL.ParameterizedQueryHash.html#ParameterizedQueryHash"><span class="hs-identifier hs-type">ParameterizedQueryHash</span></a></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688129741"><span id="local-6989586621688129743"><span id="local-6989586621688129745"><span class="annot"><span class="annottext">Int -&gt; GQLQueryOperationSuccessLog -&gt; ShowS
[GQLQueryOperationSuccessLog] -&gt; ShowS
GQLQueryOperationSuccessLog -&gt; String
(Int -&gt; GQLQueryOperationSuccessLog -&gt; ShowS)
-&gt; (GQLQueryOperationSuccessLog -&gt; String)
-&gt; ([GQLQueryOperationSuccessLog] -&gt; ShowS)
-&gt; Show GQLQueryOperationSuccessLog
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [GQLQueryOperationSuccessLog] -&gt; ShowS
$cshowList :: [GQLQueryOperationSuccessLog] -&gt; ShowS
show :: GQLQueryOperationSuccessLog -&gt; String
$cshow :: GQLQueryOperationSuccessLog -&gt; String
showsPrec :: Int -&gt; GQLQueryOperationSuccessLog -&gt; ShowS
$cshowsPrec :: Int -&gt; GQLQueryOperationSuccessLog -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688129737"><span id="local-6989586621688129739"><span class="annot"><span class="annottext">GQLQueryOperationSuccessLog -&gt; GQLQueryOperationSuccessLog -&gt; Bool
(GQLQueryOperationSuccessLog
 -&gt; GQLQueryOperationSuccessLog -&gt; Bool)
-&gt; (GQLQueryOperationSuccessLog
    -&gt; GQLQueryOperationSuccessLog -&gt; Bool)
-&gt; Eq GQLQueryOperationSuccessLog
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: GQLQueryOperationSuccessLog -&gt; GQLQueryOperationSuccessLog -&gt; Bool
$c/= :: GQLQueryOperationSuccessLog -&gt; GQLQueryOperationSuccessLog -&gt; Bool
== :: GQLQueryOperationSuccessLog -&gt; GQLQueryOperationSuccessLog -&gt; Bool
$c== :: GQLQueryOperationSuccessLog -&gt; GQLQueryOperationSuccessLog -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-special">$(</span><span id="local-6989586621688129729"><span id="local-6989586621688129731"><span id="local-6989586621688129733"><span id="local-6989586621688129735"><span class="hs-identifier">deriveToJSON</span><span> </span><span class="hs-identifier">hasuraJSON</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">omitNothingFields</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span class="hs-special">}</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">GQLQueryOperationSuccessLog</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | GQLQueryOperationErrorLog captures the request along with the error message</span><span>
</span><span id="line-158"></span><span class="hs-keyword">data</span><span> </span><span id="GQLQueryOperationErrorLog"><span class="annot"><a href="Hasura.Server.Logging.html#GQLQueryOperationErrorLog"><span class="hs-identifier hs-var">GQLQueryOperationErrorLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GQLQueryOperationErrorLog"><span class="annot"><a href="Hasura.Server.Logging.html#GQLQueryOperationErrorLog"><span class="hs-identifier hs-var">GQLQueryOperationErrorLog</span></a></span></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="gqelQuery"><span class="annot"><span class="annottext">GQLQueryOperationErrorLog -&gt; GQLReqUnparsed
</span><a href="Hasura.Server.Logging.html#gqelQuery"><span class="hs-identifier hs-var hs-var">gqelQuery</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLReqUnparsed"><span class="hs-identifier hs-type">GH.GQLReqUnparsed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-160"></span><span>    </span><span id="gqelError"><span class="annot"><span class="annottext">GQLQueryOperationErrorLog -&gt; QErr
</span><a href="Hasura.Server.Logging.html#gqelError"><span class="hs-identifier hs-var hs-var">gqelError</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688129719"><span id="local-6989586621688129721"><span id="local-6989586621688129723"><span class="annot"><span class="annottext">Int -&gt; GQLQueryOperationErrorLog -&gt; ShowS
[GQLQueryOperationErrorLog] -&gt; ShowS
GQLQueryOperationErrorLog -&gt; String
(Int -&gt; GQLQueryOperationErrorLog -&gt; ShowS)
-&gt; (GQLQueryOperationErrorLog -&gt; String)
-&gt; ([GQLQueryOperationErrorLog] -&gt; ShowS)
-&gt; Show GQLQueryOperationErrorLog
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [GQLQueryOperationErrorLog] -&gt; ShowS
$cshowList :: [GQLQueryOperationErrorLog] -&gt; ShowS
show :: GQLQueryOperationErrorLog -&gt; String
$cshow :: GQLQueryOperationErrorLog -&gt; String
showsPrec :: Int -&gt; GQLQueryOperationErrorLog -&gt; ShowS
$cshowsPrec :: Int -&gt; GQLQueryOperationErrorLog -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688129715"><span id="local-6989586621688129717"><span class="annot"><span class="annottext">GQLQueryOperationErrorLog -&gt; GQLQueryOperationErrorLog -&gt; Bool
(GQLQueryOperationErrorLog -&gt; GQLQueryOperationErrorLog -&gt; Bool)
-&gt; (GQLQueryOperationErrorLog -&gt; GQLQueryOperationErrorLog -&gt; Bool)
-&gt; Eq GQLQueryOperationErrorLog
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: GQLQueryOperationErrorLog -&gt; GQLQueryOperationErrorLog -&gt; Bool
$c/= :: GQLQueryOperationErrorLog -&gt; GQLQueryOperationErrorLog -&gt; Bool
== :: GQLQueryOperationErrorLog -&gt; GQLQueryOperationErrorLog -&gt; Bool
$c== :: GQLQueryOperationErrorLog -&gt; GQLQueryOperationErrorLog -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-special">$(</span><span id="local-6989586621688129707"><span id="local-6989586621688129709"><span id="local-6989586621688129711"><span id="local-6989586621688129713"><span class="hs-identifier">deriveToJSON</span><span> </span><span class="hs-identifier">hasuraJSON</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">GQLQueryOperationErrorLog</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-keyword">data</span><span> </span><span id="GQLBatchQueryOperationLog"><span class="annot"><a href="Hasura.Server.Logging.html#GQLBatchQueryOperationLog"><span class="hs-identifier hs-var">GQLBatchQueryOperationLog</span></a></span></span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="GQLQueryOperationSuccess"><span class="annot"><a href="Hasura.Server.Logging.html#GQLQueryOperationSuccess"><span class="hs-identifier hs-var">GQLQueryOperationSuccess</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Server.Logging.html#GQLQueryOperationSuccessLog"><span class="hs-identifier hs-type">GQLQueryOperationSuccessLog</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GQLQueryOperationError"><span class="annot"><a href="Hasura.Server.Logging.html#GQLQueryOperationError"><span class="hs-identifier hs-var">GQLQueryOperationError</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Server.Logging.html#GQLQueryOperationErrorLog"><span class="hs-identifier hs-type">GQLQueryOperationErrorLog</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688129699"><span id="local-6989586621688129701"><span id="local-6989586621688129703"><span class="annot"><span class="annottext">Int -&gt; GQLBatchQueryOperationLog -&gt; ShowS
[GQLBatchQueryOperationLog] -&gt; ShowS
GQLBatchQueryOperationLog -&gt; String
(Int -&gt; GQLBatchQueryOperationLog -&gt; ShowS)
-&gt; (GQLBatchQueryOperationLog -&gt; String)
-&gt; ([GQLBatchQueryOperationLog] -&gt; ShowS)
-&gt; Show GQLBatchQueryOperationLog
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [GQLBatchQueryOperationLog] -&gt; ShowS
$cshowList :: [GQLBatchQueryOperationLog] -&gt; ShowS
show :: GQLBatchQueryOperationLog -&gt; String
$cshow :: GQLBatchQueryOperationLog -&gt; String
showsPrec :: Int -&gt; GQLBatchQueryOperationLog -&gt; ShowS
$cshowsPrec :: Int -&gt; GQLBatchQueryOperationLog -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688129695"><span id="local-6989586621688129697"><span class="annot"><span class="annottext">GQLBatchQueryOperationLog -&gt; GQLBatchQueryOperationLog -&gt; Bool
(GQLBatchQueryOperationLog -&gt; GQLBatchQueryOperationLog -&gt; Bool)
-&gt; (GQLBatchQueryOperationLog -&gt; GQLBatchQueryOperationLog -&gt; Bool)
-&gt; Eq GQLBatchQueryOperationLog
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: GQLBatchQueryOperationLog -&gt; GQLBatchQueryOperationLog -&gt; Bool
$c/= :: GQLBatchQueryOperationLog -&gt; GQLBatchQueryOperationLog -&gt; Bool
== :: GQLBatchQueryOperationLog -&gt; GQLBatchQueryOperationLog -&gt; Bool
$c== :: GQLBatchQueryOperationLog -&gt; GQLBatchQueryOperationLog -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621688129688"><span id="local-6989586621688129690"><span id="local-6989586621688129692"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#GQLBatchQueryOperationLog"><span class="hs-identifier hs-type">GQLBatchQueryOperationLog</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621688129687"><span class="annot"><span class="annottext">toJSON :: GQLBatchQueryOperationLog -&gt; Value
</span><a href="#local-6989586621688129687"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#GQLQueryOperationSuccess"><span class="hs-identifier hs-type">GQLQueryOperationSuccess</span></a></span><span> </span><span id="local-6989586621688129686"><span class="annot"><span class="annottext">GQLQueryOperationSuccessLog
</span><a href="#local-6989586621688129686"><span class="hs-identifier hs-var">successLog</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GQLQueryOperationSuccessLog -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">GQLQueryOperationSuccessLog
</span><a href="#local-6989586621688129686"><span class="hs-identifier hs-var">successLog</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#GQLQueryOperationError"><span class="hs-identifier hs-type">GQLQueryOperationError</span></a></span><span> </span><span id="local-6989586621688129685"><span class="annot"><span class="annottext">GQLQueryOperationErrorLog
</span><a href="#local-6989586621688129685"><span class="hs-identifier hs-var">errorLog</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GQLQueryOperationErrorLog -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">GQLQueryOperationErrorLog
</span><a href="#local-6989586621688129685"><span class="hs-identifier hs-var">errorLog</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- | whether a request is executed in batched mode or not</span><span>
</span><span id="line-177"></span><span class="hs-keyword">data</span><span> </span><span id="RequestMode"><span class="annot"><a href="Hasura.Server.Logging.html#RequestMode"><span class="hs-identifier hs-var">RequestMode</span></a></span></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | this request is batched</span><span>
</span><span id="line-179"></span><span>    </span><span id="RequestModeBatched"><span class="annot"><a href="Hasura.Server.Logging.html#RequestModeBatched"><span class="hs-identifier hs-var">RequestModeBatched</span></a></span></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | this is a single request</span><span>
</span><span id="line-181"></span><span>    </span><span id="RequestModeSingle"><span class="annot"><a href="Hasura.Server.Logging.html#RequestModeSingle"><span class="hs-identifier hs-var">RequestModeSingle</span></a></span></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | this request is of a kind for which batching is not done or does not make sense</span><span>
</span><span id="line-183"></span><span>    </span><span id="RequestModeNonBatchable"><span class="annot"><a href="Hasura.Server.Logging.html#RequestModeNonBatchable"><span class="hs-identifier hs-var">RequestModeNonBatchable</span></a></span></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | the execution of this request failed</span><span>
</span><span id="line-185"></span><span>    </span><span id="RequestModeError"><span class="annot"><a href="Hasura.Server.Logging.html#RequestModeError"><span class="hs-identifier hs-var">RequestModeError</span></a></span></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688129675"><span id="local-6989586621688129677"><span id="local-6989586621688129679"><span class="annot"><span class="annottext">Int -&gt; RequestMode -&gt; ShowS
[RequestMode] -&gt; ShowS
RequestMode -&gt; String
(Int -&gt; RequestMode -&gt; ShowS)
-&gt; (RequestMode -&gt; String)
-&gt; ([RequestMode] -&gt; ShowS)
-&gt; Show RequestMode
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [RequestMode] -&gt; ShowS
$cshowList :: [RequestMode] -&gt; ShowS
show :: RequestMode -&gt; String
$cshow :: RequestMode -&gt; String
showsPrec :: Int -&gt; RequestMode -&gt; ShowS
$cshowsPrec :: Int -&gt; RequestMode -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688129671"><span id="local-6989586621688129673"><span class="annot"><span class="annottext">RequestMode -&gt; RequestMode -&gt; Bool
(RequestMode -&gt; RequestMode -&gt; Bool)
-&gt; (RequestMode -&gt; RequestMode -&gt; Bool) -&gt; Eq RequestMode
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: RequestMode -&gt; RequestMode -&gt; Bool
$c/= :: RequestMode -&gt; RequestMode -&gt; Bool
== :: RequestMode -&gt; RequestMode -&gt; Bool
$c== :: RequestMode -&gt; RequestMode -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621688129664"><span id="local-6989586621688129666"><span id="local-6989586621688129668"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#RequestMode"><span class="hs-identifier hs-type">RequestMode</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621688129663"><span class="annot"><span class="annottext">toJSON :: RequestMode -&gt; Value
</span><a href="#local-6989586621688129663"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><span class="annottext">RequestMode
</span><a href="Hasura.Server.Logging.html#RequestModeBatched"><span class="hs-identifier hs-var">RequestModeBatched</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;batched&quot;</span></span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><span class="annottext">RequestMode
</span><a href="Hasura.Server.Logging.html#RequestModeSingle"><span class="hs-identifier hs-var">RequestModeSingle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;single&quot;</span></span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><span class="annottext">RequestMode
</span><a href="Hasura.Server.Logging.html#RequestModeNonBatchable"><span class="hs-identifier hs-var">RequestModeNonBatchable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;non-graphql&quot;</span></span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><span class="annottext">RequestMode
</span><a href="Hasura.Server.Logging.html#RequestModeError"><span class="hs-identifier hs-var">RequestModeError</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;error&quot;</span></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-keyword">data</span><span> </span><span id="CommonHttpLogMetadata"><span class="annot"><a href="Hasura.Server.Logging.html#CommonHttpLogMetadata"><span class="hs-identifier hs-var">CommonHttpLogMetadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CommonHttpLogMetadata"><span class="annot"><a href="Hasura.Server.Logging.html#CommonHttpLogMetadata"><span class="hs-identifier hs-var">CommonHttpLogMetadata</span></a></span></span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_chlmRequestMode"><span class="annot"><span class="annottext">CommonHttpLogMetadata -&gt; RequestMode
</span><a href="Hasura.Server.Logging.html#_chlmRequestMode"><span class="hs-identifier hs-var hs-var">_chlmRequestMode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Server.Logging.html#RequestMode"><span class="hs-identifier hs-type">RequestMode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-197"></span><span>    </span><span id="_chlmBatchOperationLog"><span class="annot"><span class="annottext">CommonHttpLogMetadata
-&gt; Maybe (GQLBatchedReqs GQLBatchQueryOperationLog)
</span><a href="Hasura.Server.Logging.html#_chlmBatchOperationLog"><span class="hs-identifier hs-var hs-var">_chlmBatchOperationLog</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLBatchedReqs"><span class="hs-identifier hs-type">GH.GQLBatchedReqs</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#GQLBatchQueryOperationLog"><span class="hs-identifier hs-type">GQLBatchQueryOperationLog</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688129654"><span id="local-6989586621688129656"><span id="local-6989586621688129658"><span class="annot"><span class="annottext">Int -&gt; CommonHttpLogMetadata -&gt; ShowS
[CommonHttpLogMetadata] -&gt; ShowS
CommonHttpLogMetadata -&gt; String
(Int -&gt; CommonHttpLogMetadata -&gt; ShowS)
-&gt; (CommonHttpLogMetadata -&gt; String)
-&gt; ([CommonHttpLogMetadata] -&gt; ShowS)
-&gt; Show CommonHttpLogMetadata
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [CommonHttpLogMetadata] -&gt; ShowS
$cshowList :: [CommonHttpLogMetadata] -&gt; ShowS
show :: CommonHttpLogMetadata -&gt; String
$cshow :: CommonHttpLogMetadata -&gt; String
showsPrec :: Int -&gt; CommonHttpLogMetadata -&gt; ShowS
$cshowsPrec :: Int -&gt; CommonHttpLogMetadata -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688129650"><span id="local-6989586621688129652"><span class="annot"><span class="annottext">CommonHttpLogMetadata -&gt; CommonHttpLogMetadata -&gt; Bool
(CommonHttpLogMetadata -&gt; CommonHttpLogMetadata -&gt; Bool)
-&gt; (CommonHttpLogMetadata -&gt; CommonHttpLogMetadata -&gt; Bool)
-&gt; Eq CommonHttpLogMetadata
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: CommonHttpLogMetadata -&gt; CommonHttpLogMetadata -&gt; Bool
$c/= :: CommonHttpLogMetadata -&gt; CommonHttpLogMetadata -&gt; Bool
== :: CommonHttpLogMetadata -&gt; CommonHttpLogMetadata -&gt; Bool
$c== :: CommonHttpLogMetadata -&gt; CommonHttpLogMetadata -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | The http-log metadata attached to HTTP requests running in the monad 'm', split into a</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- common portion that is present regardless of 'm', and a monad-specific one defined in the</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- 'HttpLog' instance.</span><span>
</span><span id="line-204"></span><span class="hs-comment">--</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- This allows us to not have to duplicate the code that generates the common part of the metadata</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- across OSS and Pro, so that instances only have to implement the part of it unique to them.</span><span>
</span><span id="line-207"></span><span class="hs-keyword">type</span><span> </span><span id="HttpLogMetadata"><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogMetadata"><span class="hs-identifier hs-var">HttpLogMetadata</span></a></span></span><span> </span><span id="local-6989586621688129649"><span class="annot"><a href="#local-6989586621688129649"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Logging.html#CommonHttpLogMetadata"><span class="hs-identifier hs-type">CommonHttpLogMetadata</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#ExtraHttpLogMetadata"><span class="hs-identifier hs-type">ExtraHttpLogMetadata</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129649"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="annot"><a href="Hasura.Server.Logging.html#buildHttpLogMetadata"><span class="hs-identifier hs-type">buildHttpLogMetadata</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621688129648"><span class="annot"><a href="#local-6989586621688129648"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier hs-type">HttpLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129648"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><a href="Hasura.GraphQL.ParameterizedQueryHash.html#ParameterizedQueryHashList"><span class="hs-identifier hs-type">ParameterizedQueryHashList</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-213"></span><span>  </span><span class="annot"><a href="Hasura.Server.Logging.html#RequestMode"><span class="hs-identifier hs-type">RequestMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLBatchedReqs"><span class="hs-identifier hs-type">GH.GQLBatchedReqs</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#GQLBatchQueryOperationLog"><span class="hs-identifier hs-type">GQLBatchQueryOperationLog</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogMetadata"><span class="hs-identifier hs-type">HttpLogMetadata</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129648"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-216"></span><span id="buildHttpLogMetadata"><span class="annot"><span class="annottext">buildHttpLogMetadata :: ParameterizedQueryHashList
-&gt; RequestMode
-&gt; Maybe (GQLBatchedReqs GQLBatchQueryOperationLog)
-&gt; HttpLogMetadata m
</span><a href="Hasura.Server.Logging.html#buildHttpLogMetadata"><span class="hs-identifier hs-var hs-var">buildHttpLogMetadata</span></a></span></span><span> </span><span id="local-6989586621688129647"><span class="annot"><span class="annottext">ParameterizedQueryHashList
</span><a href="#local-6989586621688129647"><span class="hs-identifier hs-var">paramQueryHashList</span></a></span></span><span> </span><span id="local-6989586621688129646"><span class="annot"><span class="annottext">RequestMode
</span><a href="#local-6989586621688129646"><span class="hs-identifier hs-var">requestMode</span></a></span></span><span> </span><span id="local-6989586621688129645"><span class="annot"><span class="annottext">Maybe (GQLBatchedReqs GQLBatchQueryOperationLog)
</span><a href="#local-6989586621688129645"><span class="hs-identifier hs-var">batchQueryOperationLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RequestMode
-&gt; Maybe (GQLBatchedReqs GQLBatchQueryOperationLog)
-&gt; CommonHttpLogMetadata
</span><a href="Hasura.Server.Logging.html#CommonHttpLogMetadata"><span class="hs-identifier hs-var">CommonHttpLogMetadata</span></a></span><span> </span><span class="annot"><span class="annottext">RequestMode
</span><a href="#local-6989586621688129646"><span class="hs-identifier hs-var">requestMode</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (GQLBatchedReqs GQLBatchQueryOperationLog)
</span><a href="#local-6989586621688129645"><span class="hs-identifier hs-var">batchQueryOperationLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ParameterizedQueryHashList -&gt; ExtraHttpLogMetadata m
forall (m :: * -&gt; *).
HttpLog m =&gt;
ParameterizedQueryHashList -&gt; ExtraHttpLogMetadata m
</span><a href="Hasura.Server.Logging.html#buildExtraHttpLogMetadata"><span class="hs-identifier hs-var">buildExtraHttpLogMetadata</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621688129648"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="annottext">ParameterizedQueryHashList
</span><a href="#local-6989586621688129647"><span class="hs-identifier hs-var">paramQueryHashList</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-- | synonym for clarity, writing `emptyHttpLogMetadata @m` instead of `def @(HttpLogMetadata m)`</span><span>
</span><span id="line-220"></span><span class="annot"><a href="Hasura.Server.Logging.html#emptyHttpLogMetadata"><span class="hs-identifier hs-type">emptyHttpLogMetadata</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621688129643"><span class="annot"><a href="#local-6989586621688129643"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier hs-type">HttpLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129643"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogMetadata"><span class="hs-identifier hs-type">HttpLogMetadata</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129643"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-221"></span><span id="emptyHttpLogMetadata"><span class="annot"><span class="annottext">emptyHttpLogMetadata :: HttpLogMetadata m
</span><a href="Hasura.Server.Logging.html#emptyHttpLogMetadata"><span class="hs-identifier hs-var hs-var">emptyHttpLogMetadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RequestMode
-&gt; Maybe (GQLBatchedReqs GQLBatchQueryOperationLog)
-&gt; CommonHttpLogMetadata
</span><a href="Hasura.Server.Logging.html#CommonHttpLogMetadata"><span class="hs-identifier hs-var">CommonHttpLogMetadata</span></a></span><span> </span><span class="annot"><span class="annottext">RequestMode
</span><a href="Hasura.Server.Logging.html#RequestModeNonBatchable"><span class="hs-identifier hs-var">RequestModeNonBatchable</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (GQLBatchedReqs GQLBatchQueryOperationLog)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HttpLog m =&gt; ExtraHttpLogMetadata m
forall (m :: * -&gt; *). HttpLog m =&gt; ExtraHttpLogMetadata m
</span><a href="Hasura.Server.Logging.html#emptyExtraHttpLogMetadata"><span class="hs-identifier hs-var">emptyExtraHttpLogMetadata</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621688129643"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">{- Note [Disable query printing when query-log is disabled]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
As a temporary hack (as per https://github.com/hasura/graphql-engine-mono/issues/1770),
we want to print the graphql query string in `http-log` or `websocket-log` only
when `query-log` is enabled.
-}</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621688129981"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="HttpLog"><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier hs-var">HttpLog</span></a></span></span><span> </span><span id="local-6989586621688129981"><span class="annot"><a href="#local-6989586621688129981"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-comment">-- | Extra http-log metadata that we attach when operating in 'm'.</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ExtraHttpLogMetadata"><span class="annot"><a href="Hasura.Server.Logging.html#ExtraHttpLogMetadata"><span class="hs-identifier hs-var">ExtraHttpLogMetadata</span></a></span></span><span> </span><span id="local-6989586621688129981"><span class="annot"><a href="#local-6989586621688129981"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span>  </span><span id="emptyExtraHttpLogMetadata"><span class="annot"><a href="Hasura.Server.Logging.html#emptyExtraHttpLogMetadata"><span class="hs-identifier hs-type">emptyExtraHttpLogMetadata</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#ExtraHttpLogMetadata"><span class="hs-identifier hs-type">ExtraHttpLogMetadata</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129981"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>  </span><span id="buildExtraHttpLogMetadata"><span class="annot"><a href="Hasura.Server.Logging.html#buildExtraHttpLogMetadata"><span class="hs-identifier hs-type">buildExtraHttpLogMetadata</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.GraphQL.ParameterizedQueryHash.html#ParameterizedQueryHashList"><span class="hs-identifier hs-type">ParameterizedQueryHashList</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#ExtraHttpLogMetadata"><span class="hs-identifier hs-type">ExtraHttpLogMetadata</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129981"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span>  </span><span id="logHttpError"><span class="annot"><a href="Hasura.Server.Logging.html#logHttpError"><span class="hs-identifier hs-type">logHttpError</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-comment">-- | the logger</span><span>
</span><span id="line-240"></span><span>    </span><span class="annot"><a href="Hasura.Logging.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">Hasura</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-comment">-- | this is only required for the short-term fix in https://github.com/hasura/graphql-engine-mono/issues/1770</span><span>
</span><span id="line-242"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">HashSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Logging.html#EngineLogType"><span class="hs-identifier hs-type">EngineLogType</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">Hasura</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-comment">-- | user info may or may not be present (error can happen during user resolution)</span><span>
</span><span id="line-244"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-comment">-- | request id of the request</span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><a href="Hasura.Server.Types.html#RequestId"><span class="hs-identifier hs-type">RequestId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-comment">-- | the Wai.Request object</span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Wai.Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-comment">-- | the request body and parsed request</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-comment">-- | the error</span><span>
</span><span id="line-252"></span><span>    </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-comment">-- | list of request headers</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">HTTP.Header</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><a href="#local-6989586621688129981"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span>  </span><span id="logHttpSuccess"><span class="annot"><a href="Hasura.Server.Logging.html#logHttpSuccess"><span class="hs-identifier hs-type">logHttpSuccess</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-comment">-- | the logger</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><a href="Hasura.Logging.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">Hasura</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-comment">-- | this is only required for the short-term fix in https://github.com/hasura/graphql-engine-mono/issues/1770</span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">HashSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Logging.html#EngineLogType"><span class="hs-identifier hs-type">EngineLogType</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">Hasura</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-comment">-- | user info may or may not be present (error can happen during user resolution)</span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-comment">-- | request id of the request</span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><a href="Hasura.Server.Types.html#RequestId"><span class="hs-identifier hs-type">RequestId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-comment">-- | the Wai.Request object</span><span>
</span><span id="line-267"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Wai.Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-comment">-- | the request body and parsed request</span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-comment">-- | the response bytes</span><span>
</span><span id="line-271"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-comment">-- | the compressed response bytes</span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-comment">-- ^ TODO (from master): make the above two type represented</span><span>
</span><span id="line-274"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-comment">-- | IO/network wait time and service time (respectively) for this request, if available.</span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DiffTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiffTime</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-comment">-- | possible compression type</span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.Server.Compression.html#CompressionType"><span class="hs-identifier hs-type">CompressionType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-comment">-- | list of request headers</span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">HTTP.Header</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogMetadata"><span class="hs-identifier hs-type">HttpLogMetadata</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129981"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><a href="#local-6989586621688129981"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span id="local-6989586621688129639"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier hs-type">HttpLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129639"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier hs-type">HttpLog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Tracing.html#TraceT"><span class="hs-identifier hs-type">TraceT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129639"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ExtraHttpLogMetadata"><span class="annot"><a href="Hasura.Server.Logging.html#ExtraHttpLogMetadata"><span class="hs-identifier hs-var">ExtraHttpLogMetadata</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Tracing.html#TraceT"><span class="hs-identifier hs-type">TraceT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129639"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#ExtraHttpLogMetadata"><span class="hs-identifier hs-type">ExtraHttpLogMetadata</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129639"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span>  </span><span id="local-6989586621688129632"><span class="annot"><span class="annottext">buildExtraHttpLogMetadata :: ParameterizedQueryHashList -&gt; ExtraHttpLogMetadata (TraceT m)
</span><a href="#local-6989586621688129632"><span class="hs-identifier hs-var hs-var hs-var hs-var">buildExtraHttpLogMetadata</span></a></span></span><span> </span><span id="local-6989586621688129631"><span class="annot"><span class="annottext">ParameterizedQueryHashList
</span><a href="#local-6989586621688129631"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParameterizedQueryHashList -&gt; ExtraHttpLogMetadata m
forall (m :: * -&gt; *).
HttpLog m =&gt;
ParameterizedQueryHashList -&gt; ExtraHttpLogMetadata m
</span><a href="Hasura.Server.Logging.html#buildExtraHttpLogMetadata"><span class="hs-identifier hs-var">buildExtraHttpLogMetadata</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621688129639"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="annottext">ParameterizedQueryHashList
</span><a href="#local-6989586621688129631"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-288"></span><span>  </span><span id="local-6989586621688129630"><span class="annot"><span class="annottext">emptyExtraHttpLogMetadata :: ExtraHttpLogMetadata (TraceT m)
</span><a href="#local-6989586621688129630"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptyExtraHttpLogMetadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HttpLog m =&gt; ExtraHttpLogMetadata m
forall (m :: * -&gt; *). HttpLog m =&gt; ExtraHttpLogMetadata m
</span><a href="Hasura.Server.Logging.html#emptyExtraHttpLogMetadata"><span class="hs-identifier hs-var">emptyExtraHttpLogMetadata</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621688129639"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span>  </span><span id="local-6989586621688129629"><span class="annot"><span class="annottext">logHttpError :: Logger Hasura
-&gt; HashSet (EngineLogType Hasura)
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; QErr
-&gt; [Header]
-&gt; TraceT m ()
</span><a href="#local-6989586621688129629"><span class="hs-identifier hs-var hs-var hs-var hs-var">logHttpError</span></a></span></span><span> </span><span id="local-6989586621688129628"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621688129628"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621688129627"><span class="annot"><span class="annottext">HashSet (EngineLogType Hasura)
</span><a href="#local-6989586621688129627"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621688129626"><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621688129626"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621688129625"><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621688129625"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621688129624"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129624"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621688129623"><span class="annot"><span class="annottext">(ByteString, Maybe Value)
</span><a href="#local-6989586621688129623"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621688129622"><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621688129622"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621688129621"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621688129621"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; TraceT m ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; TraceT m ()) -&gt; m () -&gt; TraceT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
-&gt; HashSet (EngineLogType Hasura)
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; QErr
-&gt; [Header]
-&gt; m ()
forall (m :: * -&gt; *).
HttpLog m =&gt;
Logger Hasura
-&gt; HashSet (EngineLogType Hasura)
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; QErr
-&gt; [Header]
-&gt; m ()
</span><a href="Hasura.Server.Logging.html#logHttpError"><span class="hs-identifier hs-var">logHttpError</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621688129628"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (EngineLogType Hasura)
</span><a href="#local-6989586621688129627"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621688129626"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621688129625"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129624"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString, Maybe Value)
</span><a href="#local-6989586621688129623"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621688129622"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621688129621"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span>  </span><span id="local-6989586621688129619"><span class="annot"><span class="annottext">logHttpSuccess :: Logger Hasura
-&gt; HashSet (EngineLogType Hasura)
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; ByteString
-&gt; ByteString
-&gt; Maybe (DiffTime, DiffTime)
-&gt; Maybe CompressionType
-&gt; [Header]
-&gt; HttpLogMetadata (TraceT m)
-&gt; TraceT m ()
</span><a href="#local-6989586621688129619"><span class="hs-identifier hs-var hs-var hs-var hs-var">logHttpSuccess</span></a></span></span><span> </span><span id="local-6989586621688129618"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621688129618"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621688129617"><span class="annot"><span class="annottext">HashSet (EngineLogType Hasura)
</span><a href="#local-6989586621688129617"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621688129616"><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621688129616"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621688129615"><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621688129615"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621688129614"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129614"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621688129613"><span class="annot"><span class="annottext">(ByteString, Maybe Value)
</span><a href="#local-6989586621688129613"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621688129612"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621688129612"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621688129611"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621688129611"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621688129610"><span class="annot"><span class="annottext">Maybe (DiffTime, DiffTime)
</span><a href="#local-6989586621688129610"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621688129609"><span class="annot"><span class="annottext">Maybe CompressionType
</span><a href="#local-6989586621688129609"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621688129608"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621688129608"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621688129607"><span class="annot"><span class="annottext">HttpLogMetadata (TraceT m)
</span><a href="#local-6989586621688129607"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; TraceT m ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; TraceT m ()) -&gt; m () -&gt; TraceT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
-&gt; HashSet (EngineLogType Hasura)
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; ByteString
-&gt; ByteString
-&gt; Maybe (DiffTime, DiffTime)
-&gt; Maybe CompressionType
-&gt; [Header]
-&gt; HttpLogMetadata m
-&gt; m ()
forall (m :: * -&gt; *).
HttpLog m =&gt;
Logger Hasura
-&gt; HashSet (EngineLogType Hasura)
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; ByteString
-&gt; ByteString
-&gt; Maybe (DiffTime, DiffTime)
-&gt; Maybe CompressionType
-&gt; [Header]
-&gt; HttpLogMetadata m
-&gt; m ()
</span><a href="Hasura.Server.Logging.html#logHttpSuccess"><span class="hs-identifier hs-var">logHttpSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621688129618"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (EngineLogType Hasura)
</span><a href="#local-6989586621688129617"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621688129616"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621688129615"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129614"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString, Maybe Value)
</span><a href="#local-6989586621688129613"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621688129612"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621688129611"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (DiffTime, DiffTime)
</span><a href="#local-6989586621688129610"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CompressionType
</span><a href="#local-6989586621688129609"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621688129608"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">HttpLogMetadata m
HttpLogMetadata (TraceT m)
</span><a href="#local-6989586621688129607"><span class="hs-identifier hs-var">l</span></a></span></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span id="local-6989586621688129605"><span id="local-6989586621688129606"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier hs-type">HttpLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129606"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier hs-type">HttpLog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621688129605"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129606"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ExtraHttpLogMetadata"><span class="annot"><a href="Hasura.Server.Logging.html#ExtraHttpLogMetadata"><span class="hs-identifier hs-var">ExtraHttpLogMetadata</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621688129605"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129606"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#ExtraHttpLogMetadata"><span class="hs-identifier hs-type">ExtraHttpLogMetadata</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129606"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span>  </span><span id="local-6989586621688129599"><span class="annot"><span class="annottext">buildExtraHttpLogMetadata :: ParameterizedQueryHashList -&gt; ExtraHttpLogMetadata (ReaderT r m)
</span><a href="#local-6989586621688129599"><span class="hs-identifier hs-var hs-var hs-var hs-var">buildExtraHttpLogMetadata</span></a></span></span><span> </span><span id="local-6989586621688129598"><span class="annot"><span class="annottext">ParameterizedQueryHashList
</span><a href="#local-6989586621688129598"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParameterizedQueryHashList -&gt; ExtraHttpLogMetadata m
forall (m :: * -&gt; *).
HttpLog m =&gt;
ParameterizedQueryHashList -&gt; ExtraHttpLogMetadata m
</span><a href="Hasura.Server.Logging.html#buildExtraHttpLogMetadata"><span class="hs-identifier hs-var">buildExtraHttpLogMetadata</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621688129606"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="annottext">ParameterizedQueryHashList
</span><a href="#local-6989586621688129598"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-298"></span><span>  </span><span id="local-6989586621688129597"><span class="annot"><span class="annottext">emptyExtraHttpLogMetadata :: ExtraHttpLogMetadata (ReaderT r m)
</span><a href="#local-6989586621688129597"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptyExtraHttpLogMetadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HttpLog m =&gt; ExtraHttpLogMetadata m
forall (m :: * -&gt; *). HttpLog m =&gt; ExtraHttpLogMetadata m
</span><a href="Hasura.Server.Logging.html#emptyExtraHttpLogMetadata"><span class="hs-identifier hs-var">emptyExtraHttpLogMetadata</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621688129606"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span>  </span><span id="local-6989586621688129596"><span class="annot"><span class="annottext">logHttpError :: Logger Hasura
-&gt; HashSet (EngineLogType Hasura)
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; QErr
-&gt; [Header]
-&gt; ReaderT r m ()
</span><a href="#local-6989586621688129596"><span class="hs-identifier hs-var hs-var hs-var hs-var">logHttpError</span></a></span></span><span> </span><span id="local-6989586621688129595"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621688129595"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621688129594"><span class="annot"><span class="annottext">HashSet (EngineLogType Hasura)
</span><a href="#local-6989586621688129594"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621688129593"><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621688129593"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621688129592"><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621688129592"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621688129591"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129591"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621688129590"><span class="annot"><span class="annottext">(ByteString, Maybe Value)
</span><a href="#local-6989586621688129590"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621688129589"><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621688129589"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621688129588"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621688129588"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; ReaderT r m ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; ReaderT r m ()) -&gt; m () -&gt; ReaderT r m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
-&gt; HashSet (EngineLogType Hasura)
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; QErr
-&gt; [Header]
-&gt; m ()
forall (m :: * -&gt; *).
HttpLog m =&gt;
Logger Hasura
-&gt; HashSet (EngineLogType Hasura)
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; QErr
-&gt; [Header]
-&gt; m ()
</span><a href="Hasura.Server.Logging.html#logHttpError"><span class="hs-identifier hs-var">logHttpError</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621688129595"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (EngineLogType Hasura)
</span><a href="#local-6989586621688129594"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621688129593"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621688129592"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129591"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString, Maybe Value)
</span><a href="#local-6989586621688129590"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621688129589"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621688129588"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span>  </span><span id="local-6989586621688129587"><span class="annot"><span class="annottext">logHttpSuccess :: Logger Hasura
-&gt; HashSet (EngineLogType Hasura)
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; ByteString
-&gt; ByteString
-&gt; Maybe (DiffTime, DiffTime)
-&gt; Maybe CompressionType
-&gt; [Header]
-&gt; HttpLogMetadata (ReaderT r m)
-&gt; ReaderT r m ()
</span><a href="#local-6989586621688129587"><span class="hs-identifier hs-var hs-var hs-var hs-var">logHttpSuccess</span></a></span></span><span> </span><span id="local-6989586621688129586"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621688129586"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621688129585"><span class="annot"><span class="annottext">HashSet (EngineLogType Hasura)
</span><a href="#local-6989586621688129585"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621688129584"><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621688129584"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621688129583"><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621688129583"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621688129582"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129582"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621688129581"><span class="annot"><span class="annottext">(ByteString, Maybe Value)
</span><a href="#local-6989586621688129581"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621688129580"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621688129580"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621688129579"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621688129579"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621688129578"><span class="annot"><span class="annottext">Maybe (DiffTime, DiffTime)
</span><a href="#local-6989586621688129578"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621688129577"><span class="annot"><span class="annottext">Maybe CompressionType
</span><a href="#local-6989586621688129577"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621688129576"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621688129576"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621688129575"><span class="annot"><span class="annottext">HttpLogMetadata (ReaderT r m)
</span><a href="#local-6989586621688129575"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; ReaderT r m ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; ReaderT r m ()) -&gt; m () -&gt; ReaderT r m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
-&gt; HashSet (EngineLogType Hasura)
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; ByteString
-&gt; ByteString
-&gt; Maybe (DiffTime, DiffTime)
-&gt; Maybe CompressionType
-&gt; [Header]
-&gt; HttpLogMetadata m
-&gt; m ()
forall (m :: * -&gt; *).
HttpLog m =&gt;
Logger Hasura
-&gt; HashSet (EngineLogType Hasura)
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; ByteString
-&gt; ByteString
-&gt; Maybe (DiffTime, DiffTime)
-&gt; Maybe CompressionType
-&gt; [Header]
-&gt; HttpLogMetadata m
-&gt; m ()
</span><a href="Hasura.Server.Logging.html#logHttpSuccess"><span class="hs-identifier hs-var">logHttpSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621688129586"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (EngineLogType Hasura)
</span><a href="#local-6989586621688129585"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621688129584"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621688129583"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129582"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString, Maybe Value)
</span><a href="#local-6989586621688129581"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621688129580"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621688129579"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (DiffTime, DiffTime)
</span><a href="#local-6989586621688129578"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CompressionType
</span><a href="#local-6989586621688129577"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621688129576"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">HttpLogMetadata m
HttpLogMetadata (ReaderT r m)
</span><a href="#local-6989586621688129575"><span class="hs-identifier hs-var">l</span></a></span></span></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span id="local-6989586621688129574"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier hs-type">HttpLog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129574"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLog"><span class="hs-identifier hs-type">HttpLog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Metadata.Class.html#MetadataStorageT"><span class="hs-identifier hs-type">MetadataStorageT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129574"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ExtraHttpLogMetadata"><span class="annot"><a href="Hasura.Server.Logging.html#ExtraHttpLogMetadata"><span class="hs-identifier hs-var">ExtraHttpLogMetadata</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Metadata.Class.html#MetadataStorageT"><span class="hs-identifier hs-type">MetadataStorageT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129574"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#ExtraHttpLogMetadata"><span class="hs-identifier hs-type">ExtraHttpLogMetadata</span></a></span><span> </span><span class="annot"><a href="#local-6989586621688129574"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span>  </span><span id="local-6989586621688129568"><span class="annot"><span class="annottext">buildExtraHttpLogMetadata :: ParameterizedQueryHashList
-&gt; ExtraHttpLogMetadata (MetadataStorageT m)
</span><a href="#local-6989586621688129568"><span class="hs-identifier hs-var hs-var hs-var hs-var">buildExtraHttpLogMetadata</span></a></span></span><span> </span><span id="local-6989586621688129567"><span class="annot"><span class="annottext">ParameterizedQueryHashList
</span><a href="#local-6989586621688129567"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ParameterizedQueryHashList -&gt; ExtraHttpLogMetadata m
forall (m :: * -&gt; *).
HttpLog m =&gt;
ParameterizedQueryHashList -&gt; ExtraHttpLogMetadata m
</span><a href="Hasura.Server.Logging.html#buildExtraHttpLogMetadata"><span class="hs-identifier hs-var">buildExtraHttpLogMetadata</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621688129574"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="annottext">ParameterizedQueryHashList
</span><a href="#local-6989586621688129567"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-308"></span><span>  </span><span id="local-6989586621688129566"><span class="annot"><span class="annottext">emptyExtraHttpLogMetadata :: ExtraHttpLogMetadata (MetadataStorageT m)
</span><a href="#local-6989586621688129566"><span class="hs-identifier hs-var hs-var hs-var hs-var">emptyExtraHttpLogMetadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HttpLog m =&gt; ExtraHttpLogMetadata m
forall (m :: * -&gt; *). HttpLog m =&gt; ExtraHttpLogMetadata m
</span><a href="Hasura.Server.Logging.html#emptyExtraHttpLogMetadata"><span class="hs-identifier hs-var">emptyExtraHttpLogMetadata</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621688129574"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span>  </span><span id="local-6989586621688129565"><span class="annot"><span class="annottext">logHttpError :: Logger Hasura
-&gt; HashSet (EngineLogType Hasura)
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; QErr
-&gt; [Header]
-&gt; MetadataStorageT m ()
</span><a href="#local-6989586621688129565"><span class="hs-identifier hs-var hs-var hs-var hs-var">logHttpError</span></a></span></span><span> </span><span id="local-6989586621688129564"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621688129564"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621688129563"><span class="annot"><span class="annottext">HashSet (EngineLogType Hasura)
</span><a href="#local-6989586621688129563"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621688129562"><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621688129562"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621688129561"><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621688129561"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621688129560"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129560"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621688129559"><span class="annot"><span class="annottext">(ByteString, Maybe Value)
</span><a href="#local-6989586621688129559"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621688129558"><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621688129558"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621688129557"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621688129557"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; MetadataStorageT m ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; MetadataStorageT m ()) -&gt; m () -&gt; MetadataStorageT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
-&gt; HashSet (EngineLogType Hasura)
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; QErr
-&gt; [Header]
-&gt; m ()
forall (m :: * -&gt; *).
HttpLog m =&gt;
Logger Hasura
-&gt; HashSet (EngineLogType Hasura)
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; QErr
-&gt; [Header]
-&gt; m ()
</span><a href="Hasura.Server.Logging.html#logHttpError"><span class="hs-identifier hs-var">logHttpError</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621688129564"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (EngineLogType Hasura)
</span><a href="#local-6989586621688129563"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621688129562"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621688129561"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129560"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString, Maybe Value)
</span><a href="#local-6989586621688129559"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621688129558"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621688129557"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621688129556"><span class="annot"><span class="annottext">logHttpSuccess :: Logger Hasura
-&gt; HashSet (EngineLogType Hasura)
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; ByteString
-&gt; ByteString
-&gt; Maybe (DiffTime, DiffTime)
-&gt; Maybe CompressionType
-&gt; [Header]
-&gt; HttpLogMetadata (MetadataStorageT m)
-&gt; MetadataStorageT m ()
</span><a href="#local-6989586621688129556"><span class="hs-identifier hs-var hs-var hs-var hs-var">logHttpSuccess</span></a></span></span><span> </span><span id="local-6989586621688129555"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621688129555"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621688129554"><span class="annot"><span class="annottext">HashSet (EngineLogType Hasura)
</span><a href="#local-6989586621688129554"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621688129553"><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621688129553"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621688129552"><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621688129552"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621688129551"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129551"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621688129550"><span class="annot"><span class="annottext">(ByteString, Maybe Value)
</span><a href="#local-6989586621688129550"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621688129549"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621688129549"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621688129548"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621688129548"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621688129547"><span class="annot"><span class="annottext">Maybe (DiffTime, DiffTime)
</span><a href="#local-6989586621688129547"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621688129546"><span class="annot"><span class="annottext">Maybe CompressionType
</span><a href="#local-6989586621688129546"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span id="local-6989586621688129545"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621688129545"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621688129544"><span class="annot"><span class="annottext">HttpLogMetadata (MetadataStorageT m)
</span><a href="#local-6989586621688129544"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m () -&gt; MetadataStorageT m ()
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; MetadataStorageT m ()) -&gt; m () -&gt; MetadataStorageT m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
-&gt; HashSet (EngineLogType Hasura)
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; ByteString
-&gt; ByteString
-&gt; Maybe (DiffTime, DiffTime)
-&gt; Maybe CompressionType
-&gt; [Header]
-&gt; HttpLogMetadata m
-&gt; m ()
forall (m :: * -&gt; *).
HttpLog m =&gt;
Logger Hasura
-&gt; HashSet (EngineLogType Hasura)
-&gt; Maybe UserInfo
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; ByteString
-&gt; ByteString
-&gt; Maybe (DiffTime, DiffTime)
-&gt; Maybe CompressionType
-&gt; [Header]
-&gt; HttpLogMetadata m
-&gt; m ()
</span><a href="Hasura.Server.Logging.html#logHttpSuccess"><span class="hs-identifier hs-var">logHttpSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621688129555"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (EngineLogType Hasura)
</span><a href="#local-6989586621688129554"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621688129553"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621688129552"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129551"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString, Maybe Value)
</span><a href="#local-6989586621688129550"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621688129549"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621688129548"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (DiffTime, DiffTime)
</span><a href="#local-6989586621688129547"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe CompressionType
</span><a href="#local-6989586621688129546"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621688129545"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">HttpLogMetadata m
HttpLogMetadata (MetadataStorageT m)
</span><a href="#local-6989586621688129544"><span class="hs-identifier hs-var">l</span></a></span></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="hs-comment">-- | Log information about the HTTP request</span><span>
</span><span id="line-315"></span><span class="hs-keyword">data</span><span> </span><span id="HttpInfoLog"><span class="annot"><a href="Hasura.Server.Logging.html#HttpInfoLog"><span class="hs-identifier hs-var">HttpInfoLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HttpInfoLog"><span class="annot"><a href="Hasura.Server.Logging.html#HttpInfoLog"><span class="hs-identifier hs-var">HttpInfoLog</span></a></span></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="hlStatus"><span class="annot"><span class="annottext">HttpInfoLog -&gt; Status
</span><a href="Hasura.Server.Logging.html#hlStatus"><span class="hs-identifier hs-var hs-var">hlStatus</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">HTTP.Status</span></span><span class="hs-special">,</span><span>
</span><span id="line-317"></span><span>    </span><span id="hlMethod"><span class="annot"><span class="annottext">HttpInfoLog -&gt; Text
</span><a href="Hasura.Server.Logging.html#hlMethod"><span class="hs-identifier hs-var hs-var">hlMethod</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span>
</span><span id="line-318"></span><span>    </span><span id="hlSource"><span class="annot"><span class="annottext">HttpInfoLog -&gt; IpAddress
</span><a href="Hasura.Server.Logging.html#hlSource"><span class="hs-identifier hs-var hs-var">hlSource</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Network.Wai.Extended.html#IpAddress"><span class="hs-identifier hs-type">Wai.IpAddress</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-319"></span><span>    </span><span id="hlPath"><span class="annot"><span class="annottext">HttpInfoLog -&gt; Text
</span><a href="Hasura.Server.Logging.html#hlPath"><span class="hs-identifier hs-var hs-var">hlPath</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span>
</span><span id="line-320"></span><span>    </span><span id="hlHttpVersion"><span class="annot"><span class="annottext">HttpInfoLog -&gt; HttpVersion
</span><a href="Hasura.Server.Logging.html#hlHttpVersion"><span class="hs-identifier hs-var hs-var">hlHttpVersion</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">HTTP.HttpVersion</span></span><span class="hs-special">,</span><span>
</span><span id="line-321"></span><span>    </span><span id="hlCompression"><span class="annot"><span class="annottext">HttpInfoLog -&gt; Maybe CompressionType
</span><a href="Hasura.Server.Logging.html#hlCompression"><span class="hs-identifier hs-var hs-var">hlCompression</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.Server.Compression.html#CompressionType"><span class="hs-identifier hs-type">CompressionType</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-comment">-- | all the request headers</span><span>
</span><span id="line-323"></span><span>    </span><span id="hlHeaders"><span class="annot"><span class="annottext">HttpInfoLog -&gt; [Header]
</span><a href="Hasura.Server.Logging.html#hlHeaders"><span class="hs-identifier hs-var hs-var">hlHeaders</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">HTTP.Header</span></span><span class="hs-special">]</span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688129530"><span id="local-6989586621688129532"><span id="local-6989586621688129534"><span class="annot"><span class="annottext">Int -&gt; HttpInfoLog -&gt; ShowS
[HttpInfoLog] -&gt; ShowS
HttpInfoLog -&gt; String
(Int -&gt; HttpInfoLog -&gt; ShowS)
-&gt; (HttpInfoLog -&gt; String)
-&gt; ([HttpInfoLog] -&gt; ShowS)
-&gt; Show HttpInfoLog
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [HttpInfoLog] -&gt; ShowS
$cshowList :: [HttpInfoLog] -&gt; ShowS
show :: HttpInfoLog -&gt; String
$cshow :: HttpInfoLog -&gt; String
showsPrec :: Int -&gt; HttpInfoLog -&gt; ShowS
$cshowsPrec :: Int -&gt; HttpInfoLog -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688129526"><span id="local-6989586621688129528"><span class="annot"><span class="annottext">HttpInfoLog -&gt; HttpInfoLog -&gt; Bool
(HttpInfoLog -&gt; HttpInfoLog -&gt; Bool)
-&gt; (HttpInfoLog -&gt; HttpInfoLog -&gt; Bool) -&gt; Eq HttpInfoLog
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: HttpInfoLog -&gt; HttpInfoLog -&gt; Bool
$c/= :: HttpInfoLog -&gt; HttpInfoLog -&gt; Bool
== :: HttpInfoLog -&gt; HttpInfoLog -&gt; Bool
$c== :: HttpInfoLog -&gt; HttpInfoLog -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621688129519"><span id="local-6989586621688129521"><span id="local-6989586621688129523"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpInfoLog"><span class="hs-identifier hs-type">HttpInfoLog</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-328"></span><span>  </span><span id="local-6989586621688129518"><span class="annot"><span class="annottext">toJSON :: HttpInfoLog -&gt; Value
</span><a href="#local-6989586621688129518"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Logging.html#HttpInfoLog"><span class="hs-identifier hs-type">HttpInfoLog</span></a></span><span> </span><span id="local-6989586621688129517"><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621688129517"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621688129516"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621688129516"><span class="hs-identifier hs-var">met</span></a></span></span><span> </span><span id="local-6989586621688129515"><span class="annot"><span class="annottext">IpAddress
</span><a href="#local-6989586621688129515"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621688129514"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621688129514"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span id="local-6989586621688129513"><span class="annot"><span class="annottext">HttpVersion
</span><a href="#local-6989586621688129513"><span class="hs-identifier hs-var">hv</span></a></span></span><span> </span><span id="local-6989586621688129512"><span class="annot"><span class="annottext">Maybe CompressionType
</span><a href="#local-6989586621688129512"><span class="hs-identifier hs-var">compressTypeM</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Header]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-329"></span><span>    </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">object</span></span><span>
</span><span id="line-330"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;status&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Status -&gt; Int
</span><span class="hs-identifier hs-var hs-var">HTTP.statusCode</span></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621688129517"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-331"></span><span>        </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;method&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621688129516"><span class="hs-identifier hs-var">met</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-332"></span><span>        </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;ip&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">IpAddress -&gt; Text
</span><a href="Network.Wai.Extended.html#showIPAddress"><span class="hs-identifier hs-var">Wai.showIPAddress</span></a></span><span> </span><span class="annot"><span class="annottext">IpAddress
</span><a href="#local-6989586621688129515"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-333"></span><span>        </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;url&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621688129514"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-334"></span><span>        </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;http_version&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">HttpVersion -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">HttpVersion
</span><a href="#local-6989586621688129513"><span class="hs-identifier hs-var">hv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-335"></span><span>        </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;content_encoding&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Text -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompressionType -&gt; Text
</span><a href="Hasura.Server.Compression.html#compressionTypeToTxt"><span class="hs-identifier hs-var">compressionTypeToTxt</span></a></span><span> </span><span class="annot"><span class="annottext">(CompressionType -&gt; Text) -&gt; Maybe CompressionType -&gt; Maybe Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe CompressionType
</span><a href="#local-6989586621688129512"><span class="hs-identifier hs-var">compressTypeM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span class="hs-comment">-- | Information about a GraphQL/Hasura metadata operation over HTTP</span><span>
</span><span id="line-339"></span><span class="hs-keyword">data</span><span> </span><span id="OperationLog"><span class="annot"><a href="Hasura.Server.Logging.html#OperationLog"><span class="hs-identifier hs-var">OperationLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="OperationLog"><span class="annot"><a href="Hasura.Server.Logging.html#OperationLog"><span class="hs-identifier hs-var">OperationLog</span></a></span></span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="olRequestId"><span class="annot"><span class="annottext">OperationLog -&gt; RequestId
</span><a href="Hasura.Server.Logging.html#olRequestId"><span class="hs-identifier hs-var hs-var">olRequestId</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Server.Types.html#RequestId"><span class="hs-identifier hs-type">RequestId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-341"></span><span>    </span><span id="olUserVars"><span class="annot"><span class="annottext">OperationLog -&gt; Maybe SessionVariables
</span><a href="Hasura.Server.Logging.html#olUserVars"><span class="hs-identifier hs-var hs-var">olUserVars</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.Session.html#SessionVariables"><span class="hs-identifier hs-type">SessionVariables</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-342"></span><span>    </span><span id="olResponseSize"><span class="annot"><span class="annottext">OperationLog -&gt; Maybe Int64
</span><a href="Hasura.Server.Logging.html#olResponseSize"><span class="hs-identifier hs-var hs-var">olResponseSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-343"></span><span>    </span><span class="hs-comment">-- | Request IO wait time, i.e. time spent reading the full request from the socket.</span><span>
</span><span id="line-344"></span><span>    </span><span id="olRequestReadTime"><span class="annot"><span class="annottext">OperationLog -&gt; Maybe Seconds
</span><a href="Hasura.Server.Logging.html#olRequestReadTime"><span class="hs-identifier hs-var hs-var">olRequestReadTime</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Data.Time.Clock.Units.html#Seconds"><span class="hs-identifier hs-type">Seconds</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-comment">-- | Service time, not including request IO wait time.</span><span>
</span><span id="line-346"></span><span>    </span><span id="olQueryExecutionTime"><span class="annot"><span class="annottext">OperationLog -&gt; Maybe Seconds
</span><a href="Hasura.Server.Logging.html#olQueryExecutionTime"><span class="hs-identifier hs-var hs-var">olQueryExecutionTime</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Data.Time.Clock.Units.html#Seconds"><span class="hs-identifier hs-type">Seconds</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-347"></span><span>    </span><span id="olQuery"><span class="annot"><span class="annottext">OperationLog -&gt; Maybe Value
</span><a href="Hasura.Server.Logging.html#olQuery"><span class="hs-identifier hs-var hs-var">olQuery</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-348"></span><span>    </span><span id="olRawQuery"><span class="annot"><span class="annottext">OperationLog -&gt; Maybe Text
</span><a href="Hasura.Server.Logging.html#olRawQuery"><span class="hs-identifier hs-var hs-var">olRawQuery</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-349"></span><span>    </span><span id="olError"><span class="annot"><span class="annottext">OperationLog -&gt; Maybe QErr
</span><a href="Hasura.Server.Logging.html#olError"><span class="hs-identifier hs-var hs-var">olError</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-350"></span><span>    </span><span id="olRequestMode"><span class="annot"><span class="annottext">OperationLog -&gt; RequestMode
</span><a href="Hasura.Server.Logging.html#olRequestMode"><span class="hs-identifier hs-var hs-var">olRequestMode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Server.Logging.html#RequestMode"><span class="hs-identifier hs-type">RequestMode</span></a></span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688129494"><span id="local-6989586621688129496"><span id="local-6989586621688129498"><span class="annot"><span class="annottext">Int -&gt; OperationLog -&gt; ShowS
[OperationLog] -&gt; ShowS
OperationLog -&gt; String
(Int -&gt; OperationLog -&gt; ShowS)
-&gt; (OperationLog -&gt; String)
-&gt; ([OperationLog] -&gt; ShowS)
-&gt; Show OperationLog
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [OperationLog] -&gt; ShowS
$cshowList :: [OperationLog] -&gt; ShowS
show :: OperationLog -&gt; String
$cshow :: OperationLog -&gt; String
showsPrec :: Int -&gt; OperationLog -&gt; ShowS
$cshowsPrec :: Int -&gt; OperationLog -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688129490"><span id="local-6989586621688129492"><span class="annot"><span class="annottext">OperationLog -&gt; OperationLog -&gt; Bool
(OperationLog -&gt; OperationLog -&gt; Bool)
-&gt; (OperationLog -&gt; OperationLog -&gt; Bool) -&gt; Eq OperationLog
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: OperationLog -&gt; OperationLog -&gt; Bool
$c/= :: OperationLog -&gt; OperationLog -&gt; Bool
== :: OperationLog -&gt; OperationLog -&gt; Bool
$c== :: OperationLog -&gt; OperationLog -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="hs-special">$(</span><span id="local-6989586621688129482"><span id="local-6989586621688129484"><span id="local-6989586621688129486"><span id="local-6989586621688129488"><span class="hs-identifier">deriveToJSON</span><span> </span><span class="hs-identifier">hasuraJSON</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">omitNothingFields</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span class="hs-special">}</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">OperationLog</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="hs-comment">-- | @BatchOperationSuccessLog@ contains the information required for a single</span><span>
</span><span id="line-357"></span><span class="hs-comment">--   successful operation in a batch request for OSS. This type is a subset of the @GQLQueryOperationSuccessLog@</span><span>
</span><span id="line-358"></span><span class="hs-keyword">data</span><span> </span><span id="BatchOperationSuccessLog"><span class="annot"><a href="Hasura.Server.Logging.html#BatchOperationSuccessLog"><span class="hs-identifier hs-var">BatchOperationSuccessLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BatchOperationSuccessLog"><span class="annot"><a href="Hasura.Server.Logging.html#BatchOperationSuccessLog"><span class="hs-identifier hs-var">BatchOperationSuccessLog</span></a></span></span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="bolQuery"><span class="annot"><span class="annottext">BatchOperationSuccessLog -&gt; Maybe Value
</span><a href="Hasura.Server.Logging.html#bolQuery"><span class="hs-identifier hs-var hs-var">bolQuery</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-360"></span><span>    </span><span id="bolResponseSize"><span class="annot"><span class="annottext">BatchOperationSuccessLog -&gt; Int64
</span><a href="Hasura.Server.Logging.html#bolResponseSize"><span class="hs-identifier hs-var hs-var">bolResponseSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span class="hs-special">,</span><span>
</span><span id="line-361"></span><span>    </span><span id="bolQueryExecutionTime"><span class="annot"><span class="annottext">BatchOperationSuccessLog -&gt; Seconds
</span><a href="Hasura.Server.Logging.html#bolQueryExecutionTime"><span class="hs-identifier hs-var hs-var">bolQueryExecutionTime</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Data.Time.Clock.Units.html#Seconds"><span class="hs-identifier hs-type">Seconds</span></a></span><span>
</span><span id="line-362"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688129472"><span id="local-6989586621688129474"><span id="local-6989586621688129476"><span class="annot"><span class="annottext">Int -&gt; BatchOperationSuccessLog -&gt; ShowS
[BatchOperationSuccessLog] -&gt; ShowS
BatchOperationSuccessLog -&gt; String
(Int -&gt; BatchOperationSuccessLog -&gt; ShowS)
-&gt; (BatchOperationSuccessLog -&gt; String)
-&gt; ([BatchOperationSuccessLog] -&gt; ShowS)
-&gt; Show BatchOperationSuccessLog
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [BatchOperationSuccessLog] -&gt; ShowS
$cshowList :: [BatchOperationSuccessLog] -&gt; ShowS
show :: BatchOperationSuccessLog -&gt; String
$cshow :: BatchOperationSuccessLog -&gt; String
showsPrec :: Int -&gt; BatchOperationSuccessLog -&gt; ShowS
$cshowsPrec :: Int -&gt; BatchOperationSuccessLog -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688129468"><span id="local-6989586621688129470"><span class="annot"><span class="annottext">BatchOperationSuccessLog -&gt; BatchOperationSuccessLog -&gt; Bool
(BatchOperationSuccessLog -&gt; BatchOperationSuccessLog -&gt; Bool)
-&gt; (BatchOperationSuccessLog -&gt; BatchOperationSuccessLog -&gt; Bool)
-&gt; Eq BatchOperationSuccessLog
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BatchOperationSuccessLog -&gt; BatchOperationSuccessLog -&gt; Bool
$c/= :: BatchOperationSuccessLog -&gt; BatchOperationSuccessLog -&gt; Bool
== :: BatchOperationSuccessLog -&gt; BatchOperationSuccessLog -&gt; Bool
$c== :: BatchOperationSuccessLog -&gt; BatchOperationSuccessLog -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="hs-special">$(</span><span id="local-6989586621688129460"><span id="local-6989586621688129462"><span id="local-6989586621688129464"><span id="local-6989586621688129466"><span class="hs-identifier">deriveToJSON</span><span> </span><span class="hs-identifier">hasuraJSON</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">omitNothingFields</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span class="hs-special">}</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">BatchOperationSuccessLog</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">-- | @BatchOperationSuccessLog@ contains the information required for a single</span><span>
</span><span id="line-368"></span><span class="hs-comment">--   erroneous operation in a batch request for OSS. This type is a subset of the @GQLQueryOperationErrorLog@</span><span>
</span><span id="line-369"></span><span class="hs-keyword">data</span><span> </span><span id="BatchOperationErrorLog"><span class="annot"><a href="Hasura.Server.Logging.html#BatchOperationErrorLog"><span class="hs-identifier hs-var">BatchOperationErrorLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BatchOperationErrorLog"><span class="annot"><a href="Hasura.Server.Logging.html#BatchOperationErrorLog"><span class="hs-identifier hs-var">BatchOperationErrorLog</span></a></span></span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="belQuery"><span class="annot"><span class="annottext">BatchOperationErrorLog -&gt; Maybe Value
</span><a href="Hasura.Server.Logging.html#belQuery"><span class="hs-identifier hs-var hs-var">belQuery</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-371"></span><span>    </span><span id="belError"><span class="annot"><span class="annottext">BatchOperationErrorLog -&gt; QErr
</span><a href="Hasura.Server.Logging.html#belError"><span class="hs-identifier hs-var hs-var">belError</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688129451"><span id="local-6989586621688129453"><span id="local-6989586621688129455"><span class="annot"><span class="annottext">Int -&gt; BatchOperationErrorLog -&gt; ShowS
[BatchOperationErrorLog] -&gt; ShowS
BatchOperationErrorLog -&gt; String
(Int -&gt; BatchOperationErrorLog -&gt; ShowS)
-&gt; (BatchOperationErrorLog -&gt; String)
-&gt; ([BatchOperationErrorLog] -&gt; ShowS)
-&gt; Show BatchOperationErrorLog
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [BatchOperationErrorLog] -&gt; ShowS
$cshowList :: [BatchOperationErrorLog] -&gt; ShowS
show :: BatchOperationErrorLog -&gt; String
$cshow :: BatchOperationErrorLog -&gt; String
showsPrec :: Int -&gt; BatchOperationErrorLog -&gt; ShowS
$cshowsPrec :: Int -&gt; BatchOperationErrorLog -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688129447"><span id="local-6989586621688129449"><span class="annot"><span class="annottext">BatchOperationErrorLog -&gt; BatchOperationErrorLog -&gt; Bool
(BatchOperationErrorLog -&gt; BatchOperationErrorLog -&gt; Bool)
-&gt; (BatchOperationErrorLog -&gt; BatchOperationErrorLog -&gt; Bool)
-&gt; Eq BatchOperationErrorLog
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BatchOperationErrorLog -&gt; BatchOperationErrorLog -&gt; Bool
$c/= :: BatchOperationErrorLog -&gt; BatchOperationErrorLog -&gt; Bool
== :: BatchOperationErrorLog -&gt; BatchOperationErrorLog -&gt; Bool
$c== :: BatchOperationErrorLog -&gt; BatchOperationErrorLog -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="hs-special">$(</span><span id="local-6989586621688129439"><span id="local-6989586621688129441"><span id="local-6989586621688129443"><span id="local-6989586621688129445"><span class="hs-identifier">deriveToJSON</span><span> </span><span class="hs-identifier">hasuraJSON</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">omitNothingFields</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span class="hs-special">}</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">BatchOperationErrorLog</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="hs-keyword">data</span><span> </span><span id="BatchOperationLog"><span class="annot"><a href="Hasura.Server.Logging.html#BatchOperationLog"><span class="hs-identifier hs-var">BatchOperationLog</span></a></span></span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="BatchOperationSuccess"><span class="annot"><a href="Hasura.Server.Logging.html#BatchOperationSuccess"><span class="hs-identifier hs-var">BatchOperationSuccess</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Server.Logging.html#BatchOperationSuccessLog"><span class="hs-identifier hs-type">BatchOperationSuccessLog</span></a></span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="BatchOperationError"><span class="annot"><a href="Hasura.Server.Logging.html#BatchOperationError"><span class="hs-identifier hs-var">BatchOperationError</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Server.Logging.html#BatchOperationErrorLog"><span class="hs-identifier hs-type">BatchOperationErrorLog</span></a></span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688129431"><span id="local-6989586621688129433"><span id="local-6989586621688129435"><span class="annot"><span class="annottext">Int -&gt; BatchOperationLog -&gt; ShowS
[BatchOperationLog] -&gt; ShowS
BatchOperationLog -&gt; String
(Int -&gt; BatchOperationLog -&gt; ShowS)
-&gt; (BatchOperationLog -&gt; String)
-&gt; ([BatchOperationLog] -&gt; ShowS)
-&gt; Show BatchOperationLog
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [BatchOperationLog] -&gt; ShowS
$cshowList :: [BatchOperationLog] -&gt; ShowS
show :: BatchOperationLog -&gt; String
$cshow :: BatchOperationLog -&gt; String
showsPrec :: Int -&gt; BatchOperationLog -&gt; ShowS
$cshowsPrec :: Int -&gt; BatchOperationLog -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688129427"><span id="local-6989586621688129429"><span class="annot"><span class="annottext">BatchOperationLog -&gt; BatchOperationLog -&gt; Bool
(BatchOperationLog -&gt; BatchOperationLog -&gt; Bool)
-&gt; (BatchOperationLog -&gt; BatchOperationLog -&gt; Bool)
-&gt; Eq BatchOperationLog
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BatchOperationLog -&gt; BatchOperationLog -&gt; Bool
$c/= :: BatchOperationLog -&gt; BatchOperationLog -&gt; Bool
== :: BatchOperationLog -&gt; BatchOperationLog -&gt; Bool
$c== :: BatchOperationLog -&gt; BatchOperationLog -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621688129420"><span id="local-6989586621688129422"><span id="local-6989586621688129424"><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#BatchOperationLog"><span class="hs-identifier hs-type">BatchOperationLog</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-383"></span><span>  </span><span id="local-6989586621688129419"><span class="annot"><span class="annottext">toJSON :: BatchOperationLog -&gt; Value
</span><a href="#local-6989586621688129419"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-384"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#BatchOperationSuccess"><span class="hs-identifier hs-type">BatchOperationSuccess</span></a></span><span> </span><span id="local-6989586621688129418"><span class="annot"><span class="annottext">BatchOperationSuccessLog
</span><a href="#local-6989586621688129418"><span class="hs-identifier hs-var">successLog</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BatchOperationSuccessLog -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">BatchOperationSuccessLog
</span><a href="#local-6989586621688129418"><span class="hs-identifier hs-var">successLog</span></a></span><span>
</span><span id="line-385"></span><span>    </span><span class="annot"><a href="Hasura.Server.Logging.html#BatchOperationError"><span class="hs-identifier hs-type">BatchOperationError</span></a></span><span> </span><span id="local-6989586621688129417"><span class="annot"><span class="annottext">BatchOperationErrorLog
</span><a href="#local-6989586621688129417"><span class="hs-identifier hs-var">errorLog</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BatchOperationErrorLog -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">BatchOperationErrorLog
</span><a href="#local-6989586621688129417"><span class="hs-identifier hs-var">errorLog</span></a></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="hs-keyword">data</span><span> </span><span id="HttpLogContext"><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogContext"><span class="hs-identifier hs-var">HttpLogContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HttpLogContext"><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogContext"><span class="hs-identifier hs-var">HttpLogContext</span></a></span></span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="hlcHttpInfo"><span class="annot"><span class="annottext">HttpLogContext -&gt; HttpInfoLog
</span><a href="Hasura.Server.Logging.html#hlcHttpInfo"><span class="hs-identifier hs-var hs-var">hlcHttpInfo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Server.Logging.html#HttpInfoLog"><span class="hs-identifier hs-type">HttpInfoLog</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-389"></span><span>    </span><span id="hlcOperation"><span class="annot"><span class="annottext">HttpLogContext -&gt; OperationLog
</span><a href="Hasura.Server.Logging.html#hlcOperation"><span class="hs-identifier hs-var hs-var">hlcOperation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Server.Logging.html#OperationLog"><span class="hs-identifier hs-type">OperationLog</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-390"></span><span>    </span><span id="hlcRequestId"><span class="annot"><span class="annottext">HttpLogContext -&gt; RequestId
</span><a href="Hasura.Server.Logging.html#hlcRequestId"><span class="hs-identifier hs-var hs-var">hlcRequestId</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Server.Types.html#RequestId"><span class="hs-identifier hs-type">RequestId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-391"></span><span>    </span><span id="hlcBatchedOperations"><span class="annot"><span class="annottext">HttpLogContext -&gt; Maybe (NonEmpty BatchOperationLog)
</span><a href="Hasura.Server.Logging.html#hlcBatchedOperations"><span class="hs-identifier hs-var hs-var">hlcBatchedOperations</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NE.NonEmpty</span></span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#BatchOperationLog"><span class="hs-identifier hs-type">BatchOperationLog</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621688129406"><span id="local-6989586621688129408"><span id="local-6989586621688129410"><span class="annot"><span class="annottext">Int -&gt; HttpLogContext -&gt; ShowS
[HttpLogContext] -&gt; ShowS
HttpLogContext -&gt; String
(Int -&gt; HttpLogContext -&gt; ShowS)
-&gt; (HttpLogContext -&gt; String)
-&gt; ([HttpLogContext] -&gt; ShowS)
-&gt; Show HttpLogContext
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [HttpLogContext] -&gt; ShowS
$cshowList :: [HttpLogContext] -&gt; ShowS
show :: HttpLogContext -&gt; String
$cshow :: HttpLogContext -&gt; String
showsPrec :: Int -&gt; HttpLogContext -&gt; ShowS
$cshowsPrec :: Int -&gt; HttpLogContext -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688129402"><span id="local-6989586621688129404"><span class="annot"><span class="annottext">HttpLogContext -&gt; HttpLogContext -&gt; Bool
(HttpLogContext -&gt; HttpLogContext -&gt; Bool)
-&gt; (HttpLogContext -&gt; HttpLogContext -&gt; Bool) -&gt; Eq HttpLogContext
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: HttpLogContext -&gt; HttpLogContext -&gt; Bool
$c/= :: HttpLogContext -&gt; HttpLogContext -&gt; Bool
== :: HttpLogContext -&gt; HttpLogContext -&gt; Bool
$c== :: HttpLogContext -&gt; HttpLogContext -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="hs-special">$(</span><span id="local-6989586621688129394"><span id="local-6989586621688129396"><span id="local-6989586621688129398"><span id="local-6989586621688129400"><span class="hs-identifier">deriveToJSON</span><span> </span><span class="hs-identifier">hasuraJSON</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">omitNothingFields</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">True</span><span class="hs-special">}</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">HttpLogContext</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="annot"><a href="Hasura.Server.Logging.html#mkHttpAccessLogContext"><span class="hs-identifier hs-type">mkHttpAccessLogContext</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-comment">-- | Maybe because it may not have been resolved</span><span>
</span><span id="line-399"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-400"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">HashSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Logging.html#EngineLogType"><span class="hs-identifier hs-type">EngineLogType</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">Hasura</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-401"></span><span>  </span><span class="annot"><a href="Hasura.Server.Types.html#RequestId"><span class="hs-identifier hs-type">RequestId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-402"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Wai.Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-404"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-405"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DiffTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiffTime</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-406"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.Server.Compression.html#CompressionType"><span class="hs-identifier hs-type">CompressionType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">HTTP.Header</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-408"></span><span>  </span><span class="annot"><a href="Hasura.Server.Logging.html#RequestMode"><span class="hs-identifier hs-type">RequestMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-409"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLBatchedReqs"><span class="hs-identifier hs-type">GH.GQLBatchedReqs</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#GQLBatchQueryOperationLog"><span class="hs-identifier hs-type">GQLBatchQueryOperationLog</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-410"></span><span>  </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogContext"><span class="hs-identifier hs-type">HttpLogContext</span></a></span><span>
</span><span id="line-411"></span><span id="mkHttpAccessLogContext"><span class="annot"><span class="annottext">mkHttpAccessLogContext :: Maybe UserInfo
-&gt; HashSet (EngineLogType Hasura)
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; ByteString
-&gt; Maybe (DiffTime, DiffTime)
-&gt; Maybe CompressionType
-&gt; [Header]
-&gt; RequestMode
-&gt; Maybe (GQLBatchedReqs GQLBatchQueryOperationLog)
-&gt; HttpLogContext
</span><a href="Hasura.Server.Logging.html#mkHttpAccessLogContext"><span class="hs-identifier hs-var hs-var">mkHttpAccessLogContext</span></a></span></span><span> </span><span id="local-6989586621688129393"><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621688129393"><span class="hs-identifier hs-var">userInfoM</span></a></span></span><span> </span><span id="local-6989586621688129392"><span class="annot"><span class="annottext">HashSet (EngineLogType Hasura)
</span><a href="#local-6989586621688129392"><span class="hs-identifier hs-var">enabledLogTypes</span></a></span></span><span> </span><span id="local-6989586621688129391"><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621688129391"><span class="hs-identifier hs-var">reqId</span></a></span></span><span> </span><span id="local-6989586621688129390"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129390"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688129389"><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621688129389"><span class="hs-identifier hs-var">parsedReq</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621688129388"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621688129388"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span id="local-6989586621688129387"><span class="annot"><span class="annottext">Maybe (DiffTime, DiffTime)
</span><a href="#local-6989586621688129387"><span class="hs-identifier hs-var">mTiming</span></a></span></span><span> </span><span id="local-6989586621688129386"><span class="annot"><span class="annottext">Maybe CompressionType
</span><a href="#local-6989586621688129386"><span class="hs-identifier hs-var">compressTypeM</span></a></span></span><span> </span><span id="local-6989586621688129385"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621688129385"><span class="hs-identifier hs-var">headers</span></a></span></span><span> </span><span id="local-6989586621688129384"><span class="annot"><span class="annottext">RequestMode
</span><a href="#local-6989586621688129384"><span class="hs-identifier hs-var">batching</span></a></span></span><span> </span><span id="local-6989586621688129383"><span class="annot"><span class="annottext">Maybe (GQLBatchedReqs GQLBatchQueryOperationLog)
</span><a href="#local-6989586621688129383"><span class="hs-identifier hs-var">queryLogMetadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688129382"><span class="annot"><span class="annottext">http :: HttpInfoLog
</span><a href="#local-6989586621688129382"><span class="hs-identifier hs-var hs-var">http</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-413"></span><span>        </span><span class="annot"><span class="annottext">HttpInfoLog :: Status
-&gt; Text
-&gt; IpAddress
-&gt; Text
-&gt; HttpVersion
-&gt; Maybe CompressionType
-&gt; [Header]
-&gt; HttpInfoLog
</span><a href="Hasura.Server.Logging.html#HttpInfoLog"><span class="hs-identifier hs-type">HttpInfoLog</span></a></span><span>
</span><span id="line-414"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hlStatus :: Status
</span><a href="Hasura.Server.Logging.html#hlStatus"><span class="hs-identifier hs-var">hlStatus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621688129381"><span class="hs-identifier hs-var">status</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-415"></span><span>            </span><span class="annot"><span class="annottext">hlMethod :: Text
</span><a href="Hasura.Server.Logging.html#hlMethod"><span class="hs-identifier hs-var">hlMethod</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="Hasura.Prelude.html#bsToTxt"><span class="hs-identifier hs-var">bsToTxt</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var">Wai.requestMethod</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129390"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-416"></span><span>            </span><span class="annot"><span class="annottext">hlSource :: IpAddress
</span><a href="Hasura.Server.Logging.html#hlSource"><span class="hs-identifier hs-var">hlSource</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; IpAddress
</span><a href="Network.Wai.Extended.html#getSourceFromFallback"><span class="hs-identifier hs-var">Wai.getSourceFromFallback</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129390"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-417"></span><span>            </span><span class="annot"><span class="annottext">hlPath :: Text
</span><a href="Hasura.Server.Logging.html#hlPath"><span class="hs-identifier hs-var">hlPath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="Hasura.Prelude.html#bsToTxt"><span class="hs-identifier hs-var">bsToTxt</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var">Wai.rawPathInfo</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129390"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-418"></span><span>            </span><span class="annot"><span class="annottext">hlHttpVersion :: HttpVersion
</span><a href="Hasura.Server.Logging.html#hlHttpVersion"><span class="hs-identifier hs-var">hlHttpVersion</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; HttpVersion
</span><span class="hs-identifier hs-var hs-var">Wai.httpVersion</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129390"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-419"></span><span>            </span><span class="annot"><span class="annottext">hlCompression :: Maybe CompressionType
</span><a href="Hasura.Server.Logging.html#hlCompression"><span class="hs-identifier hs-var">hlCompression</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CompressionType
</span><a href="#local-6989586621688129386"><span class="hs-identifier hs-var">compressTypeM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-420"></span><span>            </span><span class="annot"><span class="annottext">hlHeaders :: [Header]
</span><a href="Hasura.Server.Logging.html#hlHeaders"><span class="hs-identifier hs-var">hlHeaders</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621688129385"><span class="hs-identifier hs-var">headers</span></a></span><span>
</span><span id="line-421"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-422"></span><span>      </span><span id="local-6989586621688129375"><span class="annot"><span class="annottext">op :: OperationLog
</span><a href="#local-6989586621688129375"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-423"></span><span>        </span><span class="annot"><span class="annottext">OperationLog :: RequestId
-&gt; Maybe SessionVariables
-&gt; Maybe Int64
-&gt; Maybe Seconds
-&gt; Maybe Seconds
-&gt; Maybe Value
-&gt; Maybe Text
-&gt; Maybe QErr
-&gt; RequestMode
-&gt; OperationLog
</span><a href="Hasura.Server.Logging.html#OperationLog"><span class="hs-identifier hs-type">OperationLog</span></a></span><span>
</span><span id="line-424"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">olRequestId :: RequestId
</span><a href="Hasura.Server.Logging.html#olRequestId"><span class="hs-identifier hs-var">olRequestId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621688129391"><span class="hs-identifier hs-var">reqId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-425"></span><span>            </span><span class="annot"><span class="annottext">olUserVars :: Maybe SessionVariables
</span><a href="Hasura.Server.Logging.html#olUserVars"><span class="hs-identifier hs-var">olUserVars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UserInfo -&gt; SessionVariables
</span><a href="Hasura.Session.html#_uiSession"><span class="hs-identifier hs-var hs-var">_uiSession</span></a></span><span> </span><span class="annot"><span class="annottext">(UserInfo -&gt; SessionVariables)
-&gt; Maybe UserInfo -&gt; Maybe SessionVariables
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621688129393"><span class="hs-identifier hs-var">userInfoM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-426"></span><span>            </span><span class="annot"><span class="annottext">olResponseSize :: Maybe Int64
</span><a href="Hasura.Server.Logging.html#olResponseSize"><span class="hs-identifier hs-var">olResponseSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int64
</span><a href="#local-6989586621688129373"><span class="hs-identifier hs-var">respSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-427"></span><span>            </span><span class="annot"><span class="annottext">olRequestReadTime :: Maybe Seconds
</span><a href="Hasura.Server.Logging.html#olRequestReadTime"><span class="hs-identifier hs-var">olRequestReadTime</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiffTime -&gt; Seconds
</span><a href="Data.Time.Clock.Units.html#Seconds"><span class="hs-identifier hs-var">Seconds</span></a></span><span> </span><span class="annot"><span class="annottext">(DiffTime -&gt; Seconds)
-&gt; ((DiffTime, DiffTime) -&gt; DiffTime)
-&gt; (DiffTime, DiffTime)
-&gt; Seconds
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DiffTime, DiffTime) -&gt; DiffTime
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((DiffTime, DiffTime) -&gt; Seconds)
-&gt; Maybe (DiffTime, DiffTime) -&gt; Maybe Seconds
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (DiffTime, DiffTime)
</span><a href="#local-6989586621688129387"><span class="hs-identifier hs-var">mTiming</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-428"></span><span>            </span><span class="annot"><span class="annottext">olQueryExecutionTime :: Maybe Seconds
</span><a href="Hasura.Server.Logging.html#olQueryExecutionTime"><span class="hs-identifier hs-var">olQueryExecutionTime</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiffTime -&gt; Seconds
</span><a href="Data.Time.Clock.Units.html#Seconds"><span class="hs-identifier hs-var">Seconds</span></a></span><span> </span><span class="annot"><span class="annottext">(DiffTime -&gt; Seconds)
-&gt; ((DiffTime, DiffTime) -&gt; DiffTime)
-&gt; (DiffTime, DiffTime)
-&gt; Seconds
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DiffTime, DiffTime) -&gt; DiffTime
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((DiffTime, DiffTime) -&gt; Seconds)
-&gt; Maybe (DiffTime, DiffTime) -&gt; Maybe Seconds
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (DiffTime, DiffTime)
</span><a href="#local-6989586621688129387"><span class="hs-identifier hs-var">mTiming</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-429"></span><span>            </span><span class="annot"><span class="annottext">olRequestMode :: RequestMode
</span><a href="Hasura.Server.Logging.html#olRequestMode"><span class="hs-identifier hs-var">olRequestMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RequestMode
</span><a href="#local-6989586621688129384"><span class="hs-identifier hs-var">batching</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-430"></span><span>            </span><span class="hs-comment">-- See Note [Disable query printing when query-log is disabled]</span><span>
</span><span id="line-431"></span><span>            </span><span class="annot"><span class="annottext">olQuery :: Maybe Value
</span><a href="Hasura.Server.Logging.html#olQuery"><span class="hs-identifier hs-var">olQuery</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Value -&gt; Maybe Value -&gt; Bool -&gt; Maybe Value
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="annot"><span class="annottext">Maybe Value
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621688129389"><span class="hs-identifier hs-var">parsedReq</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Maybe Value) -&gt; Bool -&gt; Maybe Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EngineLogType Hasura -&gt; HashSet (EngineLogType Hasura) -&gt; Bool
forall a. (Eq a, Hashable a) =&gt; a -&gt; HashSet a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">EngineLogType Hasura
</span><a href="Hasura.Logging.html#ELTQueryLog"><span class="hs-identifier hs-var">ELTQueryLog</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (EngineLogType Hasura)
</span><a href="#local-6989586621688129392"><span class="hs-identifier hs-var">enabledLogTypes</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-432"></span><span>            </span><span class="annot"><span class="annottext">olRawQuery :: Maybe Text
</span><a href="Hasura.Server.Logging.html#olRawQuery"><span class="hs-identifier hs-var">olRawQuery</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-433"></span><span>            </span><span class="annot"><span class="annottext">olError :: Maybe QErr
</span><a href="Hasura.Server.Logging.html#olError"><span class="hs-identifier hs-var">olError</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QErr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-434"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-435"></span><span>      </span><span id="local-6989586621688129367"><span class="annot"><span class="annottext">batchOpLog :: Maybe (NonEmpty BatchOperationLog)
</span><a href="#local-6989586621688129367"><span class="hs-identifier hs-var hs-var">batchOpLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-436"></span><span>        </span><span class="annot"><span class="annottext">Maybe (GQLBatchedReqs GQLBatchQueryOperationLog)
</span><a href="#local-6989586621688129383"><span class="hs-identifier hs-var">queryLogMetadata</span></a></span><span>
</span><span id="line-437"></span><span>          </span><span class="annot"><span class="annottext">Maybe (GQLBatchedReqs GQLBatchQueryOperationLog)
-&gt; (GQLBatchedReqs GQLBatchQueryOperationLog
    -&gt; Maybe (NonEmpty BatchOperationLog))
-&gt; Maybe (NonEmpty BatchOperationLog)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-438"></span><span>                  </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLSingleRequest"><span class="hs-identifier hs-type">GH.GQLSingleRequest</span></a></span><span> </span><span class="annot"><span class="annottext">GQLBatchQueryOperationLog
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (NonEmpty BatchOperationLog)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- This case is aleady handled in the `OperationLog`</span><span>
</span><span id="line-439"></span><span>                  </span><span class="annot"><a href="Hasura.GraphQL.Transport.HTTP.Protocol.html#GQLBatchedReqs"><span class="hs-identifier hs-type">GH.GQLBatchedReqs</span></a></span><span> </span><span id="local-6989586621688129364"><span class="annot"><span class="annottext">[GQLBatchQueryOperationLog]
</span><a href="#local-6989586621688129364"><span class="hs-identifier hs-var">opLogs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-440"></span><span>                    </span><span class="annot"><span class="annottext">[BatchOperationLog] -&gt; Maybe (NonEmpty BatchOperationLog)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">NE.nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">([BatchOperationLog] -&gt; Maybe (NonEmpty BatchOperationLog))
-&gt; [BatchOperationLog] -&gt; Maybe (NonEmpty BatchOperationLog)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-441"></span><span>                      </span><span class="annot"><span class="annottext">(GQLBatchQueryOperationLog -&gt; BatchOperationLog)
-&gt; [GQLBatchQueryOperationLog] -&gt; [BatchOperationLog]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-442"></span><span>                        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621688129362"><span class="annot"><span class="annottext">GQLBatchQueryOperationLog
</span><a href="#local-6989586621688129362"><span class="hs-identifier hs-var">opLog</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-443"></span><span>                            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GQLBatchQueryOperationLog
</span><a href="#local-6989586621688129362"><span class="hs-identifier hs-var">opLog</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-444"></span><span>                              </span><span class="annot"><a href="Hasura.Server.Logging.html#GQLQueryOperationSuccess"><span class="hs-identifier hs-type">GQLQueryOperationSuccess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Logging.html#GQLQueryOperationSuccessLog"><span class="hs-identifier hs-type">GQLQueryOperationSuccessLog</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688129357"><span id="local-6989586621688129358"><span id="local-6989586621688129359"><span id="local-6989586621688129360"><span id="local-6989586621688129361"><span class="annot"><span class="annottext">Int64
DiffTime
GQLReqUnparsed
ParameterizedQueryHash
gqolParameterizedQueryHash :: ParameterizedQueryHash
gqolRequestSize :: Int64
gqolResponseSize :: Int64
gqolQueryExecutionTime :: DiffTime
gqolQuery :: GQLReqUnparsed
gqolParameterizedQueryHash :: GQLQueryOperationSuccessLog -&gt; ParameterizedQueryHash
gqolRequestSize :: GQLQueryOperationSuccessLog -&gt; Int64
gqolResponseSize :: GQLQueryOperationSuccessLog -&gt; Int64
gqolQueryExecutionTime :: GQLQueryOperationSuccessLog -&gt; DiffTime
gqolQuery :: GQLQueryOperationSuccessLog -&gt; GQLReqUnparsed
</span><a href="#local-6989586621688129357"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-445"></span><span>                                </span><span class="annot"><span class="annottext">BatchOperationSuccessLog -&gt; BatchOperationLog
</span><a href="Hasura.Server.Logging.html#BatchOperationSuccess"><span class="hs-identifier hs-var">BatchOperationSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">(BatchOperationSuccessLog -&gt; BatchOperationLog)
-&gt; BatchOperationSuccessLog -&gt; BatchOperationLog
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-446"></span><span>                                  </span><span class="annot"><span class="annottext">Maybe Value -&gt; Int64 -&gt; Seconds -&gt; BatchOperationSuccessLog
</span><a href="Hasura.Server.Logging.html#BatchOperationSuccessLog"><span class="hs-identifier hs-var">BatchOperationSuccessLog</span></a></span><span>
</span><span id="line-447"></span><span>                                    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Value -&gt; Maybe Value -&gt; Bool -&gt; Maybe Value
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="annot"><span class="annottext">Maybe Value
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Maybe Value
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Maybe Value) -&gt; Value -&gt; Maybe Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GQLReqUnparsed -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">GQLReqUnparsed
</span><a href="#local-6989586621688129361"><span class="hs-identifier hs-var">gqolQuery</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Maybe Value) -&gt; Bool -&gt; Maybe Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EngineLogType Hasura -&gt; HashSet (EngineLogType Hasura) -&gt; Bool
forall a. (Eq a, Hashable a) =&gt; a -&gt; HashSet a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">EngineLogType Hasura
</span><a href="Hasura.Logging.html#ELTQueryLog"><span class="hs-identifier hs-var">ELTQueryLog</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (EngineLogType Hasura)
</span><a href="#local-6989586621688129392"><span class="hs-identifier hs-var">enabledLogTypes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span>                                    </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621688129359"><span class="hs-identifier hs-var">gqolResponseSize</span></a></span><span>
</span><span id="line-449"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DiffTime -&gt; Seconds
forall x y. (Duration x, Duration y) =&gt; x -&gt; y
</span><a href="Data.Time.Clock.Units.html#convertDuration"><span class="hs-identifier hs-var">convertDuration</span></a></span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621688129360"><span class="hs-identifier hs-var">gqolQueryExecutionTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>                              </span><span class="annot"><a href="Hasura.Server.Logging.html#GQLQueryOperationError"><span class="hs-identifier hs-type">GQLQueryOperationError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Logging.html#GQLQueryOperationErrorLog"><span class="hs-identifier hs-type">GQLQueryOperationErrorLog</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621688129354"><span id="local-6989586621688129355"><span class="annot"><span class="annottext">QErr
GQLReqUnparsed
gqelError :: QErr
gqelQuery :: GQLReqUnparsed
gqelError :: GQLQueryOperationErrorLog -&gt; QErr
gqelQuery :: GQLQueryOperationErrorLog -&gt; GQLReqUnparsed
</span><a href="#local-6989586621688129354"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-451"></span><span>                                </span><span class="annot"><span class="annottext">BatchOperationErrorLog -&gt; BatchOperationLog
</span><a href="Hasura.Server.Logging.html#BatchOperationError"><span class="hs-identifier hs-var">BatchOperationError</span></a></span><span> </span><span class="annot"><span class="annottext">(BatchOperationErrorLog -&gt; BatchOperationLog)
-&gt; BatchOperationErrorLog -&gt; BatchOperationLog
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-452"></span><span>                                  </span><span class="annot"><span class="annottext">Maybe Value -&gt; QErr -&gt; BatchOperationErrorLog
</span><a href="Hasura.Server.Logging.html#BatchOperationErrorLog"><span class="hs-identifier hs-var">BatchOperationErrorLog</span></a></span><span>
</span><span id="line-453"></span><span>                                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Value -&gt; Maybe Value -&gt; Bool -&gt; Maybe Value
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="annot"><span class="annottext">Maybe Value
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Maybe Value
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Maybe Value) -&gt; Value -&gt; Maybe Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">GQLReqUnparsed -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">GQLReqUnparsed
</span><a href="#local-6989586621688129355"><span class="hs-identifier hs-var">gqelQuery</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Maybe Value) -&gt; Bool -&gt; Maybe Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EngineLogType Hasura -&gt; HashSet (EngineLogType Hasura) -&gt; Bool
forall a. (Eq a, Hashable a) =&gt; a -&gt; HashSet a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">EngineLogType Hasura
</span><a href="Hasura.Logging.html#ELTQueryLog"><span class="hs-identifier hs-var">ELTQueryLog</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (EngineLogType Hasura)
</span><a href="#local-6989586621688129392"><span class="hs-identifier hs-var">enabledLogTypes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>                                    </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621688129354"><span class="hs-identifier hs-var">gqelError</span></a></span><span>
</span><span id="line-455"></span><span>                        </span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>                        </span><span class="annot"><span class="annottext">[GQLBatchQueryOperationLog]
</span><a href="#local-6989586621688129364"><span class="hs-identifier hs-var">opLogs</span></a></span><span>
</span><span id="line-457"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">HttpInfoLog
-&gt; OperationLog
-&gt; RequestId
-&gt; Maybe (NonEmpty BatchOperationLog)
-&gt; HttpLogContext
</span><a href="Hasura.Server.Logging.html#HttpLogContext"><span class="hs-identifier hs-var">HttpLogContext</span></a></span><span> </span><span class="annot"><span class="annottext">HttpInfoLog
</span><a href="#local-6989586621688129382"><span class="hs-identifier hs-var">http</span></a></span><span> </span><span class="annot"><span class="annottext">OperationLog
</span><a href="#local-6989586621688129375"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621688129391"><span class="hs-identifier hs-var">reqId</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (NonEmpty BatchOperationLog)
</span><a href="#local-6989586621688129367"><span class="hs-identifier hs-var">batchOpLog</span></a></span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-460"></span><span>    </span><span id="local-6989586621688129381"><span class="annot"><span class="annottext">status :: Status
</span><a href="#local-6989586621688129381"><span class="hs-identifier hs-var hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">HTTP.status200</span></span><span>
</span><span id="line-461"></span><span>    </span><span id="local-6989586621688129373"><span class="annot"><span class="annottext">respSize :: Maybe Int64
</span><a href="#local-6989586621688129373"><span class="hs-identifier hs-var hs-var">respSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Maybe Int64
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; Maybe Int64) -&gt; Int64 -&gt; Maybe Int64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int64
</span><span class="hs-identifier hs-var">BL.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621688129388"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="annot"><a href="Hasura.Server.Logging.html#mkHttpErrorLogContext"><span class="hs-identifier hs-type">mkHttpErrorLogContext</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-464"></span><span>  </span><span class="hs-comment">-- | Maybe because it may not have been resolved</span><span>
</span><span id="line-465"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.Session.html#UserInfo"><span class="hs-identifier hs-type">UserInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-466"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">HashSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Logging.html#EngineLogType"><span class="hs-identifier hs-type">EngineLogType</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">Hasura</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-467"></span><span>  </span><span class="annot"><a href="Hasura.Server.Types.html#RequestId"><span class="hs-identifier hs-type">RequestId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-468"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Wai.Request</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">BL.ByteString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Value</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-470"></span><span>  </span><span class="annot"><a href="Hasura.Base.Error.html#QErr"><span class="hs-identifier hs-type">QErr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-471"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">DiffTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DiffTime</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-472"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Hasura.Server.Compression.html#CompressionType"><span class="hs-identifier hs-type">CompressionType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">HTTP.Header</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-474"></span><span>  </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogContext"><span class="hs-identifier hs-type">HttpLogContext</span></a></span><span>
</span><span id="line-475"></span><span id="mkHttpErrorLogContext"><span class="annot"><span class="annottext">mkHttpErrorLogContext :: Maybe UserInfo
-&gt; HashSet (EngineLogType Hasura)
-&gt; RequestId
-&gt; Request
-&gt; (ByteString, Maybe Value)
-&gt; QErr
-&gt; Maybe (DiffTime, DiffTime)
-&gt; Maybe CompressionType
-&gt; [Header]
-&gt; HttpLogContext
</span><a href="Hasura.Server.Logging.html#mkHttpErrorLogContext"><span class="hs-identifier hs-var hs-var">mkHttpErrorLogContext</span></a></span></span><span> </span><span id="local-6989586621688129351"><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621688129351"><span class="hs-identifier hs-var">userInfoM</span></a></span></span><span> </span><span id="local-6989586621688129350"><span class="annot"><span class="annottext">HashSet (EngineLogType Hasura)
</span><a href="#local-6989586621688129350"><span class="hs-identifier hs-var">enabledLogTypes</span></a></span></span><span> </span><span id="local-6989586621688129349"><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621688129349"><span class="hs-identifier hs-var">reqId</span></a></span></span><span> </span><span id="local-6989586621688129348"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129348"><span class="hs-identifier hs-var">waiReq</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621688129347"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621688129347"><span class="hs-identifier hs-var">reqBody</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621688129346"><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621688129346"><span class="hs-identifier hs-var">parsedReq</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621688129345"><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621688129345"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span id="local-6989586621688129344"><span class="annot"><span class="annottext">Maybe (DiffTime, DiffTime)
</span><a href="#local-6989586621688129344"><span class="hs-identifier hs-var">mTiming</span></a></span></span><span> </span><span id="local-6989586621688129343"><span class="annot"><span class="annottext">Maybe CompressionType
</span><a href="#local-6989586621688129343"><span class="hs-identifier hs-var">compressTypeM</span></a></span></span><span> </span><span id="local-6989586621688129342"><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621688129342"><span class="hs-identifier hs-var">headers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688129341"><span class="annot"><span class="annottext">http :: HttpInfoLog
</span><a href="#local-6989586621688129341"><span class="hs-identifier hs-var hs-var">http</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-477"></span><span>        </span><span class="annot"><span class="annottext">HttpInfoLog :: Status
-&gt; Text
-&gt; IpAddress
-&gt; Text
-&gt; HttpVersion
-&gt; Maybe CompressionType
-&gt; [Header]
-&gt; HttpInfoLog
</span><a href="Hasura.Server.Logging.html#HttpInfoLog"><span class="hs-identifier hs-type">HttpInfoLog</span></a></span><span>
</span><span id="line-478"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hlStatus :: Status
</span><a href="Hasura.Server.Logging.html#hlStatus"><span class="hs-identifier hs-var">hlStatus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QErr -&gt; Status
</span><a href="Hasura.Base.Error.html#qeStatus"><span class="hs-identifier hs-var hs-var">qeStatus</span></a></span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621688129345"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-479"></span><span>            </span><span class="annot"><span class="annottext">hlMethod :: Text
</span><a href="Hasura.Server.Logging.html#hlMethod"><span class="hs-identifier hs-var">hlMethod</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="Hasura.Prelude.html#bsToTxt"><span class="hs-identifier hs-var">bsToTxt</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var">Wai.requestMethod</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129348"><span class="hs-identifier hs-var">waiReq</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-480"></span><span>            </span><span class="annot"><span class="annottext">hlSource :: IpAddress
</span><a href="Hasura.Server.Logging.html#hlSource"><span class="hs-identifier hs-var">hlSource</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; IpAddress
</span><a href="Network.Wai.Extended.html#getSourceFromFallback"><span class="hs-identifier hs-var">Wai.getSourceFromFallback</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129348"><span class="hs-identifier hs-var">waiReq</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-481"></span><span>            </span><span class="annot"><span class="annottext">hlPath :: Text
</span><a href="Hasura.Server.Logging.html#hlPath"><span class="hs-identifier hs-var">hlPath</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="Hasura.Prelude.html#bsToTxt"><span class="hs-identifier hs-var">bsToTxt</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Request -&gt; ByteString
</span><span class="hs-identifier hs-var hs-var">Wai.rawPathInfo</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129348"><span class="hs-identifier hs-var">waiReq</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-482"></span><span>            </span><span class="annot"><span class="annottext">hlHttpVersion :: HttpVersion
</span><a href="Hasura.Server.Logging.html#hlHttpVersion"><span class="hs-identifier hs-var">hlHttpVersion</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Request -&gt; HttpVersion
</span><span class="hs-identifier hs-var hs-var">Wai.httpVersion</span></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621688129348"><span class="hs-identifier hs-var">waiReq</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-483"></span><span>            </span><span class="annot"><span class="annottext">hlCompression :: Maybe CompressionType
</span><a href="Hasura.Server.Logging.html#hlCompression"><span class="hs-identifier hs-var">hlCompression</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CompressionType
</span><a href="#local-6989586621688129343"><span class="hs-identifier hs-var">compressTypeM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-484"></span><span>            </span><span class="annot"><span class="annottext">hlHeaders :: [Header]
</span><a href="Hasura.Server.Logging.html#hlHeaders"><span class="hs-identifier hs-var">hlHeaders</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Header]
</span><a href="#local-6989586621688129342"><span class="hs-identifier hs-var">headers</span></a></span><span>
</span><span id="line-485"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-486"></span><span>      </span><span id="local-6989586621688129339"><span class="annot"><span class="annottext">op :: OperationLog
</span><a href="#local-6989586621688129339"><span class="hs-identifier hs-var hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-487"></span><span>        </span><span class="annot"><span class="annottext">OperationLog :: RequestId
-&gt; Maybe SessionVariables
-&gt; Maybe Int64
-&gt; Maybe Seconds
-&gt; Maybe Seconds
-&gt; Maybe Value
-&gt; Maybe Text
-&gt; Maybe QErr
-&gt; RequestMode
-&gt; OperationLog
</span><a href="Hasura.Server.Logging.html#OperationLog"><span class="hs-identifier hs-type">OperationLog</span></a></span><span>
</span><span id="line-488"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">olRequestId :: RequestId
</span><a href="Hasura.Server.Logging.html#olRequestId"><span class="hs-identifier hs-var">olRequestId</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621688129349"><span class="hs-identifier hs-var">reqId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-489"></span><span>            </span><span class="annot"><span class="annottext">olUserVars :: Maybe SessionVariables
</span><a href="Hasura.Server.Logging.html#olUserVars"><span class="hs-identifier hs-var">olUserVars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UserInfo -&gt; SessionVariables
</span><a href="Hasura.Session.html#_uiSession"><span class="hs-identifier hs-var hs-var">_uiSession</span></a></span><span> </span><span class="annot"><span class="annottext">(UserInfo -&gt; SessionVariables)
-&gt; Maybe UserInfo -&gt; Maybe SessionVariables
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe UserInfo
</span><a href="#local-6989586621688129351"><span class="hs-identifier hs-var">userInfoM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-490"></span><span>            </span><span class="annot"><span class="annottext">olResponseSize :: Maybe Int64
</span><a href="Hasura.Server.Logging.html#olResponseSize"><span class="hs-identifier hs-var">olResponseSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Maybe Int64
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; Maybe Int64) -&gt; Int64 -&gt; Maybe Int64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int64
</span><span class="hs-identifier hs-var">BL.length</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Int64) -&gt; ByteString -&gt; Int64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QErr -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">encode</span></span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621688129345"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-491"></span><span>            </span><span class="annot"><span class="annottext">olRequestReadTime :: Maybe Seconds
</span><a href="Hasura.Server.Logging.html#olRequestReadTime"><span class="hs-identifier hs-var">olRequestReadTime</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiffTime -&gt; Seconds
</span><a href="Data.Time.Clock.Units.html#Seconds"><span class="hs-identifier hs-var">Seconds</span></a></span><span> </span><span class="annot"><span class="annottext">(DiffTime -&gt; Seconds)
-&gt; ((DiffTime, DiffTime) -&gt; DiffTime)
-&gt; (DiffTime, DiffTime)
-&gt; Seconds
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DiffTime, DiffTime) -&gt; DiffTime
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((DiffTime, DiffTime) -&gt; Seconds)
-&gt; Maybe (DiffTime, DiffTime) -&gt; Maybe Seconds
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (DiffTime, DiffTime)
</span><a href="#local-6989586621688129344"><span class="hs-identifier hs-var">mTiming</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-492"></span><span>            </span><span class="annot"><span class="annottext">olQueryExecutionTime :: Maybe Seconds
</span><a href="Hasura.Server.Logging.html#olQueryExecutionTime"><span class="hs-identifier hs-var">olQueryExecutionTime</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiffTime -&gt; Seconds
</span><a href="Data.Time.Clock.Units.html#Seconds"><span class="hs-identifier hs-var">Seconds</span></a></span><span> </span><span class="annot"><span class="annottext">(DiffTime -&gt; Seconds)
-&gt; ((DiffTime, DiffTime) -&gt; DiffTime)
-&gt; (DiffTime, DiffTime)
-&gt; Seconds
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(DiffTime, DiffTime) -&gt; DiffTime
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((DiffTime, DiffTime) -&gt; Seconds)
-&gt; Maybe (DiffTime, DiffTime) -&gt; Maybe Seconds
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (DiffTime, DiffTime)
</span><a href="#local-6989586621688129344"><span class="hs-identifier hs-var">mTiming</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-493"></span><span>            </span><span class="annot"><span class="annottext">olQuery :: Maybe Value
</span><a href="Hasura.Server.Logging.html#olQuery"><span class="hs-identifier hs-var">olQuery</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Value -&gt; Maybe Value
forall a. Maybe a -&gt; Maybe a
</span><a href="#local-6989586621688129337"><span class="hs-identifier hs-var">reqToLog</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621688129346"><span class="hs-identifier hs-var">parsedReq</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-494"></span><span>            </span><span class="hs-comment">-- if parsedReq is Nothing, add the raw query</span><span>
</span><span id="line-495"></span><span>            </span><span class="annot"><span class="annottext">olRawQuery :: Maybe Text
</span><a href="Hasura.Server.Logging.html#olRawQuery"><span class="hs-identifier hs-var">olRawQuery</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; (Value -&gt; Maybe Text) -&gt; Maybe Value -&gt; Maybe Text
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; Maybe Text
forall a. Maybe a -&gt; Maybe a
</span><a href="#local-6989586621688129337"><span class="hs-identifier hs-var">reqToLog</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Text -&gt; Maybe Text) -&gt; Maybe Text -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe Text
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe Text) -&gt; Text -&gt; Maybe Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="Hasura.Prelude.html#bsToTxt"><span class="hs-identifier hs-var">bsToTxt</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BL.toStrict</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621688129347"><span class="hs-identifier hs-var">reqBody</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; Value -&gt; Maybe Text
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621688129346"><span class="hs-identifier hs-var">parsedReq</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-496"></span><span>            </span><span class="annot"><span class="annottext">olError :: Maybe QErr
</span><a href="Hasura.Server.Logging.html#olError"><span class="hs-identifier hs-var">olError</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QErr -&gt; Maybe QErr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">QErr
</span><a href="#local-6989586621688129345"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-497"></span><span>            </span><span class="annot"><span class="annottext">olRequestMode :: RequestMode
</span><a href="Hasura.Server.Logging.html#olRequestMode"><span class="hs-identifier hs-var">olRequestMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RequestMode
</span><a href="Hasura.Server.Logging.html#RequestModeError"><span class="hs-identifier hs-var">RequestModeError</span></a></span><span>
</span><span id="line-498"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span>      </span><span class="hs-comment">-- See Note [Disable query printing when query-log is disabled]</span><span>
</span><span id="line-501"></span><span>      </span><span id="local-6989586621688129926"><span class="annot"><a href="#local-6989586621688129337"><span class="hs-identifier hs-type">reqToLog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621688129926"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621688129926"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-502"></span><span>      </span><span id="local-6989586621688129337"><span class="annot"><span class="annottext">reqToLog :: Maybe a -&gt; Maybe a
</span><a href="#local-6989586621688129337"><span class="hs-identifier hs-var hs-var">reqToLog</span></a></span></span><span> </span><span id="local-6989586621688129333"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621688129333"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Maybe a -&gt; Bool -&gt; Maybe a
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621688129333"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Maybe a) -&gt; Bool -&gt; Maybe a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EngineLogType Hasura -&gt; HashSet (EngineLogType Hasura) -&gt; Bool
forall a. (Eq a, Hashable a) =&gt; a -&gt; HashSet a -&gt; Bool
</span><span class="hs-identifier hs-var">Set.member</span></span><span> </span><span class="annot"><span class="annottext">EngineLogType Hasura
</span><a href="Hasura.Logging.html#ELTQueryLog"><span class="hs-identifier hs-var">ELTQueryLog</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (EngineLogType Hasura)
</span><a href="#local-6989586621688129350"><span class="hs-identifier hs-var">enabledLogTypes</span></a></span><span>
</span><span id="line-503"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">HttpInfoLog
-&gt; OperationLog
-&gt; RequestId
-&gt; Maybe (NonEmpty BatchOperationLog)
-&gt; HttpLogContext
</span><a href="Hasura.Server.Logging.html#HttpLogContext"><span class="hs-identifier hs-var">HttpLogContext</span></a></span><span> </span><span class="annot"><span class="annottext">HttpInfoLog
</span><a href="#local-6989586621688129341"><span class="hs-identifier hs-var">http</span></a></span><span> </span><span class="annot"><span class="annottext">OperationLog
</span><a href="#local-6989586621688129339"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">RequestId
</span><a href="#local-6989586621688129349"><span class="hs-identifier hs-var">reqId</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (NonEmpty BatchOperationLog)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- Batched operation logs are always reported in logHttpSuccess even if there are errors</span><span>
</span><span id="line-504"></span><span>
</span><span id="line-505"></span><span class="hs-keyword">data</span><span> </span><span id="HttpLogLine"><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogLine"><span class="hs-identifier hs-var">HttpLogLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HttpLogLine"><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogLine"><span class="hs-identifier hs-var">HttpLogLine</span></a></span></span><span>
</span><span id="line-506"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="_hlLogLevel"><span class="annot"><span class="annottext">HttpLogLine -&gt; LogLevel
</span><a href="Hasura.Server.Logging.html#_hlLogLevel"><span class="hs-identifier hs-var hs-var">_hlLogLevel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Logging.html#LogLevel"><span class="hs-identifier hs-type">LogLevel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-507"></span><span>    </span><span id="_hlLogLine"><span class="annot"><span class="annottext">HttpLogLine -&gt; HttpLogContext
</span><a href="Hasura.Server.Logging.html#_hlLogLine"><span class="hs-identifier hs-var hs-var">_hlLogLine</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogContext"><span class="hs-identifier hs-type">HttpLogContext</span></a></span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Hasura.Logging.html#ToEngineLog"><span class="hs-identifier hs-type">ToEngineLog</span></a></span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogLine"><span class="hs-identifier hs-type">HttpLogLine</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">Hasura</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-511"></span><span>  </span><span id="local-6989586621688129327"><span class="annot"><span class="annottext">toEngineLog :: HttpLogLine -&gt; (LogLevel, EngineLogType Hasura, Value)
</span><a href="#local-6989586621688129327"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEngineLog</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogLine"><span class="hs-identifier hs-type">HttpLogLine</span></a></span><span> </span><span id="local-6989586621688129326"><span class="annot"><span class="annottext">LogLevel
</span><a href="#local-6989586621688129326"><span class="hs-identifier hs-var">logLevel</span></a></span></span><span> </span><span id="local-6989586621688129325"><span class="annot"><span class="annottext">HttpLogContext
</span><a href="#local-6989586621688129325"><span class="hs-identifier hs-var">logLine</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-512"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LogLevel
</span><a href="#local-6989586621688129326"><span class="hs-identifier hs-var">logLevel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EngineLogType Hasura
</span><a href="Hasura.Logging.html#ELTHttpLog"><span class="hs-identifier hs-var">ELTHttpLog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">HttpLogContext -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">HttpLogContext
</span><a href="#local-6989586621688129325"><span class="hs-identifier hs-var">logLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span class="annot"><a href="Hasura.Server.Logging.html#mkHttpLog"><span class="hs-identifier hs-type">mkHttpLog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogContext"><span class="hs-identifier hs-type">HttpLogContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hasura.Server.Logging.html#HttpLogLine"><span class="hs-identifier hs-type">HttpLogLine</span></a></span><span>
</span><span id="line-515"></span><span id="mkHttpLog"><span class="annot"><span class="annottext">mkHttpLog :: HttpLogContext -&gt; HttpLogLine
</span><a href="Hasura.Server.Logging.html#mkHttpLog"><span class="hs-identifier hs-var hs-var">mkHttpLog</span></a></span></span><span> </span><span id="local-6989586621688129323"><span class="annot"><span class="annottext">HttpLogContext
</span><a href="#local-6989586621688129323"><span class="hs-identifier hs-var">httpLogCtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-516"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688129322"><span class="annot"><span class="annottext">isError :: Bool
</span><a href="#local-6989586621688129322"><span class="hs-identifier hs-var hs-var">isError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe QErr -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe QErr -&gt; Bool) -&gt; Maybe QErr -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">OperationLog -&gt; Maybe QErr
</span><a href="Hasura.Server.Logging.html#olError"><span class="hs-identifier hs-var hs-var">olError</span></a></span><span> </span><span class="annot"><span class="annottext">(OperationLog -&gt; Maybe QErr) -&gt; OperationLog -&gt; Maybe QErr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HttpLogContext -&gt; OperationLog
</span><a href="Hasura.Server.Logging.html#hlcOperation"><span class="hs-identifier hs-var hs-var">hlcOperation</span></a></span><span> </span><span class="annot"><span class="annottext">HttpLogContext
</span><a href="#local-6989586621688129323"><span class="hs-identifier hs-var">httpLogCtx</span></a></span><span>
</span><span id="line-517"></span><span>      </span><span id="local-6989586621688129320"><span class="annot"><span class="annottext">logLevel :: LogLevel
</span><a href="#local-6989586621688129320"><span class="hs-identifier hs-var hs-var">logLevel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LogLevel -&gt; LogLevel -&gt; Bool -&gt; LogLevel
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="Hasura.Logging.html#LevelInfo"><span class="hs-identifier hs-var">LevelInfo</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="Hasura.Logging.html#LevelError"><span class="hs-identifier hs-var">LevelError</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621688129322"><span class="hs-identifier hs-var">isError</span></a></span><span>
</span><span id="line-518"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">LogLevel -&gt; HttpLogContext -&gt; HttpLogLine
</span><a href="Hasura.Server.Logging.html#HttpLogLine"><span class="hs-identifier hs-var">HttpLogLine</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="#local-6989586621688129320"><span class="hs-identifier hs-var">logLevel</span></a></span><span> </span><span class="annot"><span class="annottext">HttpLogContext
</span><a href="#local-6989586621688129323"><span class="hs-identifier hs-var">httpLogCtx</span></a></span><span>
</span><span id="line-519"></span><span>
</span><span id="line-520"></span><span class="hs-comment">-- | Log warning messages for deprecated environment variables</span><span>
</span><span id="line-521"></span><span class="annot"><a href="Hasura.Server.Logging.html#logDeprecatedEnvVars"><span class="hs-identifier hs-type">logDeprecatedEnvVars</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-522"></span><span>  </span><span class="annot"><a href="Hasura.Logging.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="annot"><a href="Hasura.Logging.html#Hasura"><span class="hs-identifier hs-type">Hasura</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-523"></span><span>  </span><span class="annot"><a href="Data.Environment.html#Environment"><span class="hs-identifier hs-type">Env.Environment</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-524"></span><span>  </span><span class="annot"><a href="Hasura.RQL.Types.Source.html#SourceCache"><span class="hs-identifier hs-type">SourceCache</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-525"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span id="logDeprecatedEnvVars"><span class="annot"><span class="annottext">logDeprecatedEnvVars :: Logger Hasura -&gt; Environment -&gt; SourceCache -&gt; IO ()
</span><a href="Hasura.Server.Logging.html#logDeprecatedEnvVars"><span class="hs-identifier hs-var hs-var">logDeprecatedEnvVars</span></a></span></span><span> </span><span id="local-6989586621688129317"><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621688129317"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621688129316"><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621688129316"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621688129315"><span class="annot"><span class="annottext">SourceCache
</span><a href="#local-6989586621688129315"><span class="hs-identifier hs-var">sources</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-527"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688129314"><span class="annot"><span class="annottext">toText :: f t -&gt; Text
</span><a href="#local-6989586621688129314"><span class="hs-identifier hs-var hs-var">toText</span></a></span></span><span> </span><span id="local-6989586621688129313"><span class="annot"><span class="annottext">f t
</span><a href="#local-6989586621688129313"><span class="hs-identifier hs-var">envVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f t -&gt; Text
forall t (f :: * -&gt; *). (ToTxt t, Foldable f) =&gt; f t -&gt; Text
</span><a href="Data.Text.Extended.html#commaSeparated"><span class="hs-identifier hs-var">commaSeparated</span></a></span><span> </span><span class="annot"><span class="annottext">f t
</span><a href="#local-6989586621688129313"><span class="hs-identifier hs-var">envVars</span></a></span><span>
</span><span id="line-528"></span><span>      </span><span class="hs-comment">-- The environment variables that have been initialized by user</span><span>
</span><span id="line-529"></span><span>      </span><span id="local-6989586621688129311"><span class="annot"><span class="annottext">envVarsInitialized :: [String]
</span><a href="#local-6989586621688129311"><span class="hs-identifier hs-var hs-var">envVarsInitialized</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((String, String) -&gt; String) -&gt; [(String, String)] -&gt; [String]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(String, String) -&gt; String
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Environment -&gt; [(String, String)]
</span><a href="Data.Environment.html#toList"><span class="hs-identifier hs-var">Env.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Environment
</span><a href="#local-6989586621688129316"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>      </span><span id="local-6989586621688129309"><span class="annot"><span class="annottext">checkDeprecatedEnvVars :: [String] -&gt; [Text]
</span><a href="#local-6989586621688129309"><span class="hs-identifier hs-var hs-var">checkDeprecatedEnvVars</span></a></span></span><span> </span><span id="local-6989586621688129308"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621688129308"><span class="hs-identifier hs-var">envs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; [String] -&gt; [Text]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621688129311"><span class="hs-identifier hs-var">envVarsInitialized</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">`intersect`</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621688129308"><span class="hs-identifier hs-var">envs</span></a></span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span>  </span><span class="hs-comment">-- When a source named 'default' is present, it means that it is a migrated v2</span><span>
</span><span id="line-533"></span><span>  </span><span class="hs-comment">-- hasura project. In such cases log those environment variables that are moved</span><span>
</span><span id="line-534"></span><span>  </span><span class="hs-comment">-- to the metadata</span><span>
</span><span id="line-535"></span><span>  </span><span class="annot"><span class="annottext">Maybe BackendSourceInfo -&gt; (BackendSourceInfo -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a.
Applicative m =&gt;
Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><a href="Hasura.Prelude.html#onJust"><span class="hs-identifier hs-var">onJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceName -&gt; SourceCache -&gt; Maybe BackendSourceInfo
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">HM.lookup</span></span><span> </span><span class="annot"><span class="annottext">SourceName
</span><a href="Hasura.RQL.Types.Common.html#SNDefault"><span class="hs-identifier hs-var">SNDefault</span></a></span><span> </span><span class="annot"><span class="annottext">SourceCache
</span><a href="#local-6989586621688129315"><span class="hs-identifier hs-var">sources</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((BackendSourceInfo -&gt; IO ()) -&gt; IO ())
-&gt; (BackendSourceInfo -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621688129302"><span class="annot"><span class="annottext">BackendSourceInfo
</span><a href="#local-6989586621688129302"><span class="hs-identifier hs-var">_defSource</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-536"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688129301"><span class="annot"><span class="annottext">deprecated :: [Text]
</span><a href="#local-6989586621688129301"><span class="hs-identifier hs-var hs-var">deprecated</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [Text]
</span><a href="#local-6989586621688129309"><span class="hs-identifier hs-var">checkDeprecatedEnvVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EnvVarsMovedToMetadata -&gt; [String]
</span><a href="Hasura.Server.Utils.html#unEnvVarsMovedToMetadata"><span class="hs-identifier hs-var hs-var">unEnvVarsMovedToMetadata</span></a></span><span> </span><span class="annot"><span class="annottext">EnvVarsMovedToMetadata
</span><a href="Hasura.Server.Utils.html#envVarsMovedToMetadata"><span class="hs-identifier hs-var">envVarsMovedToMetadata</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621688129301"><span class="hs-identifier hs-var">deprecated</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-538"></span><span>      </span><span class="annot"><span class="annottext">Logger Hasura
-&gt; forall a (m :: * -&gt; *).
   (ToEngineLog a Hasura, MonadIO m) =&gt;
   a -&gt; m ()
forall impl.
Logger impl
-&gt; forall a (m :: * -&gt; *).
   (ToEngineLog a impl, MonadIO m) =&gt;
   a -&gt; m ()
</span><a href="Hasura.Logging.html#unLogger"><span class="hs-identifier hs-var hs-var">unLogger</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621688129317"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">(UnstructuredLog -&gt; IO ()) -&gt; UnstructuredLog -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-539"></span><span>        </span><span class="annot"><span class="annottext">LogLevel -&gt; TByteString -&gt; UnstructuredLog
</span><a href="Hasura.Logging.html#UnstructuredLog"><span class="hs-identifier hs-var">UnstructuredLog</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="Hasura.Logging.html#LevelWarn"><span class="hs-identifier hs-var">LevelWarn</span></a></span><span> </span><span class="annot"><span class="annottext">(TByteString -&gt; UnstructuredLog) -&gt; TByteString -&gt; UnstructuredLog
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-540"></span><span>          </span><span class="annot"><span class="annottext">Text -&gt; TByteString
</span><a href="Data.TByteString.html#fromText"><span class="hs-identifier hs-var">TBS.fromText</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; TByteString) -&gt; Text -&gt; TByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-541"></span><span>            </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;The following environment variables are deprecated and moved to metadata: &quot;</span></span><span>
</span><span id="line-542"></span><span>              </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
forall t (f :: * -&gt; *). (ToTxt t, Foldable f) =&gt; f t -&gt; Text
</span><a href="#local-6989586621688129314"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621688129301"><span class="hs-identifier hs-var">deprecated</span></a></span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span>  </span><span class="hs-comment">-- Log when completely deprecated environment variables are present</span><span>
</span><span id="line-545"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621688129294"><span class="annot"><span class="annottext">deprecated :: [Text]
</span><a href="#local-6989586621688129294"><span class="hs-identifier hs-var hs-var">deprecated</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [Text]
</span><a href="#local-6989586621688129309"><span class="hs-identifier hs-var">checkDeprecatedEnvVars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DeprecatedEnvVars -&gt; [String]
</span><a href="Hasura.Server.Utils.html#unDeprecatedEnvVars"><span class="hs-identifier hs-var hs-var">unDeprecatedEnvVars</span></a></span><span> </span><span class="annot"><span class="annottext">DeprecatedEnvVars
</span><a href="Hasura.Server.Utils.html#deprecatedEnvVars"><span class="hs-identifier hs-var">deprecatedEnvVars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-546"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621688129294"><span class="hs-identifier hs-var">deprecated</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-547"></span><span>    </span><span class="annot"><span class="annottext">Logger Hasura
-&gt; forall a (m :: * -&gt; *).
   (ToEngineLog a Hasura, MonadIO m) =&gt;
   a -&gt; m ()
forall impl.
Logger impl
-&gt; forall a (m :: * -&gt; *).
   (ToEngineLog a impl, MonadIO m) =&gt;
   a -&gt; m ()
</span><a href="Hasura.Logging.html#unLogger"><span class="hs-identifier hs-var hs-var">unLogger</span></a></span><span> </span><span class="annot"><span class="annottext">Logger Hasura
</span><a href="#local-6989586621688129317"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">(UnstructuredLog -&gt; IO ()) -&gt; UnstructuredLog -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-548"></span><span>      </span><span class="annot"><span class="annottext">LogLevel -&gt; TByteString -&gt; UnstructuredLog
</span><a href="Hasura.Logging.html#UnstructuredLog"><span class="hs-identifier hs-var">UnstructuredLog</span></a></span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="Hasura.Logging.html#LevelWarn"><span class="hs-identifier hs-var">LevelWarn</span></a></span><span> </span><span class="annot"><span class="annottext">(TByteString -&gt; UnstructuredLog) -&gt; TByteString -&gt; UnstructuredLog
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-549"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; TByteString
</span><a href="Data.TByteString.html#fromText"><span class="hs-identifier hs-var">TBS.fromText</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; TByteString) -&gt; Text -&gt; TByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-550"></span><span>          </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;The following environment variables are deprecated: &quot;</span></span><span>
</span><span id="line-551"></span><span>            </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
forall t (f :: * -&gt; *). (ToTxt t, Foldable f) =&gt; f t -&gt; Text
</span><a href="#local-6989586621688129314"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621688129294"><span class="hs-identifier hs-var">deprecated</span></a></span><span>
</span><span id="line-552"></span></pre></body></html>